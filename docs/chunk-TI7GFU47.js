import{a as Le,b as Ct,d as E1,e as Br,g as Ve}from"./chunk-T4BLILQN.js";var Lm=E1((X9,Om)=>{"use strict";Om.exports=XMLHttpRequest});var J;(function(e){function t(a,c,u){return{kind:"variable",name:a,type:c,isConstraint:u}}e.Variable=t;function n(a,c,u){return{kind:"value",namespace:a,name:c,parent:u}}e.Value=n;function r(a,c,u,l){return{kind:"container",namespace:a,name:c,child:u,alias:l}}e.Container=r;function i(a){return{kind:"union",types:a}}e.Union=i;function o(a,c,u,l){let m=Object.create(null);for(let f of l)m[f]=!0;return{kind:"oneof",namespace:a,name:c,type:u,values:m}}e.OneOf=o,e.Any={kind:"any"},e.AnyValue={kind:"any-value"},e.Num=n("","Number"),e.Str=n("","String"),e.Bool=o("","Bool",e.Str,["true","false"]);function s({values:a}){return Object.keys(a).sort()}e.oneOfValues=s})(J||(J={}));var ni;(function(e){function t(c){return{name:c}}e.Symbol=t;function n(c,u){return u?{head:c,args:u}:{head:c}}e.Apply=n;function r(c){return!!c&&Array.isArray(c)}e.isArgumentsArray=r;function i(c){return!!c&&!Array.isArray(c)}e.isArgumentsMap=i;function o(c){return!s(c)&&!a(c)}e.isLiteral=o;function s(c){return!!c&&!!c.head&&typeof c=="object"}e.isApply=s;function a(c){return!!c&&typeof c.name=="string"}e.isSymbol=a})(ni||(ni={}));function be(e,t){let{description:n=void 0,isOptional:r=!1,isRest:i=!1,defaultValue:o=void 0}=t||{};return{type:e,isOptional:r,isRest:i,defaultValue:o,description:n}}var ze;(function(e){e.None=t({});function t(r){return{kind:"dictionary",map:r,"@type":0}}e.Dictionary=t;function n(r,i){let{nonEmpty:o=!1}=i||{};return{kind:"list",type:r,nonEmpty:o,"@type":0}}e.List=n})(ze||(ze={}));function Ou(e,t,n,r){let i=function(o){return ni.Apply(ni.Symbol(i.id),o)};return i.info={namespace:"",name:e,description:r},i.id="",i.args=t,i.type=n,i}function V3(e,t,n,r){let i=function(o){return ni.Apply(ni.Symbol(i.id),o)};return i.info={namespace:e,name:t,description:r},i.id=`${e}.${t}`,i.args=ze.None,i.type=n,i}function no(e){let t=e;return typeof t=="function"&&!!t.info&&!!t.args&&typeof t.info.namespace=="string"&&!!t.type}function Ke(e,t,n){return Ou("",e,t,n)}function Fo(e){qu("","",e)}function Oo(e){let t=[];return Gu(e,t),t}function Lu(e){let t=/([a-z])([A-Z])([a-z]|$)/g;return e.replace(t,(n,r,i,o)=>`${r}-${i.toLocaleLowerCase()}${o}`).replace(t,(n,r,i,o)=>`${r}-${i.toLocaleLowerCase()}${o}`)}function qu(e,t,n){if(no(n)){n.info.namespace=e,n.info.name=n.info.name||Lu(t),n.id=`${n.info.namespace}.${n.info.name}`;return}let r=`${n["@namespace"]||Lu(t)}`,i=e?`${e}.${r}`:r;for(let o of Object.keys(n))typeof n[o]!="object"&&!no(n[o])||qu(i,o,n[o])}function Gu(e,t){if(no(e)){t.push(e);return}for(let n of Object.keys(e))typeof e[n]!="object"&&!no(e[n])||Gu(e[n],t)}var at;(function(e){e.AnyVar=J.Variable("a",J.Any),e.AnyValueVar=J.Variable("a",J.Any),e.ConstrainedVar=J.Variable("a",J.Any,!0),e.Regex=J.Value("Core","Regex"),e.Set=t=>J.Container("Core","Set",t||e.AnyValueVar),e.List=t=>J.Container("Core","List",t||e.AnyVar),e.Fn=(t,n)=>J.Container("Core","Fn",t||e.AnyVar,n),e.Flags=(t,n)=>J.Container("Core","Flags",t,n),e.BitFlags=e.Flags(J.Num,"BitFlags")})(at||(at={}));function Vt(e,t){return Ke(ze.Dictionary({0:be(e)}),e,t)}function Er(e,t){return Ke(ze.List(e,{nonEmpty:!0}),e,t)}function wn(e,t,n){return Ke(ze.Dictionary({0:be(e),1:be(e)}),t,n)}var $3=ze.Dictionary({0:be(J.Num),1:be(J.Num)}),D1={"@header":"Types",bool:Ke(ze.Dictionary({0:be(J.AnyValue)}),J.Bool,"Convert a value to boolean."),num:Ke(ze.Dictionary({0:be(J.AnyValue)}),J.Num,"Convert a value to number."),str:Ke(ze.Dictionary({0:be(J.AnyValue)}),J.Str,"Convert a value to string."),regex:Ke(ze.Dictionary({0:be(J.Str,{description:"Expression"}),1:be(J.Str,{isOptional:!0,description:"Flags, e.g. 'i' for ignore case"})}),at.Regex,"Creates a regular expression from a string using the ECMAscript syntax."),list:Ke(ze.List(at.AnyVar),at.List()),set:Ke(ze.List(at.AnyValueVar),at.Set()),bitflags:Ke(ze.Dictionary({0:be(J.Num)}),at.BitFlags,"Interpret a number as bitflags."),compositeKey:Ke(ze.List(J.AnyValue),J.AnyValue)},M1={"@header":"Logic",not:Vt(J.Bool),and:Er(J.Bool),or:Er(J.Bool)},N1={"@header":"Control",eval:Ke(ze.Dictionary({0:be(at.Fn(at.AnyVar))}),at.AnyVar,"Evaluate a function."),fn:Ke(ze.Dictionary({0:be(at.AnyVar)}),at.Fn(at.AnyVar),'Wrap an expression to a "lazy" function.'),if:Ke(ze.Dictionary({0:be(J.Bool,{description:"Condition"}),1:be(J.Variable("a",J.Any),{description:"If true"}),2:be(J.Variable("b",J.Any),{description:"If false"})}),J.Union([J.Variable("a",J.Any),J.Variable("b",J.Any)])),assoc:Ke(ze.Dictionary({0:be(J.Str,{description:"Name"}),1:be(J.Variable("a",J.Any),{description:"Value to assign"})}),J.Variable("a",J.Any))},k1={"@header":"Relational",eq:wn(J.Variable("a",J.AnyValue,!0),J.Bool),neq:wn(J.Variable("a",J.AnyValue,!0),J.Bool),lt:wn(J.Num,J.Bool),lte:wn(J.Num,J.Bool),gr:wn(J.Num,J.Bool),gre:wn(J.Num,J.Bool),inRange:Ke(ze.Dictionary({0:be(J.Num,{description:"Value to test"}),1:be(J.Num,{description:"Minimum value"}),2:be(J.Num,{description:"Maximum value"})}),J.Bool,"Check if the value of the 1st argument is >= 2nd and <= 3rd.")},U1={"@header":"Math",add:Er(J.Num),sub:Er(J.Num),mult:Er(J.Num),div:wn(J.Num,J.Num),pow:wn(J.Num,J.Num),mod:wn(J.Num,J.Num),min:Er(J.Num),max:Er(J.Num),cantorPairing:wn(J.Num,J.Num),sortedCantorPairing:wn(J.Num,J.Num),invertCantorPairing:Ke(ze.Dictionary({0:be(J.Num)}),at.List(J.Num)),floor:Vt(J.Num),ceil:Vt(J.Num),roundInt:Vt(J.Num),trunc:Vt(J.Num),abs:Vt(J.Num),sign:Vt(J.Num),sqrt:Vt(J.Num),cbrt:Vt(J.Num),sin:Vt(J.Num),cos:Vt(J.Num),tan:Vt(J.Num),asin:Vt(J.Num),acos:Vt(J.Num),atan:Vt(J.Num),sinh:Vt(J.Num),cosh:Vt(J.Num),tanh:Vt(J.Num),exp:Vt(J.Num),log:Vt(J.Num),log10:Vt(J.Num),atan2:wn(J.Num,J.Num)},R1={"@header":"Strings",concat:Er(J.Str),match:Ke(ze.Dictionary({0:be(at.Regex),1:be(J.Str)}),J.Bool)},T1={"@header":"Lists",getAt:Ke(ze.Dictionary({0:be(at.List()),1:be(J.Num)}),at.AnyVar),equal:Ke(ze.Dictionary({0:be(at.List()),1:be(at.List())}),J.Bool)},F1={"@header":"Sets",has:Ke(ze.Dictionary({0:be(at.Set(at.ConstrainedVar)),1:be(at.ConstrainedVar)}),J.Bool,"Check if the the 1st argument includes the value of the 2nd."),isSubset:Ke(ze.Dictionary({0:be(at.Set(at.ConstrainedVar)),1:be(at.Set(at.ConstrainedVar))}),J.Bool,"Check if the the 1st argument is a subset of the 2nd.")},O1={"@header":"Flags",hasAny:Ke(ze.Dictionary({0:be(at.Flags(at.ConstrainedVar)),1:be(at.Flags(at.ConstrainedVar))}),J.Bool,"Check if the the 1st argument has at least one of the 2nd one's flags."),hasAll:Ke(ze.Dictionary({0:be(at.Flags(at.ConstrainedVar)),1:be(at.Flags(at.ConstrainedVar))}),J.Bool,"Check if the the 1st argument has all 2nd one's flags.")},Lo={"@header":"Language Primitives",type:D1,logic:M1,ctrl:N1,rel:k1,math:U1,str:R1,list:T1,set:F1,flags:O1};Fo(Lo);var L1=Oo(Lo),Q3=function(){let e=Object.create(null);for(let t of L1)e[t.id]=t;return e}();var Te;(function(e){e.ElementSymbol=J.Value("Structure","ElementSymbol"),e.AtomName=J.Value("Structure","AtomName"),e.BondFlag=J.OneOf("Structure","BondFlag",J.Str,["covalent","metallic","ion","hydrogen","sulfide","computed","aromatic"]),e.BondFlags=at.Flags(e.BondFlag,"BondFlags"),e.SecondaryStructureFlag=J.OneOf("Structure","SecondaryStructureFlag",J.Str,["alpha","beta","3-10","pi","sheet","strand","helix","turn","none"]),e.SecondaryStructureFlags=at.Flags(e.SecondaryStructureFlag,"SecondaryStructureFlag"),e.RingFingerprint=J.Value("Structure","RingFingerprint"),e.EntityType=J.OneOf("Structure","EntityType",J.Str,["polymer","non-polymer","water","branched"]),e.EntitySubtype=J.OneOf("Structure","EntitySubtype",J.Str,["other","polypeptide(D)","polypeptide(L)","polydeoxyribonucleotide","polyribonucleotide","polydeoxyribonucleotide/polyribonucleotide hybrid","cyclic-pseudo-peptide","peptide nucleic acid","oligosaccharide"]),e.ObjectPrimitive=J.OneOf("Structure","ObjectPrimitive",J.Str,["atomistic","sphere","gaussian","other"]),e.ResidueId=J.Value("Structure","ResidueId"),e.ElementSet=J.Value("Structure","ElementSet"),e.ElementSelection=J.Value("Structure","ElementSelection"),e.ElementReference=J.Value("Structure","ElementReference"),e.ElementSelectionQuery=at.Fn(e.ElementSelection,"ElementSelectionQuery")})(Te||(Te={}));var G1={"@header":"Types",elementSymbol:Ke(ze.Dictionary({0:be(J.Str)}),Te.ElementSymbol,"Create element symbol representation from a string value."),atomName:Ke(ze.Dictionary({0:be(J.AnyValue)}),Te.AtomName,"Convert a value to an atom name."),entityType:Ke(ze.Dictionary({0:be(Te.EntityType)}),Te.EntityType,`Create normalized representation of entity type: ${J.oneOfValues(Te.EntityType).join(", ")}.`),bondFlags:Ke(ze.List(Te.BondFlag),Te.BondFlags,`Create bond flags representation from a list of strings. Allowed flags: ${J.oneOfValues(Te.BondFlag).join(", ")}.`),ringFingerprint:Ke(ze.List(Te.ElementSymbol,{nonEmpty:!0}),Te.RingFingerprint,"Create ring fingerprint from the supplied atom element list."),secondaryStructureFlags:Ke(ze.List(Te.SecondaryStructureFlag),Te.SecondaryStructureFlags,`Create secondary structure flags representation from a list of strings. Allowed flags: ${J.oneOfValues(Te.SecondaryStructureFlag).join(", ")}.`),authResidueId:Ke(ze.Dictionary({0:be(J.Str,{description:"auth_asym_id"}),1:be(J.Num,{description:"auth_seq_id"}),2:be(J.Str,{description:"pdbx_PDB_ins_code",isOptional:!0})}),Te.ResidueId,'Residue identifier based on "auth_" annotation.'),labelResidueId:Ke(ze.Dictionary({0:be(J.Str,{description:"label_entity_id"}),1:be(J.Str,{description:"label_asym_id"}),2:be(J.Num,{description:"label_seq_id"}),3:be(J.Str,{description:"pdbx_PDB_ins_code",isOptional:!0})}),Te.ResidueId,`Residue identifier based on mmCIF's "label_" annotation.`)},H1={"@header":"Iteration Slots",element:Ke(ze.None,Te.ElementReference,"A reference to the current element."),elementSetReduce:Ke(ze.None,J.Variable("a",J.AnyValue,!0),"Current value of the element set reducer.")},z1={"@header":"Generators",all:Ke(ze.None,Te.ElementSelectionQuery,"The entire structure."),atomGroups:Ke(ze.Dictionary({"entity-test":be(J.Bool,{isOptional:!0,defaultValue:!0,description:"Test for the 1st atom of every entity"}),"chain-test":be(J.Bool,{isOptional:!0,defaultValue:!0,description:"Test for the 1st atom of every chain"}),"residue-test":be(J.Bool,{isOptional:!0,defaultValue:!0,description:"Test for the 1st atom every residue"}),"atom-test":be(J.Bool,{isOptional:!0,defaultValue:!0}),"group-by":be(J.Any,{isOptional:!0,defaultValue:"atom-key",description:"Group atoms to sets based on this property. Default: each atom has its own set"})}),Te.ElementSelectionQuery,"Return all atoms for which the tests are satisfied, grouped into sets."),bondedAtomicPairs:Ke(ze.Dictionary({0:be(J.Bool,{isOptional:!0,defaultValue:"true for covalent bonds",description:"Test each bond with this predicate. Each bond is visited twice with swapped atom order."})}),Te.ElementSelectionQuery,"Return all pairs of atoms for which the test is satisfied."),rings:Ke(ze.Dictionary({fingerprint:be(Te.RingFingerprint,{isOptional:!0}),"only-aromatic":be(J.Bool,{isOptional:!0,defaultValue:!1})}),Te.ElementSelectionQuery,"Return all rings or those with the specified fingerprint and/or only aromatic rings."),queryInSelection:Ke(ze.Dictionary({0:be(Te.ElementSelectionQuery),query:be(Te.ElementSelectionQuery),"in-complement":be(J.Bool,{isOptional:!0,defaultValue:!1})}),Te.ElementSelectionQuery,"Executes query only on atoms that are in the source selection."),empty:Ke(ze.None,Te.ElementSelectionQuery,"Nada.")},V1={"@header":"Selection Modifications",queryEach:Ke(ze.Dictionary({0:be(Te.ElementSelectionQuery),query:be(Te.ElementSelectionQuery)}),Te.ElementSelectionQuery,"Query every atom set in the input selection separately."),intersectBy:Ke(ze.Dictionary({0:be(Te.ElementSelectionQuery),by:be(Te.ElementSelectionQuery)}),Te.ElementSelectionQuery,"Intersect each atom set from the first sequence from atoms in the second one."),exceptBy:Ke(ze.Dictionary({0:be(Te.ElementSelectionQuery),by:be(Te.ElementSelectionQuery)}),Te.ElementSelectionQuery,"Remove all atoms from 'selection' that occur in 'by'."),unionBy:Ke(ze.Dictionary({0:be(Te.ElementSelectionQuery),by:be(Te.ElementSelectionQuery)}),Te.ElementSelectionQuery,"For each atom set A in the orginal sequence, combine all atoms sets in the target selection that intersect with A."),union:Ke(ze.Dictionary({0:be(Te.ElementSelectionQuery)}),Te.ElementSelectionQuery,"Collects all atom sets in the sequence into a single atom set."),cluster:Ke(ze.Dictionary({0:be(Te.ElementSelectionQuery),"min-distance":be(J.Num,{isOptional:!0,defaultValue:0}),"max-distance":be(J.Num),"min-size":be(J.Num,{description:"Minimal number of sets to merge, must be at least 2",isOptional:!0,defaultValue:2}),"max-size":be(J.Num,{description:"Maximal number of sets to merge, if not set, no limit",isOptional:!0})}),Te.ElementSelectionQuery,"Combines atom sets that have mutual distance in the interval [min-radius, max-radius]. Minimum/maximum size determines how many atom sets can be combined."),includeSurroundings:Ke(ze.Dictionary({0:be(Te.ElementSelectionQuery),radius:be(J.Num),"atom-radius":be(J.Num,{isOptional:!0,defaultValue:0,description:"Value added to each atom before the distance check, for example VDW radius. Using this argument is computationally demanding."}),"as-whole-residues":be(J.Bool,{isOptional:!0})}),Te.ElementSelectionQuery,"For each atom set in the selection, include all surrouding atoms/residues that are within the specified radius."),surroundingLigands:Ke(ze.Dictionary({0:be(Te.ElementSelectionQuery),radius:be(J.Num),"include-water":be(J.Bool,{isOptional:!0,defaultValue:!0})}),Te.ElementSelectionQuery,"Find all ligands components around the source query."),includeConnected:Ke(ze.Dictionary({0:be(Te.ElementSelectionQuery),"bond-test":be(J.Bool,{isOptional:!0,defaultValue:"true for covalent bonds"}),"layer-count":be(J.Num,{isOptional:!0,defaultValue:1,description:"Number of bonded layers to include."}),"fixed-point":be(J.Bool,{isOptional:!0,defaultValue:!1,description:"Continue adding layers as long as new connections exist."}),"as-whole-residues":be(J.Bool,{isOptional:!0})}),Te.ElementSelectionQuery,"Pick all atom sets that are connected to the target."),wholeResidues:Ke(ze.Dictionary({0:be(Te.ElementSelectionQuery)}),Te.ElementSelectionQuery,"Expand the selection to whole residues."),expandProperty:Ke(ze.Dictionary({0:be(Te.ElementSelectionQuery),property:be(J.AnyValue)}),Te.ElementSelectionQuery,"To each atom set in the selection, add all atoms that have the same property value that was already present in the set.")},K1={"@header":"Selection Filters",pick:Ke(ze.Dictionary({0:be(Te.ElementSelectionQuery),test:be(J.Bool)}),Te.ElementSelectionQuery,"Pick all atom sets that satisfy the test."),first:Ke(ze.Dictionary({0:be(Te.ElementSelectionQuery)}),Te.ElementSelectionQuery,"Take the 1st atom set in the sequence."),withSameAtomProperties:Ke(ze.Dictionary({0:be(Te.ElementSelectionQuery),source:be(Te.ElementSelectionQuery),property:be(J.Any)}),Te.ElementSelectionQuery,"Pick all atom sets for which the set of given atom properties is a subset of the source properties."),intersectedBy:Ke(ze.Dictionary({0:be(Te.ElementSelectionQuery),by:be(Te.ElementSelectionQuery)}),Te.ElementSelectionQuery,"Pick all atom sets that have non-zero intersection with the target."),within:Ke(ze.Dictionary({0:be(Te.ElementSelectionQuery),target:be(Te.ElementSelectionQuery),"min-radius":be(J.Num,{isOptional:!0,defaultValue:0}),"max-radius":be(J.Num),"atom-radius":be(J.Num,{isOptional:!0,defaultValue:0,description:"Value added to each atom before the distance check, for example VDW radius. Using this argument is computationally demanding."}),invert:be(J.Bool,{isOptional:!0,defaultValue:!1,description:"If true, pick only atom sets that are further than the specified radius."})}),Te.ElementSelectionQuery,"Pick all atom sets from selection that have any atom within the radius of any atom from target."),isConnectedTo:Ke(ze.Dictionary({0:be(Te.ElementSelectionQuery),target:be(Te.ElementSelectionQuery),"bond-test":be(J.Bool,{isOptional:!0,defaultValue:"true for covalent bonds"}),disjunct:be(J.Bool,{isOptional:!0,defaultValue:!0,description:"If true, there must exist a bond to an atom that lies outside the given atom set to pass test."}),invert:be(J.Bool,{isOptional:!0,defaultValue:!1,description:"If true, return atom sets that are not connected."})}),Te.ElementSelectionQuery,"Pick all atom sets that are connected to the target.")},j1={"@header":"Selection Combinators",intersect:Ke(ze.List(Te.ElementSelectionQuery),Te.ElementSelectionQuery,"Return all unique atom sets that appear in all of the source selections."),merge:Ke(ze.List(Te.ElementSelectionQuery),Te.ElementSelectionQuery,"Merges multiple selections into a single one. Only unique atom sets are kept."),distanceCluster:Ke(ze.Dictionary({matrix:be(at.List(at.List(J.Num)),{description:"Distance matrix, represented as list of rows (num[][])). Lower triangle is min distance, upper triangle is max distance."}),selections:be(at.List(Te.ElementSelectionQuery),{description:"A list of held selections."})}),Te.ElementSelectionQuery,"Pick combinations of atom sets from the source sequences that are mutually within distances specified by a matrix.")},Y1={"@header":"Atom Sets",atomCount:Ke(ze.None,J.Num),countQuery:Ke(ze.Dictionary({0:be(Te.ElementSelectionQuery)}),J.Num,"Counts the number of occurences of a specific query inside the current atom set."),reduce:Ke(ze.Dictionary({initial:be(J.Variable("a",J.AnyValue,!0),{description:"Initial value assigned to slot.atom-set-reduce. Current atom is set to the 1st atom of the current set for this."}),value:be(J.Variable("a",J.AnyValue,!0),{description:"Expression executed for each atom in the set"})}),J.Variable("a",J.AnyValue,!0),"Execute the value expression for each atom in the current atom set and return the result. Works the same way as Array.reduce in JavaScript (``result = value(value(...value(initial)))``)"),propertySet:Ke(ze.Dictionary({0:be(at.ConstrainedVar)}),at.Set(at.ConstrainedVar),"Returns a set with all values of the given property in the current atom set.")},Z1={"@header":"Atom Properties",core:{"@header":"Core Properties",elementSymbol:ct(Te.ElementSymbol),vdw:ct(J.Num,"Van der Waals radius"),mass:ct(J.Num,"Atomic weight"),atomicNumber:ct(J.Num,"Atomic number"),x:ct(J.Num,"Cartesian X coordinate"),y:ct(J.Num,"Cartesian Y coordinate"),z:ct(J.Num,"Cartesian Z coordinate"),atomKey:ct(J.AnyValue,"Unique value for each atom. Main use case is grouping of atoms."),bondCount:Ke(ze.Dictionary({0:be(Te.ElementReference,{isOptional:!0,defaultValue:"slot.current-atom"}),flags:be(Te.BondFlags,{isOptional:!0,defaultValue:"covalent"})}),J.Num,"Number of bonds (by default only covalent bonds are counted)."),sourceIndex:ct(J.Num,"Index of the atom/element in the input file."),operatorName:ct(J.Str,"Name of the symmetry operator applied to this element."),operatorKey:ct(J.Num,"Key of the symmetry operator applied to this element."),modelIndex:ct(J.Num,"Index of the model in the input file."),modelLabel:ct(J.Str,"Label/header of the model in the input file.")},topology:{connectedComponentKey:ct(J.AnyValue,"Unique value for each connected component.")},macromolecular:{"@header":"Macromolecular Properties (derived from the mmCIF format)",authResidueId:ct(Te.ResidueId,"type.auth-residue-id symbol executed on current atom's residue"),labelResidueId:ct(Te.ResidueId,"type.label-residue-id symbol executed on current atom's residue"),residueKey:ct(J.AnyValue,"Unique value for each tuple ``(label_entity_id,auth_asym_id, auth_seq_id, pdbx_PDB_ins_code)``, main use case is grouping of atoms"),chainKey:ct(J.AnyValue,"Unique value for each tuple ``(label_entity_id, auth_asym_id)``, main use case is grouping of atoms"),entityKey:ct(J.AnyValue,"Unique value for each tuple ``label_entity_id``, main use case is grouping of atoms"),isHet:ct(J.Bool,"Equivalent to atom_site.group_PDB !== ATOM"),id:ct(J.Num,"_atom_site.id"),label_atom_id:ct(Te.AtomName),label_alt_id:ct(J.Str),label_comp_id:ct(J.Str),label_asym_id:ct(J.Str),label_entity_id:ct(J.Str),label_seq_id:ct(J.Num),auth_atom_id:ct(Te.AtomName),auth_comp_id:ct(J.Str),auth_asym_id:ct(J.Str),auth_seq_id:ct(J.Num),pdbx_PDB_ins_code:ct(J.Str),pdbx_formal_charge:ct(J.Num),occupancy:ct(J.Num),B_iso_or_equiv:ct(J.Num),entityType:ct(Te.EntityType,"Type of the entity as defined in mmCIF (polymer, non-polymer, branched, water)"),entitySubtype:ct(Te.EntitySubtype,"Subtype of the entity as defined in mmCIF _entity_poly.type and _pdbx_entity_branch.type (other, polypeptide(D), polypeptide(L), polydeoxyribonucleotide, polyribonucleotide, polydeoxyribonucleotide/polyribonucleotide hybrid, cyclic-pseudo-peptide, peptide nucleic acid, oligosaccharide)"),entityPrdId:ct(J.Str,"The PRD ID of the entity."),entityDescription:ct(at.List(J.Str)),objectPrimitive:ct(Te.ObjectPrimitive,"Type of the primitive object used to model this segment as defined in mmCIF/IHM (atomistic, sphere, gaussian, other)"),secondaryStructureKey:ct(J.AnyValue,"Unique value for each secondary structure element."),secondaryStructureFlags:ct(Te.SecondaryStructureFlags),isModified:ct(J.Bool,"True if the atom belongs to modification of a standard residue."),modifiedParentName:ct(J.Str,"'3-letter' code of the modifed parent residue."),isNonStandard:ct(J.Bool,"True if this is a non-standard residue."),chemCompType:ct(J.Str,"Type of the chemical component as defined in mmCIF.")}},W1={"@header":"Bond Properties",flags:Si(Te.BondFlags),order:Si(J.Num),key:Si(J.Num),length:Si(J.Num),atomA:Si(Te.ElementReference),atomB:Si(Te.ElementReference)};function ct(e,t){return Ke(ze.Dictionary({0:be(Te.ElementReference,{isOptional:!0,defaultValue:"slot.current-atom"})}),e,t)}function Si(e,t){return Ke(ze.None,e,t)}var Hu={"@header":"Structure Queries",type:G1,slot:H1,generator:z1,modifier:V1,filter:K1,combinator:j1,atomSet:Y1,atomProperty:Z1,bondProperty:W1};var $1={"@header":"Generators",bundleElement:Ke(ze.Dictionary({groupedUnits:be(J.Any),set:be(J.Any),ranges:be(J.Any)}),J.Any),bundle:Ke(ze.Dictionary({elements:be(J.Any)}),Te.ElementSelectionQuery,"A selection with single structure containing represented by the bundle."),current:Ke(ze.None,Te.ElementSelectionQuery,"Current selection provided by the query context. Avoid using this in State Transforms.")},zu={"@header":"Internal Queries",generator:$1};var Ii={core:Lo,structureQuery:Hu,internal:zu};Fo(Ii);var Q1=Oo(Ii),lA=function(){let e=Object.create(null);for(let t of Q1)e[t.id]=t;return e}();var St;(function(e){e.core=Ii.core,e.struct=Ii.structureQuery,e.internal=Ii.internal;function t(g){return e.struct.type.atomName([g])}e.atomName=t;function n(g){return e.struct.type.elementSymbol([g])}e.es=n;function r(...g){return e.core.type.list(g)}e.list=r;function i(...g){return e.core.type.set(g)}e.set=i;function o(g,C){return e.core.type.regex([g,C])}e.re=o;function s(g){return e.core.ctrl.fn([g])}e.fn=s;function a(g){return e.core.ctrl.eval([g])}e.evaluate=a;let c=e.struct.atomProperty.core,u=e.struct.atomProperty.macromolecular,l=e.struct.atomProperty.topology;function m(g){return c[g]()}e.acp=m;function f(g){return l[g]()}e.atp=f;function d(g){return u[g]()}e.ammp=d;let p=e.struct.atomSet.propertySet;function h(g){return p([m(g)])}e.acpSet=h;function x(g){return p([f(g)])}e.atpSet=x;function y(g){return p([d(g)])}e.ammpSet=y})(St||(St={}));var ya=class{add(t){let n=this.getHash(t);if(this.byHash.has(n)){let r=this.byHash.get(n);for(let i=0,o=r.length;i<o;i++)if(this.areEqual(t,r[i]))return!1;return r[r.length]=t,this.size++,!0}else return this.byHash.set(n,[t]),this.size++,!0}has(t){let n=this.getHash(t);if(!this.byHash.has(n))return!1;let r=this.byHash.get(n);for(let i=0,o=r.length;i<o;i++)if(this.areEqual(t,r[i]))return!0;return!1}constructor(t,n){this.getHash=t,this.areEqual=n,this.size=0,this.byHash=new Map}};function wi(e,t){return new ya(e,t)}function hA(){return new xa}function Vu(e){return{previous:null,next:null,inList:!0,value:e}}var xa=class{constructor(){this.count=0,this.first=null,this.last=null}addFirst(t){let n=Vu(t);return n.inList=!0,this.first&&(this.first.previous=n),n.next=this.first,this.first=n,this.count++,this.last||(this.last=n),n}addLast(t){let n=Vu(t);return this.last!==null&&(this.last.next=n),n.previous=this.last,this.last=n,this.first===null&&(this.first=n),n.inList=!0,this.count++,n}removeFirst(){let t=this.first;if(t)return this.remove(t),t.value}removeLast(){let t=this.last;if(t)return this.remove(t),t.value}remove(t){t.inList&&(t.inList=!1,t.previous!==null?t.previous.next=t.next:t.previous===null&&(this.first=t.next),t.next!==null?t.next.previous=t.previous:t.next===null&&(this.last=t.previous),t.next=null,t.previous=null,this.count--)}find(t){let n=this.first;for(;n!==null;){if(n.value===t)return n;n=n.next}}};var It;(function(e){function t(){return{keys:new Set,array:[]}}e.create=t;function n({keys:i,array:o},s,a){return i.has(s)?!1:(i.add(s),o[o.length]=a,!0)}e.add=n;function r({keys:i},o){return i.has(o)}e.has=r})(It||(It={}));var ht={};Br(ht,{Bundle:()=>wo,Location:()=>yt,Loci:()=>Hr,Stats:()=>ku,atomicProperty:()=>w3,chainIndex:()=>B3,coarseProperty:()=>v3,entityIndex:()=>E3,property:()=>I3,residueIndex:()=>P3});function Ht(e,t,n){return Math.abs(e-t)<=n}function ep(e,t,n){return(e-t)/(n-t)}function Fn(e,t,n){return Math.max(t,Math.min(n,e))}function tp(e){return Fn(e,0,1)}function qo(e,t,n){return e+(t-e)*n}function Go(e,t,n,r,i,o){let s=(n-e)*o,a=(r-t)*o,c=i*i,u=i*c;return(2*t-2*n+s+a)*u+(-3*t+3*n-2*s-a)*c+s*i+t}function Ho(e,t,n,r){let i=1-r;return i*i*e+2*i*r*t+r*r*n}function CA(e,t,n){return n=tp(ep(n,e,t)),n*n*(3-2*n)}var Aa=isFinite;function N(){return N.zero()}(function(e){function t(){let G=[.1,0,0];return G[0]=0,G}e.zero=t;function n(G){let Y=t();return Y[0]=G[0],Y[1]=G[1],Y[2]=G[2],Y}e.clone=n;function r(G){return Aa(G[0])&&Aa(G[1])&&Aa(G[2])}e.isFinite=r;function i(G){return isNaN(G[0])||isNaN(G[1])||isNaN(G[2])}e.hasNaN=i;function o(G){return G[0]=NaN,G[1]=NaN,G[2]=NaN,G}e.setNaN=o;function s(G){return l(G.x,G.y,G.z)}e.fromObj=s;function a(G){return{x:G[0],y:G[1],z:G[2]}}e.toObj=a;function c(G,Y,X){return G[0]=Y[X+0],G[1]=Y[X+1],G[2]=Y[X+2],G}e.fromArray=c;function u(G,Y,X){return Y[X+0]=G[0],Y[X+1]=G[1],Y[X+2]=G[2],Y}e.toArray=u;function l(G,Y,X){let ye=t();return ye[0]=G,ye[1]=Y,ye[2]=X,ye}e.create=l;function m(G){let Y=t();return Y[0]=G[0],Y[1]=G[1],Y[2]=G[2],Y}e.ofArray=m;function f(G,Y,X,ye){return G[0]=Y,G[1]=X,G[2]=ye,G}e.set=f;function d(G,Y){return G[0]=Y[0],G[1]=Y[1],G[2]=Y[2],G}e.copy=d;function p(G,Y,X){return G[0]=Y[0]+X[0],G[1]=Y[1]+X[1],G[2]=Y[2]+X[2],G}e.add=p;function h(G,Y,X){return G[0]=Y[0]-X[0],G[1]=Y[1]-X[1],G[2]=Y[2]-X[2],G}e.sub=h;function x(G,Y,X){return G[0]=Y[0]*X[0],G[1]=Y[1]*X[1],G[2]=Y[2]*X[2],G}e.mul=x;function y(G,Y,X){return G[0]=Y[0]/X[0],G[1]=Y[1]/X[1],G[2]=Y[2]/X[2],G}e.div=y;function g(G,Y,X){return G[0]=Y[0]*X,G[1]=Y[1]*X,G[2]=Y[2]*X,G}e.scale=g;function C(G,Y,X,ye){return G[0]=Y[0]+X[0]*ye,G[1]=Y[1]+X[1]*ye,G[2]=Y[2]+X[2]*ye,G}e.scaleAndAdd=C;function _(G,Y,X,ye){return G[0]=Y[0]-X[0]*ye,G[1]=Y[1]-X[1]*ye,G[2]=Y[2]-X[2]*ye,G}e.scaleAndSub=_;function b(G,Y,X){return G[0]=Y[0]+X,G[1]=Y[1]+X,G[2]=Y[2]+X,G}e.addScalar=b;function I(G,Y,X){return G[0]=Y[0]-X,G[1]=Y[1]-X,G[2]=Y[2]-X,G}e.subScalar=I;function E(G,Y){return G[0]=Math.round(Y[0]),G[1]=Math.round(Y[1]),G[2]=Math.round(Y[2]),G}e.round=E;function S(G,Y){return G[0]=Math.ceil(Y[0]),G[1]=Math.ceil(Y[1]),G[2]=Math.ceil(Y[2]),G}e.ceil=S;function v(G,Y){return G[0]=Math.floor(Y[0]),G[1]=Math.floor(Y[1]),G[2]=Math.floor(Y[2]),G}e.floor=v;function P(G,Y){return G[0]=Math.trunc(Y[0]),G[1]=Math.trunc(Y[1]),G[2]=Math.trunc(Y[2]),G}e.trunc=P;function L(G,Y){return G[0]=Math.abs(Y[0]),G[1]=Math.abs(Y[1]),G[2]=Math.abs(Y[2]),G}e.abs=L;function w(G,Y,X){return G[0]=Math.min(Y[0],X[0]),G[1]=Math.min(Y[1],X[1]),G[2]=Math.min(Y[2],X[2]),G}e.min=w;function D(G,Y,X){return G[0]=Math.max(Y[0],X[0]),G[1]=Math.max(Y[1],X[1]),G[2]=Math.max(Y[2],X[2]),G}e.max=D;function z(G,Y,X,ye){return G[0]=Math.max(X[0],Math.min(ye[0],Y[0])),G[1]=Math.max(X[1],Math.min(ye[1],Y[1])),G[2]=Math.max(X[2],Math.min(ye[2],Y[2])),G}e.clamp=z;function ie(G,Y){let X=Y[0]-G[0],ye=Y[1]-G[1],Ge=Y[2]-G[2];return Math.sqrt(X*X+ye*ye+Ge*Ge)}e.distance=ie;function O(G,Y){let X=Y[0]-G[0],ye=Y[1]-G[1],Ge=Y[2]-G[2];return X*X+ye*ye+Ge*Ge}e.squaredDistance=O;function Q(G){let Y=G[0],X=G[1],ye=G[2];return Math.sqrt(Y*Y+X*X+ye*ye)}e.magnitude=Q;function K(G){let Y=G[0],X=G[1],ye=G[2];return Y*Y+X*X+ye*ye}e.squaredMagnitude=K;function Z(G,Y,X){return g(G,Ce(G,Y),X)}e.setMagnitude=Z;function se(G,Y){return G[0]=-Y[0],G[1]=-Y[1],G[2]=-Y[2],G}e.negate=se;function fe(G,Y){return G[0]=1/Y[0],G[1]=1/Y[1],G[2]=1/Y[2],G}e.inverse=fe;function Ce(G,Y){let X=Y[0],ye=Y[1],Ge=Y[2],Re=X*X+ye*ye+Ge*Ge;return Re>0&&(Re=1/Math.sqrt(Re),G[0]=Y[0]*Re,G[1]=Y[1]*Re,G[2]=Y[2]*Re),G}e.normalize=Ce;function xe(G,Y){return G[0]*Y[0]+G[1]*Y[1]+G[2]*Y[2]}e.dot=xe;function H(G,Y,X){let ye=Y[0],Ge=Y[1],Re=Y[2],et=X[0],tt=X[1],Mt=X[2];return G[0]=Ge*Mt-Re*tt,G[1]=Re*et-ye*Mt,G[2]=ye*tt-Ge*et,G}e.cross=H;function $(G,Y,X,ye){let Ge=Y[0],Re=Y[1],et=Y[2];return G[0]=Ge+ye*(X[0]-Ge),G[1]=Re+ye*(X[1]-Re),G[2]=et+ye*(X[2]-et),G}e.lerp=$;let de=t();function T(G,Y,X,ye){let Ge=Fn(xe(Y,X),-1,1),Re=Math.acos(Ge)*ye;return C(de,X,Y,-Ge),Ce(de,de),p(G,g(G,Y,Math.cos(Re)),g(de,de,Math.sin(Re)))}e.slerp=T;function B(G,Y,X,ye,Ge,Re){let et=Re*Re,tt=et*(2*Re-3)+1,Mt=et*(Re-2)+Re,qt=et*(Re-1),Tn=et*(3-2*Re);return G[0]=Y[0]*tt+X[0]*Mt+ye[0]*qt+Ge[0]*Tn,G[1]=Y[1]*tt+X[1]*Mt+ye[1]*qt+Ge[1]*Tn,G[2]=Y[2]*tt+X[2]*Mt+ye[2]*qt+Ge[2]*Tn,G}e.hermite=B;function k(G,Y,X,ye,Ge,Re){let et=1-Re,tt=et*et,Mt=Re*Re,qt=tt*et,Tn=3*Re*tt,ei=3*Mt*et,ti=Mt*Re;return G[0]=Y[0]*qt+X[0]*Tn+ye[0]*ei+Ge[0]*ti,G[1]=Y[1]*qt+X[1]*Tn+ye[1]*ei+Ge[1]*ti,G[2]=Y[2]*qt+X[2]*Tn+ye[2]*ei+Ge[2]*ti,G}e.bezier=k;function R(G,Y,X,ye,Ge){return G[0]=Ho(Y[0],X[0],ye[0],Ge),G[1]=Ho(Y[1],X[1],ye[1],Ge),G[2]=Ho(Y[2],X[2],ye[2],Ge),G}e.quadraticBezier=R;function V(G,Y,X,ye,Ge,Re,et){return G[0]=Go(Y[0],X[0],ye[0],Ge[0],Re,et),G[1]=Go(Y[1],X[1],ye[1],Ge[1],Re,et),G[2]=Go(Y[2],X[2],ye[2],Ge[2],Re,et),G}e.spline=V;function j(G,Y){let X=Math.random()*2*Math.PI,ye=Math.random()*2-1,Ge=Math.sqrt(1-ye*ye)*Y;return G[0]=Math.cos(X)*Ge,G[1]=Math.sin(X)*Ge,G[2]=ye*Y,G}e.random=j;function oe(G,Y,X){let ye=Y[0],Ge=Y[1],Re=Y[2],et=1/(X[3]*ye+X[7]*Ge+X[11]*Re+X[15]||1);return G[0]=(X[0]*ye+X[4]*Ge+X[8]*Re+X[12])*et,G[1]=(X[1]*ye+X[5]*Ge+X[9]*Re+X[13])*et,G[2]=(X[2]*ye+X[6]*Ge+X[10]*Re+X[14])*et,G}e.transformMat4=oe;function ae(G,Y,X){let ye=Y[0],Ge=Y[1],Re=Y[2];return G[0]=X[0]*ye+X[4]*Ge+X[8]*Re,G[1]=X[1]*ye+X[5]*Ge+X[9]*Re,G[2]=X[2]*ye+X[6]*Ge+X[10]*Re,Ce(G,G)}e.transformDirection=ae;function ne(G,Y,X,ye,Ge,Re){let et=Y[0+Ge],tt=Y[1+Ge],Mt=Y[2+Ge],qt=1/(X[3+Re]*et+X[7+Re]*tt+X[11+Re]*Mt+X[15+Re]||1);return G[0+ye]=(X[0+Re]*et+X[4+Re]*tt+X[8+Re]*Mt+X[12+Re])*qt,G[1+ye]=(X[1+Re]*et+X[5+Re]*tt+X[9+Re]*Mt+X[13+Re])*qt,G[2+ye]=(X[2+Re]*et+X[6+Re]*tt+X[10+Re]*Mt+X[14+Re])*qt,G}e.transformMat4Offset=ne;function q(G,Y,X,ye,Ge,Re){let et=Y[0+Ge],tt=Y[1+Ge],Mt=Y[2+Ge];G[0+ye]=X[0+Re]*et+X[4+Re]*tt+X[8+Re]*Mt,G[1+ye]=X[1+Re]*et+X[5+Re]*tt+X[9+Re]*Mt,G[2+ye]=X[2+Re]*et+X[6+Re]*tt+X[10+Re]*Mt;let qt=Math.hypot(G[0+ye],G[1+ye],G[2+ye]);return qt>0&&(G[0+ye]/=qt,G[1+ye]/=qt,G[2+ye]/=qt),G}e.transformDirectionOffset=q;function F(G,Y,X){let ye=Y[0],Ge=Y[1],Re=Y[2];return G[0]=ye*X[0]+Ge*X[3]+Re*X[6],G[1]=ye*X[1]+Ge*X[4]+Re*X[7],G[2]=ye*X[2]+Ge*X[5]+Re*X[8],G}e.transformMat3=F;function W(G,Y,X){let ye=Y[0],Ge=Y[1],Re=Y[2],et=X[0],tt=X[1],Mt=X[2],qt=X[3],Tn=qt*ye+tt*Re-Mt*Ge,ei=qt*Ge+Mt*ye-et*Re,ti=qt*Re+et*Ge-tt*ye,ga=-et*ye-tt*Ge-Mt*Re;return G[0]=Tn*qt+ga*-et+ei*-Mt-ti*-tt,G[1]=ei*qt+ga*-tt+ti*-et-Tn*-Mt,G[2]=ti*qt+ga*-Mt+Tn*-tt-ei*-et,G}e.transformQuat=W;function re(G,Y){let X=Math.sqrt(K(G)*K(Y));if(X===0)return Math.PI/2;let ye=xe(G,Y)/X;return Math.acos(Fn(ye,-1,1))}e.angle=re;let _e=t(),Ae=t(),Ze=t(),A=t(),M=t(),te=t(),ce=t();function pe(G,Y,X,ye){h(_e,G,Y),h(Ae,X,Y),h(Ze,Y,X),h(A,ye,X),H(M,_e,Ae),H(te,Ze,A);let Ge=re(M,te);return H(ce,M,te),xe(Ae,ce)>0?Ge:-Ge}e.dihedralAngle=pe;function he(G,Y,X,ye){return e.set(G,ye*Math.cos(X)*Math.sin(Y),ye*Math.sin(X)*Math.sin(Y),ye*Math.cos(Y))}e.directionFromSpherical=he;function Se(G,Y){return G[0]===Y[0]&&G[1]===Y[1]&&G[2]===Y[2]}e.exactEquals=Se;function Ee(G,Y){let X=G[0],ye=G[1],Ge=G[2],Re=Y[0],et=Y[1],tt=Y[2];return Math.abs(X-Re)<=1e-6*Math.max(1,Math.abs(X),Math.abs(Re))&&Math.abs(ye-et)<=1e-6*Math.max(1,Math.abs(ye),Math.abs(et))&&Math.abs(Ge-tt)<=1e-6*Math.max(1,Math.abs(Ge),Math.abs(tt))}e.equals=Ee;let Ne=t();function Pe(G,Y,X){let ye=re(Y,X);if(Math.abs(ye)<1e-4)return ke.setIdentity(G);if(Math.abs(ye-Math.PI)<1e-6)return ke.fromScaling(G,e.negUnit);let Ge=H(Ne,Y,X);return ke.fromRotation(G,ye,Ge)}e.makeRotation=Pe;function ve(G){return G[0]===0&&G[1]===0&&G[2]===0}e.isZero=ve;function Fe(G,Y,X,ye){h(G,Y,ye);let Ge=xe(X,G)/K(X);return p(G,g(G,X,Ge),ye)}e.projectPointOnVector=Fe;let Oe=t();function Me(G,Y,X,ye){return Ce(Oe,X),h(G,Y,ye),h(G,Y,g(Oe,Oe,xe(G,Oe)))}e.projectPointOnPlane=Me;function He(G,Y,X){let ye=xe(X,Y)/K(X);return g(G,X,ye)}e.projectOnVector=He;let je=t();function it(G,Y,X){return He(je,Y,X),h(G,Y,je)}e.projectOnPlane=it;function gt(G,Y,X){return Ce(G,H(G,H(G,Y,X),Y))}e.orthogonalize=gt;function Nt(G,Y,X){return xe(Y,X)>0?d(G,Y):se(G,d(G,Y)),G}e.matchDirection=Nt;let lt=t(),st=t();function ft(G,Y,X,ye){return h(lt,X,Y),h(st,ye,Y),Ce(G,H(G,lt,st))}e.triangleNormal=ft;function Xe(G,Y){return`[${G[0].toPrecision(Y)} ${G[1].toPrecision(Y)} ${G[2].toPrecision(Y)}]`}e.toString=Xe,e.origin=l(0,0,0),e.unit=l(1,1,1),e.negUnit=l(-1,-1,-1),e.unitX=l(1,0,0),e.unitY=l(0,1,0),e.unitZ=l(0,0,1),e.negUnitX=l(-1,0,0),e.negUnitY=l(0,-1,0),e.negUnitZ=l(0,0,-1)})(N||(N={}));var BA=Math.PI/2,Ku=Math.PI/180;function Kn(e){return e*Ku}function On(e){return e/Ku}function EA(e){return e!==0&&(e&e-1)===0}function DA(...e){let t=0,n=0;for(let r=0,i=e.length;r<i;++r){let o=e[r],s=Math.abs(o);s>n&&(t=o,n=s)}return t}function MA(e,t){return e*t}function NA(e){let t=0,n=0,r=[0,-1],i=e*2+1,o=i/2,s=[];for(let a=Math.pow(i,2);a>0;--a)-o<t&&t<=o&&-o<n&&n<=o&&s.push([t,n]),(t===n||t<0&&t===-n||t>0&&t===1-n)&&([r[0],r[1]]=[-r[1],r[0]]),t+=r[0],n+=r[1];return s}function ke(){return ke.zero()}(function(e){function t(){let A=[.1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];return A[0]=0,A}e.zero=t;function n(){let A=t();return A[0]=1,A[1]=0,A[2]=0,A[3]=0,A[4]=0,A[5]=1,A[6]=0,A[7]=0,A[8]=0,A[9]=0,A[10]=1,A[11]=0,A[12]=0,A[13]=0,A[14]=0,A[15]=1,A}e.identity=n;function r(A){return A[0]=1,A[1]=0,A[2]=0,A[3]=0,A[4]=0,A[5]=1,A[6]=0,A[7]=0,A[8]=0,A[9]=0,A[10]=1,A[11]=0,A[12]=0,A[13]=0,A[14]=0,A[15]=1,A}e.setIdentity=r;function i(A){for(let M=0;M<16;M++)A[M]=0;return A}e.setZero=i;function o(A){let M=t();for(let te=0;te<4;te++){let ce=A[te];for(let pe=0;pe<4;pe++)M[4*pe+te]=ce[pe]}return M}e.ofRows=o;let s=n();function a(A,M){return u(A,s,typeof M>"u"?1e-6:M)}e.isIdentity=a;function c(A){for(let M=0;M<16;M++)if(isNaN(A[M]))return!0;return!1}e.hasNaN=c;function u(A,M,te){for(let ce=0;ce<16;ce++)if(Math.abs(A[ce]-M[ce])>te)return!1;return!0}e.areEqual=u;function l(A,M,te,ce){A[4*te+M]=ce}e.setValue=l;function m(A,M,te){return A[4*te+M]}e.getValue=m;function f(A,M,te){return M[te+0]=A[0],M[te+1]=A[1],M[te+2]=A[2],M[te+3]=A[3],M[te+4]=A[4],M[te+5]=A[5],M[te+6]=A[6],M[te+7]=A[7],M[te+8]=A[8],M[te+9]=A[9],M[te+10]=A[10],M[te+11]=A[11],M[te+12]=A[12],M[te+13]=A[13],M[te+14]=A[14],M[te+15]=A[15],M}e.toArray=f;function d(A,M,te){return A[0]=M[te+0],A[1]=M[te+1],A[2]=M[te+2],A[3]=M[te+3],A[4]=M[te+4],A[5]=M[te+5],A[6]=M[te+6],A[7]=M[te+7],A[8]=M[te+8],A[9]=M[te+9],A[10]=M[te+10],A[11]=M[te+11],A[12]=M[te+12],A[13]=M[te+13],A[14]=M[te+14],A[15]=M[te+15],A}e.fromArray=d;function p(A,M,te,ce){return i(A),l(A,0,0,M[0]),l(A,1,0,M[1]),l(A,2,0,M[2]),l(A,0,1,te[0]),l(A,1,1,te[1]),l(A,2,1,te[2]),l(A,0,2,ce[0]),l(A,1,2,ce[1]),l(A,2,2,ce[2]),l(A,3,3,1),A}e.fromBasis=p;function h(A,M){return A[0]=M[0],A[1]=M[1],A[2]=M[2],A[3]=M[3],A[4]=M[4],A[5]=M[5],A[6]=M[6],A[7]=M[7],A[8]=M[8],A[9]=M[9],A[10]=M[10],A[11]=M[11],A[12]=M[12],A[13]=M[13],A[14]=M[14],A[15]=M[15],A}e.copy=h;function x(A){return h(t(),A)}e.clone=x;function y(A,M){return A[0]=M[12],A[1]=M[13],A[2]=M[14],A}e.getTranslation=y;function g(A,M){let te=M[0],ce=M[1],pe=M[2],he=M[4],Se=M[5],Ee=M[6],Ne=M[8],Pe=M[9],ve=M[10];return A[0]=Math.sqrt(te*te+ce*ce+pe*pe),A[1]=Math.sqrt(he*he+Se*Se+Ee*Ee),A[2]=Math.sqrt(Ne*Ne+Pe*Pe+ve*ve),A}e.getScaling=g;function C(A,M){let te=M[0]+M[5]+M[10],ce=0;return te>0?(ce=Math.sqrt(te+1)*2,A[3]=.25*ce,A[0]=(M[6]-M[9])/ce,A[1]=(M[8]-M[2])/ce,A[2]=(M[1]-M[4])/ce):M[0]>M[5]&&M[0]>M[10]?(ce=Math.sqrt(1+M[0]-M[5]-M[10])*2,A[3]=(M[6]-M[9])/ce,A[0]=.25*ce,A[1]=(M[1]+M[4])/ce,A[2]=(M[8]+M[2])/ce):M[5]>M[10]?(ce=Math.sqrt(1+M[5]-M[0]-M[10])*2,A[3]=(M[8]-M[2])/ce,A[0]=(M[1]+M[4])/ce,A[1]=.25*ce,A[2]=(M[6]+M[9])/ce):(ce=Math.sqrt(1+M[10]-M[0]-M[5])*2,A[3]=(M[1]-M[4])/ce,A[0]=(M[8]+M[2])/ce,A[1]=(M[6]+M[9])/ce,A[2]=.25*ce),A}e.getRotation=C;function _(A,M){let te=1/Math.sqrt(M[0]*M[0]+M[1]*M[1]+M[2]*M[2]),ce=1/Math.sqrt(M[4]*M[4]+M[5]*M[5]+M[6]*M[6]),pe=1/Math.sqrt(M[8]*M[8]+M[9]*M[9]+M[10]*M[10]);return A[0]=M[0]*te,A[1]=M[1]*te,A[2]=M[2]*te,A[3]=0,A[4]=M[4]*ce,A[5]=M[5]*ce,A[6]=M[6]*ce,A[7]=0,A[8]=M[8]*pe,A[9]=M[9]*pe,A[10]=M[10]*pe,A[11]=0,A[12]=0,A[13]=0,A[14]=0,A[15]=1,A}e.extractRotation=_;function b(A,M){if(A===M){let te=M[1],ce=M[2],pe=M[3],he=M[6],Se=M[7],Ee=M[11];A[1]=M[4],A[2]=M[8],A[3]=M[12],A[4]=te,A[6]=M[9],A[7]=M[13],A[8]=ce,A[9]=he,A[11]=M[14],A[12]=pe,A[13]=Se,A[14]=Ee}else A[0]=M[0],A[1]=M[4],A[2]=M[8],A[3]=M[12],A[4]=M[1],A[5]=M[5],A[6]=M[9],A[7]=M[13],A[8]=M[2],A[9]=M[6],A[10]=M[10],A[11]=M[14],A[12]=M[3],A[13]=M[7],A[14]=M[11],A[15]=M[15];return A}e.transpose=b;function I(A,M){let te=M[0],ce=M[1],pe=M[2],he=M[3],Se=M[4],Ee=M[5],Ne=M[6],Pe=M[7],ve=M[8],Fe=M[9],Oe=M[10],Me=M[11],He=M[12],je=M[13],it=M[14],gt=M[15],Nt=te*Ee-ce*Se,lt=te*Ne-pe*Se,st=te*Pe-he*Se,ft=ce*Ne-pe*Ee,Xe=ce*Pe-he*Ee,G=pe*Pe-he*Ne,Y=ve*je-Fe*He,X=ve*it-Oe*He,ye=ve*gt-Me*He,Ge=Fe*it-Oe*je,Re=Fe*gt-Me*je,et=Oe*gt-Me*it,tt=Nt*et-lt*Re+st*Ge+ft*ye-Xe*X+G*Y;return tt?(tt=1/tt,A[0]=(Ee*et-Ne*Re+Pe*Ge)*tt,A[1]=(pe*Re-ce*et-he*Ge)*tt,A[2]=(je*G-it*Xe+gt*ft)*tt,A[3]=(Oe*Xe-Fe*G-Me*ft)*tt,A[4]=(Ne*ye-Se*et-Pe*X)*tt,A[5]=(te*et-pe*ye+he*X)*tt,A[6]=(it*st-He*G-gt*lt)*tt,A[7]=(ve*G-Oe*st+Me*lt)*tt,A[8]=(Se*Re-Ee*ye+Pe*Y)*tt,A[9]=(ce*ye-te*Re-he*Y)*tt,A[10]=(He*Xe-je*st+gt*Nt)*tt,A[11]=(Fe*st-ve*Xe-Me*Nt)*tt,A[12]=(Ee*X-Se*Ge-Ne*Y)*tt,A[13]=(te*Ge-ce*X+pe*Y)*tt,A[14]=(je*lt-He*ft-it*Nt)*tt,A[15]=(ve*ft-Fe*lt+Oe*Nt)*tt,!0):!1}e.tryInvert=I;function E(A,M){return I(A,M)||console.warn("non-invertible matrix.",M),A}e.invert=E;function S(A,M,te){let ce=M[0],pe=M[1],he=M[2],Se=M[3],Ee=M[4],Ne=M[5],Pe=M[6],ve=M[7],Fe=M[8],Oe=M[9],Me=M[10],He=M[11],je=M[12],it=M[13],gt=M[14],Nt=M[15],lt=te[0],st=te[1],ft=te[2],Xe=te[3];return A[0]=lt*ce+st*Ee+ft*Fe+Xe*je,A[1]=lt*pe+st*Ne+ft*Oe+Xe*it,A[2]=lt*he+st*Pe+ft*Me+Xe*gt,A[3]=lt*Se+st*ve+ft*He+Xe*Nt,lt=te[4],st=te[5],ft=te[6],Xe=te[7],A[4]=lt*ce+st*Ee+ft*Fe+Xe*je,A[5]=lt*pe+st*Ne+ft*Oe+Xe*it,A[6]=lt*he+st*Pe+ft*Me+Xe*gt,A[7]=lt*Se+st*ve+ft*He+Xe*Nt,lt=te[8],st=te[9],ft=te[10],Xe=te[11],A[8]=lt*ce+st*Ee+ft*Fe+Xe*je,A[9]=lt*pe+st*Ne+ft*Oe+Xe*it,A[10]=lt*he+st*Pe+ft*Me+Xe*gt,A[11]=lt*Se+st*ve+ft*He+Xe*Nt,lt=te[12],st=te[13],ft=te[14],Xe=te[15],A[12]=lt*ce+st*Ee+ft*Fe+Xe*je,A[13]=lt*pe+st*Ne+ft*Oe+Xe*it,A[14]=lt*he+st*Pe+ft*Me+Xe*gt,A[15]=lt*Se+st*ve+ft*He+Xe*Nt,A}e.mul=S;function v(A,M,te,ce,pe,he){let Se=M[0+pe],Ee=M[1+pe],Ne=M[2+pe],Pe=M[3+pe],ve=M[4+pe],Fe=M[5+pe],Oe=M[6+pe],Me=M[7+pe],He=M[8+pe],je=M[9+pe],it=M[10+pe],gt=M[11+pe],Nt=M[12+pe],lt=M[13+pe],st=M[14+pe],ft=M[15+pe],Xe=te[0+he],G=te[1+he],Y=te[2+he],X=te[3+he];return A[0+ce]=Xe*Se+G*ve+Y*He+X*Nt,A[1+ce]=Xe*Ee+G*Fe+Y*je+X*lt,A[2+ce]=Xe*Ne+G*Oe+Y*it+X*st,A[3+ce]=Xe*Pe+G*Me+Y*gt+X*ft,Xe=te[4+he],G=te[5+he],Y=te[6+he],X=te[7+he],A[4+ce]=Xe*Se+G*ve+Y*He+X*Nt,A[5+ce]=Xe*Ee+G*Fe+Y*je+X*lt,A[6+ce]=Xe*Ne+G*Oe+Y*it+X*st,A[7+ce]=Xe*Pe+G*Me+Y*gt+X*ft,Xe=te[8+he],G=te[9+he],Y=te[10+he],X=te[11+he],A[8+ce]=Xe*Se+G*ve+Y*He+X*Nt,A[9+ce]=Xe*Ee+G*Fe+Y*je+X*lt,A[10+ce]=Xe*Ne+G*Oe+Y*it+X*st,A[11+ce]=Xe*Pe+G*Me+Y*gt+X*ft,Xe=te[12+he],G=te[13+he],Y=te[14+he],X=te[15+he],A[12+ce]=Xe*Se+G*ve+Y*He+X*Nt,A[13+ce]=Xe*Ee+G*Fe+Y*je+X*lt,A[14+ce]=Xe*Ne+G*Oe+Y*it+X*st,A[15+ce]=Xe*Pe+G*Me+Y*gt+X*ft,A}e.mulOffset=v;function P(A,M,te,ce){return S(A,S(A,M,te),ce)}e.mul3=P;function L(A,M,te){let ce=te[0],pe=te[1],he=te[2],Se,Ee,Ne,Pe,ve,Fe,Oe,Me,He,je,it,gt;return M===A?(A[12]=M[0]*ce+M[4]*pe+M[8]*he+M[12],A[13]=M[1]*ce+M[5]*pe+M[9]*he+M[13],A[14]=M[2]*ce+M[6]*pe+M[10]*he+M[14],A[15]=M[3]*ce+M[7]*pe+M[11]*he+M[15]):(Se=M[0],Ee=M[1],Ne=M[2],Pe=M[3],ve=M[4],Fe=M[5],Oe=M[6],Me=M[7],He=M[8],je=M[9],it=M[10],gt=M[11],A[0]=Se,A[1]=Ee,A[2]=Ne,A[3]=Pe,A[4]=ve,A[5]=Fe,A[6]=Oe,A[7]=Me,A[8]=He,A[9]=je,A[10]=it,A[11]=gt,A[12]=Se*ce+ve*pe+He*he+M[12],A[13]=Ee*ce+Fe*pe+je*he+M[13],A[14]=Ne*ce+Oe*pe+it*he+M[14],A[15]=Pe*ce+Me*pe+gt*he+M[15]),A}e.translate=L;function w(A,M){return A[0]=1,A[1]=0,A[2]=0,A[3]=0,A[4]=0,A[5]=1,A[6]=0,A[7]=0,A[8]=0,A[9]=0,A[10]=1,A[11]=0,A[12]=M[0],A[13]=M[1],A[14]=M[2],A[15]=1,A}e.fromTranslation=w;function D(A,M){return A[12]=M[0],A[13]=M[1],A[14]=M[2],A}e.setTranslation=D;function z(A,M,te,ce){return A[0]=te[0],A[4]=te[1],A[8]=te[2],A[1]=ce[0],A[5]=ce[1],A[9]=ce[2],A[2]=M[0],A[6]=M[1],A[10]=M[2],A}e.setAxes=z;function ie(A,M,te,ce){let pe=ce[0],he=ce[1],Se=ce[2],Ee=Math.sqrt(pe*pe+he*he+Se*Se);if(Math.abs(Ee)<1e-6)return n();Ee=1/Ee,pe*=Ee,he*=Ee,Se*=Ee;let Ne=Math.sin(te),Pe=Math.cos(te),ve=1-Pe,Fe=M[0],Oe=M[1],Me=M[2],He=M[3],je=M[4],it=M[5],gt=M[6],Nt=M[7],lt=M[8],st=M[9],ft=M[10],Xe=M[11],G=pe*pe*ve+Pe,Y=he*pe*ve+Se*Ne,X=Se*pe*ve-he*Ne,ye=pe*he*ve-Se*Ne,Ge=he*he*ve+Pe,Re=Se*he*ve+pe*Ne,et=pe*Se*ve+he*Ne,tt=he*Se*ve-pe*Ne,Mt=Se*Se*ve+Pe;return A[0]=Fe*G+je*Y+lt*X,A[1]=Oe*G+it*Y+st*X,A[2]=Me*G+gt*Y+ft*X,A[3]=He*G+Nt*Y+Xe*X,A[4]=Fe*ye+je*Ge+lt*Re,A[5]=Oe*ye+it*Ge+st*Re,A[6]=Me*ye+gt*Ge+ft*Re,A[7]=He*ye+Nt*Ge+Xe*Re,A[8]=Fe*et+je*tt+lt*Mt,A[9]=Oe*et+it*tt+st*Mt,A[10]=Me*et+gt*tt+ft*Mt,A[11]=He*et+Nt*tt+Xe*Mt,M!==A&&(A[12]=M[12],A[13]=M[13],A[14]=M[14],A[15]=M[15]),A}e.rotate=ie;function O(A,M,te){let ce=te[0],pe=te[1],he=te[2],Se=Math.sqrt(ce*ce+pe*pe+he*he);if(Math.abs(Se)<1e-6)return r(A);Se=1/Se,ce*=Se,pe*=Se,he*=Se;let Ee=Math.sin(M),Ne=Math.cos(M),Pe=1-Ne;return A[0]=ce*ce*Pe+Ne,A[1]=pe*ce*Pe+he*Ee,A[2]=he*ce*Pe-pe*Ee,A[3]=0,A[4]=ce*pe*Pe-he*Ee,A[5]=pe*pe*Pe+Ne,A[6]=he*pe*Pe+ce*Ee,A[7]=0,A[8]=ce*he*Pe+pe*Ee,A[9]=pe*he*Pe-ce*Ee,A[10]=he*he*Pe+Ne,A[11]=0,A[12]=0,A[13]=0,A[14]=0,A[15]=1,A}e.fromRotation=O;function Q(A,M,te){let ce=te[0],pe=te[1],he=te[2];return A[0]=M[0]*ce,A[1]=M[1]*ce,A[2]=M[2]*ce,A[3]=M[3]*ce,A[4]=M[4]*pe,A[5]=M[5]*pe,A[6]=M[6]*pe,A[7]=M[7]*pe,A[8]=M[8]*he,A[9]=M[9]*he,A[10]=M[10]*he,A[11]=M[11]*he,A[12]=M[12],A[13]=M[13],A[14]=M[14],A[15]=M[15],A}e.scale=Q;function K(A,M,te){return A[0]=M[0]*te,A[1]=M[1]*te,A[2]=M[2]*te,A[3]=M[3]*te,A[4]=M[4]*te,A[5]=M[5]*te,A[6]=M[6]*te,A[7]=M[7]*te,A[8]=M[8]*te,A[9]=M[9]*te,A[10]=M[10]*te,A[11]=M[11]*te,A[12]=M[12],A[13]=M[13],A[14]=M[14],A[15]=M[15],A}e.scaleUniformly=K;function Z(A,M){return A[0]=M[0],A[1]=0,A[2]=0,A[3]=0,A[4]=0,A[5]=M[1],A[6]=0,A[7]=0,A[8]=0,A[9]=0,A[10]=M[2],A[11]=0,A[12]=0,A[13]=0,A[14]=0,A[15]=1,A}e.fromScaling=Z;function se(A,M){return A[0]=M,A[1]=0,A[2]=0,A[3]=0,A[4]=0,A[5]=M,A[6]=0,A[7]=0,A[8]=0,A[9]=0,A[10]=M,A[11]=0,A[12]=0,A[13]=0,A[14]=0,A[15]=1,A}e.fromUniformScaling=se;function fe(A,M){return A[0]=M[0],A[1]=M[1],A[2]=M[2],A[4]=M[3],A[5]=M[4],A[6]=M[5],A[8]=M[6],A[9]=M[7],A[10]=M[8],A}e.fromMat3=fe;function Ce(A,M,te,ce){let[pe,he,Se,Ee]=te,Ne=pe+pe,Pe=he+he,ve=Se+Se,Fe=pe*Ne,Oe=pe*Pe,Me=pe*ve,He=he*Pe,je=he*ve,it=Se*ve,gt=Ee*Ne,Nt=Ee*Pe,lt=Ee*ve,[st,ft,Xe]=ce;return A[0]=(1-(He+it))*st,A[1]=(Oe+lt)*st,A[2]=(Me-Nt)*st,A[3]=0,A[4]=(Oe-lt)*ft,A[5]=(1-(Fe+it))*ft,A[6]=(je+gt)*ft,A[7]=0,A[8]=(Me+Nt)*Xe,A[9]=(je-gt)*Xe,A[10]=(1-(Fe+He))*Xe,A[11]=0,A[12]=M[0],A[13]=M[1],A[14]=M[2],A[15]=1,A}e.compose=Ce;let xe=[0,0,0],H=t();function $(A,M,te,ce){let pe=N.magnitude(N.set(xe,A[0],A[1],A[2])),he=N.magnitude(N.set(xe,A[4],A[5],A[6])),Se=N.magnitude(N.set(xe,A[8],A[9],A[10]));T(A)<0&&(pe=-pe),M[0]=A[12],M[1]=A[13],M[2]=A[14],h(H,A);let Ne=1/pe,Pe=1/he,ve=1/Se;return H[0]*=Ne,H[1]*=Ne,H[2]*=Ne,H[4]*=Pe,H[5]*=Pe,H[6]*=Pe,H[8]*=ve,H[9]*=ve,H[10]*=ve,C(te,H),ce[0]=pe,ce[1]=he,ce[2]=Se,A}e.decompose=$;function de(A){let M="";for(let te=0;te<4;te++){for(let ce=0;ce<4;ce++)M+=A[4*ce+te].toString(),ce<3&&(M+=" ");te<3&&(M+=`
`)}return M}e.makeTable=de;function T(A){let M=A[0],te=A[1],ce=A[2],pe=A[3],he=A[4],Se=A[5],Ee=A[6],Ne=A[7],Pe=A[8],ve=A[9],Fe=A[10],Oe=A[11],Me=A[12],He=A[13],je=A[14],it=A[15],gt=M*Se-te*he,Nt=M*Ee-ce*he,lt=M*Ne-pe*he,st=te*Ee-ce*Se,ft=te*Ne-pe*Se,Xe=ce*Ne-pe*Ee,G=Pe*He-ve*Me,Y=Pe*je-Fe*Me,X=Pe*it-Oe*Me,ye=ve*je-Fe*He,Ge=ve*it-Oe*He,Re=Fe*it-Oe*je;return gt*Re-Nt*Ge+lt*ye+st*X-ft*Y+Xe*G}e.determinant=T;function B(A,M){return k(A,typeof M<"u"?M:1e-6)}e.isRotationAndTranslation=B;function k(A,M){let te=A[0],ce=A[1],pe=A[2],he=A[3],Se=A[4],Ee=A[5],Ne=A[6],Pe=A[7],ve=A[8],Fe=A[9],Oe=A[10],Me=A[11],He=A[15];if(!Ht(He,1,M)||!Ht(he,0,M)||!Ht(Pe,0,M)||!Ht(Me,0,M))return!1;let je=Math.abs(te*(Ee*Oe-Ne*Fe)-ce*(Se*Oe-Ne*ve)+pe*(Se*Fe-Ee*ve));return!!Ht(je,1,M)}function R(A,M){return V(A,typeof M<"u"?M:1e-6)}e.isTranslationAndUniformScaling=R;function V(A,M){let te=A[0];return Ht(A[1],0,M)&&Ht(A[2],0,M)&&Ht(A[3],0,M)&&Ht(A[4],0,M)&&Ht(A[5],te,M)&&Ht(A[6],0,M)&&Ht(A[7],0,M)&&Ht(A[8],0,M)&&Ht(A[9],0,M)&&Ht(A[10],te,M)&&Ht(A[11],0,M)&&Ht(A[15],1,M)}function j(A,M){let te=M[0],ce=M[1],pe=M[2],he=M[3],Se=te+te,Ee=ce+ce,Ne=pe+pe,Pe=te*Se,ve=ce*Se,Fe=ce*Ee,Oe=pe*Se,Me=pe*Ee,He=pe*Ne,je=he*Se,it=he*Ee,gt=he*Ne;return A[0]=1-Fe-He,A[1]=ve+gt,A[2]=Oe-it,A[3]=0,A[4]=ve-gt,A[5]=1-Pe-He,A[6]=Me+je,A[7]=0,A[8]=Oe+it,A[9]=Me-je,A[10]=1-Pe-Fe,A[11]=0,A[12]=0,A[13]=0,A[14]=0,A[15]=1,A}e.fromQuat=j;function oe(A,M,te){let ce=M[0],pe=M[1],he=M[2],Se=Math.cos(ce),Ee=Math.sin(ce),Ne=Math.cos(pe),Pe=Math.sin(pe),ve=Math.cos(he),Fe=Math.sin(he);if(te==="XYZ"){let Oe=Se*ve,Me=Se*Fe,He=Ee*ve,je=Ee*Fe;A[0]=Ne*ve,A[4]=-Ne*Fe,A[8]=Pe,A[1]=Me+He*Pe,A[5]=Oe-je*Pe,A[9]=-Ee*Ne,A[2]=je-Oe*Pe,A[6]=He+Me*Pe,A[10]=Se*Ne}else if(te==="YXZ"){let Oe=Ne*ve,Me=Ne*Fe,He=Pe*ve,je=Pe*Fe;A[0]=Oe+je*Ee,A[4]=He*Ee-Me,A[8]=Se*Pe,A[1]=Se*Fe,A[5]=Se*ve,A[9]=-Ee,A[2]=Me*Ee-He,A[6]=je+Oe*Ee,A[10]=Se*Ne}else if(te==="ZXY"){let Oe=Ne*ve,Me=Ne*Fe,He=Pe*ve,je=Pe*Fe;A[0]=Oe-je*Ee,A[4]=-Se*Fe,A[8]=He+Me*Ee,A[1]=Me+He*Ee,A[5]=Se*ve,A[9]=je-Oe*Ee,A[2]=-Se*Pe,A[6]=Ee,A[10]=Se*Ne}else if(te==="ZYX"){let Oe=Se*ve,Me=Se*Fe,He=Ee*ve,je=Ee*Fe;A[0]=Ne*ve,A[4]=He*Pe-Me,A[8]=Oe*Pe+je,A[1]=Ne*Fe,A[5]=je*Pe+Oe,A[9]=Me*Pe-He,A[2]=-Pe,A[6]=Ee*Ne,A[10]=Se*Ne}else if(te==="YZX"){let Oe=Se*Ne,Me=Se*Pe,He=Ee*Ne,je=Ee*Pe;A[0]=Ne*ve,A[4]=je-Oe*Fe,A[8]=He*Fe+Me,A[1]=Fe,A[5]=Se*ve,A[9]=-Ee*ve,A[2]=-Pe*ve,A[6]=Me*Fe+He,A[10]=Oe-je*Fe}else if(te==="XZY"){let Oe=Se*Ne,Me=Se*Pe,He=Ee*Ne,je=Ee*Pe;A[0]=Ne*ve,A[4]=-Fe,A[8]=Pe*ve,A[1]=Oe*Fe+je,A[5]=Se*ve,A[9]=Me*Fe-He,A[2]=He*Fe-Me,A[6]=Ee*ve,A[10]=je*Fe+Oe}return A[3]=0,A[7]=0,A[11]=0,A[12]=0,A[13]=0,A[14]=0,A[15]=1,A}e.fromEuler=oe;function ae(A,M,te,ce,pe,he,Se){let Ee=2*he/(te-M),Ne=2*he/(ce-pe),Pe=(te+M)/(te-M),ve=(ce+pe)/(ce-pe),Fe=-(Se+he)/(Se-he),Oe=-2*Se*he/(Se-he);return A[0]=Ee,A[1]=0,A[2]=0,A[3]=0,A[4]=0,A[5]=Ne,A[6]=0,A[7]=0,A[8]=Pe,A[9]=ve,A[10]=Fe,A[11]=-1,A[12]=0,A[13]=0,A[14]=Oe,A[15]=0,A}e.perspective=ae;function ne(A,M,te,ce,pe,he,Se){let Ee=1/(te-M),Ne=1/(ce-pe),Pe=1/(Se-he),ve=(te+M)*Ee,Fe=(ce+pe)*Ne,Oe=(Se+he)*Pe;return A[0]=2*Ee,A[1]=0,A[2]=0,A[3]=0,A[4]=0,A[5]=2*Ne,A[6]=0,A[7]=0,A[8]=0,A[9]=0,A[10]=-2*Pe,A[11]=0,A[12]=-ve,A[13]=-Fe,A[14]=-Oe,A[15]=1,A}e.ortho=ne;function q(A,M,te,ce){let pe,he,Se,Ee,Ne,Pe,ve,Fe,Oe,Me,He=M[0],je=M[1],it=M[2],gt=ce[0],Nt=ce[1],lt=ce[2],st=te[0],ft=te[1],Xe=te[2];return Math.abs(He-st)<1e-6&&Math.abs(je-ft)<1e-6&&Math.abs(it-Xe)<1e-6?r(A):(ve=He-st,Fe=je-ft,Oe=it-Xe,Me=1/Math.sqrt(ve*ve+Fe*Fe+Oe*Oe),ve*=Me,Fe*=Me,Oe*=Me,pe=Nt*Oe-lt*Fe,he=lt*ve-gt*Oe,Se=gt*Fe-Nt*ve,Me=Math.sqrt(pe*pe+he*he+Se*Se),Me?(Me=1/Me,pe*=Me,he*=Me,Se*=Me):(pe=0,he=0,Se=0),Ee=Fe*Se-Oe*he,Ne=Oe*pe-ve*Se,Pe=ve*he-Fe*pe,Me=Math.sqrt(Ee*Ee+Ne*Ne+Pe*Pe),Me?(Me=1/Me,Ee*=Me,Ne*=Me,Pe*=Me):(Ee=0,Ne=0,Pe=0),A[0]=pe,A[1]=Ee,A[2]=ve,A[3]=0,A[4]=he,A[5]=Ne,A[6]=Fe,A[7]=0,A[8]=Se,A[9]=Pe,A[10]=Oe,A[11]=0,A[12]=-(pe*He+he*je+Se*it),A[13]=-(Ee*He+Ne*je+Pe*it),A[14]=-(ve*He+Fe*je+Oe*it),A[15]=1,A)}e.lookAt=q;function F(A,M,te,ce){let pe=M[0],he=M[1],Se=M[2],Ee=ce[0],Ne=ce[1],Pe=ce[2],ve=pe-te[0],Fe=he-te[1],Oe=Se-te[2],Me=ve*ve+Fe*Fe+Oe*Oe;Me>0&&(Me=1/Math.sqrt(Me),ve*=Me,Fe*=Me,Oe*=Me);let He=Ne*Oe-Pe*Fe,je=Pe*ve-Ee*Oe,it=Ee*Fe-Ne*ve;return Me=He*He+je*je+it*it,Me>0&&(Me=1/Math.sqrt(Me),He*=Me,je*=Me,it*=Me),A[0]=He,A[1]=je,A[2]=it,A[3]=0,A[4]=Fe*it-Oe*je,A[5]=Oe*He-ve*it,A[6]=ve*je-Fe*He,A[7]=0,A[8]=ve,A[9]=Fe,A[10]=Oe,A[11]=0,A[12]=pe,A[13]=he,A[14]=Se,A[15]=1,A}e.targetTo=F;function W(A,M){i(A);for(let te=0;te<4;te++){let ce=M[te];l(A,te,ce,1)}return A}e.fromPermutation=W;function re(A){let M=A[0]*A[0]+A[1]*A[1]+A[2]*A[2],te=A[4]*A[4]+A[5]*A[5]+A[6]*A[6],ce=A[8]*A[8]+A[9]*A[9]+A[10]*A[10];return Math.sqrt(Math.max(M,te,ce))}e.getMaxScaleOnAxis=re;let _e=[1,0,0],Ae=[0,1,0],Ze=[0,0,1];e.rotX90=O(t(),Kn(90),_e),e.rotX180=O(t(),Kn(180),_e),e.rotY90=O(t(),Kn(90),Ae),e.rotY180=O(t(),Kn(180),Ae),e.rotY270=O(t(),Kn(270),Ae),e.rotZ90=O(t(),Kn(90),Ze),e.rotZ180=O(t(),Kn(180),Ze),e.rotXY90=S(t(),e.rotX90,e.rotY90),e.rotZY90=S(t(),e.rotZ90,e.rotY90),e.rotZYZ90=S(t(),e.rotZY90,e.rotZ90),e.rotZ90X180=S(t(),e.rotZ90,e.rotX180),e.rotY90Z180=S(t(),e.rotY90,e.rotZ180),e.id=n()})(ke||(ke={}));function Xt(){return Xt.zero()}(function(e){function t(){let T=[.1,0,0,0,0,0,0,0,0];return T[0]=0,T}e.zero=t;function n(){let T=t();return T[0]=1,T[1]=0,T[2]=0,T[3]=0,T[4]=1,T[5]=0,T[6]=0,T[7]=0,T[8]=1,T}e.identity=n;function r(T){return T[0]=1,T[1]=0,T[2]=0,T[3]=0,T[4]=1,T[5]=0,T[6]=0,T[7]=0,T[8]=1,T}e.setIdentity=r;function i(T,B,k){return B[k+0]=T[0],B[k+1]=T[1],B[k+2]=T[2],B[k+3]=T[3],B[k+4]=T[4],B[k+5]=T[5],B[k+6]=T[6],B[k+7]=T[7],B[k+8]=T[8],B}e.toArray=i;function o(T,B,k){return T[0]=B[k+0],T[1]=B[k+1],T[2]=B[k+2],T[3]=B[k+3],T[4]=B[k+4],T[5]=B[k+5],T[6]=B[k+6],T[7]=B[k+7],T[8]=B[k+8],T}e.fromArray=o;function s(T,B,k,R){return T[0]=B[0],T[1]=B[1],T[2]=B[2],T[3]=k[0],T[4]=k[1],T[5]=k[2],T[6]=R[0],T[7]=R[1],T[8]=R[2],T}e.fromColumns=s;function a(T,B){return T[0]=B[0],T[1]=B[1],T[2]=B[2],T[3]=B[4],T[4]=B[5],T[5]=B[6],T[6]=B[8],T[7]=B[9],T[8]=B[10],T}e.fromMat4=a;let c=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];function u(T,B,k){return ke.fromEuler(c,B,k),a(T,c)}e.fromEuler=u;function l(T,B,k,R,V,j,oe,ae,ne){let q=t();return q[0]=T,q[1]=B,q[2]=k,q[3]=R,q[4]=V,q[5]=j,q[6]=oe,q[7]=ae,q[8]=ne,q}e.create=l;let m=n();function f(T,B){return h(T,m,typeof B>"u"?1e-6:B)}e.isIdentity=f;function d(T){for(let B=0;B<9;B++)if(isNaN(T[B]))return!0;return!1}e.hasNaN=d;function p(T){return g(t(),T)}e.clone=p;function h(T,B,k){for(let R=0;R<9;R++)if(Math.abs(T[R]-B[R])>k)return!1;return!0}e.areEqual=h;function x(T,B,k,R){T[3*k+B]=R}e.setValue=x;function y(T,B,k){return T[3*k+B]}e.getValue=y;function g(T,B){return T[0]=B[0],T[1]=B[1],T[2]=B[2],T[3]=B[3],T[4]=B[4],T[5]=B[5],T[6]=B[6],T[7]=B[7],T[8]=B[8],T}e.copy=g;function C(T,B){if(T===B){let k=B[1],R=B[2],V=B[5];T[1]=B[3],T[2]=B[6],T[3]=k,T[5]=B[7],T[6]=R,T[7]=V}else T[0]=B[0],T[1]=B[3],T[2]=B[6],T[3]=B[1],T[4]=B[4],T[5]=B[7],T[6]=B[2],T[7]=B[5],T[8]=B[8];return T}e.transpose=C;function _(T,B){let k=B[0],R=B[1],V=B[2],j=B[3],oe=B[4],ae=B[5],ne=B[6],q=B[7],F=B[8],W=F*oe-ae*q,re=-F*j+ae*ne,_e=q*j-oe*ne,Ae=k*W+R*re+V*_e;return Ae?(Ae=1/Ae,T[0]=W*Ae,T[1]=(-F*R+V*q)*Ae,T[2]=(ae*R-V*oe)*Ae,T[3]=re*Ae,T[4]=(F*k-V*ne)*Ae,T[5]=(-ae*k+V*j)*Ae,T[6]=_e*Ae,T[7]=(-q*k+R*ne)*Ae,T[8]=(oe*k-R*j)*Ae,T):(console.warn("non-invertible matrix.",B),T)}e.invert=_;function b(T,B){return T===B?(T[3]=B[1],T[6]=B[2],T[7]=B[5]):(T[0]=B[0],T[1]=B[1],T[2]=B[2],T[3]=B[1],T[4]=B[4],T[5]=B[5],T[6]=B[2],T[7]=B[5],T[8]=B[8]),T}e.symmtricFromUpper=b;function I(T,B){return T===B?(T[1]=B[3],T[2]=B[6],T[5]=B[7]):(T[0]=B[0],T[1]=B[3],T[2]=B[6],T[3]=B[3],T[4]=B[4],T[5]=B[7],T[6]=B[6],T[7]=B[7],T[8]=B[8]),T}e.symmtricFromLower=I;function E(T){let B=T[0],k=T[1],R=T[2],V=T[3],j=T[4],oe=T[5],ae=T[6],ne=T[7],q=T[8],F=q*j-oe*ne,W=-q*V+oe*ae,re=ne*V-j*ae;return B*F+k*W+R*re}e.determinant=E;function S(T){return T[0]+T[4]+T[8]}e.trace=S;function v(T,B,k){return T[0]=B[0]-k[0],T[1]=B[1]-k[1],T[2]=B[2]-k[2],T[3]=B[3]-k[3],T[4]=B[4]-k[4],T[5]=B[5]-k[5],T[6]=B[6]-k[6],T[7]=B[7]-k[7],T[8]=B[8]-k[8],T}e.sub=v;function P(T,B,k){return T[0]=B[0]+k[0],T[1]=B[1]+k[1],T[2]=B[2]+k[2],T[3]=B[3]+k[3],T[4]=B[4]+k[4],T[5]=B[5]+k[5],T[6]=B[6]+k[6],T[7]=B[7]+k[7],T[8]=B[8]+k[8],T}e.add=P;function L(T,B,k){let R=B[0],V=B[1],j=B[2],oe=B[3],ae=B[4],ne=B[5],q=B[6],F=B[7],W=B[8],re=k[0],_e=k[1],Ae=k[2],Ze=k[3],A=k[4],M=k[5],te=k[6],ce=k[7],pe=k[8];return T[0]=re*R+_e*oe+Ae*q,T[1]=re*V+_e*ae+Ae*F,T[2]=re*j+_e*ne+Ae*W,T[3]=Ze*R+A*oe+M*q,T[4]=Ze*V+A*ae+M*F,T[5]=Ze*j+A*ne+M*W,T[6]=te*R+ce*oe+pe*q,T[7]=te*V+ce*ae+pe*F,T[8]=te*j+ce*ne+pe*W,T}e.mul=L;function w(T,B,k){return T[0]=B[0]-k,T[1]=B[1]-k,T[2]=B[2]-k,T[3]=B[3]-k,T[4]=B[4]-k,T[5]=B[5]-k,T[6]=B[6]-k,T[7]=B[7]-k,T[8]=B[8]-k,T}e.subScalar=w;function D(T,B,k){return T[0]=B[0]+k,T[1]=B[1]+k,T[2]=B[2]+k,T[3]=B[3]+k,T[4]=B[4]+k,T[5]=B[5]+k,T[6]=B[6]+k,T[7]=B[7]+k,T[8]=B[8]+k,T}e.addScalar=D;function z(T,B,k){return T[0]=B[0]*k,T[1]=B[1]*k,T[2]=B[2]*k,T[3]=B[3]*k,T[4]=B[4]*k,T[5]=B[5]*k,T[6]=B[6]*k,T[7]=B[7]*k,T[8]=B[8]*k,T}e.mulScalar=z;let ie=Math.PI/3,O=t();function Q(T,B){let k=B[1]*B[1]+B[2]*B[2]+B[5]*B[5];if(k===0)T[0]=B[0],T[1]=B[4],T[2]=B[8];else{let R=S(B)/3,V=B[0]-R,j=B[4]-R,oe=B[8]-R,ae=V*V+j*j+oe*oe+2*k,ne=Math.sqrt(ae/6);z(O,e.Identity,R),v(O,B,O),z(O,O,1/ne);let q=E(O)/2,F=q<=-1?ie:q>=1?0:Math.acos(q)/3;T[0]=R+2*ne*Math.cos(F),T[2]=R+2*ne*Math.cos(F+2*ie),T[1]=3*R-T[0]-T[2]}return T}e.symmetricEigenvalues=Q;let K=[.1,0,0],Z=[.1,0,0],se=[.1,0,0],fe=[.1,0,0],Ce=[.1,0,0],xe=[.1,0,0];function H(T,B,k){N.set(K,B[0]-k,B[1],B[2]),N.set(Z,B[1],B[4]-k,B[5]),N.set(se,B[2],B[5],B[8]-k),N.cross(fe,K,Z),N.cross(Ce,K,se),N.cross(xe,Z,se);let R=N.dot(fe,fe),V=N.dot(Ce,Ce),j=N.dot(xe,xe),oe=R,ae=0;return V>oe&&(oe=V,ae=1),j>oe&&(ae=2),ae===0?N.scale(T,fe,1/Math.sqrt(R)):ae===1?N.scale(T,Ce,1/Math.sqrt(V)):N.scale(T,xe,1/Math.sqrt(j)),T}e.eigenvector=H;function $(T,B){return a(T,B),_(T,T),C(T,T),T}e.directionTransform=$,e.Identity=n();function de(T,B){return T[0]*B[0]+T[1]*B[1]+T[2]*B[2]+T[3]*B[3]+T[4]*B[4]+T[5]*B[5]+T[6]*B[6]+T[7]*B[7]+T[8]*B[8]}e.innerProduct=de})(Xt||(Xt={}));function vi(){return vi.zero()}(function(e){function t(){let S=[.1,0];return S[0]=0,S}e.zero=t;function n(S){let v=t();return v[0]=S[0],v[1]=S[1],v}e.clone=n;function r(S,v){let P=t();return P[0]=S,P[1]=v,P}e.create=r;function i(S){return isNaN(S[0])||isNaN(S[1])}e.hasNaN=i;function o(S,v,P){return v[P+0]=S[0],v[P+1]=S[1],v}e.toArray=o;function s(S,v,P){return S[0]=v[P+0],S[1]=v[P+1],S}e.fromArray=s;function a(S,v){return S[0]=v[0],S[1]=v[1],S}e.copy=a;function c(S,v,P){return S[0]=v,S[1]=P,S}e.set=c;function u(S,v,P){return S[0]=v[0]+P[0],S[1]=v[1]+P[1],S}e.add=u;function l(S,v,P){return S[0]=v[0]-P[0],S[1]=v[1]-P[1],S}e.sub=l;function m(S,v,P){return S[0]=v[0]*P[0],S[1]=v[1]*P[1],S}e.mul=m;function f(S,v,P){return S[0]=v[0]/P[0],S[1]=v[1]/P[1],S}e.div=f;function d(S,v,P){return S[0]=v[0]*P,S[1]=v[1]*P,S}e.scale=d;function p(S,v){return S[0]=Math.round(v[0]),S[1]=Math.round(v[1]),S}e.round=p;function h(S,v){return S[0]=Math.ceil(v[0]),S[1]=Math.ceil(v[1]),S}e.ceil=h;function x(S,v){return S[0]=Math.floor(v[0]),S[1]=Math.floor(v[1]),S}e.floor=x;function y(S,v){let P=v[0]-S[0],L=v[1]-S[1];return Math.sqrt(P*P+L*L)}e.distance=y;function g(S,v){let P=v[0]-S[0],L=v[1]-S[1];return P*P+L*L}e.squaredDistance=g;function C(S){let v=S[0],P=S[1];return Math.sqrt(v*v+P*P)}e.magnitude=C;function _(S){let v=S[0],P=S[1];return v*v+P*P}e.squaredMagnitude=_;function b(S,v){return S[0]=1/v[0],S[1]=1/v[1],S}e.inverse=b;function I(S,v){return S[0]===v[0]&&S[1]===v[1]}e.areEqual=I;function E(S,v){return`[${S[0].toPrecision(v)} ${S[1].toPrecision(v)}}]`}e.toString=E})(vi||(vi={}));function zo(){return zo.zero()}(function(e){function t(){let w=[.1,0,0,0];return w[0]=0,w}e.zero=t;function n(w){let D=t();return D[0]=w[0],D[1]=w[1],D[2]=w[2],D[3]=w[3],D}e.clone=n;function r(w,D,z,ie){let O=t();return O[0]=w,O[1]=D,O[2]=z,O[3]=ie,O}e.create=r;function i(w,D){return w[0]=D.center[0],w[1]=D.center[1],w[2]=D.center[2],w[3]=D.radius,w}e.fromSphere=i;function o(w){return i(t(),w)}e.ofSphere=o;function s(w){return isNaN(w[0])||isNaN(w[1])||isNaN(w[2])||isNaN(w[3])}e.hasNaN=s;function a(w,D,z){return D[z+0]=w[0],D[z+1]=w[1],D[z+2]=w[2],D[z+3]=w[3],D}e.toArray=a;function c(w,D,z){return w[0]=D[z+0],w[1]=D[z+1],w[2]=D[z+2],w[3]=D[z+3],w}e.fromArray=c;function u(w,D,z){D[z+0]=w[0],D[z+1]=w[1],D[z+2]=w[2]}e.toVec3Array=u;function l(w,D,z){return w[0]=D[z+0],w[1]=D[z+1],w[2]=D[z+2],w[3]=0,w}e.fromVec3Array=l;function m(w,D){return w[0]=D[0],w[1]=D[1],w[2]=D[2],w[3]=D[3],w}e.copy=m;function f(w,D,z,ie,O){return w[0]=D,w[1]=z,w[2]=ie,w[3]=O,w}e.set=f;function d(w,D,z){return w[0]=D[0]+z[0],w[1]=D[1]+z[1],w[2]=D[2]+z[2],w[3]=D[3]+z[3],w}e.add=d;function p(w,D){let z=D[0]-w[0],ie=D[1]-w[1],O=D[2]-w[2],Q=D[3]-w[3];return Math.sqrt(z*z+ie*ie+O*O+Q*Q)}e.distance=p;function h(w,D,z){return w[0]=D[0]*z,w[1]=D[1]*z,w[2]=D[2]*z,w[4]=D[4]*z,w}e.scale=h;function x(w,D){return w[0]=Math.round(D[0]),w[1]=Math.round(D[1]),w[2]=Math.round(D[2]),w[3]=Math.round(D[3]),w}e.round=x;function y(w,D){return w[0]=Math.ceil(D[0]),w[1]=Math.ceil(D[1]),w[2]=Math.ceil(D[2]),w[3]=Math.ceil(D[3]),w}e.ceil=y;function g(w,D){return w[0]=Math.floor(D[0]),w[1]=Math.floor(D[1]),w[2]=Math.floor(D[2]),w[3]=Math.floor(D[3]),w}e.floor=g;function C(w,D){let z=D[0]-w[0],ie=D[1]-w[1],O=D[2]-w[2],Q=D[3]-w[3];return z*z+ie*ie+O*O+Q*Q}e.squaredDistance=C;function _(w){let D=w[0],z=w[1],ie=w[2],O=w[3];return Math.sqrt(D*D+z*z+ie*ie+O*O)}e.norm=_;function b(w){let D=w[0],z=w[1],ie=w[2],O=w[3];return D*D+z*z+ie*ie+O*O}e.squaredNorm=b;function I(w,D,z){let ie=D[0],O=D[1],Q=D[2],K=D[3];return w[0]=z[0]*ie+z[4]*O+z[8]*Q+z[12]*K,w[1]=z[1]*ie+z[5]*O+z[9]*Q+z[13]*K,w[2]=z[2]*ie+z[6]*O+z[10]*Q+z[14]*K,w[3]=z[3]*ie+z[7]*O+z[11]*Q+z[15]*K,w}e.transformMat4=I;function E(w,D){return w[0]*D[0]+w[1]*D[1]+w[2]*D[2]+w[3]*D[3]}e.dot=E;function S(w,D){return w[0]=1/D[0],w[1]=1/D[1],w[2]=1/D[2],w[3]=1/D[3],w}e.inverse=S;function v(w,D){return w[0]===D[0]&&w[1]===D[1]&&w[2]===D[2]&&w[3]===D[3]}e.exactEquals=v;function P(w,D){let z=w[0],ie=w[1],O=w[2],Q=w[3],K=D[0],Z=D[1],se=D[2],fe=D[3];return Math.abs(z-K)<=1e-6*Math.max(1,Math.abs(z),Math.abs(K))&&Math.abs(ie-Z)<=1e-6*Math.max(1,Math.abs(ie),Math.abs(Z))&&Math.abs(O-se)<=1e-6*Math.max(1,Math.abs(O),Math.abs(se))&&Math.abs(Q-fe)<=1e-6*Math.max(1,Math.abs(Q),Math.abs(fe))}e.equals=P;function L(w,D){return`[${w[0].toPrecision(D)} ${w[1].toPrecision(D)} ${w[2].toPrecision(D)}  ${w[3].toPrecision(D)}]`}e.toString=L})(zo||(zo={}));function KA(e){return Object.keys(e)}function gn(e){throw new Error("unreachable")}function jA(e){return typeof e?.then=="function"}function vn(){return vn.zero()}(function(e){function t(){let H=[.1,0,0,0];return H[0]=0,H}e.zero=t;function n(){let H=t();return H[3]=1,H}e.identity=n;function r(H){H[0]=0,H[1]=0,H[2]=0,H[3]=1}e.setIdentity=r;function i(H){return isNaN(H[0])||isNaN(H[1])||isNaN(H[2])||isNaN(H[3])}e.hasNaN=i;function o(H,$,de,T){let B=n();return B[0]=H,B[1]=$,B[2]=de,B[3]=T,B}e.create=o;function s(H,$,de){de=de*.5;let T=Math.sin(de);return H[0]=T*$[0],H[1]=T*$[1],H[2]=T*$[2],H[3]=Math.cos(de),H}e.setAxisAngle=s;function a(H,$){let de=Math.acos($[3])*2,T=Math.sin(de/2);return T!==0?(H[0]=$[0]/T,H[1]=$[1]/T,H[2]=$[2]/T):(H[0]=1,H[1]=0,H[2]=0),de}e.getAxisAngle=a;function c(H,$,de){let T=$[0],B=$[1],k=$[2],R=$[3],V=de[0],j=de[1],oe=de[2],ae=de[3];return H[0]=T*ae+R*V+B*oe-k*j,H[1]=B*ae+R*j+k*V-T*oe,H[2]=k*ae+R*oe+T*j-B*V,H[3]=R*ae-T*V-B*j-k*oe,H}e.multiply=c;function u(H,$,de){de*=.5;let T=$[0],B=$[1],k=$[2],R=$[3],V=Math.sin(de),j=Math.cos(de);return H[0]=T*j+R*V,H[1]=B*j+k*V,H[2]=k*j-B*V,H[3]=R*j-T*V,H}e.rotateX=u;function l(H,$,de){de*=.5;let T=$[0],B=$[1],k=$[2],R=$[3],V=Math.sin(de),j=Math.cos(de);return H[0]=T*j-k*V,H[1]=B*j+R*V,H[2]=k*j+T*V,H[3]=R*j-B*V,H}e.rotateY=l;function m(H,$,de){de*=.5;let T=$[0],B=$[1],k=$[2],R=$[3],V=Math.sin(de),j=Math.cos(de);return H[0]=T*j+B*V,H[1]=B*j-T*V,H[2]=k*j+R*V,H[3]=R*j-k*V,H}e.rotateZ=m;function f(H,$){let de=$[0],T=$[1],B=$[2];return H[0]=de,H[1]=T,H[2]=B,H[3]=Math.sqrt(Math.abs(1-de*de-T*T-B*B)),H}e.calculateW=f;function d(H,$,de,T){let B=$[0],k=$[1],R=$[2],V=$[3],j=de[0],oe=de[1],ae=de[2],ne=de[3],q,F,W,re,_e;return F=B*j+k*oe+R*ae+V*ne,F<0&&(F=-F,j=-j,oe=-oe,ae=-ae,ne=-ne),1-F>1e-6?(q=Math.acos(F),W=Math.sin(q),re=Math.sin((1-T)*q)/W,_e=Math.sin(T*q)/W):(re=1-T,_e=T),H[0]=re*B+_e*j,H[1]=re*k+_e*oe,H[2]=re*R+_e*ae,H[3]=re*V+_e*ne,H}e.slerp=d;function p(H,$){let de=$[0],T=$[1],B=$[2],k=$[3],R=de*de+T*T+B*B+k*k,V=R?1/R:0;return H[0]=-de*V,H[1]=-T*V,H[2]=-B*V,H[3]=k*V,H}e.invert=p;function h(H,$){return H[0]=-$[0],H[1]=-$[1],H[2]=-$[2],H[3]=$[3],H}e.conjugate=h;function x(H,$){return H[0]*$[0]+H[1]*$[1]+H[2]*$[2]+H[3]*$[3]}e.dot=x;function y(H,$){let de=$[0]+$[4]+$[8],T;if(de>0)T=Math.sqrt(de+1),H[3]=.5*T,T=.5/T,H[0]=($[5]-$[7])*T,H[1]=($[6]-$[2])*T,H[2]=($[1]-$[3])*T;else{let B=0;$[4]>$[0]&&(B=1),$[8]>$[B*3+B]&&(B=2);let k=(B+1)%3,R=(B+2)%3;T=Math.sqrt($[B*3+B]-$[k*3+k]-$[R*3+R]+1),H[B]=.5*T,T=.5/T,H[3]=($[k*3+R]-$[R*3+k])*T,H[k]=($[k*3+B]+$[B*3+k])*T,H[R]=($[R*3+B]+$[B*3+R])*T}return H}e.fromMat3=y;function g(H,$,de){let[T,B,k]=$,R=Math.cos(T/2),V=Math.cos(B/2),j=Math.cos(k/2),oe=Math.sin(T/2),ae=Math.sin(B/2),ne=Math.sin(k/2);switch(de){case"XYZ":H[0]=oe*V*j+R*ae*ne,H[1]=R*ae*j-oe*V*ne,H[2]=R*V*ne+oe*ae*j,H[3]=R*V*j-oe*ae*ne;break;case"YXZ":H[0]=oe*V*j+R*ae*ne,H[1]=R*ae*j-oe*V*ne,H[2]=R*V*ne-oe*ae*j,H[3]=R*V*j+oe*ae*ne;break;case"ZXY":H[0]=oe*V*j-R*ae*ne,H[1]=R*ae*j+oe*V*ne,H[2]=R*V*ne+oe*ae*j,H[3]=R*V*j-oe*ae*ne;break;case"ZYX":H[0]=oe*V*j-R*ae*ne,H[1]=R*ae*j+oe*V*ne,H[2]=R*V*ne-oe*ae*j,H[3]=R*V*j+oe*ae*ne;break;case"YZX":H[0]=oe*V*j+R*ae*ne,H[1]=R*ae*j+oe*V*ne,H[2]=R*V*ne-oe*ae*j,H[3]=R*V*j-oe*ae*ne;break;case"XZY":H[0]=oe*V*j-R*ae*ne,H[1]=R*ae*j-oe*V*ne,H[2]=R*V*ne+oe*ae*j,H[3]=R*V*j+oe*ae*ne;break;default:gn(de)}return H}e.fromEuler=g;let C=[0,0,0];function _(H,$,de){let T=N.dot($,de)+1;return T<1e-6?(T=0,Math.abs($[0])>Math.abs($[2])?N.set(C,-$[1],$[0],0):N.set(C,0,-$[2],$[1])):N.cross(C,$,de),H[0]=C[0],H[1]=C[1],H[2]=C[2],H[3]=T,D(H,H),H}e.fromUnitVec3=_;function b(H){let $=t();return $[0]=H[0],$[1]=H[1],$[2]=H[2],$[3]=H[3],$}e.clone=b;function I(H,$,de){return $[de+0]=H[0],$[de+1]=H[1],$[de+2]=H[2],$[de+3]=H[3],$}e.toArray=I;function E(H,$,de){return H[0]=$[de+0],H[1]=$[de+1],H[2]=$[de+2],H[3]=$[de+3],H}e.fromArray=E;function S(H,$){return H[0]=$[0],H[1]=$[1],H[2]=$[2],H[3]=$[3],H}e.copy=S;function v(H,$,de,T,B){return H[0]=$,H[1]=de,H[2]=T,H[3]=B,H}e.set=v;function P(H,$){return H[0]===$[0]&&H[1]===$[1]&&H[2]===$[2]&&H[3]===$[3]}e.exactEquals=P;function L(H,$){let de=H[0],T=H[1],B=H[2],k=H[3],R=$[0],V=$[1],j=$[2],oe=$[3];return Math.abs(de-R)<=1e-6*Math.max(1,Math.abs(de),Math.abs(R))&&Math.abs(T-V)<=1e-6*Math.max(1,Math.abs(T),Math.abs(V))&&Math.abs(B-j)<=1e-6*Math.max(1,Math.abs(B),Math.abs(j))&&Math.abs(k-oe)<=1e-6*Math.max(1,Math.abs(k),Math.abs(oe))}e.equals=L;function w(H,$,de){return H[0]=$[0]+de[0],H[1]=$[1]+de[1],H[2]=$[2]+de[2],H[3]=$[3]+de[3],H}e.add=w;function D(H,$){let de=$[0],T=$[1],B=$[2],k=$[3],R=de*de+T*T+B*B+k*k;return R>0&&(R=1/Math.sqrt(R),H[0]=de*R,H[1]=T*R,H[2]=B*R,H[3]=k*R),H}e.normalize=D;let z=[0,0,0],ie=[1,0,0],O=[0,1,0];function Q(H,$,de){let T=N.dot($,de);return T<-.999999?(N.cross(z,ie,$),N.magnitude(z)<1e-6&&N.cross(z,O,$),N.normalize(z,z),s(H,z,Math.PI),H):T>.999999?(H[0]=0,H[1]=0,H[2]=0,H[3]=1,H):(N.cross(z,$,de),H[0]=z[0],H[1]=z[1],H[2]=z[2],H[3]=1+T,D(H,H))}e.rotationTo=Q;let K=t(),Z=t();function se(H,$,de,T,B,k){return d(K,$,B,k),d(Z,de,T,k),d(H,K,Z,2*k*(1-k)),H}e.sqlerp=se;let fe=[0,0,0,0,0,0,0,0,0];function Ce(H,$,de,T){return fe[0]=de[0],fe[3]=de[1],fe[6]=de[2],fe[1]=T[0],fe[4]=T[1],fe[7]=T[2],fe[2]=-$[0],fe[5]=-$[1],fe[8]=-$[2],D(H,y(H,fe))}e.setAxes=Ce;function xe(H,$){return`[${H[0].toPrecision($)} ${H[1].toPrecision($)} ${H[2].toPrecision($)}  ${H[3].toPrecision($)}]`}e.toString=xe,e.Identity=n()})(vn||(vn={}));var nn;(function(e){function t(b,I,E){let S=[];for(let P=0;P<I.length;P++)S[P]=I[I.length-P-1];let v=[1];for(let P=1;P<b.length;P++)v[P]=b[S[P-1]];return{dimensions:b,axisOrderFastToSlow:S,axisOrderSlowToFast:I,accessDimensions:v,defaultCtor:E||Float64Array}}function n(b,I){return{space:b,data:I}}e.create=n;function r(b,I,E){let S=t(b,I,E),{get:v,set:P,add:L,dataOffset:w,getCoords:D}=d(S);return{rank:b.length,dimensions:b,axisOrderSlowToFast:I,create:p(S),get:v,set:P,add:L,dataOffset:w,getCoords:D}}e.Space=r;function i(b){return b}e.Data1=i;function o(b,I){return r([b],[0],I)}e.Vector=o;function s(b,I,E){return r([b,I],[1,0],E)}e.ColumnMajorMatrix=s;function a(b,I,E){return r([b,I],[0,1],E)}e.RowMajorMatrix=a;function c(b,I,E){if(I.rank!==2)throw new Error("Invalid tensor rank");let S=Math.min(4,I.dimensions[0]),v=Math.min(4,I.dimensions[1]);for(let P=0;P<S;P++)for(let L=0;L<v;L++)ke.setValue(b,P,L,I.get(E,P,L));return b}e.toMat4=c;function u(b,I,E){if(I.rank!==2)throw new Error("Invalid tensor rank");let S=Math.min(3,I.dimensions[0]),v=Math.min(3,I.dimensions[1]);for(let P=0;P<S;P++)for(let L=0;L<v;L++)Xt.setValue(b,P,L,I.get(E,P,L));return b}e.toMat3=u;function l(b,I,E){if(I.rank!==1)throw new Error("Invalid tensor rank");let S=Math.min(3,I.dimensions[0]);for(let v=0;v<S;v++)b[v]=E[v];return b}e.toVec3=l;function m(b,I,E){if(I.rank!==1)throw new Error("Invalid tensor rank");let S=Math.min(4,I.dimensions[0]);for(let v=0;v<S;v++)b[v]=E[v];return b}e.toVec4=m;function f(b,I){let E=b.length;if(E!==I.length)return!1;for(let S=0;S<E;S++)if(b[S]!==I[S])return!1;return!0}e.areEqualExact=f;function d(b){let{dimensions:I,axisOrderFastToSlow:E}=b;switch(I.length){case 1:return{get:(S,v)=>S[v],set:(S,v,P)=>S[v]=P,add:(S,v,P)=>S[v]+=P,dataOffset:S=>S,getCoords:(S,v)=>(v[0]=S,v)};case 2:{if(E[0]===0&&E[1]===1){let S=I[0];return{get:(v,P,L)=>v[L*S+P],set:(v,P,L,w)=>v[L*S+P]=w,add:(v,P,L,w)=>v[L*S+P]+=w,dataOffset:(v,P)=>P*S+v,getCoords:(v,P)=>(P[0]=v%S,P[1]=Math.floor(v/S),P)}}if(E[0]===1&&E[1]===0){let S=I[1];return{get:(v,P,L)=>v[P*S+L],set:(v,P,L,w)=>v[P*S+L]=w,add:(v,P,L,w)=>v[P*S+L]+=w,dataOffset:(v,P)=>v*S+P,getCoords:(v,P)=>(P[0]=Math.floor(v/S),P[1]=v%S,P)}}throw new Error("bad axis order")}case 3:{if(E[0]===0&&E[1]===1&&E[2]===2){let S=I[0],v=I[1],P=S*v;return{get:(L,w,D,z)=>L[w+D*S+z*P],set:(L,w,D,z,ie)=>L[w+D*S+z*P]=ie,add:(L,w,D,z,ie)=>L[w+D*S+z*P]+=ie,dataOffset:(L,w,D)=>L+w*S+D*P,getCoords:(L,w)=>{let D=Math.floor(L/S);return w[0]=L%S,w[1]=D%v,w[2]=Math.floor(D/v),w}}}if(E[0]===0&&E[1]===2&&E[2]===1){let S=I[0],v=I[2],P=S*v;return{get:(L,w,D,z)=>L[w+z*S+D*P],set:(L,w,D,z,ie)=>L[w+z*S+D*P]=ie,add:(L,w,D,z,ie)=>L[w+z*S+D*P]+=ie,dataOffset:(L,w,D)=>L+D*S+w*P,getCoords:(L,w)=>{let D=Math.floor(L/S);return w[0]=L%S,w[1]=Math.floor(D/v),w[2]=D%v,w}}}if(E[0]===1&&E[1]===0&&E[2]===2){let S=I[1],v=I[0],P=S*v;return{get:(L,w,D,z)=>L[D+w*S+z*P],set:(L,w,D,z,ie)=>L[D+w*S+z*P]=ie,add:(L,w,D,z,ie)=>L[D+w*S+z*P]+=ie,dataOffset:(L,w,D)=>w+L*S+D*P,getCoords:(L,w)=>{let D=Math.floor(L/S);return w[0]=D%v,w[1]=L%S,w[2]=Math.floor(D/v),w}}}if(E[0]===1&&E[1]===2&&E[2]===0){let S=I[1],v=I[2],P=S*v;return{get:(L,w,D,z)=>L[D+z*S+w*P],set:(L,w,D,z,ie)=>L[D+z*S+w*P]=ie,add:(L,w,D,z,ie)=>L[D+z*S+w*P]+=ie,dataOffset:(L,w,D)=>w+D*S+L*P,getCoords:(L,w)=>{let D=Math.floor(L/S);return w[0]=Math.floor(D/v),w[1]=L%S,w[2]=D%v,w}}}if(E[0]===2&&E[1]===0&&E[2]===1){let S=I[2],v=I[0],P=S*v;return{get:(L,w,D,z)=>L[z+w*S+D*P],set:(L,w,D,z,ie)=>L[z+w*S+D*P]=ie,add:(L,w,D,z,ie)=>L[z+w*S+D*P]+=ie,dataOffset:(L,w,D)=>D+L*S+w*P,getCoords:(L,w)=>{let D=Math.floor(L/S);return w[0]=D%v,w[1]=Math.floor(D/v),w[2]=L%S,w}}}if(E[0]===2&&E[1]===1&&E[2]===0){let S=I[2],v=I[1],P=S*v;return{get:(L,w,D,z)=>L[z+D*S+w*P],set:(L,w,D,z,ie)=>L[z+D*S+w*P]=ie,add:(L,w,D,z,ie)=>L[z+D*S+w*P]+=ie,dataOffset:(L,w,D)=>D+w*S+L*P,getCoords:(L,w)=>{let D=Math.floor(L/S);return w[0]=Math.floor(D/v),w[1]=D%v,w[2]=L%S,w}}}throw new Error("bad axis order")}default:return{get:(S,...v)=>S[h(b,v)],set:(S,...v)=>S[h(b,v)]=v[v.length-1],add:(S,...v)=>S[h(b,v)]+=v[v.length-1],dataOffset:(...S)=>h(b,S),getCoords:(S,v)=>x(b,S,v)}}}function p(b){let{dimensions:I}=b,E=1;for(let S=0,v=I.length;S<v;S++)E*=I[S];return S=>new(S||b.defaultCtor)(E)}function h(b,I){let{accessDimensions:E,axisOrderFastToSlow:S}=b,v=E.length-1,P=E[v]*I[S[v]];for(let L=v-1;L>=0;L--)P=(P+I[S[L]])*E[L];return P}function x(b,I,E){let{dimensions:S,axisOrderFastToSlow:v}=b,P=S.length,L=I;for(let w=0;w<P;w++){let D=S[v[w]];E[v[w]]=L%D,L=Math.floor(L/D)}return E[v[P+1]]=L,E}function y(b){let I=[];for(let E=0;E<b.length;E++)I[E]=b[b.length-E-1];return I}e.invertAxisOrder=y;function g(b,I){let E=[];for(let S=0;S<b.length;S++)E[S]=b[I[S]];return E}function C(b){let I=new Int32Array(b.length);for(let E=0;E<b.length;E++)I[b[E]]=E;return E=>g(E,I)}e.convertToCanonicalAxisIndicesFastToSlow=C;function _(b){let I=new Int32Array(b.length);for(let E=0;E<b.length;E++)I[b[b.length-E-1]]=E;return E=>g(E,I)}e.convertToCanonicalAxisIndicesSlowToFast=_})(nn||(nn={}));var yt;(function(e){function t(d,p,h){return{kind:"element-location",structure:d,unit:p,element:h||0}}e.create=t;function n(d){return t(d.structure,d.unit,d.element)}e.clone=n;function r(d,p,h,x){return p&&(d.structure=p),h&&(d.unit=h),x!==void 0&&(d.element=x),d}e.set=r;function i(d,p){return d.unit=p.unit,d.element=p.element,d}e.copy=i;function o(d){return!!d&&d.kind==="element-location"}e.is=o;function s(d,p){return d.unit===p.unit&&d.element===p.element}e.areEqual=s;let a=N(),c=N();function u(d,p){return d.unit.conformation.position(d.element,a),p.unit.conformation.position(p.element,c),N.distance(a,c)}e.distance=u;function l(d,p){return p.unit.conformation.position(p.element,d)}e.position=l;function m(d){return d.unit.model.atomicHierarchy.residueAtomSegments.index[d.element]}e.residueIndex=m;function f(d){return d.unit.model.atomicHierarchy.chainAtomSegments.index[d.element]}e.chainIndex=f})(yt||(yt={}));var ri;(function(e){function t(f){return f.creator&&f.chunkSize}e.is=t;function n(f){let d=f.growBy*f.elementSize;f.currentSize=d,f.currentIndex=0,f.currentChunk=new f.ctor(d),f.allocatedSize+=d,f.chunks[f.chunks.length]=f.currentChunk}function r(f,d,p,h,x){f.currentIndex>=f.currentSize&&n(f);let y=f.currentChunk,g=f.currentIndex;return y[g]=d,y[g+1]=p,y[g+2]=h,y[g+3]=x,f.currentIndex+=4,f.elementCount++}e.add4=r;function i(f,d,p,h){f.currentIndex>=f.currentSize&&n(f);let x=f.currentChunk,y=f.currentIndex;return x[y]=d,x[y+1]=p,x[y+2]=h,f.currentIndex+=3,f.elementCount++}e.add3=i;function o(f,d,p){f.currentIndex>=f.currentSize&&n(f);let h=f.currentChunk,x=f.currentIndex;return h[x]=d,h[x+1]=p,f.currentIndex+=2,f.elementCount++}e.add2=o;function s(f,d){return f.currentIndex>=f.currentSize&&n(f),f.currentChunk[f.currentIndex]=d,f.currentIndex+=1,f.elementCount++}e.add=s;function a(f,d,p){for(let h=0;h<d;h++)f.currentIndex>=f.currentSize&&n(f),f.currentChunk[f.currentIndex++]=p,f.elementCount++;return f.elementCount}e.addRepeat=a;function c(f,d){let{elementSize:p}=f;for(let h=0,x=d.length;h<x;h+=p){f.currentIndex>=f.currentSize&&n(f);let{currentChunk:y}=f;for(let g=0;g<p;g++)y[f.currentIndex++]=d[h+g];f.elementCount++}return f.elementCount}e.addMany=c;function u(f,d=!1){return l(f,d)}e.compact=u;function l(f,d){let{ctor:p,chunks:h,currentIndex:x}=f;if(!h.length)return new p(0);if(h.length===1&&(d||x===f.allocatedSize))return h[0];let y=0;for(let b=0,I=h.length-1;b<I;b++)y+=h[b].length;y+=f.currentIndex;let g=new p(y),C=0;if(g.buffer)for(let b=0,I=h.length-1;b<I;b++)g.set(h[b],C),C+=h[b].length;else for(let b=0,I=h.length-1;b<I;b++){let E=h[b];for(let S=0,v=E.length;S<v;S++)g[C+S]=E[S];C+=E.length}let _=h[h.length-1];if(g.buffer&&x>=f.currentSize)g.set(_,C);else for(let b=0,I=_.length;b<I;b++)g[C+b]=_[b];return g}e._compact=l;function m(f,d,p,h){let x={ctor:f,elementSize:d,growBy:Math.max(1,Math.ceil(p)),allocatedSize:0,elementCount:0,currentSize:0,currentChunk:void 0,currentIndex:0,chunks:[]};if(typeof h>"u")return x;if(typeof h=="number")return x.currentChunk=new f(h*d),x.allocatedSize=h*d,x.currentSize=x.currentChunk.length,x.chunks[0]=x.currentChunk,x;let y=h;if(y.length%d!==0)throw new Error("initialChunk length must be a multiple of the element size.");return x.currentChunk=y,x.allocatedSize=y.length,x.currentSize=y.length,x.chunks[0]=y,x}e.create=m})(ri||(ri={}));function Vo(e,t,n){return e[t]-e[n]}function lr(e,t,n){let r=e[t];e[t]=e[n],e[n]=r}function ju(e,t,n,r){let i=n+r>>1;return t(e,n,r)>0?t(e,n,i)>0?t(e,i,r)>0?i:r:n:t(e,r,i)>0?t(e,i,n)>0?i:n:r}function np(e,t,n){let{cmp:r,swap:i,data:o,parts:s}=e,a=t+1,c=n;for(i(o,t,ju(o,r,t,n));r(o,c,t)>0;)--c;for(let u=t+1;u<=c;u++){let l=r(o,u,t);if(l>0){for(i(o,u,c),--c;r(o,c,t)>0;)--c;u--}else l===0&&(i(o,u,a),a++)}for(let u=t;u<a;u++)i(o,u,t+c-u);s[0]=c-a+t+1,s[1]=c}function rp({data:e,cmp:t,swap:n},r,i){for(let o=r+1;o<=i;o++){let s=o-1;for(;s>=r&&t(e,s,s+1)>0;)n(e,s,s+1),s=s-1}}function Ko(e,t,n){let{parts:r}=e;for(;t<n;){if(n-t<16){rp(e,t,n);return}np(e,t,n);let i=r[0],o=r[1];i-t<n-o?(Ko(e,t,i-1),t=o+1):(Ko(e,o+1,n),n=i-1)}}function ip(e,t,n,r){let i=n+1,o=r;lr(e,n,ju(e,Vo,n,r));let s=e[n];for(;e[o]>s;)--o;for(let a=n+1;a<=o;a++){let c=e[a];if(c>s){for(lr(e,a,o),--o;e[o]>s;)--o;a--}else c===s&&(lr(e,a,i),++i)}for(let a=n;a<i;a++)lr(e,a,n+o-a);t[0]=o-i+n+1,t[1]=o}function op(e,t,n){for(let r=t+1;r<=n;r++){let i=e[r],o=r-1;for(;o>=t&&e[o]>i;)e[o+1]=e[o],o=o-1;e[o+1]=i}}function ba(e,t,n,r){for(;n<r;){if(r-n<16){op(e,n,r);return}ip(e,t,n,r);let i=t[0],o=t[1];i-n<r-o?(ba(e,t,n,i-1),n=o+1):(ba(e,t,o+1,r),r=i-1)}}function jt(e,t=Vo){return sp(e,0,e.length,t)}function sp(e,t,n,r=Vo){return r===Vo?ba(e,[0,0],t,n-1):Ko({data:e,cmp:r,swap:lr,parts:[0,0]},t,n-1),e}function jo(e,t,n,r,i){return Ko({data:e,cmp:r,swap:i,parts:[0,0]},t,n-1),e}function ap(e,t,n){return e[t].key<e[n].key?-1:1}function cp(e,t,n,r,i){let o=new Map,s=[],a=t(e[0]),c=!0;for(let d=r;d<i;d++){let p=t(e[d]);if(o.has(p))o.get(p).count++,a!==p&&(c=!1);else{let h={key:p,count:1,offset:d};o.set(p,h),s[s.length]=h}a=p}let u=new Int32Array(s.length+1);u[s.length]=i;let l=!0;if(n){for(let d=1,p=s.length;d<p;d++)if(s[d-1].key>s[d].key){l=!1;break}}if(c&&l){for(let d=0;d<s.length;d++)u[d]=s[d].offset;return u}n&&!l&&jo(s,0,s.length,ap,lr);let m=0;for(let d=0;d<s.length;d++){let p=s[d];p.offset=m,m+=p.count}let f=new Int32Array(i-r);for(let d=r;d<i;d++){let p=t(e[d]),h=o.get(p);f[h.offset++]=e[d]}for(let d=0,p=f.length;d<p;d++)e[d+r]=f[d];u[0]=r;for(let d=1;d<s.length;d++)u[d]=s[d-1].offset+r;return u}function Yo(e,t,n){let r=n&&n.start||0,i=n&&n.end||e.length;if(i-r<=0)throw new Error("Can only bucket non-empty collections.");return cp(e,t,!!(n&&n.sort),r,i)}var Ca=class{createGroup(t,n){let r=this.id++,i=[t];return this.groups[r]=i,{id:r,keys:i,value:n}}add(t,n){let r=this.getHash(n);if(this.byHash.has(r)){let i=this.byHash.get(r);for(let s=0,a=i.length;s<a;s++){let c=i[s];if(this.areEqual(n,c.value))return c.keys[c.keys.length]=t,c.value}let o=this.createGroup(t,n);return i[i.length]=o,o.value}else{let i=this.createGroup(t,n);return this.byHash.set(r,[i]),i.value}}constructor(t,n){this.getHash=t,this.areEqual=n,this.id=0,this.byHash=new Map,this.groups=[]}};function Yu(e,t){return new Ca(e,t)}function Zu(e){let t=e^e>>4;return t=(t^3735928559)+(t<<5),t=t^t>>11,t}function Dr(e,t){let n=23;return n=31*n+e|0,n=31*n+t|0,n=n^n>>4,n=(n^3735928559)+(n<<5),n=n^n>>11,n}function Wu(e,t,n){let r=23;return r=31*r+e|0,r=31*r+t|0,r=31*r+n|0,r=r^r>>4,r=(r^3735928559)+(r<<5),r=r^r>>11,r}function Xu(e,t,n,r){let i=23;return i=31*i+e|0,i=31*i+t|0,i=31*i+n|0,i=31*i+r|0,i=i^i>>4,i=(i^3735928559)+(i<<5),i=i^i>>11,i}function $u(e){let t=0;for(let n=0,r=e.length;n<r;n++)t=(t<<5)-t+e.charCodeAt(n)|0;return t}function jn(e,t){return(e+t)*(e+t+1)/2+t}function Sa(e,t){return e<t?jn(e,t):jn(t,e)}function xb(e,t){let n=Math.floor((Math.sqrt(8*t+1)-1)/2),r=(n*n+n)/2,i=t-r;return e[0]=n-i,e[1]=i,e}function Yn(e){let t=2166136261;for(let n=0,r=e.length;n<r;++n)t^=e[n],t+=(t<<1)+(t<<4)+(t<<7)+(t<<8)+(t<<24);return t>>>0}var Ut={};Br(Ut,{createAndFillArray:()=>up,createArray:()=>ii,fillArrayValues:()=>Qu,getArrayBounds:()=>Mr,isTypedArray:()=>Zo,typedArrayWindow:()=>Wo});function Mr(e,t){let n=t&&typeof t.start<"u"?Math.max(Math.min(t.start,e-1),0):0,r=t&&typeof t.end<"u"?Math.min(t.end,e):e;return{start:n,end:r}}function ii(e,t){let n=t&&typeof t.array<"u"?t.array:Array,{start:r,end:i}=Mr(e,t);return{array:new n(i-r),start:r,end:i}}function Qu(e,t,n){for(let r=0,i=t.length;r<i;r++)t[r]=e(n+r);return t}function up(e,t,n){let{array:r,start:i}=ii(e,n);return Qu(t,r,i)}function Zo(e){return!!e.buffer&&typeof e.byteLength=="number"&&typeof e.BYTES_PER_ELEMENT=="number"}function Wo(e,t){let{constructor:n,buffer:r,length:i,byteOffset:o,BYTES_PER_ELEMENT:s}=e,{start:a,end:c}=Mr(i,t);return a===0&&c===i?e:new n(r,o+s*a,Math.min(i,c-a))}function bb(e,t,n){for(;t<n&&e.charCodeAt(t)===32;)t++;return Pn(e,t,n)}function Pn(e,t,n){let r=t,i=0,o=1;for(e.charCodeAt(r)===45?(o=-1,++r):e.charCodeAt(r)===43&&++r;r<n;r++){let s=e.charCodeAt(r)-48;if(s>9||s<0)return o*i|0;i=10*i+s|0}return o*i}function Ju(e,t,n,r){return t.charCodeAt(n)===43&&n++,e*Math.pow(10,Pn(t,n,r))}function Cb(e,t,n){for(;t<n&&e.charCodeAt(t)===32;)t++;return Ln(e,t,n)}function Ln(e,t,n){let r=t,i=1,o=0,s=0,a=1;for(e.charCodeAt(r)===45?(i=-1,++r):e.charCodeAt(r)===43&&++r;r<n;){let c=e.charCodeAt(r)-48;if(c>=0&&c<10)o=o*10+c,++r;else if(c===-2){for(++r;r<n;)if(c=e.charCodeAt(r)-48,c>=0&&c<10)s=10*s+c,a=10*a,++r;else return c===53||c===21?Ju(i*(o+s/a),e,r+1,n):i*(o+s/a);return i*(o+s/a)}else{if(c===53||c===21)return Ju(i*o,e,r+1,n);break}}return i*o}var me;(function(e){let t;(function(P){P.str={"@type":"str",T:"",valueType:"str"},P.ustr={"@type":"str",T:"",valueType:"str",transform:"uppercase"},P.lstr={"@type":"str",T:"",valueType:"str",transform:"lowercase"},P.int={"@type":"int",T:0,valueType:"int"},P.coord={"@type":"coord",T:0,valueType:"float"},P.float={"@type":"float",T:0,valueType:"float"};function L(Z){var se;return{"@type":"str",T:(se=Z?.defaultValue)!==null&&se!==void 0?se:"",transform:Z?.transform,valueType:"str"}}P.Str=L;function w(Z=0){return{"@type":"int",T:Z,valueType:"int"}}P.Int=w;function D(Z=0){return{"@type":"float",T:Z,valueType:"float"}}P.Float=D;function z(Z,se=P.float){return{"@type":"tensor",T:Z.create(),space:Z,valueType:"tensor",baseType:se}}P.Tensor=z;function ie(Z,se=P.float){return z(nn.Vector(Z,se["@type"]==="int"?Int32Array:Float64Array),se)}P.Vector=ie;function O(Z,se,fe=P.float){return z(nn.ColumnMajorMatrix(Z,se,fe["@type"]==="int"?Int32Array:Float64Array),fe)}P.Matrix=O;function Q(Z){return Z}P.Aliased=Q;function K(Z,se,fe=[]){return{"@type":"list",T:fe,separator:Z,itemParse:se,valueType:"list"}}P.List=K})(t=e.Schema||(e.Schema={}));function n(P){return!!P&&!!P.schema&&!!P.value}e.is=n,e.ValueKind={Present:0,NotPresent:1,Unknown:2};function r(P,L){return el(L.T,P,L,1)}e.Undefined=r;function i(P,L,w){return el(P,L,w,0)}e.ofConst=i;function o(P){return Xo(P)}e.ofLambda=o;function s(P,L){return o({value:w=>w+P,rowCount:Math.max(L-P+1,0),schema:t.int})}e.range=s;function a(P){return fr(P)}e.ofArray=a;function c(P){return fr({array:P,schema:t.int})}e.ofIntArray=c;function u(P){return fr({array:P,schema:t.float})}e.ofFloatArray=u;function l(P){return fr({array:P,schema:t.str})}e.ofStringArray=l;function m(P){return fr({array:P,schema:t.Aliased(t.str)})}e.ofStringAliasArray=m;function f(P,L=","){return fr({array:P,schema:t.List(L,w=>w)})}e.ofStringListArray=f;function d(P){let{count:L,data:w,indices:D}=P;return Xo({value:z=>Pn(w,D[2*z],D[2*z+1])||0,rowCount:L,schema:t.int})}e.ofIntTokens=d;function p(P){let{count:L,data:w,indices:D}=P;return Xo({value:z=>Ln(w,D[2*z],D[2*z+1])||0,rowCount:L,schema:t.float})}e.ofFloatTokens=p;function h(P){let{count:L,data:w,indices:D}=P;return Xo({value:z=>{let ie=w.substring(D[2*z],D[2*z+1]);return ie==="."||ie==="?"?"":ie},rowCount:L,schema:t.str})}e.ofStringTokens=h;function x(P,L,w){return dp(P,L,w)}e.window=x;function y(P,L,w=!0){return _p(P,L,w)}e.view=y;function g(P){return lp(P)}e.createFirstIndexMap=g;function C(P){return fp(P)}e.createIndexer=C;function _(P,L,w){return xp(P,L,w||Array)}e.mapToArray=_;function b(P,L){return Ap(P,L)}e.areEqual=b;function I(P,L){return Sp(P,L)}e.indicesOf=I;function E(P,L){return P.__array?P:P.isDefined?fr({array:P.toArray({array:L}),schema:P.schema,valueKind:P.valueKind}):r(P.rowCount,P.schema)}e.asArrayColumn=E;function S(P,L,w=0){if(!P.isDefined)return;let D=P.__array;if(D)for(let z=0,ie=D.length;z<ie;z++)L[w+z]=D[z];else for(let z=0,ie=P.rowCount;z<ie;z++)L[w+z]=P.value(z)}e.copyToArray=S;function v(P){for(let L=0,w=P.rowCount;L<w;L++)if(L!==P.value(L))return!1;return!0}e.isIdentity=v})(me||(me={}));function lp(e){let t=new Map;for(let n=0,r=e.rowCount;n<r;n++){let i=e.value(n);t.has(i)||t.set(e.value(n),n)}return t}function fp(e){let t=new Map;for(let n=0,r=e.rowCount;n<r;n++){let i=e.value(n);t.has(i)||t.set(e.value(n),n)}return n=>t.has(n)?t.get(n):-1}function el(e,t,n,r){return{schema:n,__array:void 0,isDefined:r===0,rowCount:t,value:o=>e,valueKind:o=>r,toArray:o=>{let{array:s}=ii(t,o);for(let a=0,c=s.length;a<c;a++)s[a]=e;return s},areValuesEqual:(o,s)=>!0}}function Xo({value:e,valueKind:t,areValuesEqual:n,rowCount:r,schema:i}){return{schema:i,__array:void 0,isDefined:!0,rowCount:r,value:e,valueKind:t||(o=>0),toArray:o=>{let{array:s,start:a}=ii(r,o);for(let c=0,u=s.length;c<u;c++)s[c]=e(c+a);return s},areValuesEqual:n||((o,s)=>e(o)===e(s))}}function fr({array:e,schema:t,valueKind:n}){let r=e.length,i=t.T,o=t.valueType==="str"?t.transform==="lowercase"?a=>{let c=e[a];return typeof c=="string"?c.toLowerCase():`${c??i}`.toLowerCase()}:t.transform==="uppercase"?a=>{let c=e[a];return typeof c=="string"?c.toUpperCase():`${c??i}`.toUpperCase()}:a=>{let c=e[a];return typeof c=="string"?c:`${c??i}`}:a=>e[a],s=Zo(e);return{schema:t,__array:e,isDefined:!0,rowCount:r,value:o,valueKind:n||(a=>0),toArray:t.valueType==="str"?t.transform==="lowercase"?a=>{let{start:c,end:u}=Mr(r,a),l=new(a&&typeof a.array<"u"?a.array:e.constructor)(u-c);for(let m=0,f=u-c;m<f;m++){let d=e[c+m];l[m]=typeof d=="string"?d.toLowerCase():`${d??i}`.toLowerCase()}return l}:t.transform==="uppercase"?a=>{let{start:c,end:u}=Mr(r,a),l=new(a&&typeof a.array<"u"?a.array:e.constructor)(u-c);for(let m=0,f=u-c;m<f;m++){let d=e[c+m];l[m]=typeof d=="string"?d.toUpperCase():`${d??i}`.toUpperCase()}return l}:a=>{let{start:c,end:u}=Mr(r,a),l=new(a&&typeof a.array<"u"?a.array:e.constructor)(u-c);for(let m=0,f=u-c;m<f;m++){let d=e[c+m];l[m]=typeof d=="string"?d:`${d??i}`}return l}:s?a=>Wo(e,a):a=>{let{start:c,end:u}=Mr(r,a);if(c===0&&u===e.length)return e;let l=new(a&&typeof a.array<"u"?a.array:e.constructor)(u-c);for(let m=0,f=u-c;m<f;m++)l[m]=e[c+m];return l},areValuesEqual:(a,c)=>e[a]===e[c]}}function dp(e,t,n){return e.isDefined?t===0&&n===e.rowCount?e:e.__array&&Zo(e.__array)?mp(e,t,n):pp(e,t,n):me.Undefined(n-t,e.schema)}function mp(e,t,n){let r=Wo(e.__array,{start:t,end:n}),i=e.valueKind;return fr({array:r,schema:e.schema,valueKind:o=>i(t+o)})}function pp(e,t,n){let r=e.value,i=e.valueKind,o=e.areValuesEqual,s=t===0?r:c=>r(c+t),a=n-t;return{schema:e.schema,__array:void 0,isDefined:e.isDefined,rowCount:a,value:s,valueKind:t===0?i:c=>i(c+t),toArray:c=>{let{array:u}=ii(a,c);for(let l=0,m=u.length;l<m;l++)u[l]=r(l+t);return u},areValuesEqual:t===0?o:(c,u)=>o(c+t,u+t)}}function hp(e,t){if(e.length!==t)return!1;for(let n=0,r=e.length;n<r;n++)if(e[n]!==n)return!1;return!0}function _p(e,t,n){return e.rowCount===0||n&&hp(t,e.rowCount)?e:e.__array&&typeof e.value(0)==typeof e.__array[0]?gp(e,t):yp(e,t)}function gp(e,t){let n=e.__array,r=new n.constructor(t.length);for(let o=0,s=t.length;o<s;o++)r[o]=n[t[o]];let i=e.valueKind;return fr({array:r,schema:e.schema,valueKind:o=>i(t[o])})}function yp(e,t){let n=e.value,r=e.valueKind,i=e.areValuesEqual,o=a=>n(t[a]),s=t.length;return{schema:e.schema,__array:void 0,isDefined:e.isDefined,rowCount:s,value:o,valueKind:a=>r(t[a]),toArray:a=>{let{array:c}=ii(s,a);for(let u=0,l=c.length;u<l;u++)c[u]=n(t[u]);return c},areValuesEqual:(a,c)=>i(t[a],t[c])}}function xp(e,t,n){let r=new n(e.rowCount);for(let i=0,o=e.rowCount;i<o;i++)r[i]=t(e.value(i));return r}function Ap(e,t){return e===t?!0:e.rowCount!==t.rowCount||e.isDefined!==t.isDefined||e.schema.valueType!==t.schema.valueType?!1:e.__array&&t.__array?bp(e,t):Cp(e,t)}function bp(e,t){let n=e.__array,r=t.__array;for(let i=0,o=e.rowCount;i<o;i++)if(n[i]!==r[i])return!1;return!0}function Cp(e,t){let n=e.value,r=t.value;for(let i=0,o=e.rowCount;i<o;i++)if(n(i)!==r(i))return!1;return!0}function Sp(e,t){let n=[],r=e.value;for(let i=0,o=e.rowCount;i<o;i++)t(r(i))&&(n[n.length]=i);return n}var fn;(function(e){function t(i){return i}e.create=t;function n(i,o){return(i&o)!==0}e.has=n;function r(i,o){return!!o&&(i&o)===o}e.hasAll=r})(fn||(fn={}));var dt;(function(e){function t(_=512){return{current:[],offset:0,capacity:_,chunks:[]}}e.create=t;function n(_){return _.chunks.length?(_.offset>0&&(_.chunks[_.chunks.length]=_.current.length===_.offset?_.current.join(""):_.current.slice(0,_.offset).join("")),_.chunks.join("")):_.current.length===_.offset?_.current.join(""):_.current.splice(0,_.offset).join("")}e.getString=n;function r(_){let b=0;for(let I of _.chunks)b+=I.length;for(let I=0;I<_.offset;I++)b+=_.current[I].length;return b}e.getSize=r;function i(_){return _.offset>0&&(_.current.length===_.offset?_.chunks[_.chunks.length]=_.current.join(""):_.chunks[_.chunks.length]=_.current.slice(0,_.offset).join(""),_.offset=0),_.chunks}e.getChunks=i;let o=[];(function(){let _="";for(let b=0;b<512;b++)o[b]=_,_=_+" "})();function s(_){l(_,`
`)}e.newline=s;function a(_,b){b>0&&l(_,o[b])}e.whitespace=a;function c(_){l(_," ")}e.whitespace1=c;function u(_,b){b&&(_.offset===_.capacity&&(_.chunks[_.chunks.length]=_.current.join(""),_.offset=0),_.current[_.offset++]=b)}e.write=u;function l(_,b){_.offset===_.capacity&&(_.chunks[_.chunks.length]=_.current.join(""),_.offset=0),_.current[_.offset++]=b}e.writeSafe=l;function m(_,b,I){if(!b){a(_,I);return}let E=I-b.length;a(_,E),l(_,b)}e.writePadLeft=m;function f(_,b,I){if(!b){a(_,I);return}let E=I-b.length;l(_,b),a(_,E)}e.writePadRight=f;function d(_,b){l(_,""+b)}e.writeInteger=d;function p(_,b){l(_,""+b+" ")}e.writeIntegerAndSpace=p;function h(_,b,I){let E=""+b,S=I-E.length;a(_,S),l(_,E)}e.writeIntegerPadLeft=h;function x(_,b,I){let E=""+b,S=I-E.length;l(_,E),a(_,S)}e.writeIntegerPadRight=x;function y(_,b,I){l(_,""+Math.round(I*b)/I)}e.writeFloat=y;function g(_,b,I,E){let S=""+Math.round(I*b)/I,v=E-S.length;a(_,v),l(_,S)}e.writeFloatPadLeft=g;function C(_,b,I,E){let S=""+Math.round(I*b)/I,v=E-S.length;l(_,S),a(_,v)}e.writeFloatPadRight=C})(dt||(dt={}));var Qt=function(){if(typeof window<"u"&&window.performance){let e=window.performance;return()=>e.now()}else return typeof process<"u"&&process.hrtime!=="undefined"&&typeof process.hrtime=="function"?()=>{let e=process.hrtime();return e[0]*1e3+e[1]/1e6}:Date.now?()=>Date.now():()=>+new Date}();function Eb(e,t=!0){if(isNaN(e))return"n/a";let n=Math.floor(e/(60*60*1e3)),r=Math.floor(e/(60*1e3)%60),i=Math.floor(e/1e3%60),o=Math.floor(e%1e3).toString();for(;o.length<3;)o="0"+o;for(;!t&&o.length>1&&o[o.length-1]==="0";)o=o.substr(0,o.length-1);return n>0?`${n}h${r}m${i}.${o}s`:r>0?`${r}m${i}.${o}s`:i>0?`${i}.${o}s`:`${e.toFixed(0)}ms`}var Rt;(function(e){let t=typeof btoa<"u"?btoa:s=>Buffer.from(s).toString("base64"),n=[];function r(){let s=+new Date+Qt();for(let a=0;a<16;a++)n[a]=String.fromCharCode((s+Math.random()*255)%255|0),s=Math.floor(s/255);return t(n.join("")).replace(/\+/g,"-").replace(/\//g,"_").substr(0,22)}e.create22=r;function i(){let s=+new Date+Qt();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(c){let u=(s+Math.random()*16)%16|0;return s=Math.floor(s/16),(c==="x"?u:u&3|8).toString(16)})}e.createv4=i;function o(s){return typeof s=="string"}e.is=o})(Rt||(Rt={}));function Ip(e,t){return e-t}function wp(e){return Array.prototype.sort.call(e,Ip),e}var Ia;(function(e){class t{has(p){return!1}forEach(p,h){return h}constructor(){this.size=0}}class n{has(p){return p===this.idx}forEach(p,h){return p(this.idx,h),h}constructor(p){this.idx=p,this.size=1}}class r{has(p){return p<this.length&&!!this.mask[p]}_forEach(p,h){for(let x=0;x<this.length;x++)this.mask[x]&&p(x,h)}forEach(p,h){return this._forEach(p,h),h}constructor(p,h){this.mask=p,this.size=h,this.length=p.length}}class i{has(p){return!0}_forEach(p,h){for(let x=0;x<this.size;x++)p(x,h)}forEach(p,h){return this._forEach(p,h),h}constructor(p){this.size=p}}class o{has(p){return this.set.has(p)}_forEach(p,h){for(let x of this.flatten())p(x,h)}flatten(){if(this._flat)return this._flat;let p=new Int32Array(this.size),h=0;return this.set.forEach(x=>p[h++]=x),wp(p),this._flat=p,this._flat}forEach(p,h){return this._forEach(p,h),h}constructor(p){this.set=p,this._flat=void 0,this.size=p.size}}function s(d){return new i(d)}e.always=s,e.never=new t;function a(d){return new o(d)}e.ofSet=a;function c(d){return new n(d)}e.singleton=c;function u(d){let p=d.length;if(p===0)return new t;if(p===1)return new n(d[0]);let h=0;for(let g of d)g>h&&(h=g);if(p===h)return new i(p);if(p/h<1/12){let g=new Set;for(let C of d)g.add(C);return new o(g)}let y=new Int8Array(h+1);for(let g of d)y[g]=1;return new r(y,d.length)}e.ofUniqueIndices=u;function l(d,p){return new r(d,p)}e.ofMask=l;function m(d,p){for(let h of p)if(d.has(h))return!0;return!1}e.hasAny=m;function f(d,p){let h=0,x=0;if(p.forEach(y=>{d.has(y)||(h++,y>x&&(x=y))}),h/x<1/12){let y=new Set;return p.forEach(g=>{d.has(g)||y.add(g)}),a(y)}else{let y=new Uint8Array(x+1);return p.forEach(g=>{d.has(g)||(y[g]=1)}),l(y,h)}}e.complement=f})(Ia||(Ia={}));function Pi(e=0,t=Number.MAX_SAFE_INTEGER){let n=e;return()=>{let r=n;return n=(n+1)%t,r}}var ro;(function(e){function t(r){return{ref:r}}e.create=t;function n(r,i){return r.ref=i,r}e.set=n})(ro||(ro={}));var vp=Pi(0,2147483647),Zn;(function(e){function t(r,i){return{id:vp(),version:0,value:r,metadata:i}}e.create=t;function n(r,i){return{id:r.id,version:r.version+1,value:i,metadata:r.metadata}}e.withValue=n})(Zn||(Zn={}));var tl;(function(e){function t(o,s){return ro.create(Zn.create(o,s))}e.create=t;function n(o,s){return ro.set(o,Zn.withValue(o.ref,s))}e.update=n;function r(o,s){return ro.set(o,s)}e.set=r;function i(o,s){return o.ref.value!==s?n(o,s):o}e.updateIfChanged=i})(tl||(tl={}));var Gb=function(){};function io(e,t){let n=e.length;if(n!==t.length)return!1;for(let r=0;r<n;r++)if(e[r]!==t[r])return!1;return!0}var il=Object.prototype.hasOwnProperty;function nl(e,t){if(e===t)return!0;let n=Array.isArray(e),r=Array.isArray(t);if(n&&r){if(e.length!==t.length)return!1;for(let i=0;i<e.length;i++)if(!nl(e[i],t[i]))return!1;return!0}if(n!==r)return!1;if(e&&t&&typeof e=="object"&&typeof t=="object"){let i=Object.keys(e);if(i.length!==Object.keys(t).length)return!1;let o=e instanceof Date,s=t instanceof Date;if(o&&s)return e.getTime()===t.getTime();if(o!==s)return!1;let a=e instanceof RegExp,c=t instanceof RegExp;if(a&&c)return e.toString()===t.toString();if(a!==c)return!1;for(let u=0;u<i.length;u++)if(!il.call(t,i[u]))return!1;for(let u=0;u<i.length;u++)if(!nl(e[i[u]],t[i[u]]))return!1;return!0}return!1}function Hb(e,t){if(e===t)return!0;let n=Array.isArray(e),r=Array.isArray(t);return n&&r?Pp(e,t):n!==r?!1:e&&t&&typeof e=="object"&&typeof t=="object"?wa(e,t):!1}function wa(e,t){if(e===t)return!0;if(!e||!t)return!1;let n=Object.keys(e);if(Object.keys(t).length!==n.length)return!1;for(let r of n)if(!il.call(e,r)||e[r]!==t[r])return!1;return!0}function Pp(e,t){if(e===t)return!0;if(!e||!t||e.length!==t.length)return!1;for(let n=0,r=e.length;n<r;++n)if(e[n]!==t[n])return!1;return!0}function va(e,t){return e!==void 0?e:t}function rl(e){return(e<10?"0":"")+e}function zb(e){let t=e.getHours(),n=e.getMinutes(),r=e.getSeconds();return`${t}:${rl(n)}:${rl(r)}`}var mt;(function(e){function t(_){return _&&typeof _._rowCount=="number"&&!!_._columns&&!!_._schema}e.is=t;function n(_,b,I={}){let E=Object.create(null),S=Object.keys(_);E._rowCount=b._rowCount,E._columns=S,E._schema=_;for(let v of S)if(b[v])E[v]=b[v];else if(I[v])E[v]=I[v];else throw Error(`Cannot find column '${v}'.`);return E}e.pickColumns=n;function r(_,b){let I=Object.keys(b),E=b[I[0]].rowCount;return Le({_rowCount:E,_columns:I,_schema:_},b)}e.ofColumns=r;function i(_,b,I){let E=Object.create(null),S=Object.keys(_);E._rowCount=I,E._columns=S,E._schema=_;for(let v of S)v in b?E[v]=b[v]:E[v]=me.Undefined(I,_[v]);return E}e.ofPartialColumns=i;function o(_,b){let I=Object.create(null),E=Object.keys(_);I._rowCount=b,I._columns=E,I._schema=_;for(let S of E)I[S]=me.Undefined(b,_[S]);return I}e.ofUndefinedColumns=o;function s(_,b){let I=Object.create(null),E=b.length,S=Object.keys(_);I._rowCount=E,I._columns=S,I._schema=_;for(let v of S)I[v]=me.ofLambda({rowCount:E,schema:_[v],value:P=>b[P][v],valueKind:P=>typeof b[P][v]>"u"?1:0});return I}e.ofRows=s;function a(_,b){var I;let E=Object.create(null),S=Object.keys(_);E._rowCount=0,E._columns=S,E._schema=_;for(let v of S)typeof b[v]<"u"?(E[v]=me.ofArray({array:b[v],schema:_[v]}),E._rowCount=(I=b[v])===null||I===void 0?void 0:I.length):E[v]=me.Undefined(E._rowCount,_[v]);return E}e.ofArrays=a;function c(_,b,I){let E=Object.create(null),S=Object.keys(b);E._rowCount=I.length,E._columns=S,E._schema=b;for(let v of S)E[v]=me.view(_[v],I);return E}e.view=c;function u(_,b,I){let E=[];for(let S=0,v=_._rowCount;S<v;++S)I(S)&&E.push(S);return c(_,b,E)}e.pick=u;function l(_,b,I,E){if(I===0&&E===_._rowCount)return _;let S=Object.create(null),v=Object.keys(b);S._rowCount=E-I,S._columns=v,S._schema=b;for(let P of v)S[P]=me.window(_[P],I,E);return S}e.window=l;function m(_,b){let I=Object.create(null),E=Object.keys(b);I._rowCount=0;for(let P of _)I._rowCount+=P._rowCount;let S={};for(let P of E)S[P]=new Array(I._rowCount);I._columns=E,I._schema=b;let v=0;for(let P of _){for(let L of E)me.copyToArray(P[L],S[L],v);v+=P._rowCount}for(let P of E)I[P]=me.ofArray({array:S[P],schema:b[P]});return I}e.concat=m;function f(_,b,I){_[b]=me.asArrayColumn(_[b],I)}e.columnToArray=f;function d(_,b){let I=new Int32Array(_._rowCount);for(let v=0,P=I.length;v<P;v++)I[v]=v;jt(I,(v,P,L)=>b(P,L));let E=!0;for(let v=0,P=I.length;v<P;v++)if(I[v]!==v){E=!1;break}if(E)return _;let S=Object.create(null);S._rowCount=_._rowCount,S._columns=_._columns,S._schema=_._schema;for(let v of _._columns)S[v]=me.view(_[v],I,!1);return S}e.sort=d;function p(_,b){if(_._rowCount!==b._rowCount||_._columns.length!==b._columns.length)return!1;for(let I of _._columns)if(!b[I])return!1;for(let I of _._columns)if(!me.areEqual(_[I],b[I]))return!1;return!0}e.areEqual=p;function h(_,b){let I=Object.create(null),{_columns:E}=_;for(let S=0;S<E.length;S++){let v=E[S];I[v]=_[v].value(b)}return I}e.getRow=h;function x(_,b){for(let I=0,E=_._rowCount;I<E;++I)if(b(I))return h(_,I)}e.pickRow=x;function y(_){let b=[],{_rowCount:I}=_;for(let E=0;E<I;E++)b[E]=h(_,E);return b}e.getRows=y;function g(_){let b={},{_columns:I}=_;for(let E=0;E<I.length;E++){let S=I[E];b[S]=_[S].toArray()}return b}e.toArrays=g;function C(_){let b=dt.create(),{_columns:I,_rowCount:E}=_,S=1;dt.write(b,"|");for(let v=0;v<I.length;v++)dt.write(b,I[v]),dt.write(b,"|"),S+=I[v].length+1;dt.newline(b),dt.write(b,new Array(S+1).join("-")),dt.newline(b);for(let v=0;v<E;v++){dt.write(b,"|");for(let P=0;P<I.length;P++){let L=_[I[P]];L.valueKind(v)===0?(dt.write(b,L.value(v)),dt.write(b,"|")):dt.write(b,".|")}dt.newline(b)}return dt.getString(b)}e.formatToString=C})(mt||(mt={}));var oo;(function(e){function t(r,i,o){let s=Object.keys(o),a=Object.create(null),c=[];a._name=r,a._tableNames=c,a._schema=i;for(let u of s)mt.is(o[u])&&(a[u]=o[u],c[c.length]=u);return a}e.ofTables=t;function n(r){let i={};for(let o of r._tableNames)i[o]=mt.getRows(r[o]);return i}e.getTablesAsRows=n})(oo||(oo={}));function ol(e,t){for(let n=0,r=e.length;n<r;n++)if(t(e[n]))return e[n]}function $o(e){if(Array.from)return Array.from(e);let t=[];for(;;){let{done:n,value:r}=e.next();if(n)break;t[t.length]=r}return t}function so(e,t,n){let r=t-e+1,i=n?new n(r):new Int32Array(r);for(let o=0;o<r;o++)i[o]=o+e;return i}function sl(e,t){let n=new(Ep(e))(t.length);for(let r=0,i=t.length;r<i;r++)n[r]=e[t[r]];return n}function Ep(e){let t=e.constructor;if(!t)throw new Error("data does not define a constructor and it should");return t}var Ot;(function(e){e.Zero=0;let{_int32:t,_float64:n,_int32_1:r,_float64_1:i}=function(){let h=new ArrayBuffer(8),x=new ArrayBuffer(8);return{_int32:new Int32Array(h),_float64:new Float64Array(h),_int32_1:new Int32Array(x),_float64_1:new Float64Array(x)}}();function o(h){return typeof h=="number"}e.is=o;function s(h,x){return t[0]=h,t[1]=x,n[0]}e.create=s;function a(h){return n[0]=h,t[1]-t[0]}e.diff=a;function c(h){return n[0]=h,t[0]}e.fst=c;function u(h){return n[0]=h,t[1]}e.snd=u;function l(h,x){return n[0]=h,i[0]=x,t[0]===r[0]&&t[1]===r[1]}e.areEqual=l;function m(h,x){n[0]=h,i[0]=x;let y=t[0]-r[0];return y!==0?y:t[1]-r[1]}e.compare=m;function f(h,x,y){n[0]=h[x],i[0]=h[y];let g=t[0]-r[0];return g!==0?g:t[1]-r[1]}e.compareInArray=f;function d(h){return n[0]=h,Dr(t[0],t[1])}e.hashCode=d;function p(h){return n[0]=h,`(${t[0]}, ${t[1]})`}e.toString=p})(Ot||(Ot={}));var Pa=Ot.Zero;function Ba(e,t){return t<e?Ot.create(e,e):Ot.create(e,t+1)}function Jo(e,t){return t<=e?Ot.create(e,e):Ot.create(e,t)}function al(e){return e<0?Ot.create(0,0):Ot.create(0,e)}var cl=Ot.is,Wn=Ot.fst,dr=Ot.snd,ao=Ot.fst;function co(e){return Ot.snd(e)-1}var Nr=Ot.diff,ul=Ot.hashCode,ll=Ot.toString;function fl(e,t){return Ot.fst(e)<=t&&t<Ot.snd(e)}function dl(e,t){let n=Wn(e);return t>=n&&t<dr(e)?t-n:-1}function ml(e,t){return Ot.fst(e)+t}var pl=Ot.areEqual;function Ea(e,t){let n=Nr(e),r=Nr(t);return n===0&&r===0?!0:n>0&&r>0&&co(e)>=ao(t)&&ao(e)<=co(t)}function hl(e,t){return Nr(e)?Nr(t)?Wn(e)<=Wn(t)&&dr(e)>=dr(t):!0:Nr(t)===0}function Qo(e,t){let n=Wn(e);if(t<=n)return 0;let r=dr(e);return t>=r?r-n:t-n}function _l(e,t,n){let r=Wn(n),i=Wn(e);if(t<=r+i)return r;let o=dr(n);return t>=o+i?o:t-i}function Da(e,t,n){return Jo(Qo(e,t),Qo(e,n+1))}function gl(e,t){return Ea(e,t)?Jo(Math.max(Wn(e),Wn(t)),Math.min(dr(e),dr(t))):Pa}function yl(e,t){return Nr(Da(e,ao(t),co(t)))}var ue;(function(e){e.Empty=Pa,e.ofSingleton=t=>Ba(t,t),e.ofRange=Ba,e.ofBounds=Jo,e.ofLength=al,e.is=cl,e.has=fl,e.indexOf=dl,e.getAt=ml,e.start=Wn,e.end=dr,e.min=ao,e.max=co,e.size=Nr,e.hashCode=ul,e.toString=ll,e.areEqual=pl,e.areIntersecting=Ea,e.isSubInterval=hl,e.findPredecessorIndex=Qo,e.findPredecessorIndexInInterval=_l,e.findRange=Da,e.intersectionSize=yl,e.intersect=gl})(ue||(ue={}));var Bi=[];function xl(e){return[e]}function Al(e){return e}function bl(e){return jt(e),e}function Ma(e,t){if(t<e)return[];let n=new Int32Array(t-e+1);for(let r=e;r<=t;r++)n[r-e]=r;return n}function Cl(e){return e&&(Array.isArray(e)||!!e.buffer)}function Na(e){return e[e.length-1]-e[0]+1===e.length}function es(e){return e[0]}function ts(e){return e[e.length-1]+1}function Sl(e){return e[0]}function Il(e){return e[e.length-1]}function ka(e){return e.length}function wl(e){let t=e.length;return t?t>2?Xu(t,e[0],e[t-1],e[t>>1]):Wu(t,e[0],e[t-1]):0}function vl(e){let t=e.length;return t>5?`[${e[0]}, ${e[1]}, ..., ${e[t-1]}], length ${t}`:`[${e.join(", ")}]`}function Ua(e,t){let n=e.length;return n===0?-1:e[0]<=t&&t<=e[n-1]?Ml(e,t,0,n):-1}function Pl(e,t,n){return Ra(e,t,ue.start(n),ue.end(n))}function Ra(e,t,n,r){return e.length===0||r<=n?-1:e[n]<=t&&t<=e[r-1]?Ml(e,t,n,r):-1}function Bl(e,t){return Ua(e,t)>=0}function Ta(e,t){if(e===t)return!0;let n=e.length;if(n!==t.length||e[0]!==t[0]||e[n-1]!==t[n-1])return!1;if(Na(e))return!0;n--;for(let r=1;r<n;r++)if(e[r]!==t[r])return!1;return!0}function kr(e,t){let n=e.length;return t<=e[0]?0:t>e[n-1]?n:Nl(e,t,0,n)}function El(e,t,n){let r=ue.start(n),i=ue.end(n),o=e[r];return t<=o?r:i>r&&t>e[i-1]?i:t-o<=11?Np(e,t,r+1,i):Nl(e,t,r,i)}function Dl(e,t,n){return ue.ofBounds(kr(e,t),kr(e,n+1))}function Ml(e,t,n,r){let i=n,o=r-1;for(;i<=o;){if(i+11>o){for(let c=i;c<=o;c++)if(t===e[c])return c;return-1}let s=i+o>>1,a=e[s];if(t<a)o=s-1;else if(t>a)i=s+1;else return s}return-1}function Nl(e,t,n,r){let i=n,o=r-1;for(;i<o;){if(i+11>o){for(let c=i;c<=o;c++)if(t<=e[c])return c;return o+1}let s=i+o>>1,a=e[s];if(t<a)o=s-1;else if(t>a)i=s+1;else return s}return i>o?o+1:e[i]>=t?i:i+1}function Np(e,t,n,r){for(let i=n;i<r;i++)if(t<=e[i])return i;return r}function kl(e,t){if(e===t)return!0;let{startI:n,startJ:r,endI:i,endJ:o}=oi(e,t);for(;n<i&&r<o;){let s=e[n],a=t[r];if(s<a)n++;else if(s>a)r++;else return!0}return!1}function Ul(e,t){if(e===t)return!0;let n=t.length,{startI:r,startJ:i,endI:o,endJ:s}=oi(e,t);if(s-i<n||o-r<n)return!1;let a=0;for(;r<o&&i<s;){let c=e[r],u=t[i];c<u?r++:c>u?i++:(r++,i++,a++)}return a===n}function Fa(e,t){if(e===t)return e;let n=e.length,r=t.length;if(n===0)return t;if(r===0)return e;if(e[0]>t[0])return Fa(t,e);let{startI:i,startJ:o,endI:s,endJ:a}=oi(e,t),c=Oa(e,t,i,o,s,a);if(c===n&&c===r||c===r)return e;if(c===n)return t;let u=new Int32Array(n+r-c),l=0,m=0,f=0;for(l=0;l<i;l++)u[f++]=e[l];for(;m<a&&e[i]>t[m];)u[f++]=t[m++];for(;l<s&&m<a;){let d=e[l],p=t[m];d<p?(u[f++]=d,l++):d>p?(u[f++]=p,m++):(u[f++]=d,l++,m++)}for(;l<s;l++)u[f++]=e[l];for(;m<a;m++)u[f++]=t[m];for(;l<n;l++)u[f++]=e[l];for(;m<r;m++)u[f++]=t[m];return u}function Rl(e,t){if(e===t)return ka(e);let{startI:n,startJ:r,endI:i,endJ:o}=oi(e,t);return Oa(e,t,n,r,i,o)}function Oa(e,t,n,r,i,o){let s=n,a=r,c=0;for(;s<i&&a<o;){let u=e[s],l=t[a];u<l?s++:u>l?a++:(s++,a++,c++)}return c}function Tl(e,t){if(e===t)return e;let{startI:n,startJ:r,endI:i,endJ:o}=oi(e,t),s=Oa(e,t,n,r,i,o),a=e.length,c=t.length;if(!s)return Bi;if(s===a&&s===c||s===c)return t;if(s===a)return e;let u=new Int32Array(s),l=0,m=n,f=r;for(;m<i&&f<o;){let d=e[m],p=t[f];d<p?m++:(d>p||(u[l++]=d,m++),f++)}return u}function Fl(e,t){if(e===t)return Bi;let n=e.length,{startI:r,startJ:i,endI:o,endJ:s}=oi(e,t),a=r,c=i,u=0;for(;a<o&&c<s;){let f=e[a],d=t[c];f<d?a++:f>d?c++:(a++,c++,u++)}if(!u)return e;if(u>=n)return Bi;let l=new Int32Array(n-u),m=0;for(let f=0;f<r;f++)l[m++]=e[f];for(a=r,c=i;a<o&&c<s;){let f=e[a],d=t[c];f<d?(l[m++]=f,a++):(f>d||a++,c++)}for(;a<n;a++)l[m++]=e[a];return l}function Ol(e){if(e.length<2)return e;let t=1;for(let i=0,o=e.length-1;i<o;i++)e[i]!==e[i+1]&&t++;if(t===e.length)return e;let n=new Int32Array(t),r=0;for(let i=0,o=e.length-1;i<o;i++)e[i]!==e[i+1]&&(n[r++]=e[i]);return n[r]=e[e.length-1],n}function Ll(e,t){if(Ta(e,t))return so(0,e.length-1);let{startI:n,startJ:r,endI:i,endJ:o}=oi(e,t),s=n,a=r,c=0;for(;s<i&&a<o;){let f=e[s],d=t[a];f<d?s++:f>d?a++:(s++,a++,c++)}let u=e.length;if(!c)return Bi;if(c===u)return so(0,e.length-1);let l=new Int32Array(c),m=0;for(s=n,a=r;s<i&&a<o;){let f=e[s],d=t[a];f<d?s++:(f>d||(l[m++]=s,s++),a++)}return l}var mr={startI:0,startJ:0,endI:0,endJ:0};function oi(e,t){let n=e.length,r=t.length,i=n/r;return n>=128||r>=128||i<=.34||i>=2.99?(mr.startI=kr(e,es(t)),mr.startJ=kr(t,es(e)),mr.endI=kr(e,ts(t)),mr.endJ=kr(t,ts(e))):(mr.startI=0,mr.startJ=0,mr.endI=n,mr.endJ=r),mr}var le;(function(e){e.Empty=Bi,e.ofUnsortedArray=bl,e.ofSingleton=xl,e.ofSortedArray=Al,e.ofRange=Ma,e.ofBounds=(t,n)=>Ma(t,n-1),e.is=Cl,e.isRange=Na,e.has=Bl,e.indexOf=Ua,e.indexOfInInterval=Pl,e.indexOfInRange=Ra,e.start=es,e.end=ts,e.min=Sl,e.max=Il,e.size=ka,e.hashCode=wl,e.toString=vl,e.areEqual=Ta,e.areIntersecting=kl,e.isSubset=Ul,e.union=Fa,e.intersect=Tl,e.subtract=Fl,e.findPredecessorIndex=kr,e.findPredecessorIndexInInterval=El,e.findRange=Dl,e.intersectionSize=Rl,e.deduplicate=Ol,e.indicesOf=Ll})(le||(le={}));var qn=ue.Empty,Kl=ue.ofSingleton,jl=ue.ofRange,Yl=ue.ofBounds;function Bn(e){return e.length?le.isRange(e)?ue.ofRange(e[0],e[e.length-1]):e:qn}function Ur(e){return ue.is(e)?ue.size(e):le.size(e)}function Zl(e,t){return ue.is(e)?ue.has(e,t):le.has(e,t)}function Wl(e,t){return ue.is(e)?ue.indexOf(e,t):le.indexOf(e,t)}function ns(e,t){return ue.is(e)?ue.getAt(e,t):e[t]}function si(e){return ue.is(e)?ue.min(e):le.min(e)}function ai(e){return ue.is(e)?ue.max(e):le.max(e)}function Xl(e){return ue.is(e)?ue.start(e):le.start(e)}function $l(e){return ue.is(e)?ue.end(e):le.end(e)}function Ql(e){return ue.is(e)?ue.hashCode(e):le.hashCode(e)}function Jl(e){return ue.is(e)?ue.toString(e):le.toString(e)}function ef(e,t){return ue.is(e)?ue.is(t)?ue.areEqual(e,t):ql(e,t):ue.is(t)?ql(t,e):le.areEqual(e,t)}function tf(e,t){return ue.is(e)?ue.is(t)?ue.areIntersecting(e,t):Gl(t,e):ue.is(t)?Gl(e,t):le.areIntersecting(e,t)}function nf(e,t){return ue.is(e)?ue.is(t)?ue.isSubInterval(e,t):Rp(e,t):ue.is(t)?Up(e,t):le.isSubset(e,t)}function rf(e,t){return ue.is(e)?ue.findPredecessorIndex(e,t):le.findPredecessorIndex(e,t)}function of(e,t,n){return ue.is(e)?ue.findPredecessorIndexInInterval(e,t,n):le.findPredecessorIndexInInterval(e,t,n)}function sf(e,t,n){return ue.is(e)?ue.findRange(e,t,n):le.findRange(e,t,n)}function af(e,t){return ue.is(e)?ue.is(t)?ue.intersectionSize(e,t):zl(t,e):ue.is(t)?zl(e,t):le.intersectionSize(e,t)}function cf(e,t){return ue.is(e)?ue.is(t)?Op(e,t):Hl(t,e):ue.is(t)?Hl(e,t):Bn(le.union(e,t))}function uf(e,t){return ue.is(e)?ue.is(t)?ue.intersect(e,t):Vl(t,e):ue.is(t)?Vl(e,t):Bn(le.intersect(e,t))}function lf(e,t){return ue.is(e)?ue.is(t)?Lp(e,t):Gp(e,t):ue.is(t)?qp(e,t):Bn(le.subtract(e,t))}function ql(e,t){return ue.size(e)===le.size(t)&&ue.start(e)===le.start(t)&&ue.end(e)===le.end(t)}function Gl(e,t){return e.length!==0&&ue.size(le.findRange(e,ue.min(t),ue.max(t)))!==0}function Up(e,t){let n=ue.min(t),r=ue.max(t);if(r-n+1===0)return!0;let i=le.min(e),o=le.max(e);if(n<i||r>o)return!1;let s=le.findRange(e,n,r);return ue.size(s)===ue.size(t)}function Rp(e,t){let n=ue.min(e),r=ue.max(e);if(r-n+1===0)return!1;let i=le.min(t),o=le.max(t);return i>=n&&o<=r}function Tp(e,t){let n=Ur(e),r=Ur(t);return n===0&&r===0?!0:n>0&&r>0&&ai(e)>=si(t)&&si(e)<=ai(t)}function Fp(e,t){return Ur(e)?Ur(t)?si(e)<=si(t)&&ai(e)>=ai(t):!0:Ur(t)===0}function Op(e,t){if(ue.areEqual(e,t))return e;let n=ue.size(e),r=ue.size(t);if(!r)return e;if(!n)return t;let i=ue.min(e),o=ue.min(t);if(Tp(e,t))return ue.ofRange(Math.min(i,o),Math.max(ue.max(e),ue.max(t)));let s,a,c,u;i<o?(s=n,a=i,c=r,u=o):(s=r,a=o,c=n,u=i);let l=new Int32Array(n+r);for(let m=0;m<s;m++)l[m]=m+a;for(let m=0;m<c;m++)l[m+s]=m+u;return Bn(l)}function Hl(e,t){let n=ue.size(t);if(!n)return e;if(Fp(t,e))return t;let r=ue.min(t),i=ue.max(t),o=le.findRange(e,r,i),s=ue.start(o),a=ue.end(o),c=new Int32Array(s+(e.length-a)+n),u=0;for(let l=0;l<s;l++)c[u++]=e[l];for(let l=r;l<=i;l++)c[u++]=l;for(let l=a,m=e.length;l<m;l++)c[u++]=e[l];return Bn(c)}function zl(e,t){if(!ue.size(t))return 0;let n=le.findRange(e,ue.min(t),ue.max(t));return ue.end(n)-ue.start(n)}function Vl(e,t){if(!ue.size(t))return qn;let n=le.findRange(e,ue.min(t),ue.max(t)),r=ue.start(n),i=ue.end(n),o=i-r;if(!o)return qn;if(o===e.length)return e;let s=new Int32Array(o),a=0;for(let c=r;c<i;c++)s[a++]=e[c];return Bn(s)}function Lp(e,t){if(ue.areEqual(e,t))return qn;if(!ue.areIntersecting(e,t))return e;let n=ue.min(e),r=ue.max(e),i=ue.min(t),o=ue.max(t);if(r<n||o<i)return e;if(ue.isSubInterval(t,e))return qn;if(ue.isSubInterval(e,t)){let s=i-n,a=r-o;if(s<=0)return ue.ofRange(o+1,o+a);if(a<=0)return ue.ofRange(n,n+s-1);let c=new Int32Array(s+a),u=0;for(let l=0;l<s;l++)c[u++]=n+l;for(let l=1;l<=a;l++)c[u++]=o+l;return Bn(c)}return n<i?ue.ofRange(n,i-1):ue.ofRange(o+1,r)}function qp(e,t){let n=ue.min(t),r=ue.max(t);if(r<n)return e;let i=le.findRange(e,n,r),o=ue.start(i),s=ue.end(i),a=e.length-(s-o);if(a<=0)return qn;if(a===e.length)return e;let c=new Int32Array(a),u=0;for(let l=0;l<o;l++)c[u++]=e[l];for(let l=s,m=e.length;l<m;l++)c[u++]=e[l];return Bn(c)}function Gp(e,t){let n=ue.min(e),r=ue.max(e);if(r<n)return e;let i=r-n+1,o=le.findRange(t,n,r),s=ue.start(o),a=ue.end(o),c=a-s;if(c===0)return e;let u=i-c;if(u<=0)return qn;let l=new Int32Array(u),m=t.length-1,f=t[Math.min(s,m)],d=t[Math.min(a,m)],p=0;for(let h=n;h<f;h++)l[p++]=h;for(let h=f;h<=d;h++)le.indexOfInInterval(t,h,o)<0&&(l[p++]=h);for(let h=d+1;h<=r;h++)l[p++]=h;return Bn(l)}function ff(e,t,n){if(ue.is(e)){let r=ue.min(e);for(let i=r,o=ue.max(e);i<=o;i++)t(i,i-r,n)}else for(let r=0,i=e.length;r<i;r++)t(e[r],r,n);return n}function df(e,t,n,r){if(ue.is(e)){let i=0;for(let o=ue.min(e),s=ue.max(e);o<=s;o++){let a=t(o),c=o+1;for(;c<s&&t(c)===a;)c++;o=c-1,n(a,i,r),i++}}else{let i=0;for(let o=0,s=e.length;o<s;o++){let a=t(e[o]),c=o+1;for(;c<s&&t(e[c])===a;)c++;o=c-1,n(a,i,r),i++}}return r}function mf(e,t,n){if(t===n)return e;let r=Ur(e),i=t.length,o=n.length;if(r===0||i===0||o===0)return qn;let s=le.findPredecessorIndex(n,t[si(e)]),a=le.findPredecessorIndex(n,t[ai(e)]+1),c=0,u=0,l=0,m=s;for(;l<r&&m<a;){let d=t[ns(e,l)],p=n[m];d<p?l++:(d>p||(c++,l++),m++)}if(c===0)return qn;if(c===i&&c===o)return e;let f=new Int32Array(c);for(u=0,l=0,m=s;l<r&&m<a;){let d=t[ns(e,l)],p=n[m];d<p?l++:(d>p||(f[u++]=m,l++),m++)}return Bn(f)}var Ie;(function(e){e.Empty=qn,e.ofSingleton=Kl,e.ofRange=jl,e.ofBounds=Yl,e.ofSortedArray=Bn,e.has=Zl,e.indexOf=Wl,e.getAt=ns,e.min=si,e.max=ai,e.start=Xl,e.end=$l,e.size=Ur,e.hashCode=Ql,e.areEqual=ef,e.areIntersecting=tf,e.isSubset=nf,e.union=cf,e.intersect=uf,e.indexedIntersect=mf,e.subtract=lf,e.findPredecessorIndex=rf,e.findPredecessorIndexInInterval=of,e.findRange=sf,e.intersectionSize=af;function t(a,c,u){return ff(a,c,u)}e.forEach=t;function n(a,c,u,l){return df(a,c,u,l)}e.forEachSegment=n;function r(a){return ue.is(a)}e.isInterval=r;function i(a){return!ue.is(a)}e.isSortedArray=i;function o(a){let c=[];return e.forEach(a,u=>c.push(u)),c}e.toArray=o;function s(a){return Jl(a)}e.toString=s})(Ie||(Ie={}));function qa(e){let t=le.ofSortedArray(e),n=le.max(t),r=new Int32Array(n);for(let i=0,o=e.length-1;i<o;i++)for(let s=e[i],a=e[i+1];s<a;s++)r[s]=i;return{offsets:t,index:r,count:e.length-1}}function pf(e,t){let n=ue.start(t),r=new Int32Array(e.length+1);for(let i=0,o=e.length;i<o;i++)r[i]=e[i]-n;return r[e.length]=ue.end(t)-n,qa(r)}function hf({count:e}){return e}function _f({index:e},t){return e[t]}function gf({offsets:e},t,n){let r=Ie.max(e),i=n>=r?-1:Ie.findPredecessorIndex(e,n-1);return Ie.findRange(t,Ie.getAt(e,i),Ie.getAt(e,i+1)-1)}var La=class{move(){for(;this.hasNext;)if(this.updateValue()){this.value.index=this.segmentMin++,this.hasNext=this.segmentMax>=this.segmentMin&&ue.size(this.setRange)>0;break}else this.updateSegmentRange();return this.value}updateValue(){let t=this.segments[this.segmentMin+1],n=Ie.findPredecessorIndexInInterval(this.set,t,this.setRange);return this.value.start=ue.start(this.setRange),this.value.end=n,this.setRange=ue.ofBounds(n,ue.end(this.setRange)),n>this.value.start}updateSegmentRange(){let t=ue.min(this.setRange),n=ue.max(this.setRange);if(n<t){this.hasNext=!1;return}this.segmentMin=this.segmentMap[Ie.getAt(this.set,t)],this.segmentMax=this.segmentMap[Ie.getAt(this.set,n)],this.hasNext=this.segmentMax>=this.segmentMin}setSegment(t){this.setRange=ue.ofBounds(t.start,t.end),this.updateSegmentRange()}constructor(t,n,r,i){this.segments=t,this.segmentMap=n,this.set=r,this.segmentMin=0,this.segmentMax=0,this.setRange=ue.Empty,this.value={index:0,start:0,end:0},this.hasNext=!1,this.setRange=i,this.updateSegmentRange()}};function yf(e,t,n){let r=typeof n<"u"?ue.ofBounds(n.start,n.end):ue.ofBounds(0,Ie.size(t));return new La(e.offsets,e.index,t,r)}var We;(function(e){e.create=qa,e.ofOffsets=pf,e.count=hf,e.getSegment=_f,e.projectValue=gf,e.transientSegments=yf})(We||(We={}));function Ha(e){return new Ga(e)}var Ga=class{remove(t){let{prev:n,next:r}=this,i=n[t],o=r[t];i>=0&&(r[i]=o,n[t]=-1),o>=0&&(n[o]=i,r[t]=-1),t===this.head&&(i<0?this.head=o:this.head=i)}has(t){return this.prev[t]>=0||this.next[t]>=0||this.head===t}constructor(t){this.head=t>0?0:-1,this.prev=new Int32Array(t),this.next=new Int32Array(t);for(let n=0;n<t;n++)this.next[n]=n+1,this.prev[n]=n-1;this.prev[0]=-1,this.next[t-1]=-1}};var yn;(function(e){e.Empty=new Map;function t(s){return $o(s.keys())}e.keyArray=t;function n(){return new Map}e.Mutable=n;function r(s){return s}e.asImmutable=r;function i(s){let a=n(),c=s.keys();for(;;){let{done:u,value:l}=c.next();if(u)break;a.set(l,s.get(l))}return a}e.copy=i;function o(s,a){let c=a.keys();for(;;){let{done:u,value:l}=c.next();if(u)break;s.set(l,a.get(l))}return s}e.addFrom=o})(yn||(yn={}));var za=class{move(){return++this.index,this.lastValue=this.xs[this.index],this.hasNext=this.index<this.length-1,this.lastValue}constructor(t){this.xs=[],this.index=-1,this.length=0,this.hasNext=!1,this.length=t.length,this.hasNext=t.length>0,this.xs=t,this.index=-1,this.lastValue=t.length>0?t[0]:void 0}},rs=class{move(){return++this.value,this.hasNext=this.value<this.max,this.value}constructor(t,n){this.max=n,this.value=0,this.hasNext=!1,this.value=t-1,this.hasNext=n>=t}},Va=class{move(){return this.hasNext=!1,this.value}constructor(t){this.value=t,this.hasNext=!0}},Ka=class{move(){let t=this.f(this.base.move());return this.hasNext=this.base.hasNext,t}constructor(t,n){this.base=t,this.f=n,this.hasNext=!1,this.hasNext=t.hasNext}},ja=class{move(){let t=this.next;return this.hasNext=this.findNext(),t}findNext(){for(;this.base.hasNext;)if(this.next=this.base.move(),this.p(this.next))return!0;return!1}constructor(t,n){this.base=t,this.p=n,this.hasNext=this.findNext()}},Rr;(function(e){e.Empty=new rs(0,-1);function t(a){return new za(a)}e.Array=t;function n(a){return new Va(a)}e.Value=n;function r(a,c){return new rs(a,c)}e.Range=r;function i(a,c){return new Ka(a,c)}e.map=i;function o(a,c){return new ja(a,c)}e.filter=o;function s(a,c,u){for(;a.hasNext;)if(c(a.move(),u))return u;return u}e.forEach=s})(Rr||(Rr={}));var xt;(function(e){e.DefaultName="1_555",e.Default=t(e.DefaultName,ke.identity()),e.RotationTranslationEpsilon=.005;function t(g,C,_){let{assembly:b,ncsId:I,hkl:E,spgrOp:S,key:v}=_||{},P=E?N.clone(E):N();S=S??-1,v=v??-1,I=I||-1;let L=ke.isIdentity(C),w=r(_,L);return L?{name:g,assembly:b,matrix:C,inverse:ke.identity(),isIdentity:!0,hkl:P,spgrOp:S,ncsId:I,suffix:w,key:v}:(ke.isRotationAndTranslation(C,e.RotationTranslationEpsilon)||console.warn(`Symmetry operator (${g}) should be a composition of rotation and translation.`),{name:g,assembly:b,matrix:C,inverse:ke.invert(ke(),C),isIdentity:!1,hkl:P,spgrOp:S,key:v,ncsId:I,suffix:w})}e.create=t;function n(g){return!!g&&!!g.matrix&&!!g.inverse&&typeof g.name=="string"}function r(g,C){if(!g)return"";if(g.assembly)return n(g)?g.suffix:C?"":`_${g.assembly.operId}`;if(typeof g.spgrOp<"u"&&typeof g.hkl<"u"&&g.spgrOp!==-1){let[_,b,I]=g.hkl;return`-${g.spgrOp+1}_${5+_}${5+b}${5+I}`}return g.ncsId!==-1?`_${g.ncsId}`:""}let i=ke();function o(g,C){ke.setIdentity(i);for(let _=0;_<3;_++)for(let b=0;b<3;b++)ke.setValue(i,_,b,Xt.getValue(g,_,b));return ke.setTranslation(i,C),ke.isRotationAndTranslation(i,e.RotationTranslationEpsilon)}e.checkIfRotationAndTranslation=o;function s(g,C,_,b){let I=ke.identity();for(let E=0;E<3;E++)for(let S=0;S<3;S++)ke.setValue(I,E,S,Xt.getValue(C,E,S));return ke.setTranslation(I,_),t(g,I,{ncsId:b})}e.ofRotationAndOffset=s;let a=vn.identity(),c=vn(),u=vn(),l=N();function m(g,C,_){let b=C.inverse;if(C.isIdentity)return ke.copy(g,b);let I=1-_;ke.getRotation(c,b),vn.slerp(c,a,c,I);let E=vn.getAxisAngle(l,c);return ke.fromRotation(g,E,l),ke.setValue(g,0,3,I*ke.getValue(b,0,3)),ke.setValue(g,1,3,I*ke.getValue(b,1,3)),ke.setValue(g,2,3,I*ke.getValue(b,2,3)),g}e.lerpFromIdentity=m;function f(g,C,_,b){if(Math.abs(b)<=1e-5)return ke.copy(g,C);if(Math.abs(b-1)<=1e-5)return ke.copy(g,_);ke.getRotation(c,C),ke.getRotation(u,_),vn.slerp(u,c,u,b);let I=vn.getAxisAngle(l,u);return ke.fromRotation(g,I,l),ke.setValue(g,0,3,qo(ke.getValue(C,0,3),ke.getValue(_,0,3),b)),ke.setValue(g,1,3,qo(ke.getValue(C,1,3),ke.getValue(_,1,3),b)),ke.setValue(g,2,3,qo(ke.getValue(C,2,3),ke.getValue(_,2,3),b)),g}e.slerp=f;function d(g,C){let _=ke.mul(ke(),C.matrix,g.matrix);return t(C.name,_,C)}e.compose=d;class p{constructor(C,_,b=is){this.operator=C,this.coordinates=_,this.r=b,this._x=_.x,this._y=_.y,this._z=_.z,this._m=C.matrix}invariantPosition(C,_){return _[0]=this._x[C],_[1]=this._y[C],_[2]=this._z[C],_}position(C,_){return _[0]=this._x[C],_[1]=this._y[C],_[2]=this._z[C],N.transformMat4(_,_,this._m),_}x(C){let _=this._m,b=_[0],I=_[4],E=_[8],S=_[12],v=this._x[C],P=this._y[C],L=this._z[C],w=_[3]*v+_[7]*P+_[11]*L+_[15]||1;return(b*v+I*P+E*L+S)/w}y(C){let _=this._m,b=_[1],I=_[5],E=_[9],S=_[13],v=this._x[C],P=this._y[C],L=this._z[C],w=_[3]*v+_[7]*P+_[11]*L+_[15]||1;return(b*v+I*P+E*L+S)/w}z(C){let _=this._m,b=_[2],I=_[6],E=_[10],S=_[14],v=this._x[C],P=this._y[C],L=this._z[C],w=_[3]*v+_[7]*P+_[11]*L+_[15]||1;return(b*v+I*P+E*L+S)/w}}class h{constructor(C,_,b=is){this.operator=C,this.coordinates=_,this.r=b,this._x=_.x,this._y=_.y,this._z=_.z,this._m=C.matrix}invariantPosition(C,_){return _[0]=this._x[C],_[1]=this._y[C],_[2]=this._z[C],_}position(C,_){return _[0]=this.x(C),_[1]=this.y(C),_[2]=this.z(C),_}x(C){let _=this._m;return _[0]*this._x[C]+_[4]*this._y[C]+_[8]*this._z[C]+_[12]}y(C){let _=this._m;return _[1]*this._x[C]+_[5]*this._y[C]+_[9]*this._z[C]+_[13]}z(C){let _=this._m;return _[2]*this._x[C]+_[6]*this._y[C]+_[10]*this._z[C]+_[14]}}class x{constructor(C,_,b=is){this.operator=C,this.coordinates=_,this.r=b,this._x=_.x,this._y=_.y,this._z=_.z}invariantPosition(C,_){return _[0]=this._x[C],_[1]=this._y[C],_[2]=this._z[C],_}position(C,_){return _[0]=this._x[C],_[1]=this._y[C],_[2]=this._z[C],_}x(C){return this._x[C]}y(C){return this._y[C]}z(C){return this._z[C]}}function y(g,C,_=is){return ke.isIdentity(g.matrix)?new x(g,C,_):Kp(g.matrix)?new h(g,C,_):new p(g,C,_)}e.createMapping=y})(xt||(xt={}));function is(e){return 0}function Kp(e){return e[3]===0&&e[7]===0&&e[11]===0&&e[15]===1}function xn(e){return e}(function(e){function t(n){return n.__key||(n.__key=Rt.create22()),n.__key}e.getUUID=t})(xn||(xn={}));var pr=class{constructor(){this._list=[],this._set=new Set,this._refs=new Map,this._assets=new Map}get all(){return this._list}add(t){this._set.has(t)||(this._list.push(t),this._set.add(t))}reference(t,n){let r=this._refs.get(t)||0;r+=n?1:-1,this._refs.set(t,Math.max(r,0))}hasReference(t){return(this._refs.get(t)||0)>0}has(t){return this._set.has(t)}assets(t,n){let r=this._assets.get(t);if(r)for(let i of r)i.dispose();n?this._assets.set(t,n):this._assets.delete(t)}dispose(){this._assets.forEach(t=>{for(let n of t)n.dispose()})}};var ss=Object.prototype.hasOwnProperty;function Y5(e,t){for(let n of Object.keys(t))ss.call(t,n)&&typeof e[n]>"u"&&(e[n]=t[n]);return e}function jp(e,t){let n=!1;for(let r of Object.keys(t))if(ss.call(t,r)&&t[r]!==e[r]){n=!0;break}return n?Object.assign({},e,t):e}function Z5(e,t){if(!e)return!t;if(!t)return!1;let n=Object.keys(e);if(Object.keys(t).length!==n.length)return!1;for(let r of n)if(!ss.call(e,r)||e[r]!==t[r])return!1;return!0}function W5(e,t){let n=e;for(let r=0;r<t.length;r++)if(t[r]&&(n=jp(e,t[r]),n!==e)){for(let i=r+1;i<t.length;i++)n=Object.assign(n,t[i]);break}return n}function os(e){if(e===null||typeof e!="object")return e;if(e instanceof Array){let t=[];for(let n=0,r=e.length;n<r;n++)t[n]=os(e[n]);return t}if(typeof e=="object"&&!("prototype"in e)){let t={};for(let n in e)ss.call(e,n)&&(t[n]=os(e[n]));return t}throw new Error(`Can't clone, type "${typeof e}" unsupported`)}function X5(e,t){if(e)for(let n of Object.keys(e))t(e[n],n)}function i4(e){let t=-1/0;for(let n=0,r=e.length;n<r;++n)e[n]>t&&(t=e[n]);return t}function o4(e){let t=1/0;for(let n=0,r=e.length;n<r;++n)e[n]<t&&(t=e[n]);return t}function An(e){let t=1/0,n=-1/0;for(let r=0,i=e.length;r<i;++r)e[r]<t&&(t=e[r]),e[r]>n&&(n=e[r]);return[t,n]}function Yp(e,t=1,n=0){let r=e.length,i=0;for(let o=n;o<r;o+=t)i+=e[o];return i}function s4(e,t=1,n=0){return Yp(e,t,n)/(e.length/t)}function a4(e){let t=e.length,n=0;for(let r=0;r<t;++r){let i=e[r];n+=i*i}return Math.sqrt(n/t)}function Ya(e,t){for(let n=0,r=t?Math.min(t,e.length):e.length;n<r;++n)e[n]=n;return e}function c4(e,t){let n=0,r=!1;for(let i=e.length;n<i;n++)if(e[n]===t){r=!0;break}return r?(Zp(e,n),!0):!1}function Zp(e,t){for(let n=t,r=e.length-1;n<r;n++)e[n]=e[n+1];e.pop()}function Tr(e,t){return e.indexOf(t)>=0?!1:(e.push(t),!0)}function xf(e,t){let n=e.indexOf(t);if(n<0)return!1;for(let r=n,i=e.length-1;r<i;r++)e[r]=e[r+1];return e.pop(),!0}function u4(e,t){let n=0;for(let r=0,i=e.length;r<i;++r)t.includes(e[r])&&(n+=1);return n}function l4(e,t){if(!e||e.length===0)return!t||t.length===0;if(!t)return!1;let n=e.length;if(n!==t.length)return!1;for(let r=0;r<n;r++)if(e[r]!==t[r])return!1;return!0}function Af(e){for(let t=0,n=e.length;t<n;t++)if(e[t]!==t)return!1;return!0}function f4(e,t,n){for(let r=0,i=e.length;r<i;++r)if(e[r][0]===t){e[r][1]=n;return}e.push([t,n])}function bf(e,t){let n=[],r=[],i=[];e.x.length&&(n.push(...An(e.x)),r.push(...An(e.y)),i.push(...An(e.z))),t&&(t.spheres.x.length&&(n.push(...An(t.spheres.x)),r.push(...An(t.spheres.y)),i.push(...An(t.spheres.z))),t.gaussians.x.length&&(n.push(...An(t.gaussians.x)),r.push(...An(t.gaussians.y)),i.push(...An(t.gaussians.z))));let[o,s]=An(n),[a,c]=An(r),[u,l]=An(i),m=o+(s-o)/2,f=a+(c-a)/2,d=u+(l-u)/2;return N.create(m,f,d)}function Cf(e){let t=new Set,n=new Set;return e.properties.structAsymMap.forEach(({auth_id:r},i)=>{t.add(r),n.add(i)}),{auth:t.size,label:n.size}}function y4(e,t){return{value:e,unit:t}}var as;(function(e){function t(c,u,l){let m=!!c[0].cell,f=!!c[0].velocities,d=!!c[0].forces;return{id:Rt.create22(),frames:c,hasCell:m,hasVelocities:f,hasForces:d,deltaTime:u,timeOffset:l}}e.create=t;function n(c,u,l){var m,f;let{x:d,y:p,z:h}=c;return c.xyzOrdering.frozen?l?c.xyzOrdering.isIdentity?(d=s(d,l),p=s(p,l),h=s(h,l)):io(c.xyzOrdering.index,l)||(d=o(d,c.xyzOrdering.index,l),p=o(p,c.xyzOrdering.index,l),h=o(h,c.xyzOrdering.index,l)):c.xyzOrdering.isIdentity||(d=a(d,c.xyzOrdering.index),p=a(p,c.xyzOrdering.index),h=a(h,c.xyzOrdering.index)):l&&(c.xyzOrdering.isIdentity?(c.xyzOrdering.isIdentity=!1,c.xyzOrdering.index=l,i(d,l),i(p,l),i(h,l)):io(c.xyzOrdering.index,l)||(d=o(d,c.xyzOrdering.index,l),p=o(p,c.xyzOrdering.index,l),h=o(h,c.xyzOrdering.index,l))),c.xyzOrdering.frozen=!0,{id:Rt.create22(),atomId:u.atomId,occupancy:(m=u.occupancy)!==null&&m!==void 0?m:me.ofConst(1,c.elementCount,me.Schema.int),B_iso_or_equiv:(f=u.B_iso_or_equiv)!==null&&f!==void 0?f:me.ofConst(0,c.elementCount,me.Schema.float),xyzDefined:!0,x:d,y:p,z:h}}e.getAtomicConformation=n;let r=[.123];function i(c,u){let l=r;for(let m=0,f=c.length;m<f;m++)l[m]=c[u[m]];for(let m=0,f=c.length;m<f;m++)c[m]=l[m]}function o(c,u,l){let m=new Float32Array(c.length);for(let f=0,d=c.length;f<d;f++)m[f]=c[u[l[f]]];return m}function s(c,u){let l=new Float32Array(c.length);for(let m=0,f=c.length;m<f;m++)l[m]=c[u[m]];return l}function a(c,u){let l=new Float32Array(c.length);for(let m=0,f=c.length;m<f;m++)l[u[m]]=c[m];return l}})(as||(as={}));function Wp(){let e=function(){let h=typeof window<"u"&&window,x=typeof self<"u"&&typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&self;return h||typeof global<"u"&&global||x}(),t={},n=typeof document<"u"?document:void 0,r=1,i;function o(h,...x){typeof h!="function"&&(h=new Function(""+h));let y={callback:h,args:x};return t[r]=y,i(r),r++}function s(h){delete t[h]}function a(h){let x=h.callback,y=h.args;switch(y.length){case 0:x();break;case 1:x(y[0]);break;case 2:x(y[0],y[1]);break;case 3:x(y[0],y[1],y[2]);break;default:x.apply(void 0,y);break}}function c(h){let x=t[h];s(h),a(x)}function u(){i=function(h){process.nextTick(function(){c(h)})}}function l(){if(e&&e.postMessage&&!e.importScripts){let h=!0,x=e.onmessage;return e.onmessage=function(){h=!1},e.postMessage("","*"),e.onmessage=x,h}}function m(){let h="setImmediate$"+Math.random()+"$",x=function(y){y.source===e&&typeof y.data=="string"&&y.data.indexOf(h)===0&&c(+y.data.slice(h.length))};window.addEventListener?window.addEventListener("message",x,!1):window.attachEvent("onmessage",x),i=function(y){window.postMessage(h+y,"*")}}function f(){let h=new MessageChannel;h.port1.onmessage=function(x){let y=x.data;c(y)},i=function(x){h.port2.postMessage(x)}}function d(){let h=n.documentElement;i=function(x){let y=n.createElement("script");y.onreadystatechange=function(){c(x),y.onreadystatechange=null,h.removeChild(y),y=null},h.appendChild(y)}}function p(){i=function(h){setTimeout(c,0,h)}}return typeof process<"u"&&{}.toString.call(process)==="[object process]"?u():l()?m():typeof MessageChannel<"u"?f():n&&"onreadystatechange"in n.createElement("script")?d():p(),{setImmediate:o,clearImmediate:s}}var Za=function(){return typeof setImmediate<"u"?typeof window<"u"?{setImmediate:(e,...t)=>window.setImmediate(e,...t),clearImmediate:e=>window.clearImmediate(e)}:{setImmediate,clearImmediate}:Wp()}();function Xp(e){Za.setImmediate(e)}var Wa={setImmediate:Za.setImmediate,clearImmediate:Za.clearImmediate,immediatePromise(){return new Promise(Xp)},delay(e,t=void 0){return new Promise(n=>setTimeout(n,e,t))}};var Sf=function(){try{return!0}catch{return!1}}(),S4=function(){try{let t=process.env.DEBUG;return t==="*"||t==="molstar"}catch{return!1}}(),If=!1;var cs=[];function I4(e){cs.includes(e)||cs.push(e)}function w4(e){let t=cs.indexOf(e);t!==-1&&cs.splice(t,1)}var $p=typeof performance<"u"&&!!performance.mark&&performance.measure,Xa=$p&&If,Ei;(function(e){function t(s){return`startTask${s.id}`}function n(s){return`endTask${s.id}`}function r(s){Xa&&performance.mark(t(s))}e.markStart=r;function i(s){Xa&&performance.mark(n(s))}e.markEnd=i;function o(s){Xa&&performance.measure(`\u2733\uFE0F ${s.name}`,t(s),n(s))}e.measure=o})(Ei||(Ei={}));function wf(e,t,n=250){let r=Ef(e,t,n),i=new us(r,r.root);return $a(e,i)}function k4(e,t,n=250){let r=Ef(e,t,n);return new us(r,r.root)}function vf(e,t){return $a(t,e)}function Pf(e,t,n){return e.runChild(t,n)}function Bf(e){return{taskId:e.id,taskName:e.name,message:"",startedTime:0,canAbort:!0,isIndeterminate:!0,current:0,max:0}}function Ef(e,t,n){let r={abortRequested:!1,treeAborted:!1,reason:""};return{updateRateMs:n,lastNotified:Qt(),observer:t,abortToken:r,taskId:e.id,root:{progress:Bf(e),children:[]},tryAbort:Qp(r)}}function Qp(e){return t=>{e.abortRequested=!0,e.reason=t||e.reason}}function Df(e){return{progress:Le({},e.progress),children:e.children.map(Df)}}function Mf(e){return e.progress.canAbort&&e.children.every(Mf)}function Jp(e){return{root:Df(e.root),canAbort:Mf(e.root),requestAbort:e.tryAbort}}function $a(e,t){return Ve(this,null,function*(){Ei.markStart(e),t.node.progress.startedTime=Qt();try{let n=yield e.f(t);return Ei.markEnd(e),Ei.measure(e),t.info.abortToken.abortRequested&&Nf(t.info),n}catch(n){throw wt.isAbort(n)&&(t.isAborted=!0,t.node.children.length>0&&(yield new Promise(r=>{t.onChildrenFinished=r})),e.onAbort&&e.onAbort()),n}})}function Nf(e){throw e.abortToken.treeAborted||(e.abortToken.treeAborted=!0,kf(e.root),Uf(e,Qt())),wt.Aborted(e.abortToken.reason)}function kf(e){let t=e.progress;t.isIndeterminate=!0,t.canAbort=!1,t.message="Aborting...";for(let n of e.children)kf(n)}function Uf(e,t){e.lastNotified=t;let n=Jp(e);e.observer(n)}var us=class e{checkAborted(){this.info.abortToken.abortRequested&&(this.isAborted=!0,Nf(this.info))}get shouldUpdate(){return this.checkAborted(),Qt()-this.lastUpdatedTime>this.info.updateRateMs}updateProgress(t){if(this.checkAborted(),!t)return;let n=this.node.progress;typeof t=="string"?(n.message=t,n.isIndeterminate=!0):(typeof t.canAbort<"u"&&(n.canAbort=t.canAbort),typeof t.message<"u"&&(n.message=t.message),typeof t.current<"u"&&(n.current=t.current),typeof t.max<"u"&&(n.max=t.max),n.isIndeterminate=typeof n.current>"u"||typeof n.max>"u",typeof t.isIndeterminate<"u"&&(n.isIndeterminate=t.isIndeterminate))}update(t,n){if(this.lastUpdatedTime=Qt(),this.updateProgress(t),!n)return Uf(this.info,this.lastUpdatedTime),this.checkAborted(),Wa.immediatePromise()}runChild(t,n){return Ve(this,null,function*(){this.updateProgress(n);let r={progress:Bf(t),children:[]},i=this.node.children;i.push(r);let o=new e(this.info,r);try{return yield $a(t,o)}catch(s){if(wt.isAbort(s)&&this.isAborted)return;throw s}finally{let s=i.indexOf(r);if(s>=0){for(let a=s,c=i.length-1;a<c;a++)i[a]=i[a+1];i.pop()}i.length===0&&this.onChildrenFinished&&this.onChildrenFinished()}})}constructor(t,n){this.isSynchronous=!1,this.isExecuting=!0,this.lastUpdatedTime=0,this.onChildrenFinished=void 0,this.node=n,this.info=t}};var Qa=class{constructor(){this.shouldUpdate=!1,this.isSynchronous=!0}update(t,n){}},uo=new Qa;var wt;(function(e){class t{run(f,d=250){return f?wf(this,f,d):this.f(uo)}runAsChild(f,d){return f.isSynchronous?this.f(uo):Pf(f,this,d)}runInContext(f){return f.isSynchronous?this.f(uo):vf(f,this)}constructor(f,d,p){this.name=f,this.f=d,this.onAbort=p,this.id=l()}}function n(m){let f=m;return!!m&&typeof f.id=="number"&&typeof f.name=="string"&&!!f.run}e.is=n;function r(m){return!!m&&!!m.isAborted}e.isAbort=r;function i(m){return{isAborted:!0,reason:m,toString(){return`Aborted${m?": "+m:""}`}}}e.Aborted=i;function o(m,f,d){return new t(m,f,d)}e.create=o;function s(m,f){return o(m,d=>Ve(this,null,function*(){return f}))}e.constant=s;function a(){return o("",m=>Ve(this,null,function*(){}))}e.empty=a;function c(m,f){return o(m,d=>Ve(this,null,function*(){throw new Error(f)}))}e.fail=c;function u(m,f){return n(m)?f?m.runInContext(f):m.run():m}e.resolveInContext=u;let l=Pi(0,1073741823)})(wt||(wt={}));var Ja;(function(e){function t(r,i=""){let o=r.progress;if(!r.children.length)return o.isIndeterminate?`${i}${o.taskName}: ${o.message}`:`${i}${o.taskName}: [${o.current}/${o.max}] ${o.message}`;let s=i+"  |_ ",a=r.children.map(c=>t(c,s));return o.isIndeterminate?`${i}${o.taskName}: ${o.message}
${a.join(`
`)}`:`${i}${o.taskName}: [${o.current}/${o.max}] ${o.message}
${a.join(`
`)}`}function n(r){return t(r.root)}e.format=n})(Ja||(Ja={}));function Di(e,t,n,r,i){return Ve(this,null,function*(){let o=Math.max(t,0),s=0,a=0;if(e.isSynchronous)return r(Number.MAX_SAFE_INTEGER,n),n;let c=Qt(),u=0,l=0;for(;(u=r(o,n))>0;){s+=u;let m=Qt()-c;l+=m,a+=m,e.shouldUpdate&&(yield i(e,n,s),o=Math.round(l*s/a)+1,c=Qt(),l=0)}return e.shouldUpdate&&(yield i(e,n,s)),n})}var Jt;(function(e){function t(m,f){if(m===f)return!0;if(m.vertexCount!==f.vertexCount||m.edgeCount!==f.edgeCount)return!1;let{a:d,b:p,offset:h}=m,{a:x,b:y,offset:g}=f;for(let C=0,_=m.a.length;C<_;C++)if(d[C]!==x[C])return!1;for(let C=0,_=m.b.length;C<_;C++)if(p[C]!==y[C])return!1;for(let C=0,_=m.offset.length;C<_;C++)if(h[C]!==g[C])return!1;for(let C of Object.keys(m.edgeProps)){let _=m.edgeProps[C],b=f.edgeProps[C];if(!b)return!1;for(let I=0,E=_.length;I<E;I++)if(_[I]!==b[I])return!1}return!0}e.areEqual=t;class n{getEdgeIndex(f,d){let p,h;f<d?(p=f,h=d):(p=d,h=f);for(let x=this.offset[p],y=this.offset[p+1];x<y;x++)if(this.b[x]===h)return x;return-1}getDirectedEdgeIndex(f,d){for(let p=this.offset[f],h=this.offset[f+1];p<h;p++)if(this.b[p]===d)return p;return-1}getVertexEdgeCount(f){return this.offset[f+1]-this.offset[f]}constructor(f,d,p,h,x,y){this.offset=f,this.a=d,this.b=p,this.edgeCount=h,this.props=y,this.vertexCount=f.length-1,this.edgeProps=x||{}}}function r(m,f,d,p,h,x){return new n(m,f,d,p,h,x)}e.create=r;class i{createGraph(f,d){return r(this.offsets,this.a,this.b,this.edgeCount,f,d)}addNextEdge(){let f=this.xs[this.current],d=this.ys[this.current],p=this.offsets[f]+this.bucketFill[f];this.a[p]=f,this.b[p]=d,this.bucketFill[f]++;let h=this.offsets[d]+this.bucketFill[d];this.a[h]=d,this.b[h]=f,this.bucketFill[d]++,this.current++,this.curA=p,this.curB=h}addAllEdges(){for(let f=0;f<this.edgeCount;f++)this.addNextEdge()}assignProperty(f,d){f[this.curA]=d,f[this.curB]=d}assignDirectedProperty(f,d,p,h){f[this.curA]=d,f[this.curB]=h,p[this.curB]=d,p[this.curA]=h}constructor(f,d,p){this.vertexCount=f,this.xs=d,this.ys=p,this.current=0,this.curA=0,this.curB=0,this.edgeCount=d.length,this.offsets=new Int32Array(this.vertexCount+1),this.bucketFill=new Int32Array(this.vertexCount);let h=new Int32Array(this.vertexCount);for(let y=0,g=this.xs.length;y<g;y++)h[this.xs[y]]++;for(let y=0,g=this.ys.length;y<g;y++)h[this.ys[y]]++;let x=0;for(let y=0;y<this.vertexCount;y++)this.offsets[y]=x,x+=h[y];this.offsets[this.vertexCount]=x,this.slotCount=x,this.a=new Int32Array(x),this.b=new Int32Array(x)}}e.EdgeBuilder=i;class o{createGraph(f,d){return r(this.offsets,this.a,this.b,this.edgeCount,f,d)}addNextEdge(){let f=this.xs[this.current],d=this.ys[this.current],p=this.offsets[f]+this.bucketFill[f];this.a[p]=f,this.b[p]=d,this.bucketFill[f]++,this.current++,this.curA=p}addAllEdges(){for(let f=0;f<this.edgeCount;f++)this.addNextEdge()}assignProperty(f,d){f[this.curA]=d}constructor(f,d,p){this.vertexCount=f,this.xs=d,this.ys=p,this.current=0,this.curA=0,this.edgeCount=d.length,this.offsets=new Int32Array(this.vertexCount+1),this.bucketFill=new Int32Array(this.vertexCount);let h=new Int32Array(this.vertexCount);for(let y=0,g=this.xs.length;y<g;y++)h[this.xs[y]]++;let x=0;for(let y=0;y<this.vertexCount;y++)this.offsets[y]=x,x+=h[y];this.offsets[this.vertexCount]=x,this.slotCount=x,this.a=new Int32Array(x),this.b=new Int32Array(x)}}e.DirectedEdgeBuilder=o;class s{addEdge(f,d){let p=f,h=d;f>d&&(p=d,h=f);let x=jn(p,h);return this.included.has(x)?!1:(this.included.add(x),this.xs[this.xs.length]=p,this.ys[this.ys.length]=h,!0)}getGraph(){return a(this.vertexCount,this.xs,this.ys)}getEdgeBuiler(){return new i(this.vertexCount,this.xs,this.ys)}constructor(f){this.vertexCount=f,this.xs=[],this.ys=[],this.included=new Set}}e.UniqueEdgeBuilder=s;function a(m,f,d){let p=new e.EdgeBuilder(m,f,d);return p.addAllEdges(),p.createGraph({})}e.fromVertexPairs=a;function c(m,f,d){let{b:p,offset:h,vertexCount:x,edgeProps:y}=m,g=new Int32Array(x);for(let L=0,w=f.length;L<w;L++)g[f[L]]=L+1;let C=0;for(let L=0;L<x;L++)if(g[L]!==0)for(let w=h[L],D=h[L+1];w<D;w++)p[w]>L&&g[p[w]]!==0&&C++;let _=new Int32Array(f.length+1),b=new Int32Array(2*C),I=new Int32Array(2*C),E=new Int32Array(2*C),S=0,v=0;for(let L=0;L<x;L++){if(g[L]===0)continue;let w=g[L]-1;for(let D=h[L],z=h[L+1];D<z;D++){let ie=g[p[D]];ie!==0&&(I[S]=w,E[S]=ie-1,b[S]=D,S++)}_[++v]=S}let P={};for(let L of Object.keys(y))P[L]=sl(y[L],b);return r(_,I,E,C,P,d)}e.induceByVertices=c;function u(m){let f=m.vertexCount;if(f===0)return{componentCount:0,componentIndex:new Int32Array(0)};if(m.edgeCount===0){let C=new Int32Array(f);for(let _=0,b=f;_<b;_++)C[_]=_;return{componentCount:f,componentIndex:C}}let d=new Int32Array(f);for(let C=0,_=f;C<_;C++)d[C]=-1;let p=0;d[0]=p;let{offset:h,b:x}=m,y=[0],g=Ha(f);for(g.remove(0);y.length>0;){let C=y.pop(),_=d[C];for(let b=h[C],I=h[C+1];b<I;b++){let E=x[b];g.has(E)&&(g.remove(E),y.push(E),d[E]=_)}y.length===0&&g.head>=0&&(y.push(g.head),d[g.head]=++p,g.remove(g.head))}return{componentCount:f,componentIndex:d}}e.connectedComponents=u;function l(m,f,d,p){if(le.areIntersecting(f,d))return!0;if(p<1)return!1;let h=new Set;for(let x=0,y=f.length;x<y;++x)h.add(f[x]);return Rf(m,f,d,p,h)}e.areVertexSetsConnected=l})(Jt||(Jt={}));function Rf(e,t,n,r,i){let{b:o,offset:s}=e,a=[];for(let c=0,u=t.length;c<u;++c){let l=t[c];for(let m=s[l],f=s[l+1];m<f;++m){let d=o[m];if(!i.has(d)){if(le.has(n,d))return!0;i.add(d),a[a.length]=d}}}return r>1?Rf(e,a,n,r-1,i):!1}var ec=class{constructor(){this.map=new Map,this.applicable=new Map}add(t,n,r){this.map.set(t,n),r&&this.applicable.set(t,r)}remove(t){this.map.delete(t),this.applicable.delete(t)}get(t){return this.map.get(t)}isApplicable(t){if(!this.map.has(t.sourceData.kind))return!1;let n=this.applicable.get(t.sourceData.kind);return n?n(t):!0}};var en;(function(e){function t(n,r){let{name:i}=n,o=new ec;return{descriptor:n,formatRegistry:o,isApplicable(s){return o.isApplicable(s)},get(s){let a=r?.asDynamic?s._dynamicPropertyData:s._staticPropertyData;if(a[i])return a[i];if(s.customProperties.has(n))return;let c=o.get(s.sourceData.kind);if(c)return a[i]=c(s),s.customProperties.add(n),a[i]},set(s,a){r?.asDynamic?s._dynamicPropertyData[i]=a:s._staticPropertyData[i]=a},delete(s){r?.asDynamic?delete s._dynamicPropertyData[i]:delete s._staticPropertyData[i]}}}e.create=t})(en||(en={}));function eh(e,t,n,r){let i=new Jt.EdgeBuilder(r,e,t),o=new Int32Array(i.slotCount),s=new Array(i.slotCount),a=new Array(i.slotCount),c=new Int8Array(i.slotCount),u=new Array(i.slotCount),l=new Array(i.slotCount);for(let m=0,f=i.edgeCount;m<f;m++)i.addNextEdge(),i.assignProperty(o,n.key?n.key[m]:-1),i.assignDirectedProperty(s,n.operatorA?n.operatorA[m]:-1,a,n.operatorB?n.operatorB[m]:-1),i.assignProperty(c,n.order?n.order[m]:1),i.assignProperty(u,n.distance?n.distance[m]:-1),i.assignProperty(l,n.flag?n.flag[m]:1);return i.createGraph({key:o,operatorA:s,operatorB:a,order:c,distance:u,flag:l})}var rn;(function(e){e.Descriptor={name:"index_pair_bonds"},e.Provider=en.create(e.Descriptor,{asDynamic:!0}),e.DefaultProps={maxDistance:-1,cacheable:!0};function t(r,i={}){let o=Le(Le({},e.DefaultProps),i),{pairs:s,count:a}=r,c=s.indexA.toArray(),u=s.indexB.toArray(),l=s.key&&s.key.toArray(),m=s.operatorA&&s.operatorA.toArray(),f=s.operatorB&&s.operatorB.toArray(),d=s.order&&s.order.toArray(),p=s.distance&&s.distance.toArray(),h=s.flag&&s.flag.toArray();return{bonds:eh(c,u,{key:l,operatorA:m,operatorB:f,order:d,distance:p,flag:h},a),maxDistance:o.maxDistance,cacheable:o.cacheable}}e.fromData=t;function n(r,i,o,s,a){let c,u,l,m;i<o?(c=i,u=o,l=s,m=a):(c=o,u=i,l=a,m=s);for(let f=r.offset[c],d=r.offset[c+1];f<d;f++)if(r.b[f]===u&&r.edgeProps.operatorA[f]===l&&r.edgeProps.operatorB[f]===m)return f;return-1}e.getEdgeIndexForOperators=n})(rn||(rn={}));function y6(e){return function(t){return th(e,t)}}function th(e,t){let{data:n,indices:r,count:i}=e,{valueType:o}=t,s=o==="str"?a=>n.substring(r[2*a],r[2*a+1]):o==="int"?a=>Pn(n,r[2*a],r[2*a+1])||0:a=>Ln(n,r[2*a],r[2*a+1])||0;return{schema:t,__array:void 0,isDefined:!0,rowCount:i,value:s,valueKind:a=>0,toArray:a=>Ut.createAndFillArray(i,s,a),areValuesEqual:tc(e)}}function tc(e){let{data:t,indices:n}=e;return function(r,i){let o=n[2*r],s=n[2*i],a=n[2*r+1]-o;if(a!==n[2*i+1]-s)return!1;for(let c=0;c<a;c++)if(t.charCodeAt(c+o)!==t.charCodeAt(c+s))return!1;return!0}}function x6(e){let{count:t,indices:n}=e;for(let r=0;r<t;++r)if(n[2*r]!==n[2*r+1])return!1;return!0}function ls(e,t){return{name:t,blocks:e}}function lo(e,t,n,r=[]){return{categoryNames:e,header:n,categories:t,saveFrames:r,getField(i){let[o,s]=i.split(".");return t[o].getField(s||"")}}}function Tf(e,t,n){return{categoryNames:e,header:n,categories:t}}function Mi(e,t,n,r){return{rowCount:t,name:e,fieldNames:[...n],getField(i){return r[i]}}}(function(e){function t(i){return{rowCount:0,name:i,fieldNames:[],getField(o){}}}e.empty=t;function n(i,o){let s=Object.keys(o);return{rowCount:s.length>0?o[s[0]].rowCount:0,name:i,fieldNames:s,getField(a){return o[a]}}}e.ofFields=n;function r(i,o){let s={};for(let a of o._columns)s[a]=ci.ofColumn(o[a]);return n(i,s)}e.ofTable=r})(Mi||(Mi={}));var ci;(function(e){function t(a){return n([a])}e.ofString=t;function n(a){let c=a.length,u=d=>{let p=a[d];return!p||p==="."||p==="?"?"":p},l=d=>{let p=a[d];return Pn(p,0,p.length)||0},m=d=>{let p=a[d];return Ln(p,0,p.length)||0};return{__array:void 0,binaryEncoding:void 0,isDefined:!0,rowCount:c,str:u,int:l,float:m,valueKind:d=>{let p=a[d],h=p.length;if(h>1)return 0;if(h===0)return 1;let x=p.charCodeAt(0);return x===46?1:x===63?2:0},areValuesEqual:(d,p)=>a[d]===a[p],toStringArray:d=>d?Ut.createAndFillArray(c,u,d):a,toIntArray:d=>Ut.createAndFillArray(c,l,d),toFloatArray:d=>Ut.createAndFillArray(c,m,d)}}e.ofStrings=n;function r(a){let c=a.length,u=d=>""+a[d],l=d=>a[d],m=d=>0,f=d=>!d||d.array&&a instanceof d.array?a:Ut.createAndFillArray(c,l,d);return{__array:void 0,binaryEncoding:void 0,isDefined:!0,rowCount:c,str:u,int:l,float:l,valueKind:m,areValuesEqual:(d,p)=>a[d]===a[p],toStringArray:d=>Ut.createAndFillArray(c,u,d),toIntArray:f,toFloatArray:f}}e.ofNumbers=r;function i(a){let{data:c,indices:u,count:l}=a,m=h=>{let x=c.substring(u[2*h],u[2*h+1]);return x==="."||x==="?"?"":x},f=h=>Pn(c,u[2*h],u[2*h+1])||0,d=h=>Ln(c,u[2*h],u[2*h+1])||0;return{__array:void 0,binaryEncoding:void 0,isDefined:!0,rowCount:l,str:m,int:f,float:d,valueKind:h=>{let x=u[2*h],y=u[2*h+1]-x;if(y>1)return 0;if(y===0)return 1;let g=c.charCodeAt(x);return g===46?1:g===63?2:0},areValuesEqual:tc(a),toStringArray:h=>Ut.createAndFillArray(l,m,h),toIntArray:h=>Ut.createAndFillArray(l,f,h),toFloatArray:h=>Ut.createAndFillArray(l,d,h)}}e.ofTokens=i;function o(a){let{rowCount:c,valueKind:u,areValuesEqual:l,isDefined:m}=a,f,d,p;switch(a.schema.valueType){case"float":case"int":f=x=>""+a.value(x),d=a.value,p=a.value;break;case"str":f=a.value,d=x=>{let y=a.value(x);return Pn(y,0,y.length)||0},p=x=>{let y=a.value(x);return Ln(y,0,y.length)||0};break;case"list":let{separator:h}=a.schema;f=x=>a.value(x).join(h),d=x=>NaN,p=x=>NaN;break;default:throw new Error(`unsupported valueType '${a.schema.valueType}'`)}return{__array:void 0,binaryEncoding:void 0,isDefined:m,rowCount:c,str:f,int:d,float:p,valueKind:u,areValuesEqual:l,toStringArray:h=>Ut.createAndFillArray(c,f,h),toIntArray:h=>Ut.createAndFillArray(c,d,h),toFloatArray:h=>Ut.createAndFillArray(c,p,h)}}e.ofColumn=o;function s(a,c){return o(me.Undefined(a,c))}e.ofUndefined=s})(ci||(ci={}));function Ff(e,t,n,r){let i=n?0:1;switch(t){case 1:return r==="brackets"?o=>`${e}[${o+i}]`:o=>`${e}_${o+i}`;case 2:return r==="brackets"?(o,s)=>`${e}[${o+i}][${s+i}]`:(o,s)=>`${e}_${o+i}${s+i}`;case 3:return r==="brackets"?(o,s,a)=>`${e}[${o+i}][${s+i}][${a+i}]`:(o,s,a)=>`${e}_${o+i}${s+i}${a+i}`;default:throw new Error("Tensors with rank > 3 or rank 0 are currently not supported.")}}function Of(e,t,n,r){let i=t.create();if(t.rank===1){let o=t.dimensions[0];for(let s=0;s<o;s++){let a=e.getField(r(s));t.set(i,s,a?a.float(n):0)}}else if(t.rank===2){let o=t.dimensions[0],s=t.dimensions[1];for(let a=0;a<o;a++)for(let c=0;c<s;c++){let u=e.getField(r(a,c));t.set(i,a,c,u?u.float(n):0)}}else if(t.rank===3){let o=t.dimensions[0],s=t.dimensions[1],a=t.dimensions[2];for(let c=0;c<o;c++)for(let u=0;u<s;u++)for(let l=0;l<a;l++){let m=e.getField(r(c,u,l));t.set(i,c,u,l,m?m.float(n):0)}}else throw new Error("Tensors with rank > 3 or rank 0 are currently not supported.");return i}var Ni;(function(e){function t(i){return i.replace(".","_").replace(/\[/,"_").replace(/(\[|\])/g,"")}e.canonical=t;function n(i,o){return t(i)===t(o)}e.equal=n;function r(i,o,s=!1){let a=`${i}${o?`.${o}`:""}`;return s?t(a):a}e.create=r})(Ni||(Ni={}));function qf(e,t,n){let r={};for(let i of t.blocks)r[i.header]=En(e,i,n);return r}function En(e,t,n){return sh(e,t,n)}function Gf(e,t){return new fs(t,e,!0)}function nh(e){switch(e.valueType){case"str":return(t,n,r)=>rh(e,t,t.str,t.toStringArray);case"int":return(t,n,r)=>Lf(e,t,t.int,t.toIntArray);case"float":return(t,n,r)=>Lf(e,t,t.float,t.toFloatArray);case"list":throw new Error("Use createListColumn instead.");case"tensor":throw new Error("Use createTensorColumn instead.")}}function rh(e,t,n,r){return{schema:e,__array:t.__array,isDefined:t.isDefined,rowCount:t.rowCount,value:e.transform==="lowercase"?i=>n(i).toLowerCase():e.transform==="uppercase"?i=>n(i).toUpperCase():n,valueKind:t.valueKind,areValuesEqual:t.areValuesEqual,toArray:e.transform==="lowercase"?i=>Array.from(r(i)).map(o=>o.toLowerCase()):e.transform==="uppercase"?i=>Array.from(r(i)).map(o=>o.toUpperCase()):r}}function Lf(e,t,n,r){return{schema:e,__array:t.__array,isDefined:t.isDefined,rowCount:t.rowCount,value:n,valueKind:t.valueKind,areValuesEqual:t.areValuesEqual,toArray:r}}function ih(e,t,n){let r=e.separator,i=e.itemParse,o=t.getField(n),s=o?c=>o.str(c).split(r).map(u=>i(u.trim())).filter(u=>!!u):c=>[],a=c=>Ut.createAndFillArray(t.rowCount,s,c);return{schema:e,__array:void 0,isDefined:!!o,rowCount:t.rowCount,value:s,valueKind:o?o.valueKind:()=>1,areValuesEqual:(c,u)=>io(s(c),s(u)),toArray:a}}function oh(e,t,n){let r=e.space,i=t.fieldNames.includes(`${n}[0]`)||t.fieldNames.includes(`${n}[0][0]`)||t.fieldNames.includes(`${n}[0][0][0]`),o=i?0:1,s=t.fieldNames.includes(`${n}_1`)||t.fieldNames.includes(`${n}_11`)||t.fieldNames.includes(`${n}_111`)?"underscore":"brackets",a=Ff(n,r.rank,i,s),c=t.getField(a(o,o,o))||me.Undefined(t.rowCount,e),u=m=>Of(t,r,m,a),l=m=>Ut.createAndFillArray(t.rowCount,u,m);return{schema:e,__array:void 0,isDefined:c.isDefined,rowCount:t.rowCount,value:u,valueKind:c.valueKind,areValuesEqual:(m,f)=>nn.areEqualExact(u(m),u(f)),toArray:l}}var fs=class{constructor(t,n,r){this._isDefined=r;let i=Object.keys(n);this._rowCount=t.rowCount,this._columns=i,this._schema=n;let o=Object.create(null);for(let s of i)Object.defineProperty(this,s,{get:function(){if(o[s])return o[s];let a=n[s];if(a.valueType==="list")o[s]=ih(a,t,s);else if(a.valueType==="tensor")o[s]=oh(a,t,s);else{let c=nh(a),u=t.getField(s);o[s]=u?c(u,t,s):me.Undefined(t.rowCount,a)}return o[s]},enumerable:!0,configurable:!1})}};function sh(e,t,n){let r=Object.create(null);for(let i of Object.keys(e))r[i]=uh(i,e[i],t,n);return oo.ofTables(t.header,e,r)}function ah(e){let t=Object.create(null);for(let n of Object.keys(e.categories))for(let r of e.categories[n].fieldNames){let i=Ni.create(n,r,!0);t[i]=e.categories[n].getField(r)}return t}function ch(e,t,n,r){let i=Ni.create(t,e),o=Ni.canonical(i);if(o in n)return n[o];if(r&&i in r)for(let s of r[i]){let a=Ni.canonical(s);if(a in n)return n[a]}}function uh(e,t,n,r){let i=n.categories[e];if(r){let o=ah(n),s=Object.create(null),a=[],c=0;for(let u of Object.keys(t)){let l=ch(u,e,o,r);l&&(s[u]=l,a.push(u),c=l.rowCount)}i={rowCount:c,name:e,fieldNames:[...a],getField(u){return s[u]}}}return new fs(i||Mi.empty(e),t,!!i)}function M6(e,t,n){let r=new Float32Array(e);for(let i=0;i<r.length;i++)r[i]=t+n*i;return r}var ds=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[-1,0,0,0],[0,-1,0,0],[0,0,-1,0],[0,1,0,.5],[1,0,0,.5],[-1,0,0,.5],[0,0,1,.5],[0,-1,0,.5],[0,0,-1,.5],[1,0,0,.25],[0,-1,0,.25],[0,0,1,.25],[-1,0,0,.25],[0,1,0,.25],[0,-1,0,.75],[0,0,1,.75],[0,1,0,.75],[1,0,0,.75],[-1,0,0,.75],[0,0,-1,.25],[0,0,-1,.75],[1,-1,0,0],[-1,1,0,0],[0,0,1,.3333333333333333],[0,0,1,.6666666666666666],[1,0,0,.6666666666666666],[0,1,0,.3333333333333333],[0,-1,0,.6666666666666666],[1,-1,0,.3333333333333333],[-1,1,0,.6666666666666666],[-1,0,0,.3333333333333333],[1,0,0,.3333333333333333],[0,1,0,.6666666666666666],[0,-1,0,.3333333333333333],[1,-1,0,.6666666666666666],[-1,1,0,.3333333333333333],[-1,0,0,.6666666666666666],[0,0,-1,.3333333333333333],[0,0,-1,.6666666666666666],[0,0,1,.8333333333333334],[0,0,1,.16666666666666666],[0,0,-1,.8333333333333334],[0,0,-1,.16666666666666666]],Hf=[[0,1,2],[3,4,5],[3,1,5],[3,6,5],[7,6,2],[8,6,5],[0,4,2],[0,4,9],[7,10,2],[7,10,9],[0,10,2],[8,10,5],[3,1,11],[3,6,11],[0,10,9],[8,6,11],[3,4,2],[0,4,5],[3,4,9],[7,10,5],[8,4,9],[8,10,9],[8,10,2],[0,6,9],[3,10,9],[0,10,11],[7,1,9],[8,1,11],[7,4,11],[7,6,9],[7,10,11],[3,10,2],[8,1,5],[0,4,11],[3,1,2],[3,1,9],[7,4,2],[8,1,2],[8,1,9],[3,6,9],[7,4,9],[8,6,2],[8,6,9],[3,6,2],[12,13,14],[15,16,14],[12,17,18],[15,19,18],[20,13,18],[21,16,18],[20,17,14],[21,19,14],[0,1,5],[8,10,11],[7,6,11],[7,6,5],[8,4,2],[7,4,5],[7,1,5],[7,1,11],[0,10,5],[0,1,11],[0,6,11],[0,6,5],[3,10,11],[8,4,11],[15,13,22],[12,16,22],[15,17,23],[12,19,23],[21,13,23],[20,16,23],[21,17,22],[20,19,22],[4,0,2],[1,3,2],[4,0,14],[1,3,18],[4,0,9],[1,3,9],[4,0,18],[1,3,14],[10,7,9],[6,8,9],[4,7,14],[6,3,18],[10,0,18],[1,8,14],[1,3,5],[4,0,5],[6,8,11],[10,7,11],[1,3,11],[4,0,11],[10,7,2],[6,8,2],[3,10,22],[7,1,23],[8,4,23],[0,6,22],[1,0,5],[4,3,5],[1,0,23],[4,3,22],[10,7,14],[6,8,18],[8,6,22],[7,10,23],[4,3,11],[1,0,11],[1,0,22],[4,3,23],[10,7,18],[6,8,14],[8,6,23],[7,10,22],[6,7,11],[10,8,11],[8,1,23],[0,10,22],[3,6,22],[7,4,23],[4,3,2],[1,0,2],[10,8,2],[6,7,2],[4,3,9],[1,0,9],[10,8,9],[6,7,9],[4,8,14],[6,0,18],[10,3,18],[1,7,14],[4,8,18],[6,0,14],[10,3,14],[1,7,18],[6,7,5],[10,8,5],[6,8,5],[10,7,5],[8,1,22],[0,10,23],[3,6,23],[7,4,22],[4,24,2],[25,3,2],[4,24,26],[25,3,27],[4,24,27],[25,3,26],[28,29,26],[30,31,26],[32,33,26],[34,35,27],[36,37,27],[38,39,27],[2,0,1],[1,2,0],[1,25,5],[24,0,5],[39,36,40],[35,38,40],[37,34,40],[33,30,41],[29,32,41],[31,28,41],[5,3,4],[4,5,3],[25,1,5],[0,24,5],[24,4,5],[3,25,5],[4,3,41],[25,1,40],[24,4,41],[3,25,40],[4,3,40],[25,1,41],[24,4,40],[3,25,41],[35,34,40],[37,36,40],[39,38,40],[29,28,41],[31,30,41],[33,32,41],[3,5,4],[5,4,3],[25,1,2],[0,24,2],[24,4,2],[3,25,2],[25,1,9],[0,24,9],[24,4,9],[3,25,9],[30,33,26],[32,29,26],[28,31,26],[36,39,27],[38,35,27],[34,37,27],[0,2,1],[2,1,0],[30,33,42],[32,29,42],[28,31,42],[36,39,43],[38,35,43],[34,37,43],[7,9,6],[9,6,7],[25,1,11],[0,24,11],[24,4,11],[3,25,11],[35,34,44],[37,36,44],[39,38,44],[29,28,45],[31,30,45],[33,32,45],[8,11,10],[11,10,8],[1,25,2],[24,0,2],[1,25,42],[24,0,43],[1,25,43],[24,0,42],[1,25,27],[24,0,26],[1,25,26],[24,0,27],[1,25,9],[24,0,9],[4,24,5],[25,3,5],[4,24,11],[25,3,11],[1,0,40],[4,3,44],[0,24,45],[1,0,41],[4,3,45],[0,24,44],[0,24,40],[0,24,41],[2,3,4],[5,3,1],[5,0,4],[4,2,3],[1,5,3],[4,5,0],[2,7,6],[2,8,10],[5,8,6],[5,7,10],[1,9,7],[4,9,8],[1,11,8],[4,11,7],[9,0,6],[9,3,10],[11,3,6],[11,0,10],[6,2,7],[10,2,8],[6,5,8],[10,5,7],[9,7,1],[9,8,4],[11,8,1],[11,7,4],[6,9,0],[10,9,3],[6,11,3],[10,11,0],[9,7,6],[9,8,10],[11,8,6],[11,7,10],[6,9,7],[10,9,8],[6,11,8],[10,11,7],[2,3,10],[5,8,1],[11,0,4],[10,2,3],[1,5,8],[4,11,0],[5,0,1],[2,0,4],[2,3,1],[1,5,0],[4,2,0],[1,2,3],[11,8,10],[11,7,6],[9,7,10],[9,8,6],[10,11,8],[6,11,7],[10,9,7],[6,9,8],[5,8,10],[5,7,6],[2,7,10],[2,8,6],[4,11,8],[1,11,7],[4,9,7],[1,9,8],[11,3,10],[11,0,6],[9,0,10],[9,3,6],[10,5,8],[6,5,7],[10,2,7],[6,2,8],[11,8,4],[11,7,1],[9,7,4],[9,8,1],[10,11,3],[6,11,0],[10,9,0],[6,9,3],[22,15,13],[22,12,16],[14,12,13],[14,15,16],[13,22,15],[16,22,12],[13,14,12],[16,14,15],[22,21,17],[22,20,19],[14,20,17],[14,21,19],[13,23,21],[16,23,20],[13,18,20],[16,18,21],[23,15,17],[23,12,19],[18,12,17],[18,15,19],[17,22,21],[19,22,20],[17,14,20],[19,14,21],[23,21,13],[23,20,16],[18,20,13],[18,21,16],[17,23,15],[19,23,12],[17,18,12],[19,18,15],[5,0,6],[2,7,4],[9,3,1],[6,5,0],[4,2,7],[1,9,3],[0,2,4],[3,2,1],[0,5,1],[2,1,3],[2,4,0],[5,1,0],[7,9,10],[8,9,6],[7,11,6],[9,6,8],[9,10,7],[11,6,7],[1,7,11],[4,8,11],[1,8,9],[4,7,9],[0,9,10],[3,9,6],[3,11,10],[0,11,6],[2,6,8],[2,10,7],[5,6,7],[5,10,8],[6,0,11],[10,3,11],[6,3,9],[10,0,9],[7,2,10],[8,2,6],[8,5,10],[7,5,6],[9,1,8],[9,4,7],[11,1,7],[11,4,8],[7,9,4],[8,9,1],[8,11,4],[7,11,1],[9,6,3],[9,10,0],[11,6,0],[11,10,3],[19,12,23],[13,15,22],[16,21,18],[17,20,14],[20,14,17],[21,18,16],[15,22,13],[12,23,19],[18,16,21],[14,17,20],[23,19,12],[22,13,15],[19,20,22],[13,21,23],[16,15,14],[17,12,18],[20,18,13],[21,14,19],[15,23,17],[12,22,16],[18,19,15],[14,13,12],[23,16,20],[22,17,21],[16,12,22],[17,15,23],[19,21,14],[13,20,18],[12,14,13],[15,18,19],[21,22,17],[20,23,16],[14,16,15],[18,17,12],[22,19,20],[23,13,21],[16,20,23],[17,21,22],[19,15,18],[13,12,14],[12,18,17],[15,14,16],[21,23,13],[20,22,19],[14,19,21],[18,13,20],[22,16,12],[23,17,15],[19,12,22],[17,21,23],[16,15,18],[13,20,14],[20,14,13],[15,18,16],[21,23,17],[12,22,19],[18,16,15],[14,13,20],[22,19,12],[23,17,21],[3,2,4],[3,5,1],[0,5,4],[2,4,3],[5,1,3],[5,4,0],[1,7,9],[4,8,9],[1,8,11],[4,7,11],[0,9,6],[3,9,10],[3,11,6],[0,11,10],[2,6,7],[2,10,8],[5,6,8],[5,10,7],[6,0,9],[10,3,9],[6,3,11],[10,0,11],[7,2,6],[8,2,10],[8,5,6],[7,5,10],[9,1,7],[9,4,8],[11,1,8],[11,4,7],[7,9,1],[8,9,4],[8,11,1],[7,11,4],[9,6,0],[9,10,3],[11,6,3],[11,10,0],[8,9,10],[8,11,6],[7,11,10],[9,10,8],[11,6,8],[11,10,7],[6,0,2],[10,3,2],[6,3,5],[10,0,5],[7,2,1],[8,2,4],[8,5,1],[7,5,4],[9,1,0],[9,4,3],[11,1,3],[11,4,0],[1,7,2],[4,8,2],[1,8,5],[4,7,5],[0,9,1],[3,9,4],[3,11,1],[0,11,4],[2,6,0],[2,10,3],[5,6,3],[5,10,0],[0,2,6],[3,2,10],[3,5,6],[0,5,10],[2,1,7],[2,4,8],[5,1,8],[5,4,7],[16,12,14],[13,21,18],[19,15,23],[17,20,22],[12,14,16],[21,18,13],[15,23,19],[20,22,17],[14,16,12],[18,13,21],[23,19,15],[22,17,20],[19,20,18],[17,15,14],[16,21,22],[13,12,23],[20,18,19],[15,14,17],[21,22,16],[12,23,13],[18,19,20],[14,17,15],[22,16,21],[23,13,12],[6,0,5],[10,3,5],[6,3,2],[10,0,2],[7,2,4],[8,2,1],[8,5,4],[7,5,1],[9,1,3],[9,4,0],[11,1,0],[11,4,3],[1,7,5],[4,8,5],[1,8,2],[4,7,2],[0,9,4],[3,9,1],[3,11,4],[0,11,1],[2,6,3],[2,10,0],[5,6,0],[5,10,3],[0,2,10],[3,2,6],[3,5,10],[0,5,6],[2,1,8],[2,4,7],[5,1,7],[5,4,8],[21,17,23],[20,16,22],[12,13,18],[15,19,14],[23,21,17],[22,20,16],[18,12,13],[14,15,19],[17,23,21],[16,22,20],[13,18,12],[19,14,15],[21,13,22],[20,19,23],[12,17,14],[15,16,18],[23,15,13],[22,12,19],[18,20,17],[14,21,16],[17,22,15],[16,23,12],[13,14,20],[19,18,21],[15,17,22],[12,16,23],[20,13,14],[21,19,18],[22,21,13],[23,20,19],[14,12,17],[18,15,16],[13,23,15],[19,22,12],[17,18,20],[16,14,21],[15,13,23],[12,19,22],[20,17,18],[21,16,14],[22,15,17],[23,12,16],[14,20,13],[18,21,19],[13,22,21],[19,23,20],[17,14,12],[16,18,15],[6,5,3],[4,9,3],[9,3,4],[5,7,4],[4,5,7],[5,3,6]],zf=[[0],[0,1],[0,2],[0,3],[0,2,4,5],[0,6],[0,7],[0,6,4,8],[0,7,4,9],[0,6,2,1],[0,3,1,10],[0,6,2,1,4,8,5,11],[0,12,1,7],[0,1,13,14],[0,12,1,7,4,15,11,9],[0,16,2,17],[0,18,12,17],[0,16,5,19],[0,20,13,19],[0,18,12,17,4,21,15,19],[0,16,2,17,4,22,5,19],[0,16,2,17,23,24,13,25,26,20,27,28,4,22,5,19],[0,16,17,2,29,21,30,15],[0,20,13,19,29,31,32,33],[0,16,6,34],[0,18,7,34],[0,16,7,35],[0,16,36,37],[0,18,36,38],[0,16,14,39],[0,20,40,34],[0,16,8,41],[0,18,8,42],[0,16,9,42],[0,16,6,34,4,22,8,41],[0,18,7,34,4,21,9,41],[0,16,7,35,4,22,9,42],[0,16,6,34,23,24,14,39],[0,16,10,43,23,24,7,35],[0,16,36,37,23,24,9,42],[0,16,8,41,23,24,40,38],[0,16,6,34,23,24,14,39,26,20,40,38,4,22,8,41],[0,16,44,45,23,24,46,47,26,20,48,49,4,22,50,51],[0,16,6,34,29,21,9,42],[0,16,8,41,29,21,7,35],[0,16,36,37,29,21,14,39],[0,16,2,17,1,52,6,34],[0,16,2,17,53,54,9,42],[0,16,12,33,1,52,7,35],[0,16,2,17,11,55,8,41],[0,56,2,57,1,58,6,37],[0,56,15,25,1,58,9,39],[0,20,27,17,1,59,40,34],[0,56,12,28,1,58,7,38],[0,16,5,19,1,52,8,41],[0,22,13,28,1,55,14,38],[0,18,13,60,1,61,14,43],[0,16,15,30,1,52,9,42],[0,16,5,19,11,55,6,34],[0,21,12,19,1,54,7,41],[0,20,13,19,1,59,14,41],[0,20,3,30,1,59,10,42],[0,18,12,17,1,61,7,34,4,21,15,19,11,54,9,41],[0,24,13,17,1,62,14,34,4,20,27,19,11,59,40,41],[0,16,2,17,1,52,6,34,4,22,5,19,11,55,8,41],[0,16,12,33,1,52,7,35,4,22,15,30,11,55,9,42],[0,31,3,17,1,63,10,34,4,56,32,19,11,58,36,41],[0,22,2,19,64,59,14,38,4,16,5,17,65,62,40,39],[0,16,2,17,1,52,6,34,23,24,13,25,64,62,14,39,26,20,27,28,65,59,40,38,4,22,5,19,11,55,8,41],[0,16,2,17,66,67,44,45,23,24,13,25,68,69,46,47,26,20,27,28,70,71,48,49,4,22,5,19,72,73,50,51],[0,16,2,17,1,52,6,34,29,21,15,30,53,54,9,42],[0,16,5,19,1,52,8,41,29,21,12,33,53,54,7,35],[0,20,13,19,1,59,14,41,29,31,32,33,53,63,36,35],[0,31,3,17,1,63,10,34,29,20,27,30,53,59,40,42],[0,16,74,75],[0,18,76,77],[0,16,78,79],[0,18,80,81],[0,16,74,75,29,21,82,83],[0,21,84,85,29,16,86,87],[0,16,88,89],[0,16,88,89,29,21,90,91],[0,16,74,75,1,52,88,89],[0,16,78,79,1,52,92,93],[0,16,94,95,11,55,88,89],[0,16,82,83,53,54,88,89],[0,16,74,75,1,52,88,89,29,21,82,83,53,54,90,91],[0,21,84,85,96,97,88,91,29,16,86,87,98,99,90,89],[0,16,74,75,2,17,100,101],[0,16,94,95,5,19,100,101],[0,18,76,77,2,33,102,103],[0,18,104,105,106,107,100,108],[0,16,78,79,2,17,109,108],[0,16,82,83,15,30,100,101],[0,18,80,81,2,33,110,111],[0,18,112,113,114,115,100,108],[0,16,74,75,2,17,100,101,29,21,82,83,15,30,116,117],[0,21,84,85,118,119,116,101,29,16,86,87,120,121,100,117],[0,16,74,75,6,34,122,123],[0,16,74,75,8,41,124,125],[0,16,78,79,7,35,122,123],[0,16,82,83,9,42,122,123],[0,16,74,75,7,35,126,127],[0,16,74,75,9,42,128,129],[0,16,78,79,6,34,126,127],[0,16,78,79,8,41,128,129],[0,16,74,75,6,34,122,123,29,21,82,83,9,42,128,129],[0,16,74,75,7,35,126,127,29,21,82,83,8,41,124,125],[0,21,84,85,6,42,130,131,29,16,86,87,9,34,132,133],[0,21,84,85,7,41,134,135,29,16,86,87,8,35,136,137],[0,16,89,88,2,17,122,123],[0,16,89,88,12,33,126,127],[0,16,89,88,5,19,124,125],[0,16,89,88,15,30,128,129],[0,16,88,89,6,34,100,101],[0,16,89,88,7,35,109,108],[0,16,89,88,8,41,138,139],[0,16,89,88,9,42,116,117],[0,16,89,88,6,34,100,101,29,21,91,90,9,42,116,117],[0,16,89,88,7,35,109,108,29,21,91,90,8,41,138,139],[0,16,89,88,2,17,122,123,29,21,91,90,15,30,128,129],[0,16,89,88,118,121,132,131,29,21,91,90,120,119,130,133],[0,16,74,75,2,17,100,101,1,52,88,89,6,34,122,123],[0,16,74,75,12,33,109,108,1,52,88,89,7,35,126,127],[0,16,74,75,2,17,100,101,11,55,140,141,8,41,124,125],[0,16,74,75,2,17,100,101,53,54,90,91,9,42,128,129],[0,16,74,75,5,19,138,139,1,52,88,89,8,41,124,125],[0,16,74,75,15,30,116,117,1,52,88,89,9,42,128,129],[0,16,94,95,5,19,100,101,11,55,88,89,6,34,124,125],[0,16,94,95,15,30,109,108,11,55,88,89,7,35,128,129],[0,16,78,79,2,17,109,108,1,52,92,93,6,34,126,127],[0,16,78,79,12,33,100,101,1,52,92,93,7,35,122,123],[0,16,82,83,12,33,138,139,53,54,88,89,8,41,126,127],[0,16,82,83,2,17,116,117,53,54,88,89,9,42,122,123],[0,16,78,79,5,19,116,117,1,52,92,93,8,41,128,129],[0,16,82,83,15,30,100,101,1,52,90,91,9,42,122,123],[0,16,82,83,15,30,100,101,53,54,88,89,6,34,128,129],[0,16,82,83,5,19,109,108,53,54,88,89,7,35,124,125],[0,16,74,75,2,17,100,101,1,52,88,89,6,34,122,123,29,21,82,83,15,30,116,117,53,54,90,91,9,42,128,129],[0,16,74,75,12,33,109,108,1,52,88,89,7,35,126,127,29,21,82,83,5,19,138,139,53,54,90,91,8,41,124,125],[0,21,84,85,118,119,116,101,96,97,88,91,9,34,132,133,29,16,86,87,120,121,100,117,98,99,90,89,6,42,130,131],[0,21,84,85,142,143,138,108,96,97,88,91,8,35,136,137,29,16,86,87,144,145,109,139,98,99,90,89,7,41,134,135],[0,146,147],[0,148,149],[0,150,151],[0,146,147,152,153,154,155,156,157],[0,158,159],[0,146,147,1,160,161],[0,146,147,1,160,161,152,153,154,162,163,164,155,156,157,165,166,167],[0,158,159,1,168,169],[0,146,147,101,170,171],[0,146,147,100,172,173],[0,148,149,174,175,171],[0,148,149,100,176,177],[0,150,151,178,179,171],[0,150,151,100,180,181],[0,146,147,100,172,173,152,153,154,182,183,184,155,156,157,185,186,187],[0,158,159,101,188,189],[0,146,147,122,190,191],[0,146,147,123,192,193],[0,146,147,126,194,195],[0,146,147,127,196,197],[0,146,147,122,190,191,152,153,154,198,199,200,155,156,157,201,202,203],[0,158,159,123,204,205],[0,146,147,126,194,195,152,153,154,206,207,208,155,156,157,209,210,211],[0,158,159,129,212,213],[0,146,147,101,170,171,1,160,161,123,192,193],[0,146,147,108,214,215,1,160,161,127,196,197],[0,146,147,100,172,173,1,160,161,122,190,191],[0,146,147,109,216,217,1,160,161,126,194,195],[0,146,147,100,172,173,1,160,161,122,190,191,152,153,154,182,183,184,162,163,164,198,199,200,155,156,157,185,186,187,165,166,167,201,202,203],[0,158,159,101,188,189,1,168,169,123,204,205],[0,146,147,109,216,217,1,160,161,126,194,195,152,153,154,218,219,220,162,163,164,206,207,208,155,156,157,221,222,223,165,166,167,209,210,211],[0,158,159,117,224,225,1,168,169,129,212,213],[0,146,147,16,226,227],[0,148,149,18,228,229],[0,150,151,18,230,231],[0,150,151,16,232,233],[0,148,149,16,234,235],[0,146,147,18,236,237],[0,146,147,52,238,239],[0,146,147,16,226,227,1,160,161,52,238,239],[0,146,147,18,236,237,1,160,161,61,240,241],[0,146,147,16,226,227,100,172,173,101,170,171],[0,148,149,18,228,229,242,172,181,243,214,244],[0,150,151,18,230,231,245,172,177,246,214,247],[0,150,151,16,232,233,245,172,177,174,170,248],[0,148,149,16,234,235,242,172,181,178,170,249],[0,146,147,18,236,237,100,172,173,108,214,215],[0,146,147,16,226,227,122,190,191,123,192,193],[0,146,147,16,226,227,126,194,195,127,196,197],[0,146,147,18,236,237,126,194,195,123,192,193],[0,146,147,18,236,237,122,190,191,127,196,197],[0,146,147,52,238,239,122,190,191,101,170,171],[0,146,147,61,240,241,126,194,195,101,170,171],[0,146,147,52,238,239,100,172,173,123,192,193],[0,146,147,61,240,241,100,172,173,127,196,197],[0,146,147,16,226,227,100,172,173,101,170,171,1,160,161,52,239,238,122,190,191,123,192,193],[0,146,147,16,226,227,109,216,217,108,214,215,1,160,161,52,239,238,126,194,195,127,196,197],[0,146,147,18,236,237,109,216,217,101,170,171,1,160,161,61,241,240,126,194,195,123,192,193],[0,146,147,18,236,237,100,172,173,108,214,215,1,160,161,61,241,240,122,190,191,127,196,197],[0,16,2,17,158,250,251,252,159,253,254,255],[0,16,2,17,158,250,251,252,159,253,254,255,23,24,13,25,256,257,258,259,260,261,262,263,26,20,27,28,264,265,266,267,268,269,270,271,4,22,5,19,272,273,274,275,276,277,278,279],[0,16,2,17,158,250,251,252,159,253,254,255,29,21,15,30,280,281,282,283,284,285,286,287],[0,20,13,19,158,273,266,259,159,261,278,271],[0,20,13,19,158,273,266,259,159,261,278,271,29,31,32,33,280,288,289,290,284,291,292,293],[0,16,2,17,158,250,251,252,159,253,254,255,1,52,6,34,168,294,295,296,169,297,298,299],[0,16,2,17,158,250,251,252,159,253,254,255,53,54,9,42,300,301,302,303,304,305,306,307],[0,16,2,17,158,250,251,252,159,253,254,255,1,52,6,34,168,294,295,296,169,297,298,299,23,24,13,25,256,257,258,259,260,261,262,263,64,62,14,39,308,309,310,311,312,313,314,315,26,20,27,28,264,265,266,267,268,269,270,271,65,59,40,38,316,317,318,319,320,321,322,323,4,22,5,19,272,273,274,275,276,277,278,279,11,55,8,41,324,325,326,327,328,329,330,331],[0,16,2,17,158,250,251,252,159,253,254,255,66,67,44,45,332,333,334,335,336,337,338,339,23,24,13,25,256,257,258,259,260,261,262,263,68,69,46,47,340,341,342,343,344,345,346,347,26,20,27,28,264,265,266,267,268,269,270,271,70,71,48,49,348,349,350,351,352,353,354,355,4,22,5,19,272,273,274,275,276,277,278,279,72,73,50,51,356,357,358,359,360,361,362,363],[0,16,2,17,158,250,251,252,159,253,254,255,1,52,6,34,168,294,295,296,169,297,298,299,29,21,15,30,280,281,282,283,284,285,286,287,53,54,9,42,300,301,302,303,304,305,306,307],[0,20,13,19,158,273,266,259,159,261,278,271,1,59,14,41,168,325,318,311,169,313,330,323],[0,20,13,19,158,273,266,259,159,261,278,271,1,59,14,41,168,325,318,311,169,313,330,323,29,31,32,33,280,288,289,290,284,291,292,293,53,63,36,35,300,364,365,366,304,367,368,369],[0,16,2,17,158,250,251,252,159,253,254,255,100,101,75,74,370,371,188,372,373,374,375,189],[0,16,2,17,158,250,251,252,159,253,254,255,116,117,83,82,376,377,224,378,379,380,381,225],[0,16,2,17,158,250,251,252,159,253,254,255,100,101,75,74,370,371,188,372,373,374,375,189,23,24,13,25,256,257,258,259,260,261,262,263,382,383,384,385,386,387,388,389,390,391,392,393,26,20,27,28,264,265,266,267,268,269,270,271,394,395,396,397,398,399,400,401,402,403,404,405,4,22,5,19,272,273,274,275,276,277,278,279,138,139,95,94,406,407,408,409,410,411,412,413],[0,24,5,28,158,265,258,275,159,277,270,263,414,415,416,417,418,419,420,421,422,423,424,425,23,16,27,19,256,273,251,267,260,269,278,255,426,427,428,429,430,431,432,433,434,435,436,437,26,22,13,17,264,250,274,259,268,261,254,279,438,439,440,441,442,443,444,445,446,447,448,449,4,20,2,25,272,257,266,252,276,253,262,271,450,451,452,453,454,455,456,457,458,459,460,461],[0,16,2,17,158,250,251,252,159,253,254,255,100,101,75,74,370,371,188,372,373,374,375,189,29,21,15,30,280,281,282,283,284,285,286,287,116,117,83,82,376,377,224,378,379,380,381,225],[0,20,13,19,158,273,266,259,159,261,278,271,450,415,440,429,454,431,420,445,458,447,436,425],[0,20,13,19,158,273,266,259,159,261,278,271,462,463,464,465,466,467,468,469,470,471,472,473],[0,20,13,19,158,273,266,259,159,261,278,271,462,463,464,465,466,467,468,469,470,471,472,473,29,31,32,33,280,288,289,290,284,291,292,293,450,415,440,429,454,431,420,445,458,447,436,425],[0,16,2,17,158,250,251,252,159,253,254,255,123,122,88,89,204,474,475,476,205,477,478,479],[0,16,2,17,158,250,251,252,159,253,254,255,123,122,88,89,204,474,475,476,205,477,478,479,23,24,13,25,256,257,258,259,260,261,262,263,480,481,482,483,484,485,486,487,488,489,490,491,26,20,27,28,264,265,266,267,268,269,270,271,492,493,494,495,496,497,498,499,500,501,502,503,4,22,5,19,272,273,274,275,276,277,278,279,125,124,140,141,504,505,506,507,508,509,510,511],[0,16,2,17,158,250,251,252,159,253,254,255,123,122,88,89,204,474,475,476,205,477,478,479,29,21,15,30,280,281,282,283,284,285,286,287,129,128,90,91,212,512,513,514,213,515,516,517],[0,16,2,17,158,250,251,252,159,253,254,255,129,128,90,91,212,512,513,514,213,515,516,517],[0,16,2,17,158,250,251,252,159,253,254,255,129,128,90,91,212,512,513,514,213,515,516,517,23,24,13,25,256,257,258,259,260,261,262,263,518,519,520,521,522,523,524,525,526,527,528,529,26,20,27,28,264,265,266,267,268,269,270,271,530,531,532,533,534,535,536,537,538,539,540,541,4,22,5,19,272,273,274,275,276,277,278,279,127,126,92,93,542,543,544,545,546,547,548,549],[0,20,13,19,158,273,266,259,159,261,278,271,550,551,552,553,554,555,556,557,558,559,560,561,29,31,32,33,280,288,289,290,284,291,292,293,562,563,564,565,566,567,568,569,570,571,572,573],[0,16,2,17,158,250,251,252,159,253,254,255,100,101,75,74,370,371,188,372,373,374,375,189,1,52,6,34,168,294,295,296,169,297,298,299,122,123,89,88,475,476,204,474,479,478,477,205],[0,16,2,17,158,250,251,252,159,253,254,255,100,101,75,74,370,371,188,372,373,374,375,189,53,54,9,42,300,301,302,303,304,305,306,307,128,129,91,90,513,514,212,512,517,516,515,213],[0,16,2,17,158,250,251,252,159,253,254,255,116,117,83,82,376,377,224,378,379,380,381,225,1,52,6,34,168,294,295,296,169,297,298,299,128,129,91,90,513,514,212,512,517,516,515,213],[0,16,2,17,158,250,251,252,159,253,254,255,116,117,83,82,376,377,224,378,379,380,381,225,53,54,9,42,300,301,302,303,304,305,306,307,122,123,89,88,475,476,204,474,479,478,477,205],[0,16,2,17,158,250,251,252,159,253,254,255,100,101,75,74,370,371,188,372,373,374,375,189,1,52,6,34,168,294,295,296,169,297,298,299,122,123,89,88,475,476,204,474,479,478,477,205,23,24,13,25,256,257,258,259,260,261,262,263,382,383,384,385,386,387,388,389,390,391,392,393,64,62,14,39,308,309,310,311,312,313,314,315,481,480,483,482,486,487,484,485,491,490,489,488,26,20,27,28,264,265,266,267,268,269,270,271,394,395,396,397,398,399,400,401,402,403,404,405,65,59,40,38,316,317,318,319,320,321,322,323,493,492,495,494,498,499,496,497,503,502,501,500,4,22,5,19,272,273,274,275,276,277,278,279,138,139,95,94,406,407,408,409,410,411,412,413,11,55,8,41,324,325,326,327,328,329,330,331,124,125,141,140,506,507,504,505,511,510,509,508],[0,16,2,17,158,250,251,252,159,253,254,255,116,117,83,82,376,377,224,378,379,380,381,225,1,52,6,34,168,294,295,296,169,297,298,299,128,129,91,90,513,514,212,512,517,516,515,213,23,24,13,25,256,257,258,259,260,261,262,263,574,575,576,577,578,579,580,581,582,583,584,585,64,62,14,39,308,309,310,311,312,313,314,315,519,518,521,520,524,525,522,523,529,528,527,526,26,20,27,28,264,265,266,267,268,269,270,271,586,587,588,589,590,591,592,593,594,595,596,597,65,59,40,38,316,317,318,319,320,321,322,323,531,530,533,532,536,537,534,535,541,540,539,538,4,22,5,19,272,273,274,275,276,277,278,279,109,108,79,78,598,599,600,601,602,603,604,605,11,55,8,41,324,325,326,327,328,329,330,331,126,127,93,92,544,545,542,543,549,548,547,546],[0,24,5,28,158,265,258,275,159,277,270,263,414,415,416,417,418,419,420,421,422,423,424,425,66,69,50,49,332,349,342,359,336,361,354,347,493,123,483,140,498,507,204,485,503,490,509,205,23,16,27,19,256,273,251,267,260,269,278,255,426,427,428,429,430,431,432,433,434,435,436,437,68,67,48,51,340,357,334,351,344,353,362,339,124,480,89,494,506,499,484,474,511,478,501,488,26,22,13,17,264,250,274,259,268,261,254,279,438,439,440,441,442,443,444,445,446,447,448,449,70,73,46,45,348,333,358,343,352,345,338,363,122,492,141,482,475,487,496,505,479,510,489,500,4,20,2,25,272,257,266,252,276,253,262,271,450,451,452,453,454,455,456,457,458,459,460,461,72,71,44,47,356,341,350,335,360,337,346,355,481,125,495,88,486,476,504,497,491,502,477,508],[0,24,5,28,158,265,258,275,159,277,270,263,414,415,416,417,418,419,420,421,422,423,424,425,606,607,608,609,610,611,612,613,614,615,616,617,531,129,521,92,536,545,212,523,541,528,547,213,23,16,27,19,256,273,251,267,260,269,278,255,426,427,428,429,430,431,432,433,434,435,436,437,618,619,620,621,622,623,624,625,626,627,628,629,126,518,91,532,544,537,522,512,549,516,539,526,26,22,13,17,264,250,274,259,268,261,254,279,438,439,440,441,442,443,444,445,446,447,448,449,630,631,632,633,634,635,636,637,638,639,640,641,128,530,93,520,513,525,534,543,517,548,527,538,4,20,2,25,272,257,266,252,276,253,262,271,450,451,452,453,454,455,456,457,458,459,460,461,642,643,644,645,646,647,648,649,650,651,652,653,519,127,533,90,524,514,542,535,529,540,515,546],[0,16,2,17,158,250,251,252,159,253,254,255,100,101,75,74,370,371,188,372,373,374,375,189,1,52,6,34,168,294,295,296,169,297,298,299,122,123,89,88,475,476,204,474,479,478,477,205,29,21,15,30,280,281,282,283,284,285,286,287,116,117,83,82,376,377,224,378,379,380,381,225,53,54,9,42,300,301,302,303,304,305,306,307,128,129,91,90,513,514,212,512,517,516,515,213],[0,20,13,19,158,273,266,259,159,261,278,271,462,463,464,465,466,467,468,469,470,471,472,473,1,59,14,41,168,325,318,311,169,313,330,323,551,550,553,552,556,557,554,555,561,560,559,558,29,31,32,33,280,288,289,290,284,291,292,293,450,415,440,429,454,431,420,445,458,447,436,425,53,63,36,35,300,364,365,366,304,367,368,369,563,562,565,564,568,569,566,567,573,572,571,570],[0,16],[0,18],[0,16,26,20],[0,2,23,13],[0,3,4,32],[0,2,29,15],[0,3,29,27],[0,52],[0,63],[0,52,26,59],[0,63,26,54],[0,52,16,1],[0,18,1,61],[0,52,16,1,26,59,20,65],[0,31,1,63],[0,1,24,62],[0,15,1,9],[0,5,1,8],[0,31,1,63,26,21,65,54],[0,2,57,56],[0,60,3,16],[0,22,57,3],[0,2,28,20],[0,17,13,24],[0,20,19,13,4,24,17,27],[0,22,57,3,4,16,60,32],[0,22,57,3,23,20,30,12,26,24,33,15,4,16,60,32],[0,22,57,3,29,18,27,25],[0,22,3,57,1,55,10,37],[0,22,385,396,3,57,109,117],[0,22,57,3,159,279,654,655,158,274,656,657,29,18,25,27,284,658,262,269,280,659,257,267]],fo={"P 1":0,"P -1":1,"P 1 2 1":2,"P 1 21 1":3,"C 1 2 1":4,"P 1 m 1":5,"P 1 c 1":6,"C 1 m 1":7,"C 1 c 1":8,"P 1 2/m 1":9,"P 1 21/m 1":10,"C 1 2/m 1":11,"P 1 2/c 1":12,"P 1 21/c 1":13,"C 1 2/c 1":14,"P 2 2 2":15,"P 2 2 21":16,"P 21 21 2":17,"P 21 21 21":18,"C 2 2 21":19,"C 2 2 2":20,"F 2 2 2":21,"I 2 2 2":22,"I 21 21 21":23,"P m m 2":24,"P m c 21":25,"P c c 2":26,"P m a 2":27,"P c a 21":28,"P n c 2":29,"P m n 21":30,"P b a 2":31,"P n a 21":32,"P n n 2":33,"C m m 2":34,"C m c 21":35,"C c c 2":36,"A m m 2":37,"A b m 2":38,"A m a 2":39,"A b a 2":40,"F m m 2":41,"F d d 2":42,"I m m 2":43,"I b a 2":44,"I m a 2":45,"P 2/m 2/m 2/m":46,"P m m m":46,"P 2/n 2/n 2/n":47,"P n n n":47,"P 2/c 2/c 2/m":48,"P c c m":48,"P 2/b 2/a 2/n":49,"P b a n":49,"P 21/m 2/m 2/a":50,"P m m a":50,"P 2/n 21/n 2/a":51,"P n n a":51,"P 2/m 2/n 21/a":52,"P m n a":52,"P 21/c 2/c 2/a":53,"P c c a":53,"P 21/b 21/a 2/m":54,"P b a m":54,"P 21/c 21/c 2/n":55,"P c c n":55,"P 2/b 21/c 21/m":56,"P b c m":56,"P 21/n 21/n 2/m":57,"P n n m":57,"P 21/m 21/m 2/n":58,"P m m n":58,"P 21/b 2/c 21/n":59,"P b c n":59,"P 21/b 21/c 21/a":60,"P b c a":60,"P 21/n 21/m 21/a":61,"P n m a":61,"C 2/m 2/c 21/m":62,"C m c m":62,"C 2/m 2/c 21/a":63,"C m c a":63,"C 2/m 2/m 2/m":64,"C m m m":64,"C 2/c 2/c 2/m":65,"C c c m":65,"C 2/m 2/m 2/a":66,"C m m a":66,"C 2/c 2/c 2/a":67,"C c c a":67,"F 2/m 2/m 2/m":68,"F m m m":68,"F 2/d 2/d 2/d":69,"F d d d":69,"I 2/m 2/m 2/m":70,"I m m m":70,"I 2/b 2/a 2/m":71,"I b a m":71,"I 21/b 21/c 21/a":72,"I b c a":72,"I 21/m 21/m 21/a":73,"I m m a":73,"P 4":74,"P 41":75,"P 42":76,"P 43":77,"I 4":78,"I 41":79,"P -4":80,"I -4":81,"P 4/m":82,"P 42/m":83,"P 4/n":84,"P 42/n":85,"I 4/m":86,"I 41/a":87,"P 4 2 2":88,"P 4 21 2":89,"P 41 2 2":90,"P 41 21 2":91,"P 42 2 2":92,"P 42 21 2":93,"P 43 2 2":94,"P 43 21 2":95,"I 4 2 2":96,"I 41 2 2":97,"P 4 m m":98,"P 4 b m":99,"P 42 c m":100,"P 42 n m":101,"P 4 c c":102,"P 4 n c":103,"P 42 m c":104,"P 42 b c":105,"I 4 m m":106,"I 4 c m":107,"I 41 m d":108,"I 41 c d":109,"P -4 2 m":110,"P -4 2 c":111,"P -4 21 m":112,"P -4 21 c":113,"P -4 m 2":114,"P -4 c 2":115,"P -4 b 2":116,"P -4 n 2":117,"I -4 m 2":118,"I -4 c 2":119,"I -4 2 m":120,"I -4 2 d":121,"P 4/m 2/m 2/m":122,"P4/m m m":122,"P 4/m 2/c 2/c":123,"P4/m c c":123,"P 4/n 2/b 2/m":124,"P4/n b m":124,"P 4/n 2/n 2/c":125,"P4/n n c":125,"P 4/m 21/b 2/m":126,"P4/m b m":126,"P 4/m 21/n 2/c":127,"P4/m n c":127,"P 4/n 21/m 2/m":128,"P4/n m m":128,"P 4/n 2/c 2/c":129,"P4/n c c":129,"P 42/m 2/m 2/c":130,"P42/m m c":130,"P 42/m 2/c 2/m":131,"P42/m c m":131,"P 42/n 2/b 2/c":132,"P42/n b c":132,"P 42/n 2/n 2/m":133,"P42/n n m":133,"P 42/m 21/b 2/c":134,"P42/m b c":134,"P 42/m 21/n 2/m":135,"P42/m n m":135,"P 42/n 21/m 2/c":136,"P42/n m c":136,"P 42/n 21/c 2/m":137,"P42/n c m":137,"I 4/m 2/m 2/m":138,"I4/m m m":138,"I 4/m 2/c 2/m":139,"I4/m c m":139,"I 41/a 2/m 2/d":140,"I41/a m d":140,"I 41/a 2/c 2/d":141,"I41/a c d":141,"P 3":142,"P 31":143,"P 32":144,"H 3":145,"R 3":146,"P -3":147,"H -3":148,"R -3":149,"P 3 1 2":150,"P 3 2 1":151,"P 31 1 2":152,"P 31 2 1":153,"P 32 1 2":154,"P 32 2 1":155,"H 3 2":156,"R 3 2":157,"P 3 m 1":158,"P 3 1 m":159,"P 3 c 1":160,"P 3 1 c":161,"H 3 m":162,"R 3 m":163,"H 3 c":164,"R 3 c":165,"P -3 1 2/m":166,"P -3 1 m":166,"P -3 1 2/c":167,"P -3 1 c":167,"P -3 2/m 1":168,"P -3 m 1":168,"P -3 2/c 1":169,"P -3 c 1":169,"H -3 2/m":170,"H -3 m":170,"R -3 2/m":171,"R -3 m":171,"H -3 2/c":172,"H -3 c":172,"R -3 2/c":173,"R -3 c":173,"P 6":174,"P 61":175,"P 65":176,"P 62":177,"P 64":178,"P 63":179,"P -6":180,"P 6/m":181,"P 63/m":182,"P 6 2 2":183,"P 61 2 2":184,"P 65 2 2":185,"P 62 2 2":186,"P 64 2 2":187,"P 63 2 2":188,"P 6 m m":189,"P 6 c c":190,"P 63 c m":191,"P 63 m c":192,"P -6 m 2":193,"P -6 c 2":194,"P -6 2 m":195,"P -6 2 c":196,"P 6/m 2/m 2/m":197,"P 6/m m m":197,"P 6/m 2/c 2/c":198,"P 6/m c c":198,"P 63/m 2/c 2/m":199,"P 63/m c m":199,"P 63/m 2/m 2/c":200,"P 63/m m c":200,"P 2 3":201,"F 2 3":202,"I 2 3":203,"P 21 3":204,"I 21 3":205,"P 2/m -3":206,"P m -3":206,"P 2/n -3":207,"P n -3":207,"F 2/m -3":208,"F m -3":208,"F 2/d -3":209,"F d -3":209,"I 2/m -3":210,"I m -3":210,"P 21/a -3":211,"P a -3":211,"I 21/a -3":212,"I a -3":212,"P 4 3 2":213,"P 42 3 2":214,"F 4 3 2":215,"F 41 3 2":216,"I 4 3 2":217,"P 43 3 2":218,"P 41 3 2":219,"I 41 3 2":220,"P -4 3 m":221,"F -4 3 m":222,"I -4 3 m":223,"P -4 3 n":224,"F -4 3 c":225,"I -4 3 d":226,"P 4/m -3 2/m":227,"P m -3 m":227,"P 4/n -3 2/n":228,"P n -3 n":228,"P 42/m -3 2/n":229,"P m -3 n":229,"P 42/n -3 2/m":230,"P n -3 m":230,"F 4/m -3 2/m":231,"F m -3 m":231,"F 4/m -3 2/c":232,"F m -3 c":232,"F 41/d -3 2/m":233,"F d -3 m":233,"F 41/d -3 2/c":234,"F d -3 c":234,"I 4/m -3 2/m":235,"I m -3 m":235,"I 41/a -3 2/d":236,"I a -3 d":236,"P 1 1 2":237,"P 1 1 21":238,"B 1 1 2":239,"B 2":239,"A 1 2 1":240,"C 1 21 1":241,"I 1 2 1":242,"I 2":242,"I 1 21 1":243,"P 1 1 m":244,"P 1 1 b":245,"B 1 1 m":246,"B 1 1 b":247,"P 1 1 2/m":248,"P 1 1 21/m":249,"B 1 1 2/m":250,"P 1 1 2/b":251,"P 1 1 21/b":252,"P 1 21/n 1":253,"P 1 21/a 1":254,"B 1 1 2/b":255,"P 21 2 2":256,"P 2 21 2":257,"P 21 21 2 (a)":258,"P 21 2 21":259,"P 2 21 21":260,"C 2 2 21a)":261,"C 2 2 2a":262,"F 2 2 2a":263,"I 2 2 2a":264,"P 21/m 21/m 2/n a":265,"P 42 21 2a":266,"I 2 3a":267};function lh(e){switch(e){case 1146:return 146;case 1148:return 149;case 1155:return 157;case 1160:return 163;case 1161:return 165;case 1166:return 171;case 1167:return 173;case 1003:return 237;case 1004:return 238;case 1005:return 239;case 2005:return 240;case 3005:return 241;case 4005:return 242;case 5005:return 243;case 1006:return 244;case 1007:return 245;case 1008:return 246;case 1009:return 247;case 1010:return 248;case 1011:return 249;case 1012:return 250;case 1013:return 251;case 1014:return 252;case 2014:return 253;case 3014:return 254;case 1015:return 255;case 1017:return 256;case 2017:return 257;case 1018:return 258;case 2018:return 259;case 3018:return 260;case 1020:return 261;case 1021:return 262;case 1022:return 263;case 1023:return 264;case 1059:return 265;case 1094:return 266;case 1197:return 267}let t=0;return e>146&&++t,e>148&&++t,e>155&&++t,e>160&&++t,e>161&&++t,e>166&&++t,e>167&&++t,e-1+t}function fh(e){if(e<146)return e+1;if(e===146)return 1146;if(e<149)return e+1-1;if(e===149)return 1148;if(e<157)return e+1-2;if(e===157)return 1155;if(e<163)return e+1-3;if(e===163)return 1160;if(e<165)return e+1-4;if(e===165)return 1161;if(e<171)return e+1-5;if(e===171)return 1166;if(e<173)return e+1-6;if(e===173)return 1167;if(e<237)return e+1-7;if(e===237)return 1003;if(e===238)return 1004;if(e===239)return 1005;if(e===240)return 2005;if(e===241)return 3005;if(e===242)return 4005;if(e===243)return 5005;if(e===244)return 1006;if(e===245)return 1007;if(e===246)return 1008;if(e===247)return 1009;if(e===248)return 1010;if(e===249)return 1011;if(e===250)return 1012;if(e===251)return 1013;if(e===252)return 1014;if(e===253)return 2014;if(e===254)return 3014;if(e===255)return 1015;if(e===256)return 1017;if(e===257)return 2017;if(e===258)return 1018;if(e===259)return 2018;if(e===260)return 3018;if(e===261)return 1020;if(e===262)return 1021;if(e===263)return 1022;if(e===264)return 1023;if(e===265)return 1059;if(e===266)return 1094;if(e===267)return 1197;throw new Error(`unknown spacegroup index '${e}'`)}var rc=function(){let e=Object.create(null);for(let t of Object.keys(fo))e[fo[t]]=t;return e}(),Vf=function(){let e=Object.create(null);for(let t of Object.keys(fo)){let n=fo[t];e[n]=fh(n)}return e}();function Kf(e){let t=typeof e=="number"?lh(e):fo[e];return typeof t>"u"||typeof rc[t]>"u"?-1:t}var hr;(function(e){e.Zero=n("P 1",N.create(1,1,1),N.create(Math.PI/2,Math.PI/2,Math.PI/2));function t(r){return r?r.index===0&&r.size[0]===1&&r.size[1]===1&&r.size[1]===1:!0}e.isZero=t;function n(r,i,o){let s=Kf(r);if(s<0)return console.warn(`Unknown spacegroup '${r}', returning a 'P 1' with cellsize [1, 1, 1]`),e.Zero;let a=i[0]*i[1]*i[2],c=o[0],u=o[1],l=o[2],m=i[0],f=i[1],d=i[2],p=Math.cos(u),h=(Math.cos(c)-Math.cos(u)*Math.cos(l))/Math.sin(l),x=Math.sqrt(1-p*p-h*h),y=[m,0,0],g=[Math.cos(l)*f,Math.sin(l)*f,0],C=[p*d,h*d,x*d],_=ke.ofRows([[y[0],g[0],C[0],0],[0,g[1],C[1],0],[0,0,C[2],0],[0,0,0,1]]),b=ke.invert(ke.zero(),_);return{index:s,size:i,volume:a,anglesInRadians:o,toFractional:b,fromFractional:_}}e.create=n})(hr||(hr={}));var sn;(function(e){e.ZeroP1=t(hr.Zero);function t(x){let y=zf[x.index].map(_=>m(Hf[_])),g=rc[x.index],C=Vf[x.index];return{name:g,num:C,cell:x,operators:y}}e.create=t;let n=N(),r=ke();function i(x,y,g,C,_,b){return N.set(n,g,C,_),ke.fromTranslation(r,n),ke.mul(b,ke.mul(b,ke.mul(b,x.cell.fromFractional,r),x.operators[y]),x.cell.toFractional)}e.setOperatorMatrix=i;function o(x,y,g,C,_){let b=i(x,y,g,C,_,ke.zero());return xt.create(`${y+1}_${5+g}${5+C}${5+_}`,b,{hkl:N.create(g,C,_),spgrOp:y})}e.getSymmetryOperator=o;let s=N(),a=N(),c=N(),u=N();function l(x,y,g,C,_,b){let I=ke.zero();N.set(n,g,C,_),N.floor(s,b),ke.copy(I,x.operators[y]),N.floor(a,N.transformMat4(a,b,I)),ke.getTranslation(u,I),N.sub(u,u,a),N.add(u,u,s),N.add(u,u,n),ke.setTranslation(I,u),ke.mul(I,x.cell.fromFractional,I),ke.mul(I,I,x.cell.toFractional),N.sub(c,a,s);let E=g-c[0],S=C-c[1],v=_-c[2];return xt.create(`${y+1}_${5+E}${5+S}${5+v}`,I,{hkl:N.create(E,S,v),spgrOp:y})}e.getSymmetryOperatorRef=l;function m(x){let y=ds[x[0]],g=ds[x[1]],C=ds[x[2]];return ke.ofRows([y,g,C,[0,0,0,1]])}function f(x){return[h(d(x[0],x[4],x[8]),p(x[12])),h(d(x[1],x[5],x[9]),p(x[13])),h(d(x[2],x[6],x[10]),p(x[14]))].join(",")}e.getOperatorXyz=f;function d(x,y,g){let C=[];if(x>0?C.push("+X"):x<0&&C.push("-X"),y>0?C.push("+Y"):y<0&&C.push("-Y"),g>0?C.push("+Z"):g<0&&C.push("-Z"),C.length===1)return C[0].charAt(0)==="+"?C[0].substr(1):C[0];if(C.length===2){let _=C[0].charAt(0),b=C[1].charAt(0);if(_==="+")return`${C[0].substr(1)}${C[1]}`;if(b==="+")return`${C[1].substr(1)}${C[0]}`}throw new Error(`unknown rotation '${C}', ${x} ${y} ${g}`)}function p(x){switch(x){case 1/2:return"1/2";case 1/4:return"1/4";case 3/4:return"3/4";case 1/3:return"1/3";case 2/3:return"2/3";case 1/6:return"1/6";case 5/6:return"5/6"}return""}function h(x,y){return y===""?x:x.length>2?`${x}+${y}`:x.charAt(0)==="-"?`${y}${x}`:`${y}+${x}`}})(sn||(sn={}));var dn;(function(e){function t(o,s,a){o.squaredDistances[o.count]=a,o.indices[o.count++]=s}e.add=t;function n(o){o.count=0}e.reset=n;function r(){return{count:0,indices:[],squaredDistances:[]}}e.create=r;function i(o,s){for(let a=0;a<s.count;++a)o.indices[a]=s.indices[a],o.squaredDistances[a]=s.squaredDistances[a];return o.count=s.count,o}e.copy=i})(dn||(dn={}));function bn(){return bn.empty()}(function(e){function t(f,d,p,h){return{origin:f,dirA:d,dirB:p,dirC:h}}e.create=t;function n(){return{origin:N(),dirA:N(),dirB:N(),dirC:N()}}e.empty=n;function r(f,d){return N.copy(f.origin,d.origin),N.copy(f.dirA,d.dirA),N.copy(f.dirB,d.dirB),N.copy(f.dirC,d.dirC),f}e.copy=r;function i(f){return r(n(),f)}e.clone=i;function o(f,d){return N.set(f,N.magnitude(d.dirA)*2,N.magnitude(d.dirB)*2,N.magnitude(d.dirC)*2)}e.size=o;let s=N();function a(f){return o(s,f),s[0]*s[1]*s[2]}e.volume=a;function c(f,d){return N.copy(f.origin,d.origin),N.normalize(f.dirA,d.dirA),N.normalize(f.dirB,d.dirB),N.normalize(f.dirC,d.dirC),f}e.normalize=c;let u=Xt();function l(f,d,p){N.transformMat4(f.origin,d.origin,p);let h=Xt.directionTransform(u,p);return N.transformMat3(f.dirA,d.dirA,h),N.transformMat3(f.dirB,d.dirB,h),N.transformMat3(f.dirC,d.dirC,h),f}e.transform=l;function m(f,d,p){return N.scale(f.dirA,d.dirA,p),N.scale(f.dirB,d.dirB,p),N.scale(f.dirC,d.dirC,p),f}e.scale=m})(bn||(bn={}));var Gt;(function(e){function t(f,d,p=Float32Array){let h=f*d;return{data:new p(h),size:h,cols:f,rows:d}}e.create=t;function n(f,d,p){return f.data[f.rows*p+d]}e.get=n;function r(f,d,p,h){return f.data[f.rows*p+d]=h,f}e.set=r;function i(f,d,p,h){return f.data[f.rows*p+d]+=h,f}e.add=i;function o(f){return f.data.fill(0),f}e.makeZero=o;function s(f){return{data:f.data.slice(),size:f.size,cols:f.cols,rows:f.rows}}e.clone=s;function a(f,d,p){return{data:f,size:d*p,cols:d,rows:p}}e.fromArray=a;function c(f,d){if(f.cols!==d.rows||f.rows!==d.cols)throw new Error("transpose: matrix dimensions incompatible");if(f.data===d.data)throw new Error("transpose: matrices share memory");let p=d.rows,h=d.cols,x=d.data,y=f.data;for(let g=0,C=0,_=0;g<p;_+=1,C+=h,++g){let b=_;for(let I=0;I<h;b+=p,I++)y[b]=x[C+I]}return f}e.transpose=c;function u(f,d,p){let h=d.cols,x=d.rows,y=p.rows,g=d.data,C=p.data,_=f.data;for(let b=0,I=0,E=0;b<x;I+=h,b++)for(let S=0,v=0;v<y;E++,v++){let P=0,L=I;for(let w=0;w<h;L++,S++,w++)P+=g[L]*C[S];_[E]=P}return f}e.multiplyABt=u;function l(f){let d=f.rows,p=f.cols,h=f.data,x=new Array(p);for(let y=0;y<p;++y)x[y]=0;for(let y=0,g=0;y<d;++y)for(let C=0;C<p;++C,++g)x[C]+=h[g];for(let y=0;y<p;++y)x[y]/=d;return x}e.meanRows=l;function m(f,d){let p=f.rows,h=f.cols,x=f.data;for(let y=0,g=0;y<p;++y)for(let C=0;C<h;++C,++g)x[g]-=d[C];return f}e.subRows=m})(Gt||(Gt={}));function ic(e,t,n,r){r=e[t],e[t]=e[n],e[n]=r}function dh(e,t){return e=Math.abs(e),t=Math.abs(t),e>t?(t/=e,e*Math.sqrt(1+t*t)):t>0?(e/=t,t*Math.sqrt(1+e*e)):0}var mh=1192092896e-16,ph=1e-37;function hh(e,t,n,r,i,o,s,a){let c=mh*2,u=ph,l=0,m=0,f=0,d=0,p=Math.max(o,30),h=0,x=0,y=0,g=0,C=0,_=0,b=0,I=0,E=0,S=0,v=0,P=0,L=0,w=0,D=0,z=0,ie=0,O=4660,Q=0,K=0,Z=0,se=new Float64Array(s<<3);for(;l<s;l++){for(f=0,v=0;f<o;f++)I=e[l*t+f],v+=I*I;if(se[l]=v,r){for(f=0;f<s;f++)r[l*i+f]=0;r[l*i+l]=1}}for(;d<p;d++){for(C=0,l=0;l<s-1;l++)for(m=l+1;m<s;m++){for(h=l*t|0,x=m*t|0,D=se[l],z=0,ie=se[m],f=2,z+=e[h]*e[x],z+=e[h+1]*e[x+1];f<o;f++)z+=e[h+f]*e[x+f];if(!(Math.abs(z)<=c*Math.sqrt(D*ie))){for(z*=2,P=D-ie,L=dh(z,P),P<0?(w=(L-P)*.5,b=Math.sqrt(w/L),_=z/(L*b*2)):(_=Math.sqrt((L+P)/(L*2)),b=z/(L*_*2)),D=0,ie=0,f=2,E=_*e[h]+b*e[x],S=-b*e[h]+_*e[x],e[h]=E,e[x]=S,D+=E*E,ie+=S*S,E=_*e[h+1]+b*e[x+1],S=-b*e[h+1]+_*e[x+1],e[h+1]=E,e[x+1]=S,D+=E*E,ie+=S*S;f<o;f++)E=_*e[h+f]+b*e[x+f],S=-b*e[h+f]+_*e[x+f],e[h+f]=E,e[x+f]=S,D+=E*E,ie+=S*S;if(se[l]=D,se[m]=ie,C=1,r)for(y=l*i|0,g=m*i|0,f=2,E=_*r[y]+b*r[g],S=-b*r[y]+_*r[g],r[y]=E,r[g]=S,E=_*r[y+1]+b*r[g+1],S=-b*r[y+1]+_*r[g+1],r[y+1]=E,r[g+1]=S;f<s;f++)E=_*r[y+f]+b*r[g+f],S=-b*r[y+f]+_*r[g+f],r[y+f]=E,r[g+f]=S}}if(C===0)break}for(l=0;l<s;l++){for(f=0,v=0;f<o;f++)I=e[l*t+f],v+=I*I;se[l]=Math.sqrt(v)}for(l=0;l<s-1;l++){for(m=l,f=l+1;f<s;f++)se[m]<se[f]&&(m=f);if(l!==m&&(ic(se,l,m,v),r)){for(f=0;f<o;f++)ic(e,l*t+f,m*t+f,I);for(f=0;f<s;f++)ic(r,l*i+f,m*i+f,I)}}for(l=0;l<s;l++)n[l]=se[l];if(r)for(l=0;l<a;l++){for(v=l<s?se[l]:0;v<=u;){for(K=1/o,f=0;f<o;f++)O=O*214013+2531011,Q=O>>16&32767&256?K:-K,e[l*t+f]=Q;for(d=0;d<2;d++)for(m=0;m<l;m++){for(v=0,f=0;f<o;f++)v+=e[l*t+f]*e[m*t+f];for(Z=0,f=0;f<o;f++)I=e[l*t+f]-v*e[m*t+f],e[l*t+f]=I,Z+=Math.abs(I);for(Z=Z?1/Z:0,f=0;f<o;f++)e[l*t+f]*=Z}for(v=0,f=0;f<o;f++)I=e[l*t+f],v+=I*I;v=Math.sqrt(v)}for(b=1/v,f=0;f<o;f++)e[l*t+f]*=b}}function jf(e,t,n,r){let i=0,o=0,s=e.rows,a=e.cols,c=s,u=a;c<u&&(i=1,o=c,c=u,u=o);let l=Gt.create(c,c),m=Gt.create(1,u),f=Gt.create(u,u);if(i===0)Gt.transpose(l,e);else{for(o=0;o<a*s;o++)l.data[o]=e.data[o];for(;o<u*c;o++)l.data[o]=0}if(hh(l.data,c,m.data,f.data,u,c,u,c),t){for(o=0;o<u;o++)t.data[o]=m.data[o];for(;o<a;o++)t.data[o]=0}i===0?(n&&Gt.transpose(n,l),r&&Gt.transpose(r,f)):(n&&Gt.transpose(n,f),r&&Gt.transpose(r,l))}var mn;(function(e){function t(s){let a=n(s),c=o(s,a);return{momentsAxes:a,boxAxes:c}}e.ofPositions=t;function n(s){if(s.length===3)return bn.create(N.fromArray(N(),s,0),N.create(1,0,0),N.create(0,1,0),N.create(0,0,1));let a=Gt.fromArray(s,3,s.length/3),c=a.rows,u=c/3,l=Gt.create(3,3),m=Gt.create(1,3),f=Gt.create(3,3),d=Gt.create(3,3),p=Gt.meanRows(a),h=Gt.subRows(Gt.clone(a),p),x=Gt.transpose(Gt.create(c,3),h);Gt.multiplyABt(l,x,x),jf(l,m,f,d);let y=N.create(p[0],p[1],p[2]),g=N.create(f.data[0],f.data[3],f.data[6]),C=N.create(f.data[1],f.data[4],f.data[7]),_=N.create(f.data[2],f.data[5],f.data[8]);return N.scale(g,g,Math.sqrt(m.data[0]/u)),N.scale(C,C,Math.sqrt(m.data[1]/u)),N.scale(_,_,Math.sqrt(m.data[2]/u)),bn.create(y,g,C,_)}e.calculateMomentsAxes=n;function r(s){let a=bn.clone(s);return N.magnitude(a.dirC)<1e-6&&N.cross(a.dirC,a.dirA,a.dirB),bn.normalize(a,a)}e.calculateNormalizedAxes=r;let i=N();function o(s,a){if(s.length===3)return bn.clone(a);let c=-1/0,u=-1/0,l=-1/0,m=-1/0,f=-1/0,d=-1/0,p=N(),h=N(),x=a.origin,y=r(a);for(let P=0,L=s.length;P<L;P+=3){N.projectPointOnVector(p,N.fromArray(p,s,P),y.dirA,x);let w=N.dot(y.dirA,N.normalize(h,N.sub(h,p,x))),D=N.distance(p,x);w>0?D>c&&(c=D):D>u&&(u=D),N.projectPointOnVector(p,N.fromArray(p,s,P),y.dirB,x);let z=N.dot(y.dirB,N.normalize(h,N.sub(h,p,x))),ie=N.distance(p,x);z>0?ie>l&&(l=ie):ie>m&&(m=ie),N.projectPointOnVector(p,N.fromArray(p,s,P),y.dirC,x);let O=N.dot(y.dirC,N.normalize(h,N.sub(h,p,x))),Q=N.distance(p,x);O>0?Q>f&&(f=Q):Q>d&&(d=Q)}let g=N.setMagnitude(N(),y.dirA,(c+u)/2),C=N.setMagnitude(N(),y.dirB,(l+m)/2),_=N.setMagnitude(N(),y.dirC,(f+d)/2),b=N.isFinite(g),I=N.isFinite(C),E=N.isFinite(_),S=N(),v=function(P,L,w){N.copy(i,x),b&&N.scaleAndAdd(i,i,y.dirA,P),I&&N.scaleAndAdd(i,i,y.dirB,L),E&&N.scaleAndAdd(i,i,y.dirC,w),N.add(S,S,i)};return v(c,l,f),v(c,l,-d),v(c,-m,-d),v(c,-m,f),v(-u,-m,-d),v(-u,-m,f),v(-u,l,f),v(-u,l,-d),N.scale(S,S,1/8),bn.create(S,g,C,_)}e.calculateBoxAxes=o})(mn||(mn={}));function Kt(){return Kt.zero()}(function(e){function t(w){return w.extrema!==void 0}e.hasExtrema=t;function n(w,D){return{center:w,radius:D}}e.create=n;function r(){return{center:N(),radius:0}}e.zero=r;function i(w){let D=n(N.clone(w.center),w.radius);return t(w)&&(D.extrema=w.extrema.map(z=>N.clone(z))),D}e.clone=i;function o(w,D,z){return N.copy(w.center,D),w.radius=z,w}e.set=o;function s(w,D){return N.copy(w.center,D.center),w.radius=D.radius,t(D)&&a(w,D.extrema.map(z=>N.clone(z))),w}e.copy=s;function a(w,D){return w.extrema!==void 0?(w.extrema.length=0,w.extrema.push(...D)):w.extrema=D,w}e.setExtrema=a;function c(w){let{x:D,y:z,z:ie,indices:O}=w,Q=0,K=0,Z=0,se=0,fe=Ie.size(O);for(let Ce=0;Ce<fe;Ce++){let xe=Ie.getAt(O,Ce);Q+=D[xe],K+=z[xe],Z+=ie[xe]}fe>0&&(Q/=fe,K/=fe,Z/=fe);for(let Ce=0;Ce<fe;Ce++){let xe=Ie.getAt(O,Ce),H=D[xe]-Q,$=z[xe]-K,de=ie[xe]-Z,T=H*H+$*$+de*de;T>se&&(se=T)}return{center:N.create(Q,K,Z),radius:Math.sqrt(se)}}e.computeBounding=c;function u(w,D,z){return N.transformMat4(w.center,D.center,z),w.radius=D.radius*ke.getMaxScaleOnAxis(z),t(D)&&a(w,D.extrema.map(ie=>N.transformMat4(N(),ie,z))),w}e.transform=u;function l(w,D,z){return N.add(w.center,D.center,z),t(D)&&a(w,D.extrema.map(ie=>N.add(N(),ie,z))),w}e.translate=l;function m(w,D,z){return N.toArray(w.center,D,z),D[z+3]=w.radius,D}e.toArray=m;function f(w,D,z){return N.fromArray(w.center,D,z),w.radius=D[z+3],w}e.fromArray=f;function d(w,D){return N.scale(w.center,N.add(w.center,D.max,D.min),.5),w.radius=N.distance(w.center,D.max),e.setExtrema(w,[N.create(D.min[0],D.min[1],D.min[2]),N.create(D.max[0],D.max[1],D.max[2]),N.create(D.max[0],D.min[1],D.min[2]),N.create(D.min[0],D.max[1],D.max[2]),N.create(D.min[0],D.min[1],D.max[2]),N.create(D.max[0],D.min[1],D.max[2]),N.create(D.max[0],D.max[1],D.min[2]),N.create(D.min[0],D.max[1],D.min[2])]),w}e.fromBox3D=d;function p(w,D){return N.copy(w.center,D.origin),w.radius=Math.max(N.magnitude(D.dirA),N.magnitude(D.dirB),N.magnitude(D.dirC)),w}e.fromAxes3D=p;let h=N();function x(w,D,z){let[ie,O,Q]=D,K=N.create(0,0,0);N.transformMat4(K,K,z);let Z=N.create(ie,O,Q);N.transformMat4(Z,Z,z);let se=N.create(ie,0,0);N.transformMat4(se,se,z);let fe=N.create(0,O,Q);N.transformMat4(fe,fe,z);let Ce=N.create(0,0,Q);N.transformMat4(Ce,Ce,z);let xe=N.create(ie,0,Q);N.transformMat4(xe,xe,z);let H=N.create(ie,O,0);N.transformMat4(H,H,z);let $=N.create(0,O,0);N.transformMat4($,$,z),N.add(h,K,Z),N.scale(h,h,.5);let de=Math.max(N.distance(K,Z),N.distance(se,fe));return e.set(w,h,de/2),e.setExtrema(w,[K,Z,se,fe,Ce,xe,H,$]),w}e.fromDimensionsAndTransform=x;let y=N();function g(w,D,z){return N.distance(D.center,z)<D.radius?e.copy(w,D):(N.sub(y,D.center,z),N.sub(y,D.center,y),N.setMagnitude(y,y,D.radius),N.scale(w.center,N.add(y,y,z),.5),w.radius=N.distance(w.center,z),w)}e.addVec3=g;function C(w,D,z){return N.copy(w.center,D.center),w.radius=Math.max(D.radius,N.distance(D.center,z.center)+z.radius),t(D)&&t(z)&&a(w,[...D.extrema.map(ie=>N.clone(ie)),...z.extrema.map(ie=>N.clone(ie))]),w}e.expandBySphere=C;let _=N();function b(w,D,z){var ie,O;if(N.copy(w.center,D.center),w.radius=D.radius+z,D.radius<1e-12||((O=(ie=D.extrema)===null||ie===void 0?void 0:ie.length)!==null&&O!==void 0?O:0)<=1)return w.extrema=void 0,w;if(t(D)){let Q=new Float32Array(D.extrema.length*3);for(let Z=0;Z<D.extrema.length;Z++)N.toArray(D.extrema[Z],Q,Z*3);let K=mn.calculateMomentsAxes(Q);bn.scale(K,bn.normalize(K,K),z),a(w,D.extrema.map(Z=>{N.normalize(_,N.sub(_,Z,D.center));let se=N.clone(Z),fe=N.dot(_,K.dirA)<0?-1:1;N.scaleAndAdd(se,se,K.dirA,fe);let Ce=N.dot(_,K.dirB)<0?-1:1;N.scaleAndAdd(se,se,K.dirB,Ce);let xe=N.dot(_,K.dirC)<0?-1:1;return N.scaleAndAdd(se,se,K.dirC,xe),N.distance(w.center,se)>w.radius&&(D.extrema.length>=14&&N.normalize(_,N.sub(_,se,D.center)),N.scaleAndAdd(se,w.center,_,w.radius)),se}))}return w}e.expand=b;function I(w,D){return w.radius===D.radius&&N.exactEquals(w.center,D.center)}e.exactEquals=I;function E(w,D){let z=w.radius,ie=D.radius;return Math.abs(z-ie)<=1e-6*Math.max(1,Math.abs(z),Math.abs(ie))&&N.equals(w.center,D.center)}e.equals=E;function S(w,D){if(t(D)){for(let z of D.extrema)if(N.distance(w.center,z)>w.radius)return!1;return!0}else return N.distance(w.center,D.center)+D.radius<=w.radius}e.includes=S;function v(w,D){return N.distance(w.center,D.center)<=w.radius+D.radius}e.overlaps=v;function P(w,D){return N.distance(w.center,D.center)-w.radius+D.radius}e.distance=P;function L(w,D){let{center:z,radius:ie}=w;return N.distance(D,z)-ie}e.distanceToVec=L})(Kt||(Kt={}));function on(){return on.zero()}(function(e){function t(v,P){return{min:v,max:P}}e.create=t;function n(){return{min:N(),max:N()}}e.zero=n;function r(v,P){return N.copy(v.min,P.min),N.copy(v.max,P.max),v}e.copy=r;function i(v){return r(n(),v)}e.clone=i;let o=N();function s(v,P){return Kt.hasExtrema(P)&&P.extrema.length>=14?c(v,P.extrema):(N.set(o,P.radius,P.radius,P.radius),N.sub(v.min,P.center,o),N.add(v.max,P.center,o),v)}e.fromSphere3D=s;function a(v,P){for(let L=0,w=P.length;L<w;L++)x(v,P[L]);return v}e.addVec3Array=a;function c(v,P){return h(v),a(v,P),v}e.fromVec3Array=c;function u(v,P){return Kt.hasExtrema(P)&&P.extrema.length>=14?a(v,P.extrema):(x(v,N.subScalar(o,P.center,P.radius)),x(v,N.addScalar(o,P.center,P.radius)),v)}e.addSphere3D=u;function l(v,P){return N.clamp(o,P.center,v.min,v.max),N.squaredDistance(o,P.center)<=P.radius*P.radius}e.intersectsSphere3D=l;function m(v){let P=N.create(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),L=N.create(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE),{x:w,y:D,z,indices:ie}=v;for(let O=0,Q=Ie.size(ie);O<Q;O++){let K=Ie.getAt(ie,O);P[0]=Math.min(w[K],P[0]),P[1]=Math.min(D[K],P[1]),P[2]=Math.min(z[K],P[2]),L[0]=Math.max(w[K],L[0]),L[1]=Math.max(D[K],L[1]),L[2]=Math.max(z[K],L[2])}return{min:P,max:L}}e.computeBounding=m;function f(v,P){return N.sub(v,P.max,P.min)}e.size=f;let d=N();function p(v){return f(d,v),d[0]*d[1]*d[2]}e.volume=p;function h(v){return N.set(v.min,Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),N.set(v.max,-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE),v}e.setEmpty=h;function x(v,P){return N.min(v.min,v.min,P),N.max(v.max,v.max,P),v}e.add=x;function y(v,P,L){return N.sub(v.min,P.min,L),N.add(v.max,P.max,L),v}e.expand=y;function g(v,P,L){return N.scale(v.min,P.min,L),N.scale(v.max,P.max,L),v}e.scale=g;let C=N();function _(v,P,L){let[w,D,z]=P.min,[ie,O,Q]=P.max;return h(v),x(v,N.transformMat4(C,N.set(C,w,D,z),L)),x(v,N.transformMat4(C,N.set(C,w,D,Q),L)),x(v,N.transformMat4(C,N.set(C,w,O,z),L)),x(v,N.transformMat4(C,N.set(C,w,O,Q),L)),x(v,N.transformMat4(C,N.set(C,ie,D,z),L)),x(v,N.transformMat4(C,N.set(C,ie,D,Q),L)),x(v,N.transformMat4(C,N.set(C,ie,O,z),L)),x(v,N.transformMat4(C,N.set(C,ie,O,Q),L)),v}e.transform=_;function b(v,P){return!(P[0]<v.min[0]||P[0]>v.max[0]||P[1]<v.min[1]||P[1]>v.max[1]||P[2]<v.min[2]||P[2]>v.max[2])}e.containsVec3=b;function I(v,P){return!(v.max[0]<P.min[0]||v.min[0]>P.max[0]||v.max[1]<P.min[1]||v.min[1]>P.max[1]||v.max[2]<P.min[2]||v.min[2]>P.max[2])}e.overlaps=I;function E(v,P){let L=P.center,w=P.radius;return!(L[0]-w<v.min[0]||L[0]+w>v.max[0]||L[1]-w<v.min[1]||L[1]+w>v.max[1]||L[2]-w<v.min[2]||L[2]+w>v.max[2])}e.containsSphere3D=E;function S(v,P,L,w){let[D,z,ie]=P.min,[O,Q,K]=P.max,[Z,se,fe]=L,Ce=1/w[0],xe=1/w[1],H=1/w[2],$,de,T,B,k,R;return Ce>=0?($=(D-Z)*Ce,de=(O-Z)*Ce):($=(O-Z)*Ce,de=(D-Z)*Ce),xe>=0?(T=(z-se)*xe,B=(Q-se)*xe):(T=(Q-se)*xe,B=(z-se)*xe),H>=0?(k=(ie-fe)*H,R=(K-fe)*H):(k=(K-fe)*H,R=(ie-fe)*H),T>$&&($=T),B<de&&(de=B),k>$&&($=k),R<de&&(de=R),N.scale(v,w,$),N.set(v,v[0]+Z,v[1]+se,v[2]+fe)}e.nearestIntersectionWithRay=S})(on||(on={}));var sc=class{constructor(t,n){this.parent=null,this.child=null,this.degree=0,this.isMarked=!1,this.key=t,this.value=n,this.prev=this,this.next=this}},ac=class{constructor(t){if(this._index=-1,this._items=[],this._len=0,t){let n=t,r=0;do this._items[r++]=n,n=n.next;while(t!==n);this._len=r}}hasNext(){return this._index<this._len-1}next(){return this._items[++this._index]}reset(t){this._index=-1,this._len=0;let n=t,r=0;do this._items[r++]=n,n=n.next;while(t!==n);this._len=r}},oc=new ac,ki=class{constructor(t){this._minNode=null,this._nodeCount=0,this._compare=t||this._defaultCompare}clear(){this._minNode=null,this._nodeCount=0}decreaseKey(t,n){if(!t)throw new Error("Cannot decrease key of non-existent node");if(this._compare({key:n},{key:t.key})>0)throw new Error("New key is larger than old key");t.key=n;let r=t.parent;r&&this._compare(t,r)<0&&(this._cut(t,r,this._minNode),this._cascadingCut(r,this._minNode)),this._compare(t,this._minNode)<0&&(this._minNode=t)}delete(t){let n=t.parent;n&&(this._cut(t,n,this._minNode),this._cascadingCut(n,this._minNode)),this._minNode=t,this.extractMinimum()}extractMinimum(){let t=this._minNode;if(t){if(t.child){let r=t.child;do r.parent=null,r=r.next;while(r!==t.child)}let n=null;t.next!==t&&(n=t.next),this._removeNodeFromList(t),this._nodeCount--,this._minNode=this._mergeLists(n,t.child),this._minNode&&(this._minNode=this._consolidate(this._minNode))}return t}findMinimum(){return this._minNode}insert(t,n){let r=new sc(t,n);return this._minNode=this._mergeLists(this._minNode,r),this._nodeCount++,r}isEmpty(){return this._minNode===null}size(){return this._minNode===null?0:this._getNodeListSize(this._minNode)}union(t){this._minNode=this._mergeLists(this._minNode,t._minNode),this._nodeCount+=t._nodeCount}_defaultCompare(t,n){return t.key>n.key?1:t.key<n.key?-1:0}_cut(t,n,r){t.parent=null,n.degree--,t.next===t?n.child=null:n.child=t.next,this._removeNodeFromList(t);let i=this._mergeLists(r,t);return t.isMarked=!1,i}_cascadingCut(t,n){let r=t.parent;return r&&(t.isMarked?(n=this._cut(t,r,n),n=this._cascadingCut(r,n)):t.isMarked=!0),n}_consolidate(t){let n=[];for(oc.reset(t);oc.hasNext();){let i=oc.next(),o=n[i.degree];for(;o;){if(this._compare(i,o)>0){let s=i;i=o,o=s}this._linkHeaps(o,i),n[i.degree]=null,i.degree++,o=n[i.degree]}n[i.degree]=i}let r=null;for(let i=0;i<n.length;i++){let o=n[i];o&&(o.next=o,o.prev=o,r=this._mergeLists(r,o))}return r}_removeNodeFromList(t){let n=t.prev,r=t.next;n.next=r,r.prev=n,t.next=t,t.prev=t}_linkHeaps(t,n){this._removeNodeFromList(t),n.child=this._mergeLists(t,n.child),t.parent=n,t.isMarked=!1}_mergeLists(t,n){if(!t)return n||null;if(!n)return t;let r=t.next;return t.next=n.next,t.next.prev=t,n.next=r,n.next.prev=n,this._compare(t,n)<0?t:n}_getNodeListSize(t){let n=0,r=t;do n++,r.child&&(n+=this._getNodeListSize(r.child)),r=r.next;while(r!==t);return n}};function Xn(e,t,n){return new uc(e,t,n)}var uc=class{find(t,n,r,i,o){this.ctx.x=t,this.ctx.y=n,this.ctx.z=r,this.ctx.radius=i,this.ctx.isCheck=!1;let s=o??this.result;return Yf(this.ctx,s),s}nearest(t,n,r,i=1,o,s){this.ctx.x=t,this.ctx.y=n,this.ctx.z=r,this.ctx.k=i,this.ctx.stopIf=o;let a=s??this.result;return Ch(this.ctx,a),a}check(t,n,r,i){return this.ctx.x=t,this.ctx.y=n,this.ctx.z=r,this.ctx.radius=i,this.ctx.isCheck=!0,Yf(this.ctx,this.result)}constructor(t,n,r){let i=gh(t,n,r);this.ctx=yh(i),this.boundary={box:i.boundingBox,sphere:i.boundingSphere},this.buckets={offset:i.bucketOffset,count:i.bucketCounts,array:i.bucketArray},this.result=dn.create()}};function _h(e){let{expandedBox:t,size:[n,r,i],data:{x:o,y:s,z:a,radius:c,indices:u},elementCount:l,delta:m}=e,f=n*r*i,{min:[d,p,h]}=t,x=0,y=0,g=new Uint32Array(f),C=new Int32Array(l);for(let S=0;S<l;S++){let v=Ie.getAt(u,S),P=Math.floor((o[v]-d)/m[0]),L=Math.floor((s[v]-p)/m[1]),w=Math.floor((a[v]-h)/m[2]),D=(P*r+L)*i+w;(g[D]+=1)===1&&(y+=1),C[S]=D}if(c)for(let S=0;S<l;S++){let v=Ie.getAt(u,S);c[v]>x&&(x=c[v])}let _=new Int32Array(y);for(let S=0,v=0;S<f;S++){let P=g[S];P>0&&(g[S]=v+1,_[v]=P,v+=1)}let b=new Uint32Array(y);for(let S=1;S<y;++S)b[S]+=b[S-1]+_[S-1];let I=new Int32Array(y),E=new Int32Array(l);for(let S=0;S<l;S++){let v=g[C[S]];if(v>0){let P=v-1;E[b[P]+I[P]]=S,I[P]+=1}}return{size:e.size,bucketArray:E,bucketCounts:_,bucketOffset:b,grid:g,delta:m,min:e.expandedBox.min,data:e.data,maxRadius:x,expandedBox:e.expandedBox,boundingBox:e.boundingBox,boundingSphere:e.boundingSphere}}function gh(e,t,n){let r=on.expand(on(),t.box,N.create(.5,.5,.5)),{indices:i}=e,o=on.size(N(),r),s,a,c=Ie.size(i),u=typeof n=="number"?n:32,l=Array.isArray(n)&&n;if(l&&!N.isZero(l))a=[Math.ceil(o[0]/l[0]),Math.ceil(o[1]/l[1]),Math.ceil(o[2]/l[2])],s=l;else if(c>0){let d=Math.ceil(c/u),p=Math.pow(d/(o[0]*o[1]*o[2]),1/3);a=[Math.ceil(o[0]*p),Math.ceil(o[1]*p),Math.ceil(o[2]*p)],s=[o[0]/a[0],o[1]/a[1],o[2]/a[2]]}else s=o,a=[1,1,1];let m={x:e.x,y:e.y,z:e.z,indices:i,radius:e.radius},f={size:a,data:m,expandedBox:r,boundingBox:t.box,boundingSphere:t.sphere,elementCount:c,delta:s};return _h(f)}function yh(e){return{grid:e,x:.1,y:.1,z:.1,k:1,stopIf:void 0,radius:.1,isCheck:!1}}function Yf(e,t){let{min:n,size:[r,i,o],bucketOffset:s,bucketCounts:a,bucketArray:c,grid:u,data:{x:l,y:m,z:f,indices:d,radius:p},delta:h,maxRadius:x}=e.grid,{radius:y,isCheck:g,x:C,y:_,z:b}=e,I=y+x,E=I*I;dn.reset(t);let S=Math.max(0,Math.floor((C-I-n[0])/h[0])),v=Math.max(0,Math.floor((_-I-n[1])/h[1])),P=Math.max(0,Math.floor((b-I-n[2])/h[2])),L=Math.min(r-1,Math.floor((C+I-n[0])/h[0])),w=Math.min(i-1,Math.floor((_+I-n[1])/h[1])),D=Math.min(o-1,Math.floor((b+I-n[2])/h[2]));if(S>L||v>w||P>D)return!1;for(let z=S;z<=L;z++)for(let ie=v;ie<=w;ie++)for(let O=P;O<=D;O++){let Q=u[(z*i+ie)*o+O];if(Q===0)continue;let K=Q-1,Z=s[K],se=a[K],fe=Z+se;for(let Ce=Z;Ce<fe;Ce++){let xe=Ie.getAt(d,c[Ce]),H=l[xe]-C,$=m[xe]-_,de=f[xe]-b,T=H*H+$*$+de*de;if(T<=E){if(x>0&&Math.sqrt(T)-p[xe]>y)continue;if(g)return!0;dn.add(t,c[Ce],T)}}}return t.count>0}var Zf=N(),Fr=N(),mo=new Set,cc=new Set,xh=[.1],Ah=[.1],bh=[.1],Ui=new ki;function Ch(e,t){let{min:n,expandedBox:r,boundingSphere:{center:i},size:[o,s,a],bucketOffset:c,bucketCounts:u,bucketArray:l,grid:m,data:{x:f,y:d,z:p,indices:h,radius:x},delta:y,maxRadius:g}=e.grid,{x:C,y:_,z:b,k:I,stopIf:E}=e,S=Ie.size(h);if(dn.reset(t),S===0||I<=0)return!1;let v,P,L,w=!1,D=1,z=!0,ie=0,O=xh,Q=Ah,K=0,Z=!0,se,fe=!1,Ce=bh,xe=g*g;O.length=0,Ce.length=0,mo.clear(),Ui.clear(),N.set(Fr,C,_,b),on.containsVec3(r,Fr)?(v=Math.floor((C-n[0])/y[0]),P=Math.floor((_-n[1])/y[1]),L=Math.floor((b-n[2])/y[2])):(on.nearestIntersectionWithRay(Fr,r,Fr,N.normalize(Zf,N.sub(Zf,i,Fr))),v=Math.max(0,Math.min(o-1,Math.floor((Fr[0]-n[0])/y[0]))),P=Math.max(0,Math.min(s-1,Math.floor((Fr[1]-n[1])/y[1]))),L=Math.max(0,Math.min(a-1,Math.floor((Fr[2]-n[2])/y[2]))));let H=g!==0?Math.max(1,Math.min(o-1,Math.ceil(g/y[0]))):1,$=g!==0?Math.max(1,Math.min(s-1,Math.ceil(g/y[1]))):1,de=g!==0?Math.max(1,Math.min(a-1,Math.ceil(g/y[2]))):1;for(O.push(v,P,L,(v*s+P)*a+L);t.count<S;){let T=D*4;for(let B=0;B<T;B+=4)if(se=O[B+3],!mo.has(se)){mo.add(se),fe=mo.size>=m.length;let k=m[se];if(k!==0){let R=K,V=k-1,j=c[V],oe=u[V],ae=j+oe;for(let ne=j;ne<ae;ne++){let q=l[ne],F=Ie.getAt(h,q),W=f[F]-C,re=d[F]-_,_e=p[F]-b,Ae=W*W+re*re+_e*_e;if(g!==0){let Ze=x[F];Ae-=Ze*Ze}Z&&Ae>K&&(K=Ae),Ui.insert(Ae,q)}R<K&&(Z=!1)}}Q.length=0,ie=0,cc.clear();for(let B=0;B<T;B+=4){v=O[B],P=O[B+1],L=O[B+2];for(let k=-H;k<=H;k++){let R=v+k;if(!(R<0||R>=o))for(let V=-$;V<=$;V++){let j=P+V;if(!(j<0||j>=s))for(let oe=-de;oe<=de;oe++){let ae=L+oe;if(!(ae<0||ae>=a)&&(se=(R*s+j)*a+ae,!cc.has(se)&&(cc.add(se),!mo.has(se)))){if(!z){let ne=n[0]+R*y[0]-C,q=n[1]+j*y[1]-_,F=n[2]+ae*y[2]-b;if(ne*ne+q*q+F*F-xe>K){Ce.push(R,j,ae,se);continue}}Q.push(R,j,ae,se),ie++}}}}}if(z=!1,ie===0){if(I===1){let B=Ui.findMinimum();if(B){let{key:k,value:R}=B;return dn.add(t,R,k),!0}}else for(;!Ui.isEmpty()&&(fe||Ui.findMinimum().key<=K)&&t.count<I;){let B=Ui.extractMinimum(),k=B.key,R=B.value;dn.add(t,R,k),E&&!w&&(w=E(R,k))}if(t.count>=I||w||t.count>=S)return t.count>0;if(z=!0,Z=!0,Ce.length>0){for(let B=0,k=Ce.length;B<k;B++)O.push(Ce[B]);Ce.length=0,D=O.length}}else{let B=O;O=Q,Q=B,D=ie}}return t.count>0}var Wf="0.3.0",pt;(function(e){let t;(function(o){o[o.Int8=1]="Int8",o[o.Int16=2]="Int16",o[o.Int32=3]="Int32",o[o.Uint8=4]="Uint8",o[o.Uint16=5]="Uint16",o[o.Uint32=6]="Uint32"})(t=e.IntDataType||(e.IntDataType={}));let n;(function(o){o[o.Float32=32]="Float32",o[o.Float64=33]="Float64"})(n=e.FloatDataType||(e.FloatDataType={}));function r(o){let s;return o instanceof Int8Array?s=e.IntDataType.Int8:o instanceof Int16Array?s=e.IntDataType.Int16:o instanceof Int32Array?s=e.IntDataType.Int32:o instanceof Uint8Array?s=e.IntDataType.Uint8:o instanceof Uint16Array?s=e.IntDataType.Uint16:o instanceof Uint32Array?s=e.IntDataType.Uint32:o instanceof Float32Array?s=e.FloatDataType.Float32:o instanceof Float64Array?s=e.FloatDataType.Float64:s=e.IntDataType.Int32,s}e.getDataType=r;function i(o){if(o instanceof Int8Array||o instanceof Int16Array||o instanceof Int32Array)return!0;for(let s=0,a=o.length;s<a;s++)if(s<0)return!1;return!0}e.isSignedIntegerDataType=i})(pt||(pt={}));var Xf=new Uint16Array(new Uint8Array([18,52]).buffer)[0]===13330;function $f(e,t){let n=new ArrayBuffer(e.length),r=new Uint8Array(n);for(let i=0,o=e.length;i<o;i+=t)for(let s=0;s<t;s++)r[i+t-s-1]=e[i+s];return n}var lc=28672;function CC(e){if(e.length>lc){let t=[];for(let n=0;n<e.length;n+=lc)t.push(String.fromCharCode.apply(null,e.subarray(n,n+lc)));return t.join("")}else return String.fromCharCode.apply(null,e)}function Ri(e){let t=e.data;for(let n=e.encoding.length-1;n>=0;n--)t=Sh(t,e.encoding[n]);return t}function Sh(e,t){switch(t.kind){case"ByteArray":switch(t.type){case pt.IntDataType.Uint8:return e;case pt.IntDataType.Int8:return Ih(e);case pt.IntDataType.Int16:return wh(e);case pt.IntDataType.Uint16:return vh(e);case pt.IntDataType.Int32:return Ph(e);case pt.IntDataType.Uint32:return Bh(e);case pt.FloatDataType.Float32:return Eh(e);case pt.FloatDataType.Float64:return Dh(e);default:gn(t.type)}case"FixedPoint":return Mh(e,t);case"IntervalQuantization":return Nh(e,t);case"RunLength":return kh(e,t);case"Delta":return Uh(e,t);case"IntegerPacking":return Fh(e,t);case"StringArray":return Oh(e,t)}}function Qf(e,t){switch(e){case pt.IntDataType.Int8:return new Int8Array(t);case pt.IntDataType.Int16:return new Int16Array(t);case pt.IntDataType.Int32:return new Int32Array(t);case pt.IntDataType.Uint8:return new Uint8Array(t);case pt.IntDataType.Uint16:return new Uint16Array(t);case pt.IntDataType.Uint32:return new Uint32Array(t);default:return new Int32Array(t)}}function Jf(e,t){switch(e){case pt.FloatDataType.Float32:return new Float32Array(t);case pt.FloatDataType.Float64:return new Float64Array(t);default:return new Float64Array(t)}}function Ih(e){return new Int8Array(e.buffer,e.byteOffset)}function Ti(e,t,n){return Xf?new n(e.buffer):new n($f(e,t))}function wh(e){return Ti(e,2,Int16Array)}function vh(e){return Ti(e,2,Uint16Array)}function Ph(e){return Ti(e,4,Int32Array)}function Bh(e){return Ti(e,4,Uint32Array)}function Eh(e){return Ti(e,4,Float32Array)}function Dh(e){return Ti(e,8,Float64Array)}function Mh(e,t){let n=e.length,r=Jf(t.srcType,n),i=1/t.factor;for(let o=0;o<n;o++)r[o]=i*e[o];return r}function Nh(e,t){let n=e.length,r=Jf(t.srcType,n),i=(t.max-t.min)/(t.numSteps-1),o=t.min;for(let s=0;s<n;s++)r[s]=o+i*e[s];return r}function kh(e,t){let n=Qf(t.srcType,t.srcSize),r=0;for(let i=0,o=e.length;i<o;i+=2){let s=e[i],a=e[i+1];for(let c=0;c<a;++c)n[r++]=s}return n}function Uh(e,t){let n=e.length,r=Qf(t.srcType,n);if(!n)return e;r[0]=e[0]+(t.origin|0);for(let i=1;i<n;++i)r[i]=e[i]+r[i-1];return r}function Rh(e,t){let n=t.byteCount===1?127:32767,r=-n-1,i=e.length,o=new Int32Array(t.srcSize),s=0,a=0;for(;s<i;){let c=0,u=e[s];for(;u===n||u===r;)c+=u,s++,u=e[s];c+=u,o[a]=c,s++,a++}return o}function Th(e,t){let n=t.byteCount===1?255:65535,r=e.length,i=new Int32Array(t.srcSize),o=0,s=0;for(;o<r;){let a=0,c=e[o];for(;c===n;)a+=c,o++,c=e[o];a+=c,i[s]=a,o++,s++}return i}function Fh(e,t){return e.length===t.srcSize?e:t.isUnsigned?Th(e,t):Rh(e,t)}function Oh(e,t){let n=Ri({encoding:t.offsetEncoding,data:t.offsets}),r=Ri({encoding:t.dataEncoding,data:e}),i=t.stringData,o=new Array(n.length);o[0]="";for(let c=1,u=n.length;c<u;c++)o[c]=i.substring(n[c-1],n[c]);let s=0,a=new Array(r.length);for(let c=0,u=r.length;c<u;c++)a[s++]=o[r[c]+1];return a}function Lh(e,t,n){let r=1,i;for(i=0;i<t;i++){let o=r*e;if(Math.abs(Math.round(o)-o)<=n)return i;r*=10}return-1}function BC(e,t){return Math.abs(e)<t?0:Math.floor(Math.log10(Math.abs(e)))+1}function ed(e,t,n){let r=1,i=0;for(let o=0,s=e.length;o<s;o++){if(r>=0){let c=Lh(e[o],t,n);c<0?r=-1:c>r&&(r=c)}let a=Math.abs(e[o]);if(a>n){let c=Math.floor(Math.log10(Math.abs(a)))+1;c>i&&(i=c)}}return{mantissaDigits:r,integerDigits:i}}function EC(e){e=e.trim();let t=parseInt(e,10);return isNaN(t)?!1:t.toString()===e}function DC(e){if(!isFinite(e))return 0;let t=1,n=0;for(;Math.round(e*t)/t!==e;)t*=10,++n;return n}function MC(e,t){return parseFloat(e.toPrecision(t))}function ho(e){return po.classify(e)}function td(e){return fc.classify(e)}var po;(function(e){function t(d,p){return d>=0?Math.ceil((d+1)/p):Math.ceil((d+1)/(-p-1))}function n(d){let p=!1;for(let h=0,x=d.length;h<x;h++)if(d[h]<0){p=!0;break}return p?{signed:p,limit8:127,limit16:32767}:{signed:p,limit8:255,limit16:65535}}function r(){return{pack8:0,pack16:0,count:0}}function i({limit8:d,limit16:p},h,x){h.pack8+=t(x,d),h.pack16+=t(x,p),h.count+=1}function o(d,p){d.pack8+=t(p,127),d.pack16+=t(p,32767),d.count+=1}function s(d){return d.count*4<d.pack16*2?{length:d.count*4,elem:4}:d.pack16*2<d.pack8?{length:d.pack16*2,elem:2}:{length:d.pack8,elem:1}}function a(d,p){let h=r();for(let x=0,y=d.length;x<y;x++)i(p,h,d[x]);return Ct(Le({},s(h)),{kind:"pack"})}function c(d,p){let h=r(),x=d[0];for(let y=1,g=d.length;y<g;y++)o(h,d[y]-x),x=d[y];return Ct(Le({},s(h)),{kind:"delta"})}function u(d,p){let h=r(),x=1;for(let y=1,g=d.length;y<g;y++)d[y-1]!==d[y]?(i(p,h,d[y-1]),i(p,h,x),x=1):x++;return i(p,h,d[d.length-1]),i(p,h,x),Ct(Le({},s(h)),{kind:"rle"})}function l(d,p){let h=r(),x=1,y=0,g=0;for(let C=1,_=d.length;C<_;C++){let b=d[C]-y;g!==b?(o(h,g),o(h,x),x=1):x++,g=b,y=d[C]}return o(h,g),o(h,x),Ct(Le({},s(h)),{kind:"delta-rle"})}function m(d){let p=n(d),h=[a(d,p),u(d,p),c(d,p),l(d,p)];return h.sort((x,y)=>x.length-y.length),h}e.getSize=m;function f(d){if(d.length<2)return rt.by(rt.byteArray);let h=m(d)[0];switch(h.kind){case"pack":return rt.by(rt.integerPacking);case"rle":return rt.by(rt.runLength).and(rt.integerPacking);case"delta":return rt.by(rt.delta).and(rt.integerPacking);case"delta-rle":return rt.by(rt.delta).and(rt.runLength).and(rt.integerPacking);default:gn(h)}}e.classify=f})(po||(po={}));var fc;(function(e){function n(i){let{mantissaDigits:s,integerDigits:a}=ed(i,4,1e-6);if(s<0||s+a>10)return rt.by(rt.byteArray);if(s===0)return po.classify(i);let c=r(s),u=new Int32Array(i.length);for(let d=0,p=i.length;d<p;d++)u[d]=Math.round(c*i[d]);let m=po.getSize(u)[0],f=rt.by(rt.fixedPoint(c));switch(m.kind){case"pack":return f.and(rt.integerPacking);case"rle":return f.and(rt.runLength).and(rt.integerPacking);case"delta":return f.and(rt.delta).and(rt.integerPacking);case"delta-rle":return f.and(rt.delta).and(rt.runLength).and(rt.integerPacking);default:gn(m)}}e.classify=n;function r(i){let o=1;for(let s=0;s<i;s++)o*=10;return o}})(fc||(fc={}));var ms=class e{and(t){return new e(this.providers.concat([t]))}encode(t){let n=[];for(let r of this.providers){let i=r(t);if(!i.encodings.length)throw new Error("Encodings must be non-empty.");t=i.data;for(let o of i.encodings)n.push(o)}if(!(t instanceof Uint8Array))throw new Error("The encoding must result in a Uint8Array. Fix your encoding chain.");return{encoding:n,data:t}}constructor(t){this.providers=t}},Gn;(function(e){function t(i){return new ms([i])}e.by=t;function n(i){let o=t(r(i[0]));for(let s=1;s<i.length&&i[s-1].kind!=="IntegerPacking";s++)o=o.and(r(i[s]));return o}e.fromEncoding=n;function r(i){switch(i.kind){case"ByteArray":return rt.byteArray;case"FixedPoint":return rt.fixedPoint(i.factor);case"IntervalQuantization":return rt.intervalQuantizaiton(i.min,i.max,i.numSteps);case"RunLength":return rt.runLength;case"Delta":return rt.delta;case"IntegerPacking":return rt.integerPacking;case"StringArray":return rt.stringArray}}})(Gn||(Gn={}));var rt;(function(e){function t(_){return new ms([_])}e.by=t;function n(_){return{encodings:[{kind:"ByteArray",type:pt.IntDataType.Uint8}],data:_}}function r(_){return{encodings:[{kind:"ByteArray",type:pt.IntDataType.Int8}],data:new Uint8Array(_.buffer,_.byteOffset)}}let i={[pt.IntDataType.Int16]:function(_,b,I){_.setInt16(2*b,I,!0)},[pt.IntDataType.Uint16]:function(_,b,I){_.setUint16(2*b,I,!0)},[pt.IntDataType.Int32]:function(_,b,I){_.setInt32(4*b,I,!0)},[pt.IntDataType.Uint32]:function(_,b,I){_.setUint32(4*b,I,!0)},[pt.FloatDataType.Float32]:function(_,b,I){_.setFloat32(4*b,I,!0)},[pt.FloatDataType.Float64]:function(_,b,I){_.setFloat64(8*b,I,!0)}},o={[pt.IntDataType.Int16]:2,[pt.IntDataType.Uint16]:2,[pt.IntDataType.Int32]:4,[pt.IntDataType.Uint32]:4,[pt.FloatDataType.Float32]:4,[pt.FloatDataType.Float64]:8};function s(_){let b=pt.getDataType(_);if(b===pt.IntDataType.Int8)return r(_);if(b===pt.IntDataType.Uint8)return n(_);let I=new Uint8Array(_.length*o[b]),E=i[b],S=new DataView(I.buffer);for(let v=0,P=_.length;v<P;v++)E(S,v,_[v]);return{encodings:[{kind:"ByteArray",type:b}],data:I}}e.byteArray=s;function a(_,b){let I=pt.getDataType(_),E=new Int32Array(_.length);for(let S=0,v=_.length;S<v;S++)E[S]=Math.round(_[S]*b);return{encodings:[{kind:"FixedPoint",factor:b,srcType:I}],data:E}}function c(_){return b=>a(b,_)}e.fixedPoint=c;function u(_,b,I,E,S){let v=pt.getDataType(_);if(!_.length)return{encodings:[{kind:"IntervalQuantization",min:b,max:I,numSteps:E,srcType:v}],data:new Int32Array(0)};if(I<b){let w=b;b=I,I=w}let P=(I-b)/(E-1),L=new S(_.length);for(let w=0,D=_.length;w<D;w++){let z=_[w];z<=b?L[w]=0:z>=I?L[w]=E-1:L[w]=Math.round((z-b)/P)|0}return{encodings:[{kind:"IntervalQuantization",min:b,max:I,numSteps:E,srcType:v}],data:L}}function l(_,b,I,E=Int32Array){return S=>u(S,_,b,I,E)}e.intervalQuantizaiton=l;function m(_){let b=pt.getDataType(_);if(b===void 0&&(_=new Int32Array(_),b=pt.IntDataType.Int32),!_.length)return{encodings:[{kind:"RunLength",srcType:b,srcSize:0}],data:new Int32Array(0)};let I=2;for(let P=1,L=_.length;P<L;P++)_[P-1]!==_[P]&&(I+=2);let E=new Int32Array(I),S=0,v=1;for(let P=1,L=_.length;P<L;P++)_[P-1]!==_[P]?(E[S]=_[P-1],E[S+1]=v,v=1,S+=2):++v;return E[S]=_[_.length-1],E[S+1]=v,{encodings:[{kind:"RunLength",srcType:b,srcSize:_.length}],data:E}}e.runLength=m;function f(_){if(!pt.isSignedIntegerDataType(_))throw new Error("Only signed integer types can be encoded using delta encoding.");let b=pt.getDataType(_);if(b===void 0&&(_=new Int32Array(_),b=pt.IntDataType.Int32),!_.length)return{encodings:[{kind:"Delta",origin:0,srcType:b}],data:new _.constructor(0)};let I=new _.constructor(_.length),E=_[0];I[0]=_[0];for(let S=1,v=_.length;S<v;S++)I[S]=_[S]-_[S-1];return I[0]=0,{encodings:[{kind:"Delta",origin:E,srcType:b}],data:I}}e.delta=f;function d(_){for(let b=0,I=_.length;b<I;b++)if(_[b]<0)return!0;return!1}function p(_,b){let I=0;for(let E=0,S=_.length;E<S;E++)I+=_[E]/b|0;return I+=_.length,I}function h(_,b){let I=-b-1,E=0;for(let S=0,v=_.length;S<v;S++){let P=_[S];P>=0?E+=P/b|0:E+=P/I|0}return E+=_.length,E}function x(_){let b=d(_),I=b?h(_,127):p(_,255),E=b?h(_,32767):p(_,65535);return _.length*4<E*2?{isSigned:b,size:_.length,bytesPerElement:4}:E*2<I?{isSigned:b,size:E,bytesPerElement:2}:{isSigned:b,size:I,bytesPerElement:1}}function y(_,b){let I=b.isSigned?b.bytesPerElement===1?127:32767:b.bytesPerElement===1?255:65535,E=-I-1,S=_.length,v=b.isSigned?b.bytesPerElement===1?new Int8Array(b.size):new Int16Array(b.size):b.bytesPerElement===1?new Uint8Array(b.size):new Uint16Array(b.size),P=0;for(let w=0;w<S;w++){let D=_[w];if(D>=0)for(;D>=I;)v[P]=I,++P,D-=I;else for(;D<=E;)v[P]=E,++P,D-=E;v[P]=D,++P}let L=s(v);return{encodings:[{kind:"IntegerPacking",byteCount:b.bytesPerElement,isUnsigned:!b.isSigned,srcSize:S},L.encodings[0]],data:L.data}}function g(_){let b=x(_);return b.bytesPerElement===4?s(_):y(_,b)}e.integerPacking=g;function C(_){let b=Object.create(null),I=[],E=new Int32Array(_.length),S=ri.create(Int32Array,1,Math.min(1024,_.length<32?_.length+1:Math.round(_.length/8)+1));ri.add(S,0);let v=0,P=0;for(let O of _){if(O==null){E[P++]=-1;continue}let Q=b[O];Q===void 0&&(v+=O.length,Q=I.length,I[Q]=O,b[O]=Q,ri.add(S,v)),E[P++]=Q}let L=ri.compact(S),D=ho(L).encode(L),ie=ho(E).encode(E);return{encodings:[{kind:"StringArray",dataEncoding:ie.encoding,stringData:I.join(""),offsetEncoding:D.encoding,offsets:D.data}],data:ie.data}}e.stringArray=C})(rt||(rt={}));var ps;(function(e){function t(a,c,u){return{name:a,type:0,value:c,valueKind:u&&u.valueKind,defaultFormat:u&&u.encoder?{encoder:u.encoder}:void 0,shouldInclude:u&&u.shouldInclude}}e.str=t;function n(a,c,u){return{name:a,type:1,value:c,valueKind:u&&u.valueKind,defaultFormat:u?{encoder:u.encoder,typedArray:u.typedArray}:void 0,shouldInclude:u&&u.shouldInclude}}e.int=n;function r(a,c,u){return{name:a,type:2,value:c,valueKind:u&&u.valueKind,defaultFormat:u?{encoder:u.encoder,typedArray:u.typedArray,digitCount:typeof u.digitCount<"u"?u.digitCount:void 0}:void 0,shouldInclude:u&&u.shouldInclude}}e.float=r;function i(a){return n(a,(c,u,l)=>l+1,{typedArray:Int32Array,encoder:rt.by(rt.delta).and(rt.runLength).and(rt.integerPacking)})}e.index=i;class o{constructor(){this.fields=[]}index(c){return this.fields.push(e.index(c)),this}str(c,u,l){return this.fields.push(e.str(c,u,l)),this}int(c,u,l){return this.fields.push(e.int(c,u,l)),this}vec(c,u,l){for(let m=0;m<u.length;m++)this.fields.push(e.int(`${c}[${m+1}]`,u[m],l));return this}float(c,u,l){return this.fields.push(e.float(c,u,l)),this}many(c){for(let u=0;u<c.length;u++)this.fields.push(c[u]);return this}add(c){return this.fields.push(c),this}getFields(){return this.fields}}e.Builder=o;function s(){return new o}e.build=s})(ps||(ps={}));var tn;(function(e){e.Empty={fields:[],source:[]};function t(r){let i=[],o=[],s=[],a=[];for(let u of r.split(/[\r\n]+/)){if(u=u.trim(),u.length===0)continue;let l=/^!/.test(u);l&&(u=u.substr(1));let m=u.split(/\./),f=m[1],d=l?f?a:o:f?s:i;d[d.length]=u,f&&!i.includes(m[0])&&(i[i.length]=m[0])}let c=s.map(u=>u.split(".")[0]);return{includeCategory(u){return o.includes(u)?!1:i.length<=0||i.indexOf(u)!==-1},includeField(u,l){let m=u+"."+l;return a.includes(m)?!1:!c.includes(u)||s.includes(m)}}}e.filterOf=t,e.DefaultFilter={includeCategory(r){return!0},includeField(r,i){return!0}},e.DefaultFormatter={getFormat(r,i){}};function n(r,i){return i?{fields:nd(r._schema),source:[{data:r,rowCount:i.length,keys:()=>Rr.Array(i)}]}:{fields:nd(r._schema),source:[{data:r,rowCount:r._rowCount}]}}e.ofTable=n})(tn||(tn={}));var hs;(function(e){function t(r,i,o){r.startDataBlock(i);for(let s of o._tableNames)r.writeCategory({name:s,instance:()=>tn.ofTable(o[s])})}e.writeDatabase=t;function n(r,i){for(let o of Object.keys(i))t(r,o,i[o])}e.writeDatabaseCollection=n})(hs||(hs={}));function dc(e){return(t,n)=>n[e].value(t)}function qh(e){return(t,n)=>n[e].value(t).join(n[e].schema.separator)}function mc(e,...t){return(n,r)=>r[e].schema.space.get(r[e].value(n),...t)}function _o(e){return(t,n)=>n[e].valueKind(t)}function Gh(e,t){let n=[],i=_o(e);if(t.rank===1){let o=t.dimensions[0];for(let s=0;s<o;s++){let a=`${e}[${s+1}]`;n.push({name:a,type:2,value:mc(e,s),valueKind:i})}}else if(t.rank===2){let o=t.dimensions[0],s=t.dimensions[1];for(let a=0;a<o;a++)for(let c=0;c<s;c++){let u=`${e}[${a+1}][${c+1}]`;n.push({name:u,type:2,value:mc(e,a,c),valueKind:i})}}else if(t.rank===3){let o=t.dimensions[0],s=t.dimensions[1],a=t.dimensions[2];for(let c=0;c<o;c++)for(let u=0;u<s;u++)for(let l=0;l<a;l++){let m=`${e}[${c+1}][${u+1}][${l+1}]`;n.push({name:m,type:2,value:mc(e,c,u,l),valueKind:i})}}else throw new Error("Tensors with rank > 3 or rank 0 are currently not supported.");return n}function nd(e){let t=[];for(let n of Object.keys(e)){let r=e[n];r.valueType==="int"?t.push({name:n,type:1,value:dc(n),valueKind:_o(n)}):r.valueType==="float"?t.push({name:n,type:2,value:dc(n),valueKind:_o(n)}):r.valueType==="str"?t.push({name:n,type:0,value:dc(n),valueKind:_o(n)}):r.valueType==="list"?t.push({name:n,type:0,value:qh(n),valueKind:_o(n)}):r.valueType==="tensor"?t.push(...Gh(n,r.space)):gn(r.valueType)}return t}function rd(e){return e.defaultFormat&&typeof e.defaultFormat.digitCount<"u"?Math.max(0,Math.min(e.defaultFormat.digitCount,16)):6}function go(e){return e.fields.some(t=>!!t.shouldInclude)?e.fields.filter(t=>!t.shouldInclude||e.source.some(n=>t.shouldInclude(n.data))):e.fields}function _s(e,t){let n=e.instance(t),r=n.source.filter(s=>s.rowCount>0);if(!r.length)return{instance:n,rowCount:0,source:[]};let i=r.reduce((s,a)=>s+a.rowCount,0),o=r.map(s=>({data:s.data,keys:()=>s.keys?s.keys():Rr.Range(0,s.rowCount-1),rowCount:s.rowCount}));return{instance:n,rowCount:i,source:o}}var ys=class{constructor(){this.builder=dt.create(),this.encoded=!1,this.dataBlockCreated=!1,this.filter=tn.DefaultFilter,this.formatter=tn.DefaultFormatter,this.isBinary=!1,this.binaryEncodingProvider=void 0}setFilter(t){this.filter=t||tn.DefaultFilter}isCategoryIncluded(t){return this.filter.includeCategory(t)}setFormatter(t){this.formatter=t||tn.DefaultFormatter}startDataBlock(t){this.dataBlockCreated=!0,dt.write(this.builder,`data_${(t||"").replace(/[ \n\t]/g,"").toUpperCase()}
#
`)}writeCategory(t,n,r){if(this.encoded)throw new Error("The writer contents have already been encoded, no more writing.");if(!this.dataBlockCreated)throw new Error("No data block created.");if(!r?.ignoreFilter&&!this.filter.includeCategory(t.name))return;let{instance:i,rowCount:o,source:s}=_s(t,n);o&&(o===1?zh(t,i,s,this.builder,this.filter,this.formatter):Vh(t,i,s,this.builder,this.filter,this.formatter))}encode(){this.encoded=!0}writeTo(t){let n=dt.getChunks(this.builder);for(let r=0,i=n.length;r<i;r++)t.writeString(n[r])}getSize(){return dt.getSize(this.builder)}getData(){return dt.getString(this.builder)}};function od(e,t,n,r,i,o){let s=r.valueKind,a=s?s(n,t):0;if(a!==0)a===1?Zh(e):Wh(e);else{let c=r.value(n,t,o),u=r.type;if(u===0)return Kh(c)?(gs(e,c),!0):Xh(e,c);u===1?jh(e,c):Yh(e,c,i)}return!1}function sd(e,t,n){let r=[];for(let i of t){let o=n.getFormat(e,i.name);o&&typeof o.digitCount<"u"?r[r.length]=i.type===2?Math.pow(10,Math.max(0,Math.min(o.digitCount,15))):0:r[r.length]=i.type===2?Math.pow(10,rd(i)):0}return r}function zh(e,t,n,r,i,o){let s=go(t),a=n[0],c=a.data,u=s.reduce((d,p)=>i.includeField(e.name,p.name)?Math.max(d,p.name.length):0,0);if(u===0)return;u+=e.name.length+6;let m=a.keys().move(),f=sd(e.name,t.fields,o);for(let d=0;d<s.length;d++){let p=s[d];if(!i.includeField(e.name,p.name))continue;dt.writePadRight(r,`_${e.name}.${p.name}`,u),od(r,c,m,p,f[d],0)||dt.newline(r)}dt.write(r,`#
`)}function Vh(e,t,n,r,i,o){let s=go(t),a=i===tn.DefaultFilter?s:s.filter(m=>i.includeField(e.name,m.name)),c=a.length;if(c===0)return;let u=sd(e.name,a,o);id(r,"loop_");for(let m=0;m<c;m++)id(r,`_${e.name}.${a[m].name}`);let l=0;for(let m=0;m<n.length;m++){let f=n[m],d=f.data;if(f.rowCount===0)continue;let p=f.keys();for(;p.hasNext;){let h=p.move(),x=!1;for(let y=0;y<c;y++)x=od(r,d,h,a[y],u[y],l);x||dt.newline(r),l++}}dt.write(r,`#
`)}function Kh(e){return typeof e=="string"&&e.indexOf(`
`)>=0}function id(e,t){dt.write(e,t),dt.newline(e)}function jh(e,t){dt.writeInteger(e,t),dt.whitespace1(e)}function Yh(e,t,n){dt.writeFloat(e,t,n),dt.whitespace1(e)}function Zh(e){dt.writeSafe(e,". ")}function Wh(e){dt.writeSafe(e,"? ")}function Xh(e,t){if(!t)return dt.writeSafe(e,". "),!1;let n=t.charCodeAt(0),r=!1,i=0,o=!1,s=!1;for(let a=0,c=t.length-1;a<=c;a++)switch(t.charCodeAt(a)){case 9:r=!0;break;case 10:return gs(e,t),!0;case 32:r=!0;break;case 34:if(a&&a===c)break;if(o)return gs(e,t),!0;s=!0,r=!0,i=0;break;case 39:if(a&&a===c)break;if(s)return gs(e,t),!0;o=!0,r=!0,i=1;break}return!r&&(n===35||n===36||n===59||n===91||n===93||n===95)&&(r=!0),r?(dt.writeSafe(e,i?'"':"'"),dt.writeSafe(e,t),dt.writeSafe(e,i?'" ':"' ")):(dt.writeSafe(e,t),dt.writeSafe(e," ")),!1}function gs(e,t){dt.writeSafe(e,`
;`+t),dt.writeSafe(e,`
;
`)}function yo(e,t,n){for(let r=0,i=n.length;r<i;r++){let o=n.charCodeAt(r);if(o<128){e[t++]=o>>>0&127|0;continue}if(o<2048){e[t++]=o>>>6&31|192,e[t++]=o>>>0&63|128;continue}if(o<65536){e[t++]=o>>>12&15|224,e[t++]=o>>>6&63|128,e[t++]=o>>>0&63|128;continue}if(o<1114112){e[t++]=o>>>18&7|240,e[t++]=o>>>12&63|128,e[t++]=o>>>6&63|128,e[t++]=o>>>0&63|128;continue}throw new Error("bad codepoint "+o)}}var $h=function(){let e=[];for(let t=0;t<1024;t++)e[t]=String.fromCharCode(t);return e}();function cd(e){throw new Error(e)}function Qh(e,t,n){let r=$h,i,o=0,s=[],a=512;for(let c=t,u=t+n;c<u;c++){let l=e[c];l&128?(l&224)===192?s[o++]=r[(l&15)<<6|e[++c]&63]:(l&240)===224?s[o++]=String.fromCharCode((l&15)<<12|(e[++c]&63)<<6|(e[++c]&63)<<0):(l&248)===240?s[o++]=String.fromCharCode((l&7)<<18|(e[++c]&63)<<12|(e[++c]&63)<<6|(e[++c]&63)<<0):cd("Invalid byte "+l.toString(16)):s[o++]=r[l],o===a&&(i=i||[],i[i.length]=s.join(""),o=0)}return i?(o>0&&(i[i.length]=s.slice(0,o).join("")),i.join("")):s.slice(0,o).join("")}var ad=typeof TextDecoder<"u"?new TextDecoder:void 0;function xs(e,t,n){if(ad){let r=t||n!==e.length?e.subarray(t,t+n):e;return ad.decode(r)}else return Qh(e,t,n)}function pc(e){let t=0;for(let n=0,r=e.length;n<r;n++){let i=e.charCodeAt(n);if(i<128){t+=1;continue}if(i<2048){t+=2;continue}if(i<65536){t+=3;continue}if(i<1114112){t+=4;continue}cd("bad codepoint "+i)}return t}function ud(e){let t=new ArrayBuffer(As(e)),n=new DataView(t),r=new Uint8Array(t);return bs(e,n,r,0),r}function As(e){let t=typeof e;if(t==="string"){let n=pc(e);if(n<32)return 1+n;if(n<256)return 2+n;if(n<65536)return 3+n;if(n<4294967296)return 5+n}if(e instanceof Uint8Array){let n=e.byteLength;if(n<256)return 2+n;if(n<65536)return 3+n;if(n<4294967296)return 5+n}if(t==="number"){if(Math.floor(e)!==e)return 9;if(e>=0){if(e<128)return 1;if(e<256)return 2;if(e<65536)return 3;if(e<4294967296)return 5;throw new Error("Number too big 0x"+e.toString(16))}if(e>=-32)return 1;if(e>=-128)return 2;if(e>=-32768)return 3;if(e>=-2147483648)return 5;throw new Error("Number too small -0x"+e.toString(16).substr(1))}if(t==="boolean"||e===null||e===void 0)return 1;if(t==="object"){let n,r=0;if(Array.isArray(e)){n=e.length;for(let i=0;i<n;i++)r+=As(e[i])}else{let i=Object.keys(e);n=i.length;for(let o=0;o<n;o++){let s=i[o];r+=As(s)+As(e[s])}}if(n<16)return 1+r;if(n<65536)return 3+r;if(n<4294967296)return 5+r;throw new Error("Array or object too long 0x"+n.toString(16))}throw new Error("Unknown type "+t)}function bs(e,t,n,r){let i=typeof e;if(i==="string"){let o=pc(e);if(o<32)return t.setUint8(r,o|160),yo(n,r+1,e),1+o;if(o<256)return t.setUint8(r,217),t.setUint8(r+1,o),yo(n,r+2,e),2+o;if(o<65536)return t.setUint8(r,218),t.setUint16(r+1,o),yo(n,r+3,e),3+o;if(o<4294967296)return t.setUint8(r,219),t.setUint32(r+1,o),yo(n,r+5,e),5+o}if(e instanceof Uint8Array){let o=e.byteLength,s=new Uint8Array(t.buffer);if(o<256)return t.setUint8(r,196),t.setUint8(r+1,o),s.set(e,r+2),2+o;if(o<65536)return t.setUint8(r,197),t.setUint16(r+1,o),s.set(e,r+3),3+o;if(o<4294967296)return t.setUint8(r,198),t.setUint32(r+1,o),s.set(e,r+5),5+o}if(i==="number"){if(!isFinite(e))throw new Error("Number not finite: "+e);if(Math.floor(e)!==e)return t.setUint8(r,203),t.setFloat64(r+1,e),9;if(e>=0){if(e<128)return t.setUint8(r,e),1;if(e<256)return t.setUint8(r,204),t.setUint8(r+1,e),2;if(e<65536)return t.setUint8(r,205),t.setUint16(r+1,e),3;if(e<4294967296)return t.setUint8(r,206),t.setUint32(r+1,e),5;throw new Error("Number too big 0x"+e.toString(16))}if(e>=-32)return t.setInt8(r,e),1;if(e>=-128)return t.setUint8(r,208),t.setInt8(r+1,e),2;if(e>=-32768)return t.setUint8(r,209),t.setInt16(r+1,e),3;if(e>=-2147483648)return t.setUint8(r,210),t.setInt32(r+1,e),5;throw new Error("Number too small -0x"+(-e).toString(16).substr(1))}if(e==null)return t.setUint8(r,192),1;if(i==="boolean")return t.setUint8(r,e?195:194),1;if(i==="object"){let o,s=0,a=Array.isArray(e),c;if(a?o=e.length:(c=Object.keys(e),o=c.length),o<16?(t.setUint8(r,o|(a?144:128)),s=1):o<65536?(t.setUint8(r,a?220:222),t.setUint16(r+1,o),s=3):o<4294967296&&(t.setUint8(r,a?221:223),t.setUint32(r+1,o),s=5),a)for(let u=0;u<o;u++)s+=bs(e[u],t,n,r+s);else for(let u=0,l=c.length;u<l;u++){let m=c[u];s+=bs(m,t,n,r+s),s+=bs(e[m],t,n,r+s)}return s}throw new Error("Unknown type "+i)}var Cs=class{setFilter(t){this.filter=t||tn.DefaultFilter}isCategoryIncluded(t){return this.filter.includeCategory(t)}setFormatter(t){this.formatter=t||tn.DefaultFormatter}startDataBlock(t){this.dataBlocks.push({header:(t||"").replace(/[ \n\t]/g,"").toUpperCase(),categories:[]})}writeCategory(t,n,r){if(!this.data)throw new Error("The writer contents have already been encoded, no more writing.");if(!this.dataBlocks.length)throw new Error("No data block created.");if(!r?.ignoreFilter&&!this.filter.includeCategory(t.name))return;let{instance:i,rowCount:o,source:s}=_s(t,n);if(!o)return;let a={name:"_"+t.name,columns:[],rowCount:o},c=go(i);for(let u of c){if(!this.filter.includeField(t.name,u.name))continue;let l=this.formatter.getFormat(t.name,u.name);a.columns.push(r2(t.name,u,s,o,l,this.binaryEncodingProvider,this.autoClassify))}a.columns.length&&this.dataBlocks[this.dataBlocks.length-1].categories.push(a)}encode(){this.encodedData||(this.encodedData=ud(this.data),this.data=null,this.dataBlocks=null)}writeTo(t){t.writeBinary(this.encodedData)}getData(){return this.encode(),this.encodedData}getSize(){return this.encodedData.length}constructor(t,n,r){this.autoClassify=r,this.dataBlocks=[],this.filter=tn.DefaultFilter,this.formatter=tn.DefaultFormatter,this.isBinary=!0,this.binaryEncodingProvider=void 0,this.binaryEncodingProvider=n,this.data={encoder:t,version:Wf,dataBlocks:this.dataBlocks}}};function Jh(e,t){return t&&t.typedArray?t.typedArray:e.defaultFormat&&e.defaultFormat.typedArray?e.defaultFormat.typedArray:e.type===0?Array:e.type===1?Int32Array:Float64Array}function e2(e){return e===0?Gn.by(rt.stringArray):Gn.by(rt.byteArray)}function t2(e,t,n,r){return n&&n.encoder?n.encoder:t.defaultFormat&&t.defaultFormat.encoder?t.defaultFormat.encoder:r?r.get(e,t.name):void 0}function n2(e,t){return e===0?Gn.by(rt.stringArray):e===1?ho(t):td(t)}function r2(e,t,n,r,i,o,s){let{array:a,allPresent:c,mask:u}=i2(t,Jh(t,i),r,n),l;t.type===0?l=Gn.by(rt.stringArray):l=t2(e,t,i,o),l||(s?l=n2(t.type,a):l=e2(t.type));let m=l.encode(a),f;if(!c){let d=Gn.by(rt.runLength).and(rt.byteArray).encode(u);d.data.length<u.length?f=d:f=Gn.by(rt.byteArray).encode(u)}return{name:t.name,data:m,mask:f}}function i2(e,t,n,r){let i=e.type===0,o=new t(n),s=new Uint8Array(n),a=e.valueKind,c=e.value,u=!0,l=0;for(let m=0;m<r.length;m++){let f=r[m].data,d=r[m].keys();for(;d.hasNext;){let p=d.move(),h=a?a(p,f):0;if(h!==0)s[l]=h,i&&(o[l]=""),u=!1;else{let x=c(p,f,l);typeof x=="string"&&!x?(s[l]=1,u=!1):s[l]=0,o[l]=x}l++}}return{array:o,allPresent:u,mask:s}}var At;(function(e){e.Encoder=hs,e.Category=tn,e.Field=ps,e.Encoding=rt;function t(c){let{binary:u=!1,encoderName:l="mol*"}=c||{};return u?new Cs(l,c?c.binaryEncodingPovider:void 0,c?!!c.binaryAutoClassifyEncoding:!1):new ys}e.createEncoder=t;function n(){return e.Field.build()}e.fields=n;var r=e.Encoding;e.Encodings={deltaRLE:r.by(r.delta).and(r.runLength).and(r.integerPacking),fixedPoint2:r.by(r.fixedPoint(100)).and(r.delta).and(r.integerPacking),fixedPoint3:r.by(r.fixedPoint(1e3)).and(r.delta).and(r.integerPacking)};function i(c,u){return{fields:c,source:[u]}}e.categoryInstance=i;function o(c){return{get(u,l){let m=c.categories[u];if(!m)return;let f=m.getField(l);return f&&f.binaryEncoding?Gn.fromEncoding(f.binaryEncoding):void 0}}}e.createEncodingProviderFromCifFrame=o;function s(c){return{get(u,l){for(let m=0;m<c.length;m++){let f=c[m];if(f.categoryName===u&&f.columnName===l)return a(f)}}}}e.createEncodingProviderFromJsonConfig=s;function a(c){let u=c.precision;if(u!==void 0){let l=Math.pow(10,u),m=r.by(r.fixedPoint(l));switch(c.encoding){case"pack":return m.and(r.integerPacking);case"rle":return m.and(r.runLength).and(r.integerPacking);case"delta":return m.and(r.delta).and(r.integerPacking);case"delta-rle":return m.and(r.delta).and(r.runLength).and(r.integerPacking)}}else switch(c.encoding){case"pack":return r.by(r.integerPacking);case"rle":return r.by(r.runLength).and(r.integerPacking);case"delta":return r.by(r.delta).and(r.integerPacking);case"delta-rle":return r.by(r.delta).and(r.runLength).and(r.integerPacking)}throw new Error("cannot be reached")}})(At||(At={}));var fd={molstar_atom_site_operator_mapping:{label_asym_id:me.Schema.Str(),auth_asym_id:me.Schema.Str(),operator_name:me.Schema.Str(),suffix:me.Schema.Str(),assembly_id:me.Schema.Str(),assembly_operator_id:me.Schema.Int(),symmetry_operator_index:me.Schema.Int(),symmetry_hkl:me.Schema.Vector(3),ncs_id:me.Schema.Int()}},ld=(e,t)=>typeof t[e].operator.assembly>"u"?1:0,hc=(e,t)=>t[e].operator.spgrOp===-1?1:0,bS=At.fields().str("label_asym_id",(e,t)=>t[e].label_asym_id).str("auth_asym_id",(e,t)=>t[e].auth_asym_id).str("operator_name",(e,t)=>t[e].operator.name).str("suffix",(e,t)=>t[e].operator.suffix).str("assembly_id",(e,t)=>{var n;return((n=t[e].operator.assembly)===null||n===void 0?void 0:n.id)||""},{valueKind:ld}).int("assembly_operator_id",(e,t)=>{var n;return((n=t[e].operator.assembly)===null||n===void 0?void 0:n.operId)||0},{valueKind:ld}).int("symmetry_operator_index",(e,t)=>t[e].operator.spgrOp,{valueKind:hc}).vec("symmetry_hkl",[(e,t)=>t[e].operator.hkl[0],(e,t)=>t[e].operator.hkl[1],(e,t)=>t[e].operator.hkl[2]],{valueKind:hc}).int("ncs_id",(e,t)=>t[e].operator.ncsId,{valueKind:hc}).getFields();var _r=me.Schema,U=_r.str,ee=_r.int,Je=_r.float,_c=_r.coord,Ue=_r.Aliased,Or=_r.Matrix,Ss=_r.Vector,bt=_r.lstr,ui=_r.List,nt={atom_site:{auth_asym_id:U,auth_atom_id:U,auth_comp_id:U,auth_seq_id:ee,B_iso_or_equiv:Je,Cartn_x:_c,Cartn_y:_c,Cartn_z:_c,group_PDB:Ue(U),id:ee,label_alt_id:U,label_asym_id:U,label_atom_id:U,label_comp_id:U,label_entity_id:U,label_seq_id:ee,occupancy:Je,type_symbol:U,pdbx_PDB_ins_code:U,pdbx_PDB_model_num:ee,pdbx_formal_charge:ee,pdbx_label_index:ee,pdbx_sifts_xref_db_name:U,pdbx_sifts_xref_db_acc:U,pdbx_sifts_xref_db_num:U,pdbx_sifts_xref_db_res:U,ihm_model_id:ee},atom_site_anisotrop:{id:ee,type_symbol:U,U:Or(3,3),U_esd:Or(3,3),pdbx_auth_seq_id:U,pdbx_auth_asym_id:U,pdbx_auth_atom_id:U,pdbx_auth_comp_id:U,pdbx_label_seq_id:ee,pdbx_label_alt_id:U,pdbx_label_asym_id:U,pdbx_label_atom_id:U,pdbx_label_comp_id:U,pdbx_PDB_ins_code:U},atom_sites:{entry_id:U,fract_transf_matrix:Or(3,3),fract_transf_vector:Ss(3)},audit_author:{name:U,pdbx_ordinal:ee,identifier_ORCID:U},audit_conform:{dict_location:U,dict_name:U,dict_version:U},cell:{angle_alpha:Je,angle_beta:Je,angle_gamma:Je,entry_id:U,length_a:Je,length_b:Je,length_c:Je,Z_PDB:ee,pdbx_unique_axis:U},chem_comp:{formula:U,formula_weight:Je,id:U,mon_nstd_flag:Ue(bt),name:U,type:Ue(bt),pdbx_synonyms:ui(";",e=>e)},chem_comp_bond:{atom_id_1:U,atom_id_2:U,comp_id:U,value_order:Ue(bt),pdbx_ordinal:ee,pdbx_stereo_config:Ue(bt),pdbx_aromatic_flag:Ue(bt)},citation:{book_publisher:U,country:U,id:U,journal_abbrev:U,journal_id_ASTM:U,journal_id_CSD:U,journal_id_ISSN:U,journal_volume:U,page_first:U,page_last:U,title:U,year:ee,pdbx_database_id_DOI:U,pdbx_database_id_PubMed:ee},citation_author:{citation_id:U,name:U,ordinal:ee},database_2:{database_id:Ue(bt),database_code:U},entity:{details:U,formula_weight:Je,id:U,src_method:Ue(bt),type:Ue(bt),pdbx_description:ui(",",e=>e),pdbx_number_of_molecules:ee,pdbx_mutation:U,pdbx_fragment:U,pdbx_ec:ui(",",e=>e)},entity_poly:{entity_id:U,nstd_linkage:Ue(bt),nstd_monomer:Ue(bt),type:Ue(U),pdbx_strand_id:ui(",",e=>e),pdbx_seq_one_letter_code:U,pdbx_seq_one_letter_code_can:U,pdbx_target_identifier:U},entity_poly_seq:{entity_id:U,hetero:Ue(bt),mon_id:U,num:ee},entry:{id:U},exptl:{entry_id:U,method:Ue(U)},software:{classification:U,date:U,description:U,name:U,type:Ue(bt),version:U,pdbx_ordinal:ee},struct:{entry_id:U,title:U,pdbx_descriptor:U},struct_asym:{details:U,entity_id:U,id:U,pdbx_modified:U,pdbx_blank_PDB_chainid_flag:Ue(U)},struct_conf:{beg_label_asym_id:U,beg_label_comp_id:U,beg_label_seq_id:ee,beg_auth_asym_id:U,beg_auth_comp_id:U,beg_auth_seq_id:ee,conf_type_id:Ue(bt),details:U,end_label_asym_id:U,end_label_comp_id:U,end_label_seq_id:ee,end_auth_asym_id:U,end_auth_comp_id:U,end_auth_seq_id:ee,id:U,pdbx_beg_PDB_ins_code:U,pdbx_end_PDB_ins_code:U,pdbx_PDB_helix_class:U,pdbx_PDB_helix_length:ee,pdbx_PDB_helix_id:U},struct_conn:{conn_type_id:Ue(bt),details:U,id:U,ptnr1_label_asym_id:U,ptnr1_label_atom_id:U,ptnr1_label_comp_id:U,ptnr1_label_seq_id:ee,ptnr1_auth_asym_id:U,ptnr1_auth_comp_id:U,ptnr1_auth_seq_id:ee,ptnr1_symmetry:U,ptnr2_label_asym_id:U,ptnr2_label_atom_id:U,ptnr2_label_comp_id:U,ptnr2_label_seq_id:ee,ptnr2_auth_asym_id:U,ptnr2_auth_comp_id:U,ptnr2_auth_seq_id:ee,ptnr2_symmetry:U,pdbx_ptnr1_PDB_ins_code:U,pdbx_ptnr1_label_alt_id:U,pdbx_ptnr1_standard_comp_id:U,pdbx_ptnr2_PDB_ins_code:U,pdbx_ptnr2_label_alt_id:U,pdbx_ptnr3_PDB_ins_code:U,pdbx_ptnr3_label_alt_id:U,pdbx_ptnr3_label_asym_id:U,pdbx_ptnr3_label_atom_id:U,pdbx_ptnr3_label_comp_id:U,pdbx_ptnr3_label_seq_id:ee,pdbx_PDB_id:U,pdbx_dist_value:Je,pdbx_value_order:Ue(bt)},struct_conn_type:{criteria:U,id:Ue(bt),reference:U},struct_keywords:{entry_id:U,text:ui(",",e=>e),pdbx_keywords:U},struct_ncs_oper:{code:Ue(U),details:U,id:ee,matrix:Or(3,3),vector:Ss(3)},struct_sheet_range:{beg_label_asym_id:U,beg_label_comp_id:U,beg_label_seq_id:ee,end_label_asym_id:U,end_label_comp_id:U,end_label_seq_id:ee,beg_auth_asym_id:U,beg_auth_comp_id:U,beg_auth_seq_id:ee,end_auth_asym_id:U,end_auth_comp_id:U,end_auth_seq_id:ee,id:U,sheet_id:U,pdbx_beg_PDB_ins_code:U,pdbx_end_PDB_ins_code:U},struct_site:{details:U,id:U,pdbx_num_residues:ee,pdbx_evidence_code:U,pdbx_auth_asym_id:U,pdbx_auth_comp_id:U,pdbx_auth_seq_id:U,pdbx_auth_ins_code:U},struct_site_gen:{details:U,id:U,label_alt_id:U,label_asym_id:U,label_atom_id:U,label_comp_id:U,label_seq_id:ee,auth_asym_id:U,auth_comp_id:U,auth_seq_id:U,site_id:U,symmetry:U,pdbx_auth_ins_code:U,pdbx_num_res:ee},symmetry:{entry_id:U,cell_setting:Ue(bt),Int_Tables_number:ee,space_group_name_Hall:U,"space_group_name_H-M":U},pdbx_database_status:{status_code:Ue(U),status_code_sf:Ue(U),status_code_mr:Ue(U),entry_id:U,recvd_initial_deposition_date:U,SG_entry:Ue(bt),deposit_site:Ue(U),process_site:Ue(U),status_code_cs:Ue(U),methods_development_category:Ue(U),pdb_format_compatible:Ue(bt)},pdbx_nonpoly_scheme:{asym_id:U,entity_id:U,mon_id:U,pdb_strand_id:U,ndb_seq_num:U,pdb_seq_num:U,auth_seq_num:U,pdb_mon_id:U,auth_mon_id:U,pdb_ins_code:U},pdbx_database_related:{db_name:U,details:U,db_id:U,content_type:Ue(U)},pdbx_entity_nonpoly:{entity_id:U,comp_id:U,name:U},pdbx_chem_comp_synonyms:{name:U,comp_id:U,provenance:Ue(U)},pdbx_chem_comp_identifier:{comp_id:U,identifier:U,type:Ue(U),program:U,program_version:U},pdbx_unobs_or_zero_occ_residues:{id:ee,polymer_flag:Ue(bt),occupancy_flag:Ue(ee),PDB_model_num:ee,auth_asym_id:U,auth_comp_id:U,auth_seq_id:U,PDB_ins_code:U,label_asym_id:U,label_comp_id:U,label_seq_id:ee},pdbx_struct_mod_residue:{id:ee,auth_asym_id:U,auth_comp_id:U,auth_seq_id:ee,PDB_ins_code:U,label_asym_id:U,label_comp_id:U,label_seq_id:ee,parent_comp_id:U,details:U},pdbx_struct_oper_list:{id:U,type:Ue(U),name:U,symmetry_operation:U,matrix:Or(3,3),vector:Ss(3)},pdbx_struct_assembly:{method_details:U,oligomeric_details:U,oligomeric_count:ee,details:U,id:U},pdbx_struct_assembly_gen:{asym_id_list:ui(",",e=>e),assembly_id:U,oper_expression:U},pdbx_reference_entity_list:{prd_id:U,ref_entity_id:U,type:Ue(bt),details:U,component_id:ee},pdbx_reference_entity_link:{link_id:ee,prd_id:U,details:U,ref_entity_id_1:U,ref_entity_id_2:U,entity_seq_num_1:ee,entity_seq_num_2:ee,comp_id_1:U,comp_id_2:U,atom_id_1:U,atom_id_2:U,value_order:Ue(bt),component_1:ee,component_2:ee,link_class:Ue(U)},pdbx_reference_entity_poly_link:{link_id:ee,prd_id:U,ref_entity_id:U,component_id:ee,entity_seq_num_1:ee,entity_seq_num_2:ee,comp_id_1:U,comp_id_2:U,atom_id_1:U,atom_id_2:U,value_order:Ue(bt)},pdbx_molecule:{prd_id:U,instance_id:ee,asym_id:U},pdbx_molecule_features:{prd_id:U,class:Ue(bt),type:Ue(bt),name:U,details:U},entity_src_nat:{entity_id:U,pdbx_organism_scientific:U,pdbx_plasmid_name:U,pdbx_src_id:ee,pdbx_beg_seq_num:ee,pdbx_end_seq_num:ee},entity_src_gen:{entity_id:U,pdbx_gene_src_gene:ui(",",e=>e),pdbx_gene_src_scientific_name:U,plasmid_name:U,pdbx_src_id:ee,pdbx_beg_seq_num:ee,pdbx_end_seq_num:ee},pdbx_entity_src_syn:{organism_scientific:U,entity_id:U,pdbx_src_id:ee,pdbx_beg_seq_num:ee,pdbx_end_seq_num:ee},pdbx_entity_branch_descriptor:{entity_id:U,descriptor:U,type:Ue(bt),program:U,program_version:U,ordinal:ee},pdbx_entity_instance_feature:{details:U,feature_type:Ue(U),auth_asym_id:U,asym_id:U,auth_seq_num:U,seq_num:ee,comp_id:U,auth_comp_id:U,ordinal:ee},pdbx_entity_branch_list:{entity_id:U,hetero:Ue(bt),comp_id:U,num:ee},pdbx_entity_branch_link:{link_id:ee,details:U,entity_id:U,entity_branch_list_num_1:ee,entity_branch_list_num_2:ee,comp_id_1:U,comp_id_2:U,atom_id_1:U,leaving_atom_id_1:U,atom_stereo_config_1:Ue(bt),atom_id_2:U,leaving_atom_id_2:U,atom_stereo_config_2:Ue(bt),value_order:Ue(bt)},pdbx_entity_branch:{entity_id:U,type:Ue(U)},pdbx_branch_scheme:{entity_id:U,hetero:Ue(bt),asym_id:U,mon_id:U,num:ee,pdb_asym_id:U,pdb_seq_num:U,pdb_mon_id:U,auth_asym_id:U,auth_seq_num:U,auth_mon_id:U},pdbx_chem_comp_related:{comp_id:U,related_comp_id:U,relationship_type:Ue(U),details:U},ihm_starting_model_details:{starting_model_id:U,entity_id:U,entity_description:U,asym_id:U,entity_poly_segment_id:ee,starting_model_source:Ue(U),starting_model_auth_asym_id:U,starting_model_sequence_offset:ee,dataset_list_id:ee},ihm_starting_comparative_models:{id:ee,starting_model_id:U,starting_model_auth_asym_id:U,starting_model_seq_id_begin:ee,starting_model_seq_id_end:ee,template_auth_asym_id:U,template_seq_id_begin:ee,template_seq_id_end:ee,template_sequence_identity:Je,template_sequence_identity_denominator:Ue(ee),template_dataset_list_id:ee,alignment_file_id:ee},ihm_starting_model_seq_dif:{id:ee,entity_id:U,asym_id:U,seq_id:ee,comp_id:U,starting_model_id:U,db_asym_id:U,db_seq_id:ee,db_comp_id:U,details:U},ihm_model_representation:{id:ee,name:U,details:U},ihm_model_representation_details:{id:ee,representation_id:ee,entity_poly_segment_id:ee,entity_id:U,entity_description:U,entity_asym_id:U,model_object_primitive:Ue(U),starting_model_id:U,model_mode:Ue(U),model_granularity:Ue(U),model_object_count:ee},ihm_struct_assembly_details:{id:ee,assembly_id:ee,parent_assembly_id:ee,entity_description:U,entity_id:U,asym_id:U,entity_poly_segment_id:ee},ihm_struct_assembly:{id:ee,name:U,description:U},ihm_modeling_protocol:{id:ee,num_steps:ee,protocol_name:U},ihm_modeling_protocol_details:{id:ee,protocol_id:ee,step_id:ee,struct_assembly_id:ee,dataset_group_id:ee,struct_assembly_description:U,step_name:U,step_method:U,num_models_begin:ee,num_models_end:ee,multi_scale_flag:Ue(bt),multi_state_flag:Ue(bt),ordered_flag:Ue(bt),script_file_id:ee,software_id:ee},ihm_multi_state_modeling:{state_id:ee,state_group_id:ee,population_fraction:Je,population_fraction_sd:Je,state_type:U,state_name:U,experiment_type:Ue(U),details:U},ihm_modeling_post_process:{id:ee,protocol_id:ee,analysis_id:ee,step_id:ee,type:Ue(U),feature:Ue(U),num_models_begin:ee,num_models_end:ee},ihm_ensemble_info:{ensemble_id:ee,ensemble_name:U,post_process_id:ee,model_group_id:ee,ensemble_clustering_method:Ue(U),ensemble_clustering_feature:Ue(U),num_ensemble_models:ee,num_ensemble_models_deposited:ee,ensemble_precision_value:Je,ensemble_file_id:ee},ihm_model_list:{model_id:ee,model_name:U,assembly_id:ee,protocol_id:ee,representation_id:ee},ihm_model_group:{id:ee,name:U,details:U},ihm_model_group_link:{model_id:ee,group_id:ee},ihm_model_representative:{id:ee,model_group_id:ee,model_id:ee,selection_criteria:Ue(U)},ihm_dataset_list:{id:ee,data_type:Ue(U),database_hosted:Ue(bt)},ihm_dataset_group:{id:ee,name:U,application:Ue(U),details:U},ihm_dataset_group_link:{dataset_list_id:ee,group_id:ee},ihm_related_datasets:{dataset_list_id_derived:ee,dataset_list_id_primary:ee},ihm_dataset_related_db_reference:{id:ee,dataset_list_id:ee,db_name:Ue(U),accession_code:U,version:U,details:U},ihm_external_reference_info:{reference_id:ee,reference_provider:U,reference_type:Ue(U),reference:U,refers_to:Ue(U),associated_url:U},ihm_external_files:{id:ee,reference_id:ee,file_path:U,content_type:Ue(U),file_size_bytes:Je,details:U},ihm_dataset_external_reference:{id:ee,dataset_list_id:ee,file_id:ee},ihm_localization_density_files:{id:ee,file_id:ee,ensemble_id:ee,entity_id:U,entity_poly_segment_id:ee,asym_id:U},ihm_predicted_contact_restraint:{id:ee,group_id:ee,entity_id_1:U,entity_id_2:U,asym_id_1:U,asym_id_2:U,comp_id_1:U,comp_id_2:U,seq_id_1:ee,seq_id_2:ee,rep_atom_1:Ue(U),rep_atom_2:Ue(U),distance_lower_limit:Je,distance_upper_limit:Je,probability:Je,restraint_type:Ue(U),model_granularity:Ue(U),dataset_list_id:ee,software_id:ee},ihm_cross_link_list:{id:ee,group_id:ee,entity_description_1:U,entity_description_2:U,entity_id_1:U,entity_id_2:U,comp_id_1:U,comp_id_2:U,seq_id_1:ee,seq_id_2:ee,linker_type:Ue(U),dataset_list_id:ee},ihm_cross_link_restraint:{id:ee,group_id:ee,entity_id_1:U,entity_id_2:U,asym_id_1:U,asym_id_2:U,comp_id_1:U,comp_id_2:U,seq_id_1:ee,seq_id_2:ee,atom_id_1:U,atom_id_2:U,restraint_type:Ue(U),conditional_crosslink_flag:Ue(U),model_granularity:Ue(U),distance_threshold:Je,psi:Je,sigma_1:Je,sigma_2:Je},ihm_cross_link_result_parameters:{id:ee,restraint_id:ee,model_id:ee,psi:Je,sigma_1:Je,sigma_2:Je},ihm_2dem_class_average_restraint:{id:ee,dataset_list_id:ee,number_raw_micrographs:ee,pixel_size_width:Je,pixel_size_height:Je,image_resolution:Je,image_segment_flag:Ue(bt),number_of_projections:ee,struct_assembly_id:ee,details:U},ihm_2dem_class_average_fitting:{id:ee,restraint_id:ee,model_id:ee,cross_correlation_coefficient:Je,rot_matrix:Or(3,3),tr_vector:Ss(3)},ihm_3dem_restraint:{id:ee,dataset_list_id:ee,model_id:ee,struct_assembly_id:ee,fitting_method:U,number_of_gaussians:ee,cross_correlation_coefficient:Je},ihm_sas_restraint:{id:ee,dataset_list_id:ee,model_id:ee,struct_assembly_id:ee,profile_segment_flag:Ue(bt),fitting_atom_type:U,fitting_method:U,fitting_state:Ue(U),radius_of_gyration:Je,chi_value:Je,details:U},ihm_starting_model_coord:{ordinal_id:ee,starting_model_id:U,group_PDB:Ue(U),id:ee,type_symbol:U,entity_id:U,atom_id:U,comp_id:U,seq_id:ee,asym_id:U,Cartn_x:Je,Cartn_y:Je,Cartn_z:Je,B_iso_or_equiv:Je},ihm_sphere_obj_site:{id:ee,entity_id:U,seq_id_begin:ee,seq_id_end:ee,asym_id:U,Cartn_x:Je,Cartn_y:Je,Cartn_z:Je,object_radius:Je,rmsf:Je,model_id:ee},ihm_gaussian_obj_site:{id:ee,entity_id:U,seq_id_begin:ee,seq_id_end:ee,asym_id:U,mean_Cartn_x:Je,mean_Cartn_y:Je,mean_Cartn_z:Je,weight:Je,covariance_matrix:Or(3,3),model_id:ee},ihm_gaussian_obj_ensemble:{id:ee,entity_id:U,seq_id_begin:ee,seq_id_end:ee,asym_id:U,mean_Cartn_x:Je,mean_Cartn_y:Je,mean_Cartn_z:Je,weight:Je,covariance_matrix:Or(3,3),ensemble_id:ee},ihm_feature_list:{feature_id:ee,feature_type:Ue(U),entity_type:Ue(U)},ihm_poly_residue_feature:{ordinal_id:ee,feature_id:ee,entity_id:U,asym_id:U,comp_id_begin:U,comp_id_end:U,seq_id_begin:ee,seq_id_end:ee},ihm_derived_distance_restraint:{id:ee,group_id:ee,feature_id_1:ee,feature_id_2:ee,group_conditionality:Ue(U),random_exclusion_fraction:Je,distance_upper_limit:Je,restraint_type:Ue(U),dataset_list_id:ee},ma_model_list:{ordinal_id:ee,model_id:ee,model_group_id:ee,model_name:U,model_group_name:U,model_type:Ue(U),data_id:ee},ma_target_entity:{entity_id:U,data_id:ee,origin:Ue(U)},ma_target_entity_instance:{asym_id:U,entity_id:U,details:U},ma_target_ref_db_details:{target_entity_id:U,db_name:Ue(U),db_code:U,db_accession:U,seq_db_isoform:U,seq_db_align_begin:U,seq_db_align_end:U,ncbi_taxonomy_id:U,organism_scientific:U},ma_data:{id:ee,content_type:Ue(U),content_type_other_details:U,name:U},ma_software_group:{ordinal_id:ee,group_id:ee,software_id:ee},ma_qa_metric:{id:ee,name:U,type:Ue(U),mode:Ue(U),software_group_id:ee},ma_qa_metric_global:{ordinal_id:ee,model_id:ee,metric_id:ee,metric_value:Je},ma_qa_metric_local:{ordinal_id:ee,model_id:ee,label_asym_id:U,label_seq_id:ee,label_comp_id:U,metric_id:ee,metric_value:Je}};var dd={type_symbol:me.Schema.Aliased(nt.atom_site.type_symbol),label_atom_id:nt.atom_site.label_atom_id,auth_atom_id:nt.atom_site.auth_atom_id,label_alt_id:nt.atom_site.label_alt_id,label_comp_id:nt.atom_site.label_comp_id,auth_comp_id:nt.atom_site.auth_comp_id,pdbx_formal_charge:nt.atom_site.pdbx_formal_charge},md={group_PDB:nt.atom_site.group_PDB,label_seq_id:nt.atom_site.label_seq_id,auth_seq_id:nt.atom_site.auth_seq_id,pdbx_PDB_ins_code:nt.atom_site.pdbx_PDB_ins_code},pd={label_asym_id:nt.atom_site.label_asym_id,auth_asym_id:nt.atom_site.auth_asym_id,label_entity_id:nt.atom_site.label_entity_id},Is;(function(e){function t(){return{label_entity_id:"",label_asym_id:"",auth_seq_id:0,pdbx_PDB_ins_code:void 0}}e.EmptyResidueKey=t})(Is||(Is={}));var $n;(function(e){function t(i,o){return i.residueAtomSegments.index[i.chainAtomSegments.offsets[o]]}e.chainStartResidueIndex=t;function n(i,o){return i.residueAtomSegments.index[i.chainAtomSegments.offsets[o+1]-1]+1}e.chainEndResidueIndexExcl=n;function r(i,o){return n(i,o)-t(i,o)}e.chainResidueCount=r})($n||($n={}));var gc={H:1,D:1,T:1,HE:2,LI:3,BE:4,B:5,C:6,N:7,O:8,F:9,NE:10,NA:11,MG:12,AL:13,SI:14,P:15,S:16,CL:17,AR:18,K:19,CA:20,SC:21,TI:22,V:23,CR:24,MN:25,FE:26,CO:27,NI:28,CU:29,ZN:30,GA:31,GE:32,AS:33,SE:34,BR:35,KR:36,RB:37,SR:38,Y:39,ZR:40,NB:41,MO:42,TC:43,RU:44,RH:45,PD:46,AG:47,CD:48,IN:49,SN:50,SB:51,TE:52,I:53,XE:54,CS:55,BA:56,LA:57,CE:58,PR:59,ND:60,PM:61,SM:62,EU:63,GD:64,TB:65,DY:66,HO:67,ER:68,TM:69,YB:70,LU:71,HF:72,TA:73,W:74,RE:75,OS:76,IR:77,PT:78,AU:79,HG:80,TL:81,PB:82,BI:83,PO:84,AT:85,RN:86,FR:87,RA:88,AC:89,TH:90,PA:91,U:92,NP:93,PU:94,AM:95,CM:96,BK:97,CF:98,ES:99,FM:100,MD:101,NO:102,LR:103,RF:104,DB:105,SG:106,BH:107,HS:108,MT:109},o2={1:1.1,2:1.4,3:1.81,4:1.53,5:1.92,6:1.7,7:1.55,8:1.52,9:1.47,10:1.54,11:2.27,12:1.73,13:1.84,14:2.1,15:1.8,16:1.8,17:1.75,18:1.88,19:2.75,20:2.31,21:2.3,22:2.15,23:2.05,24:2.05,25:2.05,26:2.05,27:2,28:2,29:2,30:2.1,31:1.87,32:2.11,33:1.85,34:1.9,35:1.83,36:2.02,37:3.03,38:2.49,39:2.4,40:2.3,41:2.15,42:2.1,43:2.05,44:2.05,45:2,46:2.05,47:2.1,48:2.2,49:2.2,50:1.93,51:2.17,52:2.06,53:1.98,54:2.16,55:3.43,56:2.68,57:2.5,58:2.48,59:2.47,60:2.45,61:2.43,62:2.42,63:2.4,64:2.38,65:2.37,66:2.35,67:2.33,68:2.32,69:2.3,70:2.28,71:2.27,72:2.25,73:2.2,74:2.1,75:2.05,76:2,77:2,78:2.05,79:2.1,80:2.05,81:1.96,82:2.02,83:2.07,84:1.97,85:2.02,86:2.2,87:3.48,88:2.83,89:2,90:2.4,91:2,92:2.3,93:2,94:2,95:2,96:2,97:2,98:2,99:2,100:2,101:2,102:2,103:2,104:2,105:2,106:2,107:2,108:2,109:2},s2={1:1.008,2:4.0026,3:6.94,4:9.0122,5:10.81,6:10.81,7:14.007,8:15.999,9:18.998,10:20.18,11:22.99,12:24.305,13:26.982,14:28.085,15:30.974,16:32.06,17:35.45,18:39.948,19:39.098,20:40.078,21:44.956,22:47.867,23:50.942,24:51.996,25:54.938,26:55.845,27:58.933,28:58.693,29:63.546,30:65.38,31:69.723,32:72.63,33:74.922,34:78.971,35:79.904,36:83.798,37:85.468,38:87.62,39:88.906,40:91.224,41:92.906,42:95.95,43:96.906,44:101.07,45:102.91,46:106.42,47:107.87,48:112.41,49:114.82,50:118.71,51:121.76,52:127.6,53:127.6,54:131.29,55:132.91,56:137.33,57:138.91,58:140.12,59:140.91,60:144.24,61:144.912,62:150.36,63:151.96,64:157.25,65:158.93,66:162.5,67:164.93,68:167.26,69:168.93,70:173.05,71:174.97,72:178.49,73:180.95,74:183.84,75:186.21,76:190.23,77:192.22,78:195.08,79:196.97,80:200.59,81:204.38,82:207.2,83:208.98,84:1.97,85:2.02,86:2.2,87:3.48,88:2.83,89:2,90:232.04,91:231.04,92:238.03,93:237.048,94:244.064,95:243.061,96:247.07,97:247.07,98:251.079,99:252.083,100:257.095,101:258.098,102:259.101,103:262.11,104:267.122,105:270.131,106:271.134,107:270.133,108:270.134,109:278.156},a2=1.7,c2=10.81,u2=0;function hd(e){let t=gc[e];return t===void 0?a2:o2[t]}function BS(e){let t=gc[e];return t===void 0?c2:s2[t]}function _d(e){let t=gc[e];return t===void 0?u2:t}function pn(){return pn.zero()}(function(e){function t(){let w=[.1,0,0];return w[0]=0,w}e.zero=t;function n(w,D,z){let ie=t();return ie[0]=w,ie[1]=D,ie[2]=z,ie}e.create=n;function r(w,D,z,ie){return w[0]=D,w[1]=z,w[2]=ie,w}e.set=r;function i(w,D){let z=D[0]-w[0],ie=D[1]-w[1],O=D[2]-w[2];return Math.sqrt(z*z+ie*ie+O*O)}e.distance=i;function o(w,D){let[z,ie,O]=Cn.toRgb(D),[Q,K,Z]=L(z,ie,O),se=116*K-16;return w[0]=se<0?0:se,w[1]=500*(Q-K),w[2]=200*(K-Z),w}e.fromColor=o;function s(w,D){return Hn.toLab(w,D)}e.fromHcl=s;function a(w){let D=(w[0]+16)/116,z=isNaN(w[1])?D:D+w[1]/500,ie=isNaN(w[2])?D:D-w[2]/200;D=y*S(D),z=x*S(z),ie=g*S(ie);let O=E(3.2404542*z-1.5371385*D-.4985314*ie),Q=E(-.969266*z+1.8760108*D+.041556*ie),K=E(.0556434*z-.2040259*D+1.0572252*ie);return Cn.fromRgb(Math.round(Fn(O,0,255)),Math.round(Fn(Q,0,255)),Math.round(Fn(K,0,255)))}e.toColor=a;function c(w,D){let[z,ie,O]=D,Q=Math.sqrt(ie*ie+O*O),K=(On(Math.atan2(O,ie))+360)%360;return Math.round(Q*1e4)===0&&(K=Number.NaN),w[0]=K,w[1]=Q,w[2]=z,w}e.toHcl=c;function u(w,D){return w[0]=D[0],w[1]=D[1],w[2]=D[2],w}e.copy=u;function l(w,D,z){return w[0]=D[0]-h*z,w[1]=D[1],w[2]=D[2],w}e.darken=l;function m(w,D,z){return l(w,D,-z)}e.lighten=m;let f=[0,0,0];function d(w,D,z){return c(f,D),Hn.toLab(w,Hn.saturate(f,f,z))}e.saturate=d;function p(w,D,z){return d(w,D,-z)}e.desaturate=p;let h=18,x=.95047,y=1,g=1.08883,C=.137931034,_=.206896552,b=.12841855,I=.008856452;function E(w){return 255*(w<=.00304?12.92*w:1.055*Math.pow(w,1/2.4)-.055)}function S(w){return w>_?w*w*w:b*(w-C)}function v(w){return(w/=255)<=.04045?w/12.92:Math.pow((w+.055)/1.055,2.4)}function P(w){return w>I?Math.pow(w,1/3):w/b+C}function L(w,D,z){w=v(w),D=v(D),z=v(z);let ie=P((.4124564*w+.3575761*D+.1804375*z)/x),O=P((.2126729*w+.7151522*D+.072175*z)/y),Q=P((.0193339*w+.119192*D+.9503041*z)/g);return[ie,O,Q]}})(pn||(pn={}));function Hn(){return Hn.zero()}(function(e){function t(){let g=[.1,0,0];return g[0]=0,g}e.zero=t;function n(g,C,_){let b=t();return b[0]=g,b[1]=C,b[2]=_,b}e.create=n;function r(g,C,_,b){return g[0]=C,g[1]=_,g[2]=b,g}e.set=r;function i(g){return!isNaN(g[0])}e.hasHue=i;let o=[0,0,0];function s(g,C){return pn.toHcl(g,pn.fromColor(o,C))}e.fromColor=s;function a(g,C){return pn.toHcl(g,C)}e.fromLab=a;let c=[0,0,0];function u(g){return pn.toColor(l(c,g))}e.toColor=u;function l(g,C){let[_,b,I]=C;return isNaN(_)&&(_=0),_=Kn(_),g[0]=I,g[1]=Math.cos(_)*b,g[2]=Math.sin(_)*b,g}e.toLab=l;function m(g,C){return g[0]=C[0],g[1]=C[1],g[2]=C[2],g}e.copy=m;function f(g,C,_){return g[0]=C[0],g[1]=Math.max(0,C[1]+y*_),g[2]=C[2],g}e.saturate=f;function d(g,C,_){return f(g,C,-_)}e.desaturate=d;let p=[0,0,0];function h(g,C,_){return l(p,C),pn.toHcl(g,pn.darken(p,p,_))}e.darken=h;function x(g,C,_){return h(g,C,-_)}e.lighten=x;let y=18})(Hn||(Hn={}));function Cn(e){return e}(function(e){function t(O){return`rgb(${O>>16&255}, ${O>>8&255}, ${O&255})`}e.toStyle=t;function n(O){return"#"+("000000"+O.toString(16)).slice(-6)}e.toHexStyle=n;function r(O){return"0x"+("000000"+O.toString(16)).slice(-6)}e.toHexString=r;function i(O){return`RGB: ${e.toRgb(O).join(", ")}`}e.toRgbString=i;function o(O){return[O>>16&255,O>>8&255,O&255]}e.toRgb=o;function s(O){return[(O>>16&255)/255,(O>>8&255)/255,(O&255)/255]}e.toRgbNormalized=s;function a(O){return parseInt(O.replace("#","0x"))}e.fromHexStyle=a;function c(O){return parseInt(O)}e.fromHexString=c;function u(O,Q,K){return O<<16|Q<<8|K}e.fromRgb=u;function l(O,Q,K){return O*255<<16|Q*255<<8|K*255}e.fromNormalizedRgb=l;function m(O,Q){return u(O[Q],O[Q+1],O[Q+2])}e.fromArray=m;function f(O,Q){return l(O[Q],O[Q+1],O[Q+2])}e.fromNormalizedArray=f;function d(O,Q,K){return Q[K]=O>>16&255,Q[K+1]=O>>8&255,Q[K+2]=O&255,Q}e.toArray=d;function p(O,Q,K){return Q[K]=(O>>16&255)/255,Q[K+1]=(O>>8&255)/255,Q[K+2]=(O&255)/255,Q}e.toArrayNormalized=p;function h(O,Q){return O[0]=Q>>16&255,O[1]=Q>>8&255,O[2]=Q&255,O}e.toVec3=h;function x(O,Q){return O[0]=(Q>>16&255)/255,O[1]=(Q>>8&255)/255,O[2]=(Q&255)/255,O}e.toVec3Normalized=x;function y(O,Q,K){let Z=O>>16&255,se=O>>8&255,fe=O&255,Ce=Q>>16&255,xe=Q>>8&255,H=Q&255,$=Z+(Ce-Z)*K,de=se+(xe-se)*K,T=fe+(H-fe)*K;return $<<16|de<<8|T}e.interpolate=y;function g(O){let Q=O>>16&255,K=O>>8&255,Z=O&255;return Q!==K||Q!==Z}e.hasHue=g;let C=[0,0,0];function _(O,Q){return g(O)?(Hn.fromColor(C,O),Hn.toColor(Hn.saturate(C,C,Q))):O}e.saturate=_;function b(O,Q){return _(O,-Q)}e.desaturate=b;let I=[0,0,0];function E(O,Q){return pn.fromColor(I,O),pn.toColor(pn.darken(I,I,Q))}e.darken=E;function S(O,Q){return E(O,-Q)}e.lighten=S;function v(O){return O<=.03928?O/12.92:Math.pow((O+.055)/1.055,2.4)}function P(O){let Q=v((O>>16&255)/255),K=v((O>>8&255)/255),Z=v((O&255)/255);return .2126*Q+.7152*K+.0722*Z}e.luminance=P;function L(O,Q){let K=P(O),Z=P(Q);return K>Z?(K+.05)/(Z+.05):(Z+.05)/(K+.05)}e.contrast=L;function w(O){return O<.04045?O*.0773993808:Math.pow(O*.9478672986+.0521327014,2.4)}function D(O){return l(w((O>>16&255)/255),w((O>>8&255)/255),w((O&255)/255))}e.sRGBToLinear=D;function z(O){return O<.0031308?O*12.92:1.055*Math.pow(O,.41666)-.055}function ie(O){return l(z((O>>16&255)/255),z((O>>8&255)/255),z((O&255)/255))}e.linearToSRGB=ie})(Cn||(Cn={}));function ut(e,t,n,r){return{label:e,description:n,list:r,type:t}}function VS(e,t,n){let r={};for(let i in e){let o=e[i];o=Cn.saturate(o,t),o=Cn.darken(o,-n),r[i]=o}return r}function gd(e,t=" "){return e.replace(/([a-z\xE0-\xFF])([A-Z\xC0\xDF])/g,`$1${t}$2`)}function jS(e){return ws(gd(e))}var l2=e=>e.toUpperCase();function YS(e){return e?typeof e=="string"?e.toUpperCase():`${e}`.toUpperCase():""}function ws(e){return e.toLowerCase().replace(/^\w|\s\w/g,l2)}function f2(e){return e.replace(/_/g," ")}function d2(e){return e.replace(/-/g," ")}function Lr(e){return ws(gd(f2(d2(e))))}function ZS(e,t,n,r){let i=r.length;if(i>n-t)return!1;for(let o=0;o<i;o++)if(e.charCodeAt(t+o)!==r.charCodeAt(o))return!1;return!0}function WS(e,t){let n=Object.keys(t),r=Object.values(t);return new Function(...n,`return \`${e}\`;`)(...r)}function XS(e){return e.replace(/<\/?[^>]+>/g,"")}function $S(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}var gr={"orange-red":ut("Orange-Red","sequential","Orange-Red, sequential color scheme from ColorBrewer 2.0",[16775148,16705736,16635038,16628612,16551257,15689032,14102559,11730944,8323072]),"purple-blue":ut("Purple-Blue","sequential","Purple-Blue, sequential color scheme from ColorBrewer 2.0",[16775163,15525874,13685222,10927579,7645647,3576e3,356528,285325,145496]),"blue-purple":ut("Blue-Purple","sequential","Blue-Purple, sequential color scheme from ColorBrewer 2.0",[16252157,14740724,12571622,10403034,9213638,9202609,8929693,8458108,5046347]),oranges:ut("Oranges","sequential","",[16774635,16705230,16634018,16625259,16616764,15821075,14239745,10892803,8333060]),"blue-green":ut("Blue-Green","sequential","",[16252157,15070713,13429990,10082505,6734500,4304502,2329413,27948,17435]),"yellow-orange-brown":ut("Yellow-Orange-Brown","sequential","",[16777189,16775100,16704401,16696399,16685353,15495188,13388802,10040324,6694150]),"yellow-green":ut("Yellow-Green","sequential","",[16777189,16252089,14282915,11394446,7915129,4303709,2327619,26679,17705]),reds:ut("Reds","sequential","",[16774640,16703698,16563105,16552562,16476746,15678252,13309981,10817301,6750221]),"red-purple":ut("Red-Purple","sequential","",[16775155,16638173,16565696,16424885,16214177,14496919,11403646,7995767,4784234]),greens:ut("Greens","sequential","",[16252149,15070688,13101504,10607003,7652470,4303709,2329413,27948,17435]),"yellow-green-blue":ut("Yellow-Green-Blue","sequential","",[16777177,15595697,13101492,8375739,4306628,1937856,2252456,2438292,531800]),purples:ut("Purples","sequential","",[16579581,15724021,14342891,12369372,10394312,8420794,6967715,5515151,4128893]),"green-blue":ut("Green-Blue","sequential","",[16252144,14742491,13429701,11066805,8113348,5157843,2854078,551084,540801]),greys:ut("Greys","sequential","",[16777215,15790320,14277081,12434877,9868950,7566195,5395026,2434341,0]),"yellow-orange-red":ut("Yellow-Orange-Red","sequential","",[16777164,16772512,16701814,16691788,16616764,16535082,14883356,12386342,8388646]),"purple-red":ut("Purple-Red","sequential","",[16250105,15196655,13941210,13210823,14640560,15149450,13505110,9961539,6750239]),blues:ut("Blues","sequential","",[16251903,14609399,13032431,10406625,7057110,4362950,2191797,545180,536683]),"purple-blue-green":ut("Purple-Blue-Green","sequential","",[16775163,15524592,13685222,10927579,6793679,3576e3,164234,93273,83510]),spectral:ut("Spectral","diverging","",[10355010,13975119,16018755,16625249,16703627,16777151,15136152,11263396,6734501,3311805,6180770]),"red-yellow-green":ut("Red-Yellow-Green","diverging","",[10813478,14102567,16018755,16625249,16703627,16777151,14282635,10934634,6733155,1742928,26679]),"red-blue":ut("Red-Blue","diverging","",[6750239,11671595,14049357,16033154,16636871,16250871,13755888,9618910,4428739,2188972,340065]),"pink-yellow-green":ut("Pink-Yellow-Green","diverging","",[9306450,12917629,14579630,15840986,16638191,16250871,15136208,12116358,8371265,5083681,2581529]),"purple-green":ut("Purple-Green","diverging","",[4194379,7744131,10055851,12756431,15193320,16250871,14282963,10935200,5942881,1800247,17435]),"red-yellow-blue":ut("Red-Yellow-Blue","diverging","Red-Yellow-Blue, diverging color scheme from ColorBrewer 2.0",[10813478,14102567,16018755,16625249,16703632,16777151,14742520,11262441,7646673,4552116,3225237]),"brown-white-green":ut("Brown-White-Green","diverging","",[5517317,9195786,12550445,14664317,16181443,16119285,13101797,8441281,3512207,91742,15408]),"red-grey":ut("Red-Grey","diverging","",[6750239,11671595,14049357,16033154,16636871,16777215,14737632,12237498,8882055,5066061,1710618]),"orange-purple":ut("Orange-Purple","diverging","",[8338184,11753478,14713364,16627811,16703670,16250871,14211819,11709394,8418220,5515144,2949195]),"set-2":ut("Set-2","qualitative","",[6734501,16551266,9281739,15174339,10934356,16767279,15058068,11776947]),accent:ut("Accent","qualitative","",[8374655,12496596,16629894,16777113,3697840,15729279,12540695,6710886]),"set-1":ut("Set-1","qualitative","",[14948892,3636920,5091146,9981603,16744192,16777011,10901032,16220607,10066329]),"set-3":ut("Set-3","qualitative","",[9294791,16777139,12499674,16482418,8434131,16626786,11787881,16567781,14277081,12353725,13429701,16772463]),"dark-2":ut("Dark-2","qualitative","",[1810039,14245634,7696563,15149450,6727198,15117058,10909213,6710886]),paired:ut("Paired","qualitative","",[10931939,2062516,11722634,3383340,16489113,14883356,16629615,16744192,13284054,6962586,16777113,11622696]),"pastel-2":ut("Pastel-2","qualitative","",[11789005,16633260,13358568,16042724,15136201,16773806,15852236,13421772]),"pastel-1":ut("Pastel-1","qualitative","",[16495790,11783651,13429701,14601188,16701862,16777164,15063229,16636652,15921906]),"many-distinct":ut("Many-Distinct","qualitative","",[1810039,14245634,7696563,15149450,6727198,15117058,10909213,6710886,14948892,3636920,5091146,9981603,16744192,16777011,10901032,16220607,10066329,6734501,16551266,9281739,15174339,10934356,16767279,15058068,11776947]),magma:ut("Magma","sequential","Perceptually uniform shades of black-red-white",[4329332,4853881,5378684,5903742,6363263,6888576,7413633,7938689,8463745,8988801,9513600,10038655,10563454,11088508,11613562,12138360,12728949,13254258,13714030,14239338,14699366,15094114,15489119,15753309,16017499,16216411,16350045,16483424,16551523,16619368,16621934,16689780,16692091,16694402,16696969,16633746,16636058,16638371,16575148,16577461,16514239]),inferno:ut("Inferno","sequential","Perceptually uniform shades of black-red-yellow",[4721514,5246316,5771373,6296430,6821486,7346542,7871597,8396651,8921450,9446504,9971557,10496610,10956127,11481435,12006486,12466258,12926285,13386056,13780802,14241085,14570295,14965297,15229227,15558693,15757342,15956248,16154897,16288267,16421638,16489734,16492043,16494612,16496926,16368426,16305463,16111429,15982678,15853928,15856253,16119953,16580260]),plasma:ut("Plasma","sequential","Perceptually uniform shades of blue-red-yellow",[1771148,2426257,3081365,3671193,4195228,4784799,5308834,5833124,6357158,6815911,7340200,7864744,8324007,8783782,9309348,9769377,10164126,10624154,11018902,11413393,11808141,12137352,12466307,12795519,13124730,13453685,13717361,14046573,14309992,14573668,14837344,15035483,15299159,15497299,15695438,15893834,16091974,16224833,16357693,16425017,16557877,16625457,16627245,16629289,16631334,16567845,16438820,16310052,16115494,15921190,15726625]),viridis:ut("Viridis","sequential","Perceptually uniform shades of blue-green-yellow",[4524123,4656994,4658793,4726127,4727668,4663929,4599933,4535937,4406404,4276870,4081800,3952010,3822475,3627148,3497356,3302029,3172237,3042446,2912654,2782862,2652814,2523022,2393229,2328973,2198924,2069132,2004874,2005897,2007175,2139525,2337154,2666111,3060348,3520376,4045684,4570991,5227369,5883748,6605661,7392854,8180303,8967495,9819967,10672695,11525166,12443174,13295646,14148121,15000344,15852828,16639780]),cividis:ut("Cividis","sequential","Perceptually uniform shades of blue-green-yellow, should look effectively identical to colorblind and non-colorblind users",[11367,12400,537456,1455727,2046574,2571629,3031404,3425388,3754092,4148075,4476779,4805227,5133932,5396844,5725549,5988462,6317166,6580079,6843249,7171698,7434867,7697781,7960951,8289656,8618104,8881272,9209976,9538679,9867127,10195830,10524533,10853235,11181938,11510640,11839343,12168045,12497002,12891240,13219941,13548642,13943134,14271834,14666326,14995025,15389516,15718470,16112703,16507190,16639799]),twilight:ut("Twilight","sequential","Perceptually uniform shades of white-blue-black-red-white, cyclic",[14670305,14211037,13554648,12766675,11847630,10993866,10139847,9351365,8628419,8036290,7509952,7048895,6718653,6519739,6386105,6252470,6184114,6181293,6112935,6044831,5976470,5777291,5447293,5052270,4592479,4067665,3674181,3281211,3150646,3543352,4067644,4657728,5379141,6166345,6953549,7741007,8463184,9120336,9777743,10304079,10830671,11291984,11687762,12083541,12348505,12613471,12878439,13077872,13211771,13411209,13545111,13809830,14074293,14338756,14537169,14735067,14801121]),turbo:ut("Turbo","sequential","Improved (smooth) rainbow colormap for visualization",[4866485,4872413,4354034,3770361,3120629,2667241,2475736,2611140,3073454,3928216,5109892,6487408,8126047,9829201,11531332,13167162,14605618,15780908,16693543,16753699,16748063,16741916,16146200,15026195,13644558,12198408,10818563,9833728]),rainbow:ut("Rainbow","sequential","",[3367393,3516485,16383744,15501073,12526114]),"red-white-blue":ut("Red-White-Blue","diverging","",[12526114,16777215,3367393])},m2=Object.keys(gr),yd=m2.map(e=>[e,gr[e].label,ws(gr[e].type)]),tI=yd.filter(e=>gr[e[0]].type==="diverging"||gr[e[0]].type==="sequential"),nI=yd.filter(e=>gr[e[0]].type==="qualitative");function vs(e){return e in gr?gr[e]:(console.warn(`unknown color list named '${e}'`),gr["red-yellow-blue"])}function iI(e){return{kind:"table-legend",table:e}}function xd(e,t,n){return{kind:"scale-legend",minLabel:e,maxLabel:t,colors:n}}var p2={domain:[0,1],reverse:!1,listOrName:"red-yellow-blue",minLabel:"",maxLabel:""},yc;(function(e){function t(n){let{domain:r,reverse:i,listOrName:o}=Le(Le({},p2),n),s=typeof o=="string"?vs(o).list:o,a=i?s.slice().reverse():s,c=a.length-1,u=0,l=0,m=0;function f(y,g){l=y,m=g,u=m-l||1}f(r[0],r[1]);let d=va(n.minLabel,l.toString()),p=va(n.maxLabel,m.toString()),h;if(a.every(y=>Array.isArray(y))){let y=[...a];y.sort((b,I)=>b[1]-I[1]);let g=y.map(b=>b[0]),C=le.ofSortedArray(y.map(b=>b[1])),_=g.length-1;h=b=>{let I=Fn((b-l)/u,0,1),E=le.findPredecessorIndex(C,I);if(E===0)return g[l];if(E>_)return g[_];let S=C[E-1],v=C[E],P=Fn((I-S)/(v-S),0,1);return Cn.interpolate(g[E-1],g[E],P)}}else h=y=>{let g=Math.min(a.length-1,Math.max(0,(y-l)/u*c)),C=Math.floor(g),_=a[C],b=a[Math.ceil(g)];return Cn.interpolate(_,b,g-C)};return{color:h,colorToArray:(y,g,C)=>{Cn.toArray(h(y),g,C)},normalizedColorToArray:(y,g,C)=>{Cn.toArrayNormalized(h(y),g,C)},setDomain:f,get legend(){return xd(d,p,a)}}}e.create=t})(yc||(yc={}));var xc=new Set(["145","147","149","289","291","293","445","475","491","510","604","045","05L","07E","07Y","08U","09X","0AT","0BD","0H0","0HX","0LP","0MK","0NZ","0TS","0UB","0V4","0WK","0XY","0YT","10M","12E","14T","15L","16F","16G","16O","17T","18D","18O","18T","1AR","1BW","1CF","1FT","1GL","1GN","1JB","1LL","1NA","1S3","1S4","1SD","1X4","20S","20X","22O","22S","23V","24S","25E","26M","26O","26Q","26R","26V","26W","26Y","27C","2DG","2DR","2F8","2FG","2FL","2FP","2GL","2GS","2H5","2HA","2M4","2M5","2M8","2OS","2SI","2WP","2WS","32O","34V","38J","3BU","3CM","3DO","3DY","3FM","3GR","3HD","3J3","3J4","3LJ","3LR","3MF","3MG","3MK","3R3","3S6","3SA","3YW","40J","42D","44S","46D","46M","46Z","48Z","49A","49S","49T","49V","4AM","4CQ","4GC","4GL","4GP","4JA","4N2","4NN","4QY","4R1","4RS","4SG","4U0","4U1","4U2","4UZ","4V5","50A","51N","56N","57S","5DI","5GF","5GO","5II","5KQ","5KS","5KT","5KV","5L2","5L3","5LS","5LT","5MM","5N6","5QP","5RP","5SA","5SP","5TH","5TJ","5TK","5TM","61J","62I","64K","66O","6BG","6C2","6DM","6GB","6GP","6GR","6K3","6KH","6KL","6KS","6KU","6KW","6LA","6LS","6LW","6MJ","6MN","6PG","6PY","6PZ","6S2","6SA","6UD","6Y6","6YR","6ZC","73E","79J","7CV","7D1","7GP","7JZ","7K2","7K3","7NU","7SA","83Y","89Y","8B7","8B9","8EX","8GA","8GG","8GP","8I4","8LM","8LR","8OQ","8PK","8S0","8YV","95Z","96O","98U","9AM","9C1","9CD","9GP","9KJ","9MR","9OK","9PG","9QG","9QZ","9RN","9S7","9SG","9SJ","9SM","9SP","9T1","9T7","9VP","9WJ","9WN","9WZ","9YW","A0K","A1AIO","A1Q","A2G","A5C","A6P","AAL","AAO","ABC","ABD","ABE","ABF","ABL","AC1","ACG","ACR","ACX","ADA","ADG","ADR","AF1","AFD","AFL","AFO","AFP","AFR","AGC","AGH","AGL","AGR","AH2","AH8","AHG","AHM","AHR","AIG","ALL","ALX","AMG","AMN","AMU","AMV","ANA","AOG","AOS","AQA","ARA","ARB","ARE","ARI","ARW","ASC","ASG","ASO","AXP","AXR","AY9","AZC","B0D","B16","B1H","B1N","B2G","B4G","B6D","B7G","B8D","B9D","BBK","BBV","BCD","BCW","BDF","BDG","BDP","BDR","BDZ","BEM","BFN","BFP","BG6","BG8","BGC","BGL","BGN","BGP","BGS","BHG","BM3","BM7","BMA","BMX","BND","BNG","BNX","BO1","BOG","BQY","BRI","BS7","BTG","BTU","BW3","BWG","BXF","BXP","BXX","BXY","BZD","C3B","C3G","C3X","C4B","C4W","C4X","C5X","CAP","CBF","CBI","CBK","CDR","CE5","CE6","CE8","CEG","CEX","CEY","CEZ","CGF","CJB","CKB","CKP","CNP","CR1","CR6","CRA","CT3","CTO","CTR","CTT","D0N","D1M","D5E","D6G","DAF","DAG","DAN","DDA","DDB","DDL","DEG","DEL","DFR","DFX","DG0","DGC","DGD","DGM","DGO","DGS","DGU","DIG","DJB","DJE","DK4","DKX","DKZ","DL6","DLD","DLF","DLG","DMU","DNO","DO8","DOM","DP5","DPC","DQQ","DQR","DR2","DR3","DR4","DR5","DRI","DSR","DT6","DVC","DYM","E3M","E4P","E5G","EAG","EBG","EBQ","EEN","EEQ","EGA","EJT","EMP","EMZ","EPG","EQP","EQV","ERE","ERI","ETT","EUS","F1P","F1X","F55","F58","F6P","F8X","FBP","FCA","FCB","FCT","FDP","FDQ","FFC","FFX","FIF","FIX","FK9","FKD","FMF","FMO","FNG","FNY","FRU","FSA","FSI","FSM","FSR","FSW","FU4","FUB","FUC","FUD","FUF","FUL","FUY","FVQ","FX1","FYJ","G0S","G16","G1P","G20","G28","G2F","G3F","G3I","G4D","G4S","G6D","G6P","G6S","G7P","G8Z","GAA","GAC","GAD","GAF","GAL","GAT","GBH","GC1","GC4","GC9","GCB","GCD","GCN","GCO","GCS","GCT","GCU","GCV","GCW","GDA","GDL","GE1","GE3","GFP","GIV","GL0","GL1","GL2","GL4","GL5","GL6","GL7","GL9","GLA","GLB","GLC","GLD","GLF","GLG","GLO","GLP","GLS","GLT","GLW","GM0","GMB","GMH","GMT","GMZ","GN1","GN4","GNS","GNX","GP0","GP1","GP4","GPH","GPK","GPM","GPO","GPQ","GPU","GPV","GPW","GQ1","GRF","GRX","GS1","GS4","GS9","GSA","GSD","GTE","GTH","GTK","GTM","GTR","GU0","GU1","GU2","GU3","GU4","GU5","GU6","GU8","GU9","GUF","GUL","GUP","GUZ","GXL","GXV","GYE","GYG","GYP","GYU","GYV","GZL","H1M","H1S","H2P","H3S","H53","H6Q","H6Z","HBZ","HD4","HDL","HMS","HNV","HNW","HSG","HSH","HSJ","HSQ","HSR","HSU","HSX","HSY","HSZ","HTG","HTM","HVC","I57","IAB","IDC","IDF","IDG","IDR","IDS","IDT","IDU","IDX","IDY","IEM","IN1","IPT","ISD","ISL","ISX","IVG","IXD","J5B","JFZ","JHM","JLT","JRV","JS2","JSV","JV4","JVA","JVS","JZR","K5B","K99","KBA","KBG","KD5","KDA","KDB","KDD","KDE","KDF","KDM","KDN","KDO","KDR","KFN","KG1","KGM","KHP","KME","KO1","KO2","KOT","KQC","KTU","L1L","L6N","L6S","L6T","LAG","LAH","LAI","LAK","LAO","LAT","LB2","LBS","LBT","LCN","LDY","LEC","LER","LFC","LFR","LGC","LGU","LKA","LKS","LM2","LMO","LMT","LMU","LNV","LOG","LOX","LPK","LRH","LSM","LTG","LTM","LVO","LVZ","LXB","LXC","LXZ","LZ0","M1F","M1P","M2F","M3M","M3N","M55","M6D","M6P","M7B","M7P","M8C","MA1","MA2","MA3","MA8","MAB","MAF","MAG","MAL","MAN","MAT","MAV","MAW","MBE","MBF","MBG","MCU","MDA","MDP","MFA","MFB","MFU","MG5","MGA","MGC","MGL","MGS","MJJ","MLB","MLR","MMA","MMN","MN0","MNA","MQG","MQT","MRH","MRP","MSX","MTT","MUB","MUG","MUR","MVP","MXY","MXZ","MYG","N1L","N3U","N9S","NA1","NAA","NAG","NBG","NBX","NBY","NDG","NED","NFG","NG1","NG6","NGA","NGB","NGC","NGE","NGF","NGK","NGL","NGR","NGS","NGY","NGZ","NHF","NLC","NM6","NM9","NNG","NPF","NSQ","NT1","NTF","NTO","NTP","NXD","NYT","O1G","OAK","OEL","OI7","OPM","ORP","OSU","OTG","OTN","OTU","OX2","P53","P6P","P8E","PA1","PA5","PAV","PDX","PH5","PKM","PNA","PNG","PNJ","PNW","PPC","PRP","PSG","PSJ","PSV","PTQ","PUF","PZU","QDK","QIF","QKH","QPS","QV4","R1P","R1X","R2B","R2G","R5P","RAA","RAE","RAF","RAM","RAO","RAT","RB5","RBL","RCD","RDP","REL","RER","RF5","RG1","RGG","RHA","RHC","RI2","RIB","RIP","RM4","RNS","RNT","ROB","ROR","RP3","RP5","RP6","RPA","RR7","RRJ","RRY","RST","RTG","RTV","RUB","RUG","RUU","RV7","RVG","RVM","RWI","RY7","RZM","S6P","S7P","S81","SA0","SCG","SCR","SDD","SDY","SEJ","SF6","SF9","SFJ","SFU","SG4","SG5","SG6","SG7","SGA","SGC","SGD","SGN","SGS","SHB","SHD","SHG","SI3","SIA","SID","SIO","SIZ","SLB","SLM","SLT","SMD","SN5","SNG","SOE","SOG","SOL","SOR","SR1","SSG","SSH","STW","STZ","SUC","SUP","SUS","SWE","SZZ","T68","T6D","T6P","T6T","TA6","TAG","TCB","TCG","TDG","TEU","TF0","TFU","TGA","TGK","TGR","TGY","TH1","TM5","TM6","TM9","TMR","TMX","TNX","TOA","TOC","TQY","TRE","TRV","TS8","TT7","TTV","TTZ","TU4","TUG","TUJ","TUP","TUR","TVD","TVG","TVM","TVS","TVV","TVY","TW7","TWA","TWD","TWG","TWJ","TWY","TXB","TY6","TYV","U1Y","U2A","U2D","U63","U8V","U97","U9A","U9D","U9G","U9J","U9M","UAP","UBH","UBO","UCD","UDC","UEA","V3M","V3P","V71","VDF","VG1","VJ1","VJ4","VKN","VTB","W9T","WIA","WOO","WUN","WZ1","WZ2","WZ4","X0X","X1P","X1X","X2F","X2Y","X34","X4S","X5S","X6X","X6Y","XBP","XDP","XDX","XGP","XIL","XKJ","XLF","XLS","XMM","XS2","XUL","XXM","XXR","XXX","XY6","XY9","XYB","XYF","XYL","XYP","XYS","XYT","XYZ","YDR","YIO","YJM","YKR","YO5","YX0","YX1","YYB","YYD","YYH","YYJ","YYK","YYM","YYQ","YYR","YZ0","YZT","Z0F","Z15","Z16","Z2D","Z2T","Z3K","Z3L","Z3Q","Z3U","Z4K","Z4R","Z4S","Z4U","Z4V","Z4W","Z4Y","Z57","Z5J","Z5L","Z61","Z6G","Z6H","Z6J","Z6W","Z8H","Z8T","Z9D","Z9E","Z9H","Z9K","Z9L","Z9M","Z9N","Z9W","ZB0","ZB1","ZB2","ZB3","ZCD","ZCZ","ZD0","ZDC","ZDM","ZDO","ZEE","ZEL","ZGE","ZMR","UMQ","SQD"]);var Zt=function(e){return e[e.FilledSphere=0]="FilledSphere",e[e.FilledCube=1]="FilledCube",e[e.CrossedCube=2]="CrossedCube",e[e.DividedDiamond=3]="DividedDiamond",e[e.FilledCone=4]="FilledCone",e[e.DevidedCone=5]="DevidedCone",e[e.FlatBox=6]="FlatBox",e[e.FilledStar=7]="FilledStar",e[e.FilledDiamond=8]="FilledDiamond",e[e.FlatDiamond=9]="FlatDiamond",e[e.FlatHexagon=10]="FlatHexagon",e[e.Pentagon=11]="Pentagon",e[e.DiamondPrism=12]="DiamondPrism",e[e.PentagonalPrism=13]="PentagonalPrism",e[e.HexagonalPrism=14]="HexagonalPrism",e[e.HeptagonalPrism=15]="HeptagonalPrism",e}(Zt||{}),qe={Blue:37052,Green:42577,Yellow:16765952,Orange:16021792,Pink:16162465,Purple:10830745,LightBlue:9424105,Brown:10582605,Red:15539236,Secondary:15854817},De=function(e){return e[e.Hexose=0]="Hexose",e[e.HexNAc=1]="HexNAc",e[e.Hexosamine=2]="Hexosamine",e[e.Hexuronate=3]="Hexuronate",e[e.Deoxyhexose=4]="Deoxyhexose",e[e.DeoxyhexNAc=5]="DeoxyhexNAc",e[e.DiDeoxyhexose=6]="DiDeoxyhexose",e[e.Pentose=7]="Pentose",e[e.Deoxynonulosonate=8]="Deoxynonulosonate",e[e.DiDeoxynonulosonate=9]="DiDeoxynonulosonate",e[e.Unknown=10]="Unknown",e[e.Assigned=11]="Assigned",e}(De||{}),bI={[De.Hexose]:"Hexose",[De.HexNAc]:"HexNAc",[De.Hexosamine]:"Hexosamine",[De.Hexuronate]:"Hexuronate",[De.Deoxyhexose]:"Deoxyhexose",[De.DeoxyhexNAc]:"DeoxyhexNAc",[De.DiDeoxyhexose]:"Di-deoxyhexose",[De.Pentose]:"Pentose",[De.Deoxynonulosonate]:"Deoxynonulosonate",[De.DiDeoxynonulosonate]:"Di-deoxynonulosonate",[De.Unknown]:"Unknown",[De.Assigned]:"Assigned"};var _2={[De.Hexose]:Zt.FilledSphere,[De.HexNAc]:Zt.FilledCube,[De.Hexosamine]:Zt.CrossedCube,[De.Hexuronate]:Zt.DividedDiamond,[De.Deoxyhexose]:Zt.FilledCone,[De.DeoxyhexNAc]:Zt.DevidedCone,[De.DiDeoxyhexose]:Zt.FlatBox,[De.Pentose]:Zt.FilledStar,[De.Deoxynonulosonate]:Zt.FilledDiamond,[De.DiDeoxynonulosonate]:Zt.FlatDiamond,[De.Unknown]:Zt.FlatHexagon,[De.Assigned]:Zt.Pentagon};function CI(e,t){return e===De.Unknown?t===4?Zt.DiamondPrism:t===5?Zt.PentagonalPrism:t===6?Zt.HexagonalPrism:t===7?Zt.HeptagonalPrism:Zt.FlatHexagon:_2[e]}var Ps={abbr:"Unk",name:"Unknown",color:qe.Secondary,type:De.Unknown},Fi=[{abbr:"Glc",name:"Glucose",color:qe.Blue,type:De.Hexose},{abbr:"Man",name:"Mannose",color:qe.Green,type:De.Hexose},{abbr:"Gal",name:"Galactose",color:qe.Yellow,type:De.Hexose},{abbr:"Gul",name:"Gulose",color:qe.Orange,type:De.Hexose},{abbr:"Alt",name:"Altrose",color:qe.Pink,type:De.Hexose},{abbr:"All",name:"Allose",color:qe.Purple,type:De.Hexose},{abbr:"Tal",name:"Talose",color:qe.LightBlue,type:De.Hexose},{abbr:"Ido",name:"Idose",color:qe.Brown,type:De.Hexose},{abbr:"GlcNAc",name:"N-Acetyl Glucosamine",color:qe.Blue,type:De.HexNAc},{abbr:"ManNAc",name:"N-Acetyl Mannosamine",color:qe.Green,type:De.HexNAc},{abbr:"GalNAc",name:"N-Acetyl Galactosamine",color:qe.Yellow,type:De.HexNAc},{abbr:"GulNAc",name:"N-Acetyl Gulosamine",color:qe.Orange,type:De.HexNAc},{abbr:"AltNAc",name:"N-Acetyl Altrosamine",color:qe.Pink,type:De.HexNAc},{abbr:"AllNAc",name:"N-Acetyl Allosamine",color:qe.Purple,type:De.HexNAc},{abbr:"TalNAc",name:"N-Acetyl Talosamine",color:qe.LightBlue,type:De.HexNAc},{abbr:"IdoNAc",name:"N-Acetyl Idosamine",color:qe.Brown,type:De.HexNAc},{abbr:"GlcN",name:"Glucosamine",color:qe.Blue,type:De.Hexosamine},{abbr:"ManN",name:"Mannosamine",color:qe.Green,type:De.Hexosamine},{abbr:"GalN",name:"Galactosamine",color:qe.Yellow,type:De.Hexosamine},{abbr:"GulN",name:"Gulosamine",color:qe.Orange,type:De.Hexosamine},{abbr:"AltN",name:"Altrosamine",color:qe.Pink,type:De.Hexosamine},{abbr:"AllN",name:"Allosamine",color:qe.Purple,type:De.Hexosamine},{abbr:"TalN",name:"Talosamine",color:qe.LightBlue,type:De.Hexosamine},{abbr:"IdoN",name:"Idosamine",color:qe.Brown,type:De.Hexosamine},{abbr:"GlcA",name:"Glucuronic Acid",color:qe.Blue,type:De.Hexuronate},{abbr:"ManA",name:"Mannuronic Acid",color:qe.Green,type:De.Hexuronate},{abbr:"GalA",name:"Galacturonic Acid",color:qe.Yellow,type:De.Hexuronate},{abbr:"GulA",name:"Guluronic Acid",color:qe.Orange,type:De.Hexuronate},{abbr:"AltA",name:"Altruronic Acid",color:qe.Pink,type:De.Hexuronate},{abbr:"AllA",name:"Alluronic Acid",color:qe.Purple,type:De.Hexuronate},{abbr:"TalA",name:"Taluronic Acid",color:qe.LightBlue,type:De.Hexuronate},{abbr:"IdoA",name:"Iduronic Acid",color:qe.Brown,type:De.Hexuronate},{abbr:"Qui",name:"Quinovose",color:qe.Blue,type:De.Deoxyhexose},{abbr:"Rha",name:"Rhamnose",color:qe.Green,type:De.Deoxyhexose},{abbr:"6dGul",name:"6-Deoxy Gulose",color:qe.Orange,type:De.Deoxyhexose},{abbr:"6dAlt",name:"6-Deoxy Altrose",color:qe.Pink,type:De.Deoxyhexose},{abbr:"6dTal",name:"6-Deoxy Talose",color:qe.LightBlue,type:De.Deoxyhexose},{abbr:"Fuc",name:"Fucose",color:qe.Red,type:De.Deoxyhexose},{abbr:"QuiNAc",name:"N-Acetyl Quinovosamine",color:qe.Blue,type:De.DeoxyhexNAc},{abbr:"RhaNAc",name:"N-Acetyl Rhamnosamine",color:qe.Green,type:De.DeoxyhexNAc},{abbr:"6dAltNAc",name:"N-Acetyl 6-Deoxy Altrosamine",color:qe.Pink,type:De.DeoxyhexNAc},{abbr:"6dTalNAc",name:"N-Acetyl 6-Deoxy Talosamine",color:qe.LightBlue,type:De.DeoxyhexNAc},{abbr:"FucNAc",name:"N-Acetyl Fucosamine",color:qe.Red,type:De.DeoxyhexNAc},{abbr:"Oli",name:"Olivose",color:qe.Blue,type:De.DiDeoxyhexose},{abbr:"Tyv",name:"Tyvelose",color:qe.Green,type:De.DiDeoxyhexose},{abbr:"Abe",name:"Abequose",color:qe.Orange,type:De.DiDeoxyhexose},{abbr:"Par",name:"Paratose",color:qe.Pink,type:De.DiDeoxyhexose},{abbr:"Dig",name:"Digitoxose",color:qe.Purple,type:De.DiDeoxyhexose},{abbr:"Col",name:"Colitose",color:qe.LightBlue,type:De.DiDeoxyhexose},{abbr:"Ara",name:"Arabinose",color:qe.Green,type:De.Pentose},{abbr:"Lyx",name:"Lyxose",color:qe.Yellow,type:De.Pentose},{abbr:"Xyl",name:"Xylose",color:qe.Orange,type:De.Pentose},{abbr:"Rib",name:"Ribose",color:qe.Pink,type:De.Pentose},{abbr:"Kdn",name:"Keto-Deoxy Nonulonic Acid",color:qe.Green,type:De.Deoxynonulosonate},{abbr:"Neu5Ac",name:"N-Acetyl Neuraminic Acid",color:qe.Purple,type:De.Deoxynonulosonate},{abbr:"Neu5Gc",name:"N-Glycolyl Neuraminic Acid",color:qe.LightBlue,type:De.Deoxynonulosonate},{abbr:"Neu",name:"Neuraminic Acid",color:qe.Brown,type:De.Deoxynonulosonate},{abbr:"Sia",name:"Sialic acid",color:qe.Red,type:De.Deoxynonulosonate},{abbr:"Pse",name:"Pseudaminic Acid",color:qe.Green,type:De.DiDeoxynonulosonate},{abbr:"Leg",name:"Legionaminic Acid",color:qe.Yellow,type:De.DiDeoxynonulosonate},{abbr:"Aci",name:"Acinetaminic Acid",color:qe.Pink,type:De.DiDeoxynonulosonate},{abbr:"4eLeg",name:"4-Epilegionaminic Acid",color:qe.LightBlue,type:De.DiDeoxynonulosonate},{abbr:"Bac",name:"Bacillosamine",color:qe.Blue,type:De.Unknown},{abbr:"LDmanHep",name:"L-Glycero-D-Manno Heptose",color:qe.Green,type:De.Unknown},{abbr:"Kdo",name:"Keto-Deoxy Octulonic Acid",color:qe.Yellow,type:De.Unknown},{abbr:"Dha",name:"3-Deoxy Lyxo-Heptulosaric Acid",color:qe.Orange,type:De.Unknown},{abbr:"DDmanHep",name:"D-Glycero-D-Manno-Heptose",color:qe.Pink,type:De.Unknown},{abbr:"MurNAc",name:"N-Acetyl Muramic Acid",color:qe.Purple,type:De.Unknown},{abbr:"MurNGc",name:"N-Glycolyl Muramic Acid",color:qe.LightBlue,type:De.Unknown},{abbr:"Mur",name:"Muramic Acid",color:qe.Brown,type:De.Unknown},{abbr:"Api",name:"Apicose",color:qe.Green,type:De.Assigned},{abbr:"Fru",name:"Fructose",color:qe.Green,type:De.Assigned},{abbr:"Tag",name:"Tagatose",color:qe.Yellow,type:De.Assigned},{abbr:"Sor",name:"Sorbose",color:qe.Orange,type:De.Assigned},{abbr:"Psi",name:"Psicose",color:qe.Pink,type:De.Assigned}],Ad=function(){let e=new Map;for(let t=0,n=Fi.length;t<n;++t){let r=Fi[t];e.set(r.abbr,r)}return e}(),SI=[["Glc-family",qe.Blue],["Man-family",qe.Green],["Gal-family",qe.Yellow],["Gul-family",qe.Orange],["Alt-family",qe.Pink],["All-family",qe.Purple],["Tal-family",qe.LightBlue],["Ido-family",qe.Brown],["Fuc-family",qe.Red],["Generic/Unknown/Secondary",qe.Secondary]],bd={Glc:["GLC","BGC","Z8T","TRE","MLR"],Man:["MAN","BMA"],Gal:["GLA","GAL","GZL","GXL","GIV"],Gul:["4GL","GL0","GUP","Z8H"],Alt:["Z6H","3MK","SHD"],All:["AFD","ALL","WOO","Z2D"],Tal:["ZEE","A5C","SDY"],Ido:["ZCD","Z0F","4N2"],GlcNAc:["NDG","NAG","NGZ"],ManNAc:["BM3","BM7"],GalNAc:["A2G","NGA","YYQ"],GulNAc:["LXB"],AltNAc:[],AllNAc:["NAA"],TalNAc:[],IdoNAc:["LXZ","HSQ"],GlcN:["PA1","GCS"],ManN:["95Z"],GalN:["X6X","1GN"],GulN:[],AltN:[],AllN:[],TalN:[],IdoN:[],GlcA:["GCU","BDP"],ManA:["MAV","BEM"],GalA:["ADA","GTR","GTK"],GulA:["LGU"],AltA:[],AllA:[],TalA:["X1X","X0X"],IdoA:["IDR"],Qui:["G6D","YYK"],Rha:["RAM","RM4","XXR"],"6dGul":["66O"],"6dAlt":[],"6dTal":[],Fuc:["FUC","FUL","FCA","FCB","GYE"],QuiNAc:["Z9W"],RhaNAc:[],"6dAltNAc":[],"6dTalNAc":[],FucNAc:["49T"],Oli:["DDA","RAE","Z5J"],Tyv:["TYV"],Abe:["ABE"],Par:["PZU"],Dig:["Z3U"],Col:[],Ara:["64K","ARA","ARB","AHR","FUB","BXY","BXX","SEJ"],Lyx:["LDY","Z4W"],Xyl:["XYS","XYP","XYZ","HSY","LXC"],Rib:["YYM","RIP","RIB","BDR","0MK","Z6J","32O"],Kdn:["KDM","KDN"],Neu5Ac:["SIA","SLB"],Neu5Gc:["NGC","NGE"],Neu:[],Sia:[],Pse:[],Leg:[],Aci:[],"4eLeg":[],Bac:[],LDmanHep:["GMH"],Kdo:["KDO"],Dha:[],DDmanHep:["289"],MurNAc:["MUB","AMU"],MurNGc:[],Mur:["1S4","MUR"],Api:["XXM"],Fru:["BDF","Z9N","FRU","LFR"],Tag:["T6T"],Sor:["SOE","UEA"],Psi:["PSV","SF6","SF9","TTV"]},Cd={Glc:["AGLC","BGLC"],GlcNAc:["AGLCNA","BGLCNA","BGLCN0"],GlcA:["AGLCA","BGLCA","BGLCA0"],Man:["AMAN","BMAN"],Rha:["ARHM","BRHM"],Ara:["AARB","BARB"],Gal:["AGAL","BGAL"],GalNAc:["AGALNA","BGALNA"],Gul:["AGUL","BGUL"],Alt:["AALT","BALT"],All:["AALL","BALL"],Tal:["ATAL","BTAL"],Ido:["AIDO","BIDO"],IdoA:["AIDOA","BIDOA"],Fuc:["AFUC","BFUC"],Lyx:["ALYF","BLYF"],Xyl:["AXYL","BXYL","AXYF","BXYF"],Rib:["ARIB","BRIB"],Fru:["AFRU","BFRU"],Neu5Ac:["ANE5AC","BNE5AC"]},g2={Glc:["0GA","0GB","1GA","1GB","2GA","2GB","3GA","3GB","4GA","4GB","6GA","6GB","ZGA","ZGB","YGA","YGB","XGA","XGB","WGA","WGB","VGA","VGB","UGA","UGB","TGA","TGB","SGA","SGB","RGA","RGB","QGA","QGB","PGA","PGB","0gA","0gB","1gA","1gB","2gA","2gB","3gA","3gB","4gA","4gB","6gA","6gB","ZgA","ZgB","YgA","YgB","XgA","XgB","WgA","WgB","VgA","VgB","UgA","UgB","TgA","TgB","SgA","SgB","RgA","RgB","QgA","QgB","PgA","PgB"],GlcNAc:["0YA","0YB","1YA","1YB","3YA","3YB","4YA","4YB","6YA","6YB","WYA","WYB","VYA","VYB","UYA","UYB","QYA","QYB","0yA","0yB","1yA","1yB","3yA","3yB","4yA","4yB","6yA","6yB","WyA","WyB","VyA","VyB","UyA","UyB","QyA","QyB","0YS","0Ys","3YS","3Ys","4YS","4Ys","6YS","6Ys","QYS","QYs","UYS","UYs","VYS","VYs","WYS","WYs","0yS","0ys","3yS","3ys","4yS","4ys"],GlcA:["0ZA","0ZB","1ZA","1ZB","2ZA","2ZB","3ZA","3ZB","4ZA","4ZB","ZZA","ZZB","YZA","YZB","WZA","WZB","TZA","TZB","0zA","0zB","1zA","1zB","2zA","2zB","3zA","3zB","4zA","4zB","ZzA","ZzB","YzA","YzB","WzA","WzB","TzA","TzB","0ZBP"],GlcN:["0YN","3YN","4YN","6YN","WYN","VYN","UYN","QYN","3Yn","4Yn","WYn","0Yn","0YP","3YP","4YP","6YP","WYP","VYP","UYP","QYP","0Yp","3Yp","4Yp","WYp"],Man:["0MA","0MB","1MA","1MB","2MA","2MB","3MA","3MB","4MA","4MB","6MA","6MB","ZMA","ZMB","YMA","YMB","XMA","XMB","WMA","WMB","VMA","VMB","UMA","UMB","TMA","TMB","SMA","SMB","RMA","RMB","QMA","QMB","PMA","PMB","0mA","0mB","1mA","1mB","2mA","2mB","3mA","3mB","4mA","4mB","6mA","6mB","ZmA","ZmB","YmA","YmB","XmA","XmB","WmA","WmB","VmA","VmB","UmA","UmB","TmA","TmB","SmA","SmB","RmA","RmB","QmA","QmB","PmA","PmB"],ManNAc:["0WA","0WB","1WA","1WB","3WA","3WB","4WA","4WB","6WA","6WB","WWA","WWB","VWA","VWB","UWA","UWB","QWA","QWB","0wA","0wB","1wA","1wB","3wA","3wB","4wA","4wB","6wA","6wB","WwA","WwB","VwA","VwB","UwA","UwB","QwA","QwB"],Ara:["0AA","0AB","1AA","1AB","2AA","2AB","3AA","3AB","4AA","4AB","ZAA","ZAB","YAA","YAB","WAA","WAB","TAA","TAB","0AD","0AU","1AD","1AU","2AD","2AU","3AD","3AU","5AD","5AU","ZAD","ZAU","0aA","0aB","1aA","1aB","2aA","2aB","3aA","3aB","4aA","4aB","ZaA","ZaB","YaA","YaB","WaA","WaB","TaA","TaB","0aD","0aU","1aD","1aU","2aD","2aU","3aD","3aU","5aD","5aU","ZaD","ZaU"],Gal:["0LA","0LB","1LA","1LB","2LA","2LB","3LA","3LB","4LA","4LB","6LA","6LB","ZLA","ZLB","YLA","YLB","XLA","XLB","WLA","WLB","VLA","VLB","ULA","ULB","TLA","TLB","SLA","SLB","RLA","RLB","QLA","QLB","PLA","PLB","0lA","0lB","1lA","1lB","2lA","2lB","3lA","3lB","4lA","4lB","6lA","6lB","ZlA","ZlB","YlA","YlB","XlA","XlB","WlA","WlB","VlA","VlB","UlA","UlB","TlA","TlB","SlA","SlB","RlA","RlB","QlA","QlB","PlA","PlB"],GalNAc:["0VA","0VB","1VA","1VB","3VA","3VB","4VA","4VB","6VA","6VB","WVA","WVB","VVA","VVB","UVA","UVB","QVA","QVB","0vA","0vB","1vA","1vB","3vA","3vB","4vA","4vB","6vA","6vB","WvA","WvB","VvA","VvB","UvA","UvB","QvA","QvB"],GalA:["0OA","0OB","1OA","1OB","2OA","2OB","3OA","3OB","4OA","4OB","ZOA","ZOB","YOA","YOB","WOA","WOB","TOA","TOB","0oA","0oB","1oA","1oB","2oA","2oB","3oA","3oB","4oA","4oB","ZoA","ZoB","YoA","YoB","WoA","WoB","ToA","ToB"],Gul:["0KA","0KB","1KA","1KB","2KA","2KB","3KA","3KB","4KA","4KB","6KA","6KB","ZKA","ZKB","YKA","YKB","XKA","XKB","WKA","WKB","VKA","VKB","UKA","UKB","TKA","TKB","SKA","SKB","RKA","RKB","QKA","QKB","PKA","PKB","0kA","0kB","1kA","1kB","2kA","2kB","3kA","3kB","4kA","4kB","6kA","6kB","ZkA","ZkB","YkA","YkB","XkA","XkB","WkA","WkB","VkA","VkB","UkA","UkB","TkA","TkB","SkA","SkB","RkA","RkB","QkA","QkB","PkA","PkB"],Alt:["0EA","0EB","1EA","1EB","2EA","2EB","3EA","3EB","4EA","4EB","6EA","6EB","ZEA","ZEB","YEA","YEB","XEA","XEB","WEA","WEB","VEA","VEB","UEA","UEB","TEA","TEB","SEA","SEB","REA","REB","QEA","QEB","PEA","PEB","0eA","0eB","1eA","1eB","2eA","2eB","3eA","3eB","4eA","4eB","6eA","6eB","ZeA","ZeB","YeA","YeB","XeA","XeB","WeA","WeB","VeA","VeB","UeA","UeB","TeA","TeB","SeA","SeB","ReA","ReB","QeA","QeB","PeA","PeB"],All:["0NA","0NB","1NA","1NB","2NA","2NB","3NA","3NB","4NA","4NB","6NA","6NB","ZNA","ZNB","YNA","YNB","XNA","XNB","WNA","WNB","VNA","VNB","UNA","UNB","TNA","TNB","SNA","SNB","RNA","RNB","QNA","QNB","PNA","PNB","0nA","0nB","1nA","1nB","2nA","2nB","3nA","3nB","4nA","4nB","6nA","6nB","ZnA","ZnB","YnA","YnB","XnA","XnB","WnA","WnB","VnA","VnB","UnA","UnB","TnA","TnB","SnA","SnB","RnA","RnB","QnA","QnB","PnA","PnB"],Tal:["0TA","0TB","1TA","1TB","2TA","2TB","3TA","3TB","4TA","4TB","6TA","6TB","ZTA","ZTB","YTA","YTB","XTA","XTB","WTA","WTB","VTA","VTB","UTA","UTB","TTA","TTB","STA","STB","RTA","RTB","QTA","QTB","PTA","PTB","0tA","0tB","1tA","1tB","2tA","2tB","3tA","3tB","4tA","4tB","6tA","6tB","ZtA","ZtB","YtA","YtB","XtA","XtB","WtA","WtB","VtA","VtB","UtA","UtB","TtA","TtB","StA","StB","RtA","RtB","QtA","QtB","PtA","PtB"],Ido:["0IA","0IB","1IA","1IB","2IA","2IB","3IA","3IB","4IA","4IB","6IA","6IB","ZIA","ZIB","YIA","YIB","XIA","XIB","WIA","WIB","VIA","VIB","UIA","UIB","TIA","TIB","SIA","SIB","RIA","RIB","QIA","QIB","PIA","PIB","0iA","0iB","1iA","1iB","2iA","2iB","3iA","3iB","4iA","4iB","6iA","6iB","ZiA","ZiB","YiA","YiB","XiA","XiB","WiA","WiB","ViA","ViB","UiA","UiB","TiA","TiB","SiA","SiB","RiA","RiB","QiA","QiB","PiA","PiB"],IdoA:["0UA","0UB","1UA","1UB","2UA","2UB","3UA","3UB","4UA","4UB","ZUA","ZUB","YUA","YUB","WUA","WUB","TUA","TUB","0uA","0uB","1uA","1uB","2uA","2uB","3uA","3uB","4uA","4uB","ZuA","ZuB","YuA","YuB","WuA","WuB","TuA","TuB","YuAP"],Fuc:["0FA","0FB","1FA","1FB","2FA","2FB","3FA","3FB","4FA","4FB","ZFA","ZFB","YFA","YFB","WFA","WFB","TFA","TFB","0fA","0fB","1fA","1fB","2fA","2fB","3fA","3fB","4fA","4fB","ZfA","ZfB","YfA","YfB","WfA","WfB","TfA","TfB"],Rha:["0HA","0HB","1HA","1HB","2HA","2HB","3HA","3HB","4HA","4HB","ZHA","ZHB","YHA","YHB","WHA","WHB","THA","THB","0hA","0hB","1hA","1hB","2hA","2hB","3hA","3hB","4hA","4hB","ZhA","ZhB","YhA","YhB","WhA","WhB","ThA","ThB"],Qui:["0QA","0QB","1QA","1QB","2QA","2QB","3QA","3QB","4QA","4QB","ZQA","ZQB","YQA","YQB","WQA","WQB","TQA","TQB","0qA","0qB","1qA","1qB","2qA","2qB","3qA","3qB","4qA","4qB","ZqA","ZqB","YqA","YqB","WqA","WqB","TqA","TqB"],Lyx:["0DA","0DB","1DA","1DB","2DA","2DB","3DA","3DB","4DA","4DB","ZDA","ZDB","YDA","YDB","WDA","WDB","TDA","TDB","0DD","0DU","1DD","1DU","2DD","2DU","3DD","3DU","5DD","5DU","ZDD","ZDU","0dA","0dB","1dA","1dB","2dA","2dB","3dA","3dB","4dA","4dB","ZdA","ZdB","YdA","YdB","WdA","WdB","TdA","TdB","0dD","0dU","1dD","1dU","2dD","2dU","3dD","3dU","5dD","5dU","ZdD","ZdU"],Xyl:["0XA","0XB","1XA","1XB","2XA","2XB","3XA","3XB","4XA","4XB","ZXA","ZXB","YXA","YXB","WXA","WXB","TXA","TXB","0XD","0XU","1XD","1XU","2XD","2XU","3XD","3XU","5XD","5XU","ZXD","ZXU","0xA","0xB","1xA","1xB","2xA","2xB","3xA","3xB","4xA","4xB","ZxA","ZxB","YxA","YxB","WxA","WxB","TxA","TxB","0xD","0xU","1xD","1xU","2xD","2xU","3xD","3xU","5xD","5xU","ZxD","ZxU"],Rib:["0RA","0RB","1RA","1RB","2RA","2RB","3RA","3RB","4RA","4RB","ZRA","ZRB","YRA","YRB","WRA","WRB","TRA","TRB","0RD","0RU","1RD","1RU","2RD","2RU","3RD","3RU","5RD","5RU","ZRD","ZRU","0rA","0rB","1rA","1rB","2rA","2rB","3rA","3rB","4rA","4rB","ZrA","ZrB","YrA","YrB","WrA","WrB","TrA","TrB","0rD","0rU","1rD","1rU","2rD","2rU","3rD","3rU","5rD","5rU","ZrD","ZrU"],Fru:["0CA","0CB","1CA","1CB","2CA","2CB","3CA","3CB","4CA","4CB","5CA","5CB","WCA","WCB","0CD","0CU","1CD","1CU","2CD","2CU","3CD","3CU","4CD","4CU","6CD","6CU","WCD","WCU","VCD","VCU","UCD","UCU","QCD","QCU","0cA","0cB","1cA","1cB","2cA","2cB","3cA","3cB","4cA","4cB","5cA","5cB","WcA","WcB","0cD","0cU","1cD","1cU","2cD","2cU","3cD","3cU","4cD","4cU","6cD","6cU","WcD","WcU","VcD","VcU","UcD","UcU","QcD","QcU"],Tag:["0JA","0JB","1JA","1JB","2JA","2JB","3JA","3JB","4JA","4JB","5JA","5JB","WJA","WJB","0JD","0JU","1JD","1JU","2JD","2JU","3JD","3JU","4JD","4JU","6JD","6JU","WJD","WJU","VJD","VJU","UJD","UJU","QJD","QJU","0jA","0jB","1jA","1jB","2jA","2jB","3jA","3jB","4jA","4jB","5jA","5jB","WjA","WjB","0jD","0jU","1jD","1jU","2jD","2jU","3jD","3jU","4jD","4jU","6jD","6jU","WjD","WjU","VjD","VjU","UjD","UjU","QjD","QjU"],Sor:["0BA","0BB","1BA","1BB","2BA","2BB","3BA","3BB","4BA","4BB","5BA","5BB","WBA","WBB","0BD","0BU","1BD","1BU","2BD","2BU","3BD","3BU","4BD","4BU","6BD","6BU","WBD","WBU","VBD","VBU","UBD","UBU","QBD","QBU","0bA","0bB","1bA","1bB","2bA","2bB","3bA","3bB","4bA","4bB","5bA","5bB","WbA","WbB","0bD","0bU","1bD","1bU","2bD","2bU","3bD","3bU","4bD","4bU","6bD","6bU","WbD","WbU","VbD","VbU","UbD","UbU","QbD","QbU"],Psi:["0PA","0PB","1PA","1PB","2PA","2PB","3PA","3PB","4PA","4PB","5PA","5PB","WPA","WPB","0PD","0PU","1PD","1PU","2PD","2PU","3PD","3PU","4PD","4PU","6PD","6PU","WPD","WPU","VPD","VPU","UPD","UPU","QPD","QPU","0pA","0pB","1pA","1pB","2pA","2pB","3pA","3pB","4pA","4pB","5pA","5pB","WpA","WpB","0pD","0pU","1pD","1pU","2pD","2pU","3pD","3pU","4pD","4pU","6pD","6pU","WpD","WpU","VpD","VpU","UpD","UpU","QpD","QpU"],Neu5Ac:["0SA","0SB","4SA","4SB","7SA","7SB","8SA","8SB","9SA","9SB","ASA","ASB","BSA","BSB","CSA","CSB","DSA","DSB","ESA","ESB","FSA","FSB","GSA","GSB","HSA","HSB","ISA","ISB","JSA","JSB","KSA","KSB","0sA","0sB","4sA","4sB","7sA","7sB","8sA","8sB","9sA","9sB","AsA","AsB","BsA","BsB","CsA","CsB","DsA","DsB","EsA","EsB","FsA","FsB","GsA","GsB","HsA","HsB","IsA","IsB","JsA","JsB","KsA","KsB"],Neu5Gc:["0GL","4GL","7GL","8GL","9GL","CGL","DGL","EGL","FGL","GGL","HGL","IGL","JGL","KGL","0gL","4gL","7gL","8gL","9gL","AgL","BgL","CgL","DgL","EgL","FgL","GgL","HgL","IgL","JgL","KgL"],Tyv:["0TV","0Tv","1TV","1Tv","2TV","2Tv","4TV","4Tv","YTV","YTv","0tV","0tv","1tV","1tv","2tV","2tv","4tV","4tv","YtV","Ytv"],Abe:["0AE","2AE","4AE","YGa","0AF","2AF","4AF","YAF"],Bac:["0BC","3BC","0bC","3bC"],Kdn:["0KN","4KN","5KN","7KN","8KN","9KN","AKN","BKN","CKN","DKN","EKN","FKN","GKN","HKN","IKN","JKN","KKN","LKN","MKN","NKN","OKN","PKN","QKN","RKN","SKN","TKN","UKN","VKN","WKN","XKN","YKN","0Kn","4Kn","5Kn","7Kn","8Kn","9Kn","AKn","BKn","CKn","DKn","EKn","FKn","GKn","HKn","IKn","JKn","KKn","LKn","MKn","NKn","OKn","PKn","QKn","RKn","SKn","TKn","UKn","VKn","WKn","XKn","YKn"],Kdo:["0KO","4KO","5KO","7KO","8KO","AKO","BKO","CKO","DKO","EKO","FKO","GKO","HKO","IKO","JKO","KKO","0Ko","4Ko","5Ko","7Ko","8Ko","AKo","BKo","CKo","DKo","EKo","FKo","GKo","HKo","IKo","JKo","KKo"]},Sd=function(){let e=new Map;for(let t=0,n=Fi.length;t<n;++t){let r=Fi[t],i=bd[r.abbr];if(i)for(let s=0,a=i.length;s<a;++s)e.set(i[s],r);let o=Cd[r.abbr];if(o)for(let s=0,a=o.length;s<a;++s)e.set(o[s],r)}return xc.forEach(t=>{e.has(t)||e.set(t,Ps)}),e}(),y2=function(){let e=new Map;for(let t=0,n=Fi.length;t<n;++t){let r=Fi[t],i=bd[r.abbr];if(i)for(let a=0,c=i.length;a<c;++a)e.set(i[a],r);let o=Cd[r.abbr];if(o)for(let a=0,c=o.length;a<c;++a)e.set(o[a],r);let s=g2[r.abbr];if(s)for(let a=0,c=s.length;a<c;++a)e.has(s[a])||e.set(s[a],r)}return xc.forEach(t=>{e.has(t)||e.set(t,Ps)}),e}();function II(e){Dn=e==="default"?Sd:y2}var Dn=Sd;var hn;(function(e){function t(d){return Array.from(d.values())}e.toArray=t;function n(d,p){if(d===p)return!0;if(d.size<p.size)return!1;for(let h of p)if(!d.has(h))return!1;return!0}e.isSuperset=n;function r(d,...p){for(let h=0;h<p.length;h++)for(let x of p[h])d.add(x);return d}e.add=r;function i(d,p){let h=new Set(d);if(d===p)return h;for(let x of p)h.add(x);return h}e.union=i;function o(...d){if(d.length===0)return new Set;let p=new Set(d[0]);for(let h=1,x=d.length;h<x;h++)for(let y of d[h])p.add(y);return p}e.unionMany=o;function s(d){if(d.length===0)return new Set;let p=new Set(d[0]);for(let h=1;h<d.length;h++)for(let x of d[h])p.add(x);return p}e.unionManyArrays=s;function a(d,p){if(d===p)return new Set(d);let h=new Set;for(let x of p)d.has(x)&&h.add(x);return h}e.intersection=a;function c(d,p){if(d===p)return d.size>0;d.size<p.size&&([d,p]=[p,d]);for(let h of p)if(d.has(h))return!0;return!1}e.areIntersecting=c;function u(d,p){if(d===p)return d.size;d.size<p.size&&([d,p]=[p,d]);let h=0;for(let x of p)d.has(x)&&(h+=1);return h}e.intersectionSize=u;function l(d,p){if(d===p)return new Set;let h=new Set(d);for(let x of p)h.delete(x);return h}e.difference=l;function m(d,p){if(d===p)return 0;let h=d.size;for(let x of d)p.has(x)&&(h-=1);return h}e.differenceSize=m;function f(d,p){if(d===p)return!0;if(d.size!==p.size)return!1;for(let h of p)if(!d.has(h))return!1;return!0}e.areEqual=f})(hn||(hn={}));var Ac=new Set(["DAPC","DBPC","DFPC","DGPC","DIPC","DLPC","DNPC","DOPC","DPPC","DRPC","DTPC","DVPC","DXPC","DYPC","LPPC","PAPC","PEPC","PGPC","PIPC","POPC","PRPC","PUPC","DAPE","DBPE","DFPE","DGPE","DIPE","DLPE","DNPE","DOPE","DPPE","DRPE","DTPE","DUPE","DVPE","DXPE","DYPE","LPPE","PAPE","PGPE","PIPE","POPE","PQPE","PRPE","PUPE","DAPS","DBPS","DFPS","DGPS","DIPS","DLPS","DNPS","DOPS","DPPS","DRPS","DTPS","DUPS","DVPS","DXPS","DYPS","LPPS","PAPS","PGPS","PIPS","POPS","PQPS","PRPS","PUPS","DAPG","DBPG","DFPG","DGPG","DIPG","DLPG","DNPG","DOPG","DPPG","DRPG","DTPG","DVPG","DXPG","DYPG","LPPG","PAPG","PGPG","PIPG","POPG","PRPG","DAPA","DBPA","DFPA","DGPA","DIPA","DLPA","DNPA","DOPA","DPPA","DRPA","DTPA","DVPA","DXPA","DYPA","LPPA","PAPA","PGPA","PIPA","POPA","PRPA","PUPA","DPP","DPPI","PAPI","PIPI","POP","POPI","PUPI","PVP","PVPI","PADG","PIDG","PODG","PUDG","PVDG","APC","CPC","IPC","LPC","OPC","PPC","TPC","UPC","VPC","BNSM","DBSM","DPSM","DXSM","PGSM","PNSM","POSM","PVSM","XNSM","DPCE","DXCE","PNCE","XNCE","DMPC"]);var bc=new Set(["118","119","543","1AL","1CU","2FK","2HP","2OF","3CO","3MT","3NI","3OF","3P8","4MO","4PU","4TI","6MO","ACT","AG","AL","ALF","AM","ATH","AU","AU3","AUC","AZI","BA","BCT","BEF","BF4","BO4","BR","BS3","BSY","CA","CAC","CD","CD1","CD3","CD5","CE","CF","CHT","CL","CO","CO3","CO5","CON","CR","CS","CSB","CU","CU1","CU3","CUA","CUZ","CYN","DME","DMI","DSC","DTI","DY","E4N","EDR","EMC","ER3","EU","EU3","F","FE","FE2","FPO","GA","GD3","GEP","HAI","HG","HGC","IN","IOD","IR","IR3","IRI","IUM","K","KO4","LA","LCO","LCP","LI","LU","MAC","MG","MH2","MH3","MLI","MMC","MN","MN3","MN5","MN6","MO1","MO2","MO3","MO4","MO5","MO6","MOO","MOS","MOW","MW1","MW2","MW3","NA","NA2","NA5","NA6","NAO","NAW","ND","NET","NH4","NI","NI1","NI2","NI3","NO2","NO3","NRU","NT3","O4M","OAA","OC1","OC2","OC3","OC4","OC5","OC6","OC7","OC8","OCL","OCM","OCN","OCO","OF1","OF2","OF3","OH","OS","OS4","OXL","PB","PBM","PD","PDV","PER","PI","PO3","PO4","PR","PT","PT4","PTN","RB","RH3","RHD","RHF","RU","SB","SCN","SE4","SEK","SM","SMO","SO3","SO4","SR","T1A","TB","TBA","TCN","TEA","TH","THE","TL","TMA","TRA","UNX","V","VN3","VO4","W","WO5","Y1","YB","YB2","YH","YT3","ZCM","ZN","ZN2","ZN3","ZNO","ZO3","ZR","NCO","OHX"]);var x2=function(){let e=Object.create(null),t=[];for(let n=65;n<=90;n++)t[t.length]=String.fromCharCode(n);for(let n=97;n<=122;n++)t[t.length]=String.fromCharCode(n);for(let n=48;n<=57;n++)t[t.length]=String.fromCharCode(n);for(let n of t){e[n]=n.toUpperCase();for(let r of t){e[n+r]=(n+r).toUpperCase();for(let i of t)e[n+r+i]=(n+r+i).toUpperCase()}}return e}();function yr(e){return x2[e]||e.toUpperCase()}var Id=new Map([[1,"H"],[2,"He"],[3,"Li"],[4,"Be"],[5,"B"],[6,"C"],[7,"N"],[8,"O"],[9,"F"],[10,"Ne"],[11,"Na"],[12,"Mg"],[13,"Al"],[14,"Si"],[15,"P"],[16,"S"],[17,"Cl"],[18,"Ar"],[19,"K"],[20,"Ca"],[21,"Sc"],[22,"Ti"],[23,"V"],[24,"Cr"],[25,"Mn"],[26,"Fe"],[27,"Co"],[28,"Ni"],[29,"Cu"],[30,"Zn"],[31,"Ga"],[32,"Ge"],[33,"As"],[34,"Se"],[35,"Br"],[36,"Kr"],[37,"Rb"],[38,"Sr"],[39,"Y"],[40,"Zr"],[41,"Nb"],[42,"Mo"],[43,"Tc"],[44,"Ru"],[45,"Rh"],[46,"Pd"],[47,"Ag"],[48,"Cd"],[49,"In"],[50,"Sn"],[51,"Sb"],[52,"Te"],[53,"I"],[54,"Xe"],[55,"Cs"],[56,"Ba"],[57,"La"],[58,"Ce"],[59,"Pr"],[60,"Nd"],[61,"Pm"],[62,"Sm"],[63,"Eu"],[64,"Gd"],[65,"Tb"],[66,"Dy"],[67,"Ho"],[68,"Er"],[69,"Tm"],[70,"Yb"],[71,"Lu"],[72,"Hf"],[73,"Ta"],[74,"W"],[75,"Re"],[76,"Os"],[77,"Ir"],[78,"Pt"],[79,"Au"],[80,"Hg"],[81,"Tl"],[82,"Pb"],[83,"Bi"],[84,"Po"],[85,"At"],[86,"Rn"],[87,"Fr"],[88,"Ra"],[89,"Ac"],[90,"Th"],[91,"Pa"],[92,"U"],[93,"Np"],[94,"Pu"],[95,"Am"],[96,"Cm"],[97,"Bk"],[98,"Cf"],[99,"Es"],[100,"Fm"],[101,"Md"],[102,"No"],[103,"Lr"],[104,"Rf"],[105,"Db"],[106,"Sg"],[107,"Bh"],[108,"Hs"],[109,"Mt"],[110,"Ds"],[111,"Rg"],[112,"Cn"],[113,"Uut"],[114,"Fl"],[115,"Uup"],[116,"Lv"],[117,"Uus"],[118,"Uuo"]].map(e=>[e[0],yr(e[1])]));function UI(e){return Id.has(e)?Id.get(e):yr("H")}var wd={0:{trace:new Set,directionFrom:new Set,directionTo:new Set,backboneStart:new Set,backboneEnd:new Set,coarseBackbone:new Set},1:{trace:new Set(["CA"]),directionFrom:new Set(["C"]),directionTo:new Set(["O","OC1","O1","OX1","OXT","OT1"]),backboneStart:new Set(["N"]),backboneEnd:new Set(["C"]),coarseBackbone:new Set(["CA","BB","CA1"])},2:{trace:new Set(["CA"]),directionFrom:new Set(["C"]),directionTo:new Set(["O"]),backboneStart:new Set(["N"]),backboneEnd:new Set(["CD"]),coarseBackbone:new Set(["CA"])},3:{trace:new Set(["CA"]),directionFrom:new Set(["C"]),directionTo:new Set(["O"]),backboneStart:new Set(["N"]),backboneEnd:new Set(["CG"]),coarseBackbone:new Set(["CA"])},4:{trace:new Set(["O3'","O3*"]),directionFrom:new Set(["C4'","C4*"]),directionTo:new Set(["C3'","C3*"]),backboneStart:new Set(["P"]),backboneEnd:new Set(["O3'","O3*"]),coarseBackbone:new Set(["P"])},5:{trace:new Set(["O3'","O3*"]),directionFrom:new Set(["C3'","C3*"]),directionTo:new Set(["C1'","C1*"]),backboneStart:new Set(["P"]),backboneEnd:new Set(["O3'","O3*"]),coarseBackbone:new Set(["P"])},6:{trace:new Set(["N4'","N4*"]),directionFrom:new Set(["N4'","N4*"]),directionTo:new Set(["C7'","C7*"]),backboneStart:new Set(["N1'","N1*"]),backboneEnd:new Set(["C'","C*"]),coarseBackbone:new Set(["P"])}},RI=new Set(["CA","C","N","O","O1","O2","OC1","OC2","OT1","OT2","OX1","OXT","H","H1","H2","H3","HA","HN","HXT","BB"]),TI=new Set(["P","OP1","OP2","HOP2","HOP3","O2'","O3'","O4'","O5'","C1'","C2'","C3'","C4'","C5'","H1'","H2'","H2''","HO2'","H3'","H4'","H5'","H5''","HO3'","HO5'","O2*","O3*","O4*","O5*","C1*","C2*","C3*","C4*","C5*"]),vd=new Set(["d-peptide linking","d-peptide nh3 amino terminus","d-peptide cooh carboxy terminus","d-gamma-peptide, c-delta linking","d-beta-peptide, c-gamma linking"]),Pd=new Set(["l-peptide linking","l-peptide nh3 amino terminus","l-peptide cooh carboxy terminus","l-gamma-peptide, c-delta linking","l-beta-peptide, c-gamma linking"]),A2=new Set(["d-gamma-peptide, c-delta linking","l-gamma-peptide, c-delta linking"]),b2=new Set(["d-beta-peptide, c-gamma linking","l-beta-peptide, c-gamma linking"]),C2=new Set(["d-peptide nh3 amino terminus","d-peptide cooh carboxy terminus","l-peptide nh3 amino terminus","l-peptide cooh carboxy terminus"]),Bd=new Set(["peptide linking","peptide-like"]),S2=hn.unionMany(vd,Pd,Bd),Ed=new Set(["dna linking","l-dna linking","dna oh 5 prime terminus","dna oh 3 prime terminus"]),Dd=new Set(["rna linking","l-rna linking","rna oh 5 prime terminus","rna oh 3 prime terminus"]),Md=hn.unionMany(new Set(["d-saccharide, beta linking","l-saccharide, beta linking","d-saccharide, alpha linking","l-saccharide, alpha linking","l-saccharide","d-saccharide","saccharide"]),new Set(["d-saccharide 1,4 and 1,4 linking","l-saccharide 1,4 and 1,4 linking","d-saccharide 1,4 and 1,6 linking","l-saccharide 1,4 and 1,6 linking"])),I2=new Set(["non-polymer","other"]),w2=new Set(["ion"]),v2=new Set(["lipid"]),Bs=new Set(["SOL","WAT","HOH","H2O","W","DOD","D3O","TIP","TIP3","TIP4","SPC"]),Nd=new Set(["HIS","ARG","LYS","ILE","PHE","LEU","TRP","ALA","MET","PRO","CYS","ASN","VAL","GLY","SER","GLN","TYR","ASP","GLU","THR","SEC","PYL","UNK","MSE","SEP","TPO","PTR","PCA","HYP","HSD","HSE","HSP","LSN","ASPP","GLUP","HID","HIE","HIP","LYN","ASH","GLH"]),kd=new Set(["DAL","DAR","DSG","DAS","DCY","DGL","DGN","DHI","DIL","DLE","DLY","MED","DPN","DPR","DSN","DTH","DTR","DTY","DVA","DNE"]),xo=hn.unionMany(Nd,kd),FI=new Set(["NME","ACE","NH2","FOR","FMT"]),Es=new Set(["A","C","T","G","I","U","N"]),Ds=new Set(["DA","DC","DT","DG","DI","DU","DN"]),Cc=new Set(["APN","CPN","TPN","GPN"]),P2=new Set(["A","G","I","DA","DG","DI","APN","GPN"]),B2=new Set(["C","T","U","DC","DT","DU","CPN","TPN"]),Sc=hn.unionMany(Es,Ds,Cc),OI=e=>P2.has(e.toUpperCase()),LI=e=>B2.has(e.toUpperCase()),Ms=hn.unionMany(xo,Sc);function Oi(e,t){return t=t.toUpperCase(),Cc.has(t)?8:S2.has(e)?5:Dd.has(e)?6:Ed.has(e)?7:Md.has(e)?9:Bs.has(t)?2:bc.has(t)?3:Ac.has(t)?4:I2.has(e)?Dn.has(t)?9:xo.has(t)?5:Es.has(t)?6:Ds.has(t)?7:1:0}function Ud(e,t){return t===5?A2.has(e)?2:b2.has(e)?3:C2.has(e)?0:1:t===6?4:t===7?5:t===8?6:0}function Ic(e){return e=e.toUpperCase(),xo.has(e)?"peptide linking":Es.has(e)?"rna linking":Ds.has(e)?"dna linking":Dn.has(e)?"saccharide":"other"}function Rd(e){return{formula:"",formula_weight:0,id:e,name:e,mon_nstd_flag:Ms.has(e)?"y":"n",pdbx_synonyms:[],type:Ic(e)}}function Td(e){return e=e.toUpperCase(),Bs.has(e)?"water":Ms.has(e)?"polymer":Dn.has(e)?"branched":"non-polymer"}function Fd(e,t){return e=e.toUpperCase(),Pd.has(t)?"polypeptide(L)":vd.has(t)?"polypeptide(D)":Dd.has(t)?"polyribonucleotide":Ed.has(t)?"polydeoxyribonucleotide":Md.has(t)||Dn.has(e)?"oligosaccharide":Cc.has(e)?"peptide nucleic acid":Nd.has(e)?"polypeptide(L)":kd.has(e)?"polypeptide(D)":Es.has(e)?"polyribonucleotide":Ds.has(e)?"polydeoxyribonucleotide":w2.has(t)||bc.has(e)?"ion":v2.has(t)||Ac.has(e)?"lipid":Bd.has(t)?"peptide-like":"other"}function Li(e){return wc(e)||vc(e)}function wc(e){return e===7||e===6||e===8}function vc(e){return e===5}var kt;(function(e){e.is=fn.has,e.create=fn.create,e.SecondaryStructureMmcif={helx_lh_27_p:1058,helx_lh_3t_p:2082,helx_lh_al_p:4130,helx_lh_a_n:524321,helx_lh_b_n:1048609,helx_lh_ga_p:8226,helx_lh_n:33,helx_lh_om_p:16418,helx_lh_ot_n:131105,helx_lh_ot_p:546,helx_lh_p:34,helx_lh_pi_p:32802,helx_lh_pp_p:65570,helx_lh_z_n:262177,helx_n:1,helx_ot_n:1,helx_ot_p:2,helx_p:2,helx_rh_27_p:1090,helx_rh_3t_p:2114,helx_rh_al_p:4162,helx_rh_a_n:524353,helx_rh_b_n:1048641,helx_rh_ga_p:8258,helx_rh_n:65,helx_rh_om_p:16450,helx_rh_ot_n:131137,helx_rh_ot_p:578,helx_rh_p:66,helx_rh_pi_p:32834,helx_rh_pp_p:65602,helx_rh_z_n:262209,strn:4194308,turn_ot_p:33554448,turn_p:16,turn_ty1p_p:67109136,turn_ty1_p:67109008,turn_ty2p_p:134218e3,turn_ty2_p:134217872,turn_ty3p_p:268435728,turn_ty3_p:268435600,bend:8,other:0},e.SecondaryStructurePdb={1:4162,2:16450,3:32834,4:8258,5:2114,6:4130,7:16418,8:8226,9:1026,10:65538},e.SecondaryStructureStride={H:4098,G:2050,I:32770,E:8388612,B:4194308,T:16,C:536870912},e.SecondaryStructureDssp={H:4098,B:4194308,E:8388612,G:2050,I:32770,T:16,S:8}})(kt||(kt={}));var $t;(function(e){e.is=fn.has;function t(a){return fn.create(a)}e.create=t;function n(a){return(a&1)!==0}e.isCovalent=n;function r(a){return a===Math.pow(2,6)-1}e.isAll=r,e.Names={covalent:1,"metal-coordination":2,"hydrogen-bond":4,disulfide:8,aromatic:16,computed:32};function i(a){return a in e.Names}e.isName=i;function o(a){switch(a){case"covalent":return 1;case"metal-coordination":return 2;case"hydrogen-bond":return 4;case"disulfide":return 8;case"aromatic":return 16;case"computed":return 32}}e.fromName=o;function s(a){let c=0;for(let u=0,l=a.length;u<l;++u)c|=o(a[u]);return c}e.fromNames=s})($t||($t={}));var qI={ALA:[.17,.5,.33],ARG:[.81,1.81,1],ASN:[.42,.85,.43],ASP:[1.23,3.64,2.41],ASH:[-.07,.43,.5],CYS:[-.24,-.02,.22],GLN:[.58,.77,.19],GLU:[2.02,3.63,1.61],GLH:[-.01,.11,.12],GLY:[.01,1.15,1.14],HIS:[.17,.11,-.06],ILE:[-.31,-1.12,-.81],LEU:[-.56,-1.25,-.69],LYS:[.99,2.8,1.81],MET:[-.23,-.67,-.44],PHE:[-1.13,-1.71,-.58],PRO:[.45,.14,-.31],SER:[.13,.46,.33],THR:[.14,.25,.11],TRP:[-1.85,-2.09,-.24],TYR:[-.94,-.71,.23],VAL:[.07,-.46,-.53],HSD:[.17,.11,-.06],HSE:[.17,.11,-.06],HSP:[.96,2.33,1.37],HID:[.17,.11,-.06],HIE:[.17,.11,-.06],HIP:[.96,2.33,1.37]};function D2(e,t){let n=e.coarseElements.entityKey[t],r=e.model.sequence.byEntityKey[n].sequence,i=e.coarseElements.seq_id_begin.value(t);return r.compId.value(i-1)}function zI(e,t){switch(e.kind){case 0:return e.model.atomicHierarchy.derived.residue.moleculeType[e.residueIndex[t]];case 1:case 2:let n=D2(e,t),r=e.model.properties.chemicalComponentMap.get(n);if(r)return Oi(r.type,n)}return 0}var M2=new Set;function Qn(e,t){let n=wd[e];if(n!==void 0){let r=n[t];if(r!==void 0)return r}return M2}var Od=N.zero();function Ns(e,t){let n=e.conformation,r=new Float32Array(t.length*3),{elements:i}=e;for(let o=0,s=t.length;o<s;++o)n.position(i[t[o]],Od),N.toArray(Od,r,o*3);return r}function Ld(e,t,n,r){let{label_comp_id:i,type_symbol:o,_rowCount:s}=e.atoms,{_rowCount:a}=e.residues,{offsets:c}=t.residueAtomSegments,u=new Uint8Array(s);for(let y=0;y<s;++y)u[y]=_d(o.value(y));let l=new Int32Array(a),m=new Int32Array(a),f=new Int32Array(a),d=new Uint8Array(a),p=new Uint8Array(a),h=new Map,x=new Map;for(let y=0;y<a;++y){let g=i.value(c[y]),C=r,_,b;if(h.has(g))_=h.get(g),b=x.get(g);else{let P;C.has(g)?P=C.get(g).type:(Sf||console.info("chemComp not found",g),P=Ic(g)),_=Oi(P,g),b=Ud(P,_),h.set(g,_),x.set(g,b)}d[y]=_,p[y]=b;let I=Qn(b,"trace"),E=n.findAtomsOnResidue(y,I);if(E===-1){let P=Qn(b,"coarseBackbone");E=n.findAtomsOnResidue(y,P),E===-1&&Li(_)&&(E=n.findElementOnResidue(y,yr("C")))}l[y]=E;let S=Qn(b,"directionFrom");m[y]=n.findAtomsOnResidue(y,S);let v=Qn(b,"directionTo");f[y]=n.findAtomsOnResidue(y,v)}return{atom:{atomicNumber:u},residue:{traceElementIndex:l,directionFromElementIndex:m,directionToElementIndex:f,moleculeType:d,polymerType:p}}}function qi(e,t){return t?t.length===1?jn(t.charCodeAt(0),e):t.length===2?jn(t.charCodeAt(0),jn(t.charCodeAt(1),e)):`${e} ${t}`:e}function N2(e,t,n,r){if(e.has(t)){let i=e.get(t);i.has(n)||i.set(n,r)}else{let i=new Map;e.set(t,i),i.set(n,r)}}function k2(e){throw new Error(`Missing entity entry for entity id '${e}'.`)}function U2(e,t,n){return{entities:e,segments:n,label_seq_id:le.ofSortedArray(t.residues.label_seq_id.toArray({array:Int32Array})),label_atom_id:t.atoms.label_atom_id,auth_atom_id:t.atoms.auth_atom_id,label_alt_id:t.atoms.label_alt_id,type_symbol:t.atoms.type_symbol,chain_index_entity_index:new Int32Array(t.chains._rowCount),entity_index_label_asym_id:new Map,chain_index_label_seq_id:new Map,auth_asym_id_auth_seq_id:new Map,chain_index_auth_seq_id:new Map,label_asym_id:new Map}}var Ao=Is.EmptyResidueKey(),Ec=class{getEntityFromChain(t){return this.map.chain_index_entity_index[t]}findEntity(t){let n=this.map.label_asym_id.get(t);return n!==void 0?n:-1}findChainLabel(t){let n=this.entityIndex(t.label_entity_id);if(n<0||!this.map.entity_index_label_asym_id.has(n))return-1;let r=this.map.entity_index_label_asym_id.get(n);return r&&r.has(t.label_asym_id)?r.get(t.label_asym_id):-1}findChainAuth(t){if(!this.map.auth_asym_id_auth_seq_id.has(t.auth_asym_id))return-1;let n=this.map.auth_asym_id_auth_seq_id.get(t.auth_asym_id);return n.has(t.auth_seq_id)?n.get(t.auth_seq_id):-1}findResidue(t,n,r,i){let o;arguments.length===1?o=t:(Ao.label_entity_id=t,Ao.label_asym_id=n,Ao.auth_seq_id=r,Ao.pdbx_PDB_ins_code=i,o=Ao);let s=this.findChainLabel(o);if(s<0)return-1;let a=this.map.chain_index_auth_seq_id.get(s),c=qi(o.auth_seq_id,o.pdbx_PDB_ins_code||"");return a.has(c)?a.get(c):-1}findResidueLabel(t){let n=this.findChainLabel(t);if(n<0)return-1;let r=this.map.chain_index_label_seq_id.get(n),i=qi(t.label_seq_id,t.pdbx_PDB_ins_code||"");return r.has(i)?r.get(i):-1}findResidueAuth(t){let n=this.findChainAuth(t);if(n<0)return-1;let r=this.map.chain_index_auth_seq_id.get(n),i=qi(t.auth_seq_id,t.pdbx_PDB_ins_code||"");return r.has(i)?r.get(i):-1}findResidueInsertion(t){let n=this.findChainLabel(t);if(n<0)return-1;let r=this.map.chain_index_label_seq_id.get(n),i=qi(t.label_seq_id,t.pdbx_PDB_ins_code||"");if(r.has(i))return r.get(i);let o=le.findPredecessorIndex(this.map.label_seq_id,t.label_seq_id),s=$n.chainStartResidueIndex(this.map.segments,n);if(o<s)return s;let a=$n.chainEndResidueIndexExcl(this.map.segments,n)-1;return o>=a?a:o}findAtom(t){let n=this.findResidue(t);return n<0?-1:typeof t.label_alt_id>"u"?Pc(this.residueOffsets[n],this.residueOffsets[n+1],this.map.label_atom_id,t.label_atom_id):Bc(this.residueOffsets[n],this.residueOffsets[n+1],this.map.label_atom_id,this.map.label_alt_id,t.label_atom_id,t.label_alt_id)}findAtomAuth(t){let n=this.findResidueAuth(t);return n<0?-1:typeof t.label_alt_id>"u"?Pc(this.residueOffsets[n],this.residueOffsets[n+1],this.map.auth_atom_id,t.auth_atom_id):Bc(this.residueOffsets[n],this.residueOffsets[n+1],this.map.auth_atom_id,this.map.label_alt_id,t.auth_atom_id,t.label_alt_id)}findAtomOnResidue(t,n,r){return typeof r>"u"?Pc(this.residueOffsets[t],this.residueOffsets[t+1],this.map.label_atom_id,n):Bc(this.residueOffsets[t],this.residueOffsets[t+1],this.map.label_atom_id,this.map.label_alt_id,n,r)}findAtomsOnResidue(t,n){return R2(this.residueOffsets[t],this.residueOffsets[t+1],this.map.label_atom_id,n)}findElementOnResidue(t,n){return T2(this.residueOffsets[t],this.residueOffsets[t+1],this.map.type_symbol,n)}constructor(t){this.map=t,this.entityIndex=t.entities.getEntityIndex,this.residueOffsets=this.map.segments.residueAtomSegments.offsets}};function Pc(e,t,n,r){for(let i=e;i<t;i++)if(n.value(i)===r)return i;return-1}function R2(e,t,n,r){for(let i=e;i<t;i++)if(r.has(n.value(i)))return i;return-1}function Bc(e,t,n,r,i,o){for(let s=e;s<t;s++)if(n.value(s)===i&&r.value(s)===o)return s;return-1}function T2(e,t,n,r){for(let i=e;i<t;i++)if(n.value(i)===r)return i;return-1}function qd(e,t,n){let r=U2(t,e,n),{label_seq_id:i,auth_seq_id:o,pdbx_PDB_ins_code:s}=e.residues,{label_entity_id:a,label_asym_id:c,auth_asym_id:u}=e.chains,l=ue.ofBounds(0,e.atoms._rowCount),m=We.transientSegments(n.chainAtomSegments,l);for(;m.hasNext;){let f=m.move(),d=f.index,p=t.getEntityIndex(a.value(d));p<0&&k2(a.value(d)),r.chain_index_entity_index[d]=p;let h=u.value(d),x=r.auth_asym_id_auth_seq_id.get(h);x||(x=new Map,r.auth_asym_id_auth_seq_id.set(h,x));let y=c.value(d);r.label_asym_id.has(y)||r.label_asym_id.set(y,p),N2(r.entity_index_label_asym_id,p,y,d);let g=new Map,C=new Map;r.chain_index_label_seq_id.set(d,g),r.chain_index_auth_seq_id.set(d,C);let _=We.transientSegments(n.residueAtomSegments,l,f);for(;_.hasNext;){let I=_.move().index,E=o.value(I),S=s.value(I);g.set(qi(i.value(I),S),I),C.set(qi(E,S),I),x.set(E,d)}}return new Ec(r)}function ks(e){return{data:e,position:0,length:e.length,lineNumber:1,tokenStart:0,tokenEnd:0}}(function(e){function t(g){return g.data.substring(g.tokenStart,g.tokenEnd)}e.getTokenString=t;function n(g){g.position=0,g.lineNumber=1,g.tokenStart=0,g.tokenEnd=0}e.reset=n;function r(g){let{data:C}=g;for(;g.position<g.length;)switch(C.charCodeAt(g.position)){case 10:return g.tokenEnd=g.position,++g.position,++g.lineNumber,!0;case 13:return g.tokenEnd=g.position,++g.position,++g.lineNumber,C.charCodeAt(g.position)===10&&++g.position,!0;default:++g.position;break}return g.tokenEnd=g.position,g.tokenStart!==g.tokenEnd}e.eatLine=r;function i(g){g.tokenStart=g.position}e.markStart=i;function o(g){return g.tokenStart=g.position,r(g)}e.markLine=o;function s(g){return o(g),t(g)}e.readLine=s;function a(g){o(g);let C=g.position;return y(g,g.tokenStart,g.tokenEnd),g.position=C,t(g)}e.readLineTrim=a;function c(g,C,_){let b=0;for(let I=0;I<C;I++){if(!o(g))return b;Mn.addUnchecked(_,g.tokenStart,g.tokenEnd),b++}return b}function u(g,C){let _=Mn.create(g.data,C*2);return c(g,C,_),_}e.markLines=u;function l(g,C){let _=[];for(let b=0;b<C;b++)_.push(e.readLine(g));return _}e.readLines=l;function m(g,C,_,b=1e5){return Ve(this,null,function*(){let I=Mn.create(g.data,C*2),E=0;return yield Di(_,b,g,(S,v)=>{let P=Math.min(C-E,S);return c(v,P,I),E+=P,P},(S,v)=>S.update({message:"Parsing...",current:v.position,max:v.length})),I})}e.readLinesAsync=m;function f(g){let C=e(g),_=Mn.create(C.data,Math.max(g.length/80,2));for(;o(C);)Mn.add(_,C.tokenStart,C.tokenEnd);return _}e.readAllLines=f;function d(g,C,_){let b=0;for(let I=0;I<C;I++){if(!o(g))return b;Mn.add(_,g.tokenStart,g.tokenEnd),b++}return b}function p(g,C,_=1e5){return Ve(this,null,function*(){let b=e(g),I=Mn.create(b.data,Math.max(g.length/80,2));return yield Di(C,_,b,(E,S)=>(d(S,E,I),S.position<S.length?E:0),(E,S)=>E.update({message:"Parsing...",current:S.position,max:S.length})),I})}e.readAllLinesAsync=p;function h(g){for(;g.position<g.length;)switch(g.data.charCodeAt(g.position)){case 9:case 10:case 13:case 32:g.tokenEnd=g.position;return;default:++g.position;break}g.tokenEnd=g.position}e.eatValue=h;function x(g){let C=-1;for(;g.position<g.length;){let _=g.data.charCodeAt(g.position);switch(_){case 9:case 32:C=_,++g.position;break;case 10:C!==13&&++g.lineNumber,C=_,++g.position;break;case 13:C=_,++g.position,++g.lineNumber;break;default:return C}}return C}e.skipWhitespace=x;function y(g,C,_){let{data:b}=g,I=C,E=_-1,S=b.charCodeAt(I);for(;(S===9||S===32)&&I<=E;)S=b.charCodeAt(++I);for(S=b.charCodeAt(E);(S===9||S===32)&&E>=I;)S=b.charCodeAt(--E);return g.tokenStart=I,g.tokenEnd=E+1,g.position=_,g}e.trim=y})(ks||(ks={}));function t8(e,t,n){let r=t,i=n-1,o=e.charCodeAt(r);for(;(o===9||o===32)&&r<=i;)o=e.charCodeAt(++r);for(o=e.charCodeAt(i);(o===9||o===32)&&i>=r;)o=e.charCodeAt(--i);return e.substring(r,i+1)}var Mn;(function(e){function t(s){let a=new Uint32Array(1.61*s.indices.length|0);a.set(s.indices),s.indices=a,s.indicesLenMinus2=a.length-2|0}function n(s,a,c){let u=s;u.offset>u.indicesLenMinus2&&t(u),u.indices[u.offset++]=a,u.indices[u.offset++]=c,s.count++}e.add=n;function r(s,a){n(s,a.tokenStart,a.tokenEnd)}e.addToken=r;function i(s,a,c){s.indices[s.offset++]=a,s.indices[s.offset++]=c,s.count++}e.addUnchecked=i;function o(s,a){return a=Math.max(10,a),{data:s,indicesLenMinus2:a-2|0,count:0,offset:0,indices:new Uint32Array(a)}}e.create=o})(Mn||(Mn={}));var xr;(function(e){function t(o,s=-1){return new r(o,s)}e.error=t;function n(o,s=[]){return new i(o,s)}e.success=n;class r{toString(){return this.line>=0?`[Line ${this.line}] ${this.message}`:this.message}constructor(s,a){this.message=s,this.line=a,this.isError=!0}}e.Error=r;class i{constructor(s,a){this.result=s,this.warnings=a,this.isError=!1}}e.Success=i})(xr||(xr={}));function Gd(e){for(;e.position<e.length;)switch(e.data.charCodeAt(e.position)){case 9:case 10:case 13:case 32:e.tokenEnd=e.position;return;default:++e.position;break}e.tokenEnd=e.position}function F2(e,t){let n,r;for(++e.position;e.position<e.length;)if(r=e.data.charCodeAt(e.position),r===t)switch(n=e.data.charCodeAt(e.position+1),n){case 9:case 10:case 13:case 32:e.tokenStart++,e.tokenEnd=e.position,e.isEscaped=!0,++e.position;return;default:if(n===void 0){e.tokenStart++,e.tokenEnd=e.position,e.isEscaped=!0,++e.position;return}++e.position;break}else{if(r===10||r===13){e.tokenEnd=e.position;return}++e.position}e.tokenEnd=e.position}function O2(e){for(e.position+=3;e.position<e.length;){if(e.data.charCodeAt(e.position)===39&&Vd(e)){e.tokenStart+=3,e.tokenEnd=e.position,e.isEscaped=!0,e.position+=3;return}++e.position}e.tokenEnd=e.position}function L2(e){let t=59,n=e.position+1,r;for(;n<e.length;)if(r=e.data.charCodeAt(n),r===59&&(t===10||t===13)){for(e.position=n+1,e.tokenStart++,n--,r=e.data.charCodeAt(n);r===10||r===13;)n--,r=e.data.charCodeAt(n);e.tokenEnd=n+1,e.isEscaped=!0;return}else(r===13||r===10&&t!==13)&&e.lineNumber++,t=r,++n;return e.position=n,t}function q2(e){for(;e.position<e.length;)switch(e.data.charCodeAt(e.position)){case 93:++e.position,e.tokenEnd=e.position,e.isImportGet=!1;return;default:++e.position;break}}function G2(e){for(;e.position<e.length;){let t=e.data.charCodeAt(e.position);if(t===10||t===13)return;++e.position}}function H2(e){let t=10;for(;e.position<e.length;){let n=e.data.charCodeAt(e.position);switch(n){case 9:case 32:t=n,++e.position;break;case 10:t!==13&&++e.lineNumber,t=n,++e.position;break;case 13:t=n,++e.position,++e.lineNumber;break;default:return t}}return t}function Vd(e){return!(e.length-e.position<2||e.data.charCodeAt(e.position+1)!==39||e.data.charCodeAt(e.position+2)!==39)}function z2(e){let t=e.data.charCodeAt(e.tokenStart);return!(t!==68&&t!==100||(t=e.data.charCodeAt(e.tokenStart+1),t!==65&&t!==97)||(t=e.data.charCodeAt(e.tokenStart+2),t!==84&&t!==116)||(t=e.data.charCodeAt(e.tokenStart+3),t!==65&&t!==97))}function V2(e){let t=e.data.charCodeAt(e.tokenStart);return!(t!==83&&t!==115||(t=e.data.charCodeAt(e.tokenStart+1),t!==65&&t!==97)||(t=e.data.charCodeAt(e.tokenStart+2),t!==86&&t!==118)||(t=e.data.charCodeAt(e.tokenStart+3),t!==69&&t!==101))}function K2(e){if(e.tokenEnd-e.tokenStart!==5)return!1;let t=e.data.charCodeAt(e.tokenStart);return!(t!==76&&t!==108||(t=e.data.charCodeAt(e.tokenStart+1),t!==79&&t!==111)||(t=e.data.charCodeAt(e.tokenStart+2),t!==79&&t!==111)||(t=e.data.charCodeAt(e.tokenStart+3),t!==80&&t!==112))}function j2(e){return!(e.tokenEnd-e.tokenStart!==11||e.data.charCodeAt(e.tokenStart+1)!==105||e.data.charCodeAt(e.tokenStart+2)!==109||e.data.charCodeAt(e.tokenStart+3)!==112||e.data.charCodeAt(e.tokenStart+4)!==111||e.data.charCodeAt(e.tokenStart+5)!==114||e.data.charCodeAt(e.tokenStart+6)!==116||e.data.charCodeAt(e.tokenStart+7)!==46||e.data.charCodeAt(e.tokenStart+8)!==103||e.data.charCodeAt(e.tokenStart+9)!==101||e.data.charCodeAt(e.tokenStart+10)!==116)}function Y2(e,t,n){let r,i=n-t,o=e.tokenStart-t,s=e.tokenEnd-e.tokenStart;if(s<i)return!1;for(r=t;r<n;++r)if(e.data.charCodeAt(r)!==e.data.charCodeAt(r+o))return!1;return i===s||e.data.charCodeAt(r+o)===46}function Kd(e){let t;for(t=e.tokenStart;t<e.tokenEnd;++t)if(e.data.charCodeAt(t)===46)return t;return t}function jd(e,t){return e.data.substring(e.tokenStart,t)}function Z2(e){let t;for(t=e.tokenStart;t<e.tokenEnd;++t)if(e.data.charCodeAt(t)===46)return!1;return!0}function Dc(e){return e.data.substring(e.tokenStart,e.tokenEnd)}function Hd(e){let t=H2(e);if(e.position>=e.length){e.tokenType=6;return}e.tokenStart=e.position,e.tokenEnd=e.position,e.isEscaped=!1;let n=e.data.charCodeAt(e.position);switch(n){case 35:G2(e),e.tokenType=5;break;case 39:if(Vd(e)){O2(e),e.tokenType=3;break}case 34:F2(e,n),e.tokenType=3;break;case 59:t===10||t===13?L2(e):Gd(e),e.tokenType=3;break;default:e.isImportGet?q2(e):Gd(e),e.isEscaped?e.tokenType=3:e.data.charCodeAt(e.tokenStart)===95?(e.inSaveFrame&&j2(e)&&(e.isImportGet=!0),e.tokenType=4):e.tokenEnd-e.tokenStart>=5&&e.data.charCodeAt(e.tokenStart+4)===95?z2(e)?e.tokenType=0:V2(e)?e.tokenType=1:K2(e)?e.tokenType=2:e.tokenType=3:e.tokenType=3;break}}function qr(e){for(Hd(e);e.tokenType===5;)Hd(e)}function W2(e,t){return{data:e,length:e.length,position:0,tokenStart:0,tokenEnd:0,tokenType:6,lineNumber:1,isEscaped:!1,isImportGet:!1,inSaveFrame:!1,runtimeCtx:t}}function Us(){return{categoryNames:[],categoryData:Object.create(null)}}function Nc(e,t){let n=Object.create(null);for(let r of e){let i=t[r];n[r]=Mi(i.name,i.rowCount,i.fieldNames,i.fields)}return n}function zd(e,t,n){return lo(e.categoryNames,Nc(e.categoryNames,e.categoryData),t,n)}function X2(e,t){return lo(e.categoryNames,Nc(e.categoryNames,e.categoryData),t)}function Mc(e,t,n,r,i){if(t in e.categoryData){let o=e.categoryData[t];o.fieldNames.push(...r),Object.assign(o.fields,i)}else e.categoryData[t]={name:t,rowCount:n,fieldNames:r,fields:i},e.categoryNames.push(t)}function $2(e,t){let n=e.tokenStart,r=Kd(e),i=jd(e,r),o=Object.create(null),s=[],a=!0;for(;a;){if(e.tokenType!==4||!Y2(e,n,r)){a=!1;break}let c=Dc(e).substring(i.length+1);if(qr(e),e.tokenType!==3)return{hasError:!0,errorLine:e.lineNumber,errorMessage:"Expected value."};o[c]=ci.ofTokens({data:e.data,indices:[e.tokenStart,e.tokenEnd],count:1}),s[s.length]=c,qr(e)}return Mc(t,i.substr(1),1,s,o),{hasError:!1,errorLine:0,errorMessage:""}}function Q2(e,t){let{tokenizer:n,tokens:r,fieldCount:i}=t,o=t.tokenCount,s=0;for(;n.tokenType===3&&s<e;)Mn.add(r[o++%i],n.tokenStart,n.tokenEnd),qr(n),s++;return t.tokenCount=o,s}function J2(e,t){return e.update({message:"Parsing...",current:t.tokenizer.position,max:t.tokenizer.data.length})}function e_(e,t){return Ve(this,null,function*(){let n=e.lineNumber;qr(e);let r=jd(e,Kd(e)),i=Z2(e),o=[];for(;e.tokenType===4;)o[o.length]=i?Dc(e):Dc(e).substring(r.length+1),qr(e);let s=r==="_atom_site"?e.data.length/100|0:32,a=[],c=o.length;for(let m=0;m<c;m++)a[m]=Mn.create(e.data,s);let u={fieldCount:c,tokenCount:0,tokenizer:e,tokens:a};if(yield Di(e.runtimeCtx,1e6,u,Q2,J2),u.tokenCount%c!==0)return{hasError:!0,errorLine:e.lineNumber,errorMessage:`The number of values for loop starting at line ${n} is not a multiple of the number of columns.`};let l=u.tokenCount/c|0;if(i)for(let m=0;m<c;m++){let f={"":ci.ofTokens(a[m])};Mc(t,o[m].substr(1),l,[""],f)}else{let m=Object.create(null);for(let f=0;f<c;f++)m[o[f]]=ci.ofTokens(a[f]);Mc(t,r.substr(1),l,o,m)}return{hasError:!1,errorLine:0,errorMessage:""}})}function Gi(e,t){return xr.error(t,e)}function t_(e){return xr.success(e)}function n_(e,t){return Ve(this,null,function*(){let n=[],r=W2(e,t),i="",o=Us(),s=[],a=Us(),c=Tf(a.categoryNames,Nc(a.categoryNames,a.categoryData),""),u="";for(t.update({message:"Parsing...",current:0,max:e.length}),qr(r);r.tokenType!==6;){let l=r.tokenType;if(l===0){if(r.inSaveFrame)return Gi(r.lineNumber,"Unexpected data block inside a save frame.");o.categoryNames.length>0&&n.push(zd(o,i,s)),i=e.substring(r.tokenStart+5,r.tokenEnd),o=Us(),s=[],qr(r)}else if(l===1){if(r.tokenEnd-r.tokenStart===5)a.categoryNames.length>0&&(s[s.length]=X2(a,u)),r.inSaveFrame=!1;else{if(r.inSaveFrame)return Gi(r.lineNumber,"Save frames cannot be nested.");r.inSaveFrame=!0,u=e.substring(r.tokenStart+5,r.tokenEnd),a=Us()}qr(r)}else if(l===2){let m=yield e_(r,r.inSaveFrame?a:o);if(m.hasError)return Gi(m.errorLine,m.errorMessage)}else if(l===4){let m=$2(r,r.inSaveFrame?a:o);if(m.hasError)return Gi(m.errorLine,m.errorMessage)}else return console.log(r.tokenType,ks.getTokenString(r)),Gi(r.lineNumber,"Unexpected token. Expected data_, loop_, or data name.")}return r.inSaveFrame?Gi(r.lineNumber,`Unfinished save frame (${c.header}).`):((o.categoryNames.length>0||s.length>0)&&n.push(zd(o,i,s)),t_(ls(n)))})}function kc(e){return wt.create("Parse CIF",t=>Ve(this,null,function*(){return yield n_(e,t)}))}function Yd(e){let t=e.mask?Ri(e.mask):void 0,n=Ri(e.data),r=Ut.isTypedArray(n),i=r?t?u=>t[u]===0?""+n[u]:"":u=>""+n[u]:t?u=>t[u]===0?n[u]:"":u=>n[u],o=r?u=>n[u]:u=>{let l=n[u];return Pn(l,0,l.length)},s=r?u=>n[u]:u=>{let l=n[u];return Ln(l,0,l.length)},a=t?u=>t[u]:u=>0,c=n.length;return{__array:n,binaryEncoding:e.data.encoding,isDefined:!0,rowCount:c,str:i,int:o,float:s,valueKind:a,areValuesEqual:(u,l)=>n[u]===n[l],toStringArray:u=>Ut.createAndFillArray(c,i,u),toIntArray:r?u=>Ut.typedArrayWindow(n,u):u=>Ut.createAndFillArray(c,o,u),toFloatArray:r?u=>Ut.typedArrayWindow(n,u):u=>Ut.createAndFillArray(c,s,u)}}function Zd(e){return Ts({buffer:e,offset:0,dataView:new DataView(e.buffer)})}function Uc(e,t){let n={};for(let r=0;r<t;r++){let i=Ts(e);n[i]=Ts(e)}return n}function Rc(e,t){let n=new Uint8Array(t),r=e.offset;for(let i=0;i<t;i++)n[i]=e.buffer[i+r];return e.offset+=t,n}function Rs(e,t){let n=xs(e.buffer,e.offset,t);return e.offset+=t,n}function Tc(e,t){let n=new Array(t);for(let r=0;r<t;r++)n[r]=Ts(e);return n}function Ts(e){let t=e.buffer[e.offset],n,r;if(!(t&128))return e.offset++,t;if((t&240)===128)return r=t&15,e.offset++,Uc(e,r);if((t&240)===144)return r=t&15,e.offset++,Tc(e,r);if((t&224)===160)return r=t&31,e.offset++,Rs(e,r);if((t&224)===224)return n=e.dataView.getInt8(e.offset),e.offset++,n;switch(t){case 192:return e.offset++,null;case 194:return e.offset++,!1;case 195:return e.offset++,!0;case 196:return r=e.dataView.getUint8(e.offset+1),e.offset+=2,Rc(e,r);case 197:return r=e.dataView.getUint16(e.offset+1),e.offset+=3,Rc(e,r);case 198:return r=e.dataView.getUint32(e.offset+1),e.offset+=5,Rc(e,r);case 202:return n=e.dataView.getFloat32(e.offset+1),e.offset+=5,n;case 203:return n=e.dataView.getFloat64(e.offset+1),e.offset+=9,n;case 204:return n=e.buffer[e.offset+1],e.offset+=2,n;case 205:return n=e.dataView.getUint16(e.offset+1),e.offset+=3,n;case 206:return n=e.dataView.getUint32(e.offset+1),e.offset+=5,n;case 208:return n=e.dataView.getInt8(e.offset+1),e.offset+=2,n;case 209:return n=e.dataView.getInt16(e.offset+1),e.offset+=3,n;case 210:return n=e.dataView.getInt32(e.offset+1),e.offset+=5,n;case 217:return r=e.dataView.getUint8(e.offset+1),e.offset+=2,Rs(e,r);case 218:return r=e.dataView.getUint16(e.offset+1),e.offset+=3,Rs(e,r);case 219:return r=e.dataView.getUint32(e.offset+1),e.offset+=5,Rs(e,r);case 220:return r=e.dataView.getUint16(e.offset+1),e.offset+=3,Tc(e,r);case 221:return r=e.dataView.getUint32(e.offset+1),e.offset+=5,Tc(e,r);case 222:return r=e.dataView.getUint16(e.offset+1),e.offset+=3,Uc(e,r);case 223:return r=e.dataView.getUint32(e.offset+1),e.offset+=5,Uc(e,r)}throw new Error("Unknown type 0x"+t.toString(16))}function r_(e,t){for(let n=0;n<2;n++)if(e[n]>t[n])return!1;return!0}function i_(e){let t=Object.create(null),n=Object.create(null);for(let r of e.columns)t[r.name]=r;return{rowCount:e.rowCount,name:e.name.substr(1),fieldNames:e.columns.map(r=>r.name),getField(r){let i=t[r];if(i)return n[r]||(n[r]=Yd(i)),n[r]}}}function Fc(e){return wt.create("Parse BinaryCIF",t=>Ve(this,null,function*(){let n=[0,3];try{let r=Zd(e);if(!r_(n,r.version.match(/(\d)\.(\d)\.\d/).slice(1).map(o=>+o)))return xr.error(`Unsupported format version. Current ${r.version}, required ${n.join(".")}.`);let i=ls(r.dataBlocks.map(o=>{let s=Object.create(null);for(let a of o.categories)s[a.name.substr(1)]=i_(a);return lo(o.categories.map(a=>a.name.substr(1)),s,o.header)}));return xr.success(i)}catch(r){return xr.error(""+r)}}))}var li=me.Schema,Bt=li.str,o_=li.float,Wd=li.List,Jn=li.lstr,Sn=li.Aliased,bo=li.int,Hi=li.coord,Xd={chem_comp:{formula:Bt,formula_weight:o_,id:Bt,mon_nstd_parent_comp_id:Wd(",",e=>e),name:Bt,one_letter_code:Bt,three_letter_code:Bt,type:Sn(Jn),pdbx_synonyms:Wd(";",e=>e),pdbx_type:Bt,pdbx_ambiguous_flag:Bt,pdbx_replaced_by:Bt,pdbx_replaces:Bt,pdbx_formal_charge:bo,pdbx_model_coordinates_details:Bt,pdbx_model_coordinates_db_code:Bt,pdbx_ideal_coordinates_details:Bt,pdbx_ideal_coordinates_missing_flag:Sn(Jn),pdbx_model_coordinates_missing_flag:Sn(Jn),pdbx_initial_date:Bt,pdbx_modified_date:Bt,pdbx_release_status:Sn(Bt),pdbx_processing_site:Sn(Bt)},chem_comp_atom:{alt_atom_id:Bt,atom_id:Bt,charge:bo,model_Cartn_x:Hi,model_Cartn_y:Hi,model_Cartn_z:Hi,comp_id:Bt,type_symbol:Bt,pdbx_align:bo,pdbx_ordinal:bo,pdbx_model_Cartn_x_ideal:Hi,pdbx_model_Cartn_y_ideal:Hi,pdbx_model_Cartn_z_ideal:Hi,pdbx_stereo_config:Sn(Jn),pdbx_aromatic_flag:Sn(Jn),pdbx_leaving_atom_flag:Sn(Jn)},chem_comp_bond:{atom_id_1:Bt,atom_id_2:Bt,comp_id:Bt,value_order:Sn(Jn),pdbx_ordinal:bo,pdbx_stereo_config:Sn(Jn),pdbx_aromatic_flag:Sn(Jn)},pdbx_chem_comp_descriptor:{comp_id:Bt,descriptor:Bt,type:Sn(Jn),program:Bt,program_version:Bt},pdbx_chem_comp_identifier:{comp_id:Bt,identifier:Bt,type:Sn(Bt),program:Bt,program_version:Bt}};var Co=me.Schema,Qe=Co.str,s_=Co.float,Ar=Co.lstr,an=Co.Aliased,Nn=Co.int,$d={pdbx_reference_molecule:{prd_id:Qe,formula_weight:s_,formula:Qe,type:an(Ar),type_evidence_code:Qe,class:an(Ar),class_evidence_code:Qe,name:Qe,represent_as:an(Ar),chem_comp_id:Qe,compound_details:Qe,description:Qe,representative_PDB_id_code:Qe,release_status:an(Ar),replaces:Qe,replaced_by:Qe},pdbx_reference_entity_list:{prd_id:Qe,ref_entity_id:Qe,type:an(Ar),details:Qe,component_id:Nn},pdbx_reference_entity_nonpoly:{prd_id:Qe,ref_entity_id:Qe,name:Qe,chem_comp_id:Qe},pdbx_reference_entity_link:{link_id:Nn,prd_id:Qe,details:Qe,ref_entity_id_1:Qe,ref_entity_id_2:Qe,entity_seq_num_1:Nn,entity_seq_num_2:Nn,comp_id_1:Qe,comp_id_2:Qe,atom_id_1:Qe,atom_id_2:Qe,value_order:an(Ar),component_1:Nn,component_2:Nn,link_class:an(Qe)},pdbx_reference_entity_poly_link:{link_id:Nn,prd_id:Qe,ref_entity_id:Qe,component_id:Nn,entity_seq_num_1:Nn,entity_seq_num_2:Nn,comp_id_1:Qe,comp_id_2:Qe,atom_id_1:Qe,atom_id_2:Qe,value_order:an(Ar)},pdbx_reference_entity_poly:{prd_id:Qe,ref_entity_id:Qe,type:an(Qe),db_code:Qe,db_name:Qe},pdbx_reference_entity_poly_seq:{prd_id:Qe,ref_entity_id:Qe,mon_id:Qe,parent_mon_id:Qe,num:Nn,observed:an(Ar),hetero:an(Ar)},pdbx_reference_entity_sequence:{prd_id:Qe,ref_entity_id:Qe,type:an(Qe),NRP_flag:an(Qe),one_letter_codes:Qe},pdbx_reference_entity_src_nat:{prd_id:Qe,ref_entity_id:Qe,ordinal:Nn,organism_scientific:Qe,taxid:Qe,db_code:Qe,db_name:Qe},pdbx_prd_audit:{prd_id:Qe,date:Qe,processing_site:an(Qe),action_type:an(Qe)}};var Qd=me.Schema,zt=Qd.str,a_=Qd.float,c_={id:zt,description:zt},u_={title:zt,datablock_id:zt,version:zt},l_={version:zt,update:zt,revision:zt},f_={id:zt,description:zt},d_={id:zt,parent_id:zt,description:zt},m_={code:zt,primitive_code:zt,construct:zt,detail:zt},p_={code:zt,detail:zt},h_={from_code:zt,to_code:zt,operator:zt,factor:a_},Jd={datablock:c_,dictionary:u_,dictionary_history:l_,sub_category:f_,category_group_list:d_,item_type_list:m_,item_units_list:p_,item_units_conversion:h_};var So=me.Schema,er=So.str,Fs=So.int,br=So.float,Os=So.Aliased,Gr=So.Vector,E8={density_server_result:{server_version:er,datetime_utc:er,guid:er,is_empty:Os(er),has_error:Os(er),error:er,query_source_id:er,query_type:Os(er),query_box_type:Os(er),query_box_a:Gr(3),query_box_b:Gr(3)}},Ls={volume_data_3d_info:{name:er,axis_order:Gr(3,Fs),origin:Gr(3),dimensions:Gr(3),sample_rate:Fs,sample_count:Gr(3,Fs),spacegroup_number:Fs,spacegroup_cell_size:Gr(3),spacegroup_cell_angles:Gr(3),mean_source:br,mean_sampled:br,sigma_source:br,sigma_sampled:br,min_source:br,min_sampled:br,max_source:br,max_sampled:br},volume_data_3d:{values:br}};var qs=me.Schema,Lt=qs.float,Oc=qs.int,Dt=qs.str,__=qs.Matrix,em={cell:{angle_alpha:Lt,angle_beta:Lt,angle_gamma:Lt,formula_units_z:Oc,length_a:Lt,length_b:Lt,length_c:Lt,volume:Lt},chemical:{melting_point:Lt,name_common:Dt,name_systematic:Dt},chemical_formula:{moiety:Dt,sum:Dt,weight:Lt},space_group:{crystal_system:Dt,it_number:Oc,"name_h-m_full":Dt},space_group_symop:{operation_xyz:Dt},geom_bond:{atom_site_label_1:Dt,atom_site_label_2:Dt,distance:Lt,publ_flag:Dt,site_symmetry_1:Dt,site_symmetry_2:Dt,valence:Lt},audit:{block_doi:Dt},database_code:{cod:Dt,csd:Dt,depnum_ccdc_archive:Dt,depnum_ccdc_fiz:Dt,icsd:Dt,mdf:Dt,nbs:Dt},atom_site:{adp_type:Dt,calc_flag:Dt,disorder_assembly:Dt,disorder_group:Dt,fract_x:Lt,fract_y:Lt,fract_z:Lt,label:Dt,occupancy:Lt,refinement_flags:Dt,site_symmetry_multiplicity:Oc,type_symbol:Dt,u_iso_or_equiv:Lt},atom_site_aniso:{label:Dt,u_11:Lt,u:__(3,3),u_12:Lt,u_13:Lt,u_22:Lt,u_23:Lt,u_33:Lt},atom_type:{description:Dt,symbol:Dt},atom_type_scat:{dispersion_imag:Lt,dispersion_real:Lt,source:Dt}},tm={"cell.formula_units_z":["cell_formula_units_Z"],"space_group.it_number":["space_group_IT_number","symmetry_Int_Tables_number"],"space_group.name_h-m_full":["symmetry_space_group_name_H-M"],"space_group_symop.operation_xyz":["symmetry_equiv_pos_as_xyz"],"geom_bond.atom_site_label_1":["geom_bond_atom_site_id_1"],"geom_bond.atom_site_label_2":["geom_bond_atom_site_id_2"],"geom_bond.distance":["geom_bond_dist"],"audit.block_doi":["audit_block_DOI"],"database_code.cod":["database_code_COD"],"database_code.csd":["database_code_CSD"],"database_code.depnum_ccdc_archive":["database_code_depnum_CCDC_archive"],"database_code.depnum_ccdc_fiz":["database_code_depnum_CCDC_fiz"],"database_code.icsd":["database_code_ICSD"],"database_code.mdf":["database_code_MDF"],"database_code.nbs":["database_code_NBS"],"atom_site.adp_type":["atom_site_ADP_type","atom_site_thermal_displace_type"],"atom_site.label":["atom_site_id"],"atom_site.site_symmetry_multiplicity":["atom_site_symmetry_multiplicity"],"atom_site.u_iso_or_equiv":["atom_site_U_iso_or_equiv"],"atom_site_aniso.label":["atom_site_anisotrop_id"],"atom_site_aniso.u_11":["atom_site_aniso_U_11","atom_site_anisotrop_U_11"],"atom_site_aniso.u_12":["atom_site_aniso_U_12","atom_site_anisotrop_U_12"],"atom_site_aniso.u_13":["atom_site_aniso_U_13","atom_site_anisotrop_U_13"],"atom_site_aniso.u_22":["atom_site_aniso_U_22","atom_site_anisotrop_U_22"],"atom_site_aniso.u_23":["atom_site_aniso_U_23","atom_site_anisotrop_U_23"],"atom_site_aniso.u_33":["atom_site_aniso_U_33","atom_site_anisotrop_U_33"]};var g_=me.Schema,Lc=g_.int,nm={volume_data_3d_info:Ls.volume_data_3d_info,segmentation_data_table:{set_id:Lc,segment_id:Lc},segmentation_data_3d:{values:Lc}};var qc={parse:e=>typeof e=="string"?kc(e):Fc(e),parseText:kc,parseBinary:Fc,toDatabaseCollection:qf,toDatabase:En,schema:{mmCIF:e=>En(nt,e),CCD:e=>En(Xd,e),BIRD:e=>En($d,e),dic:e=>En(Jd,e),cifCore:e=>En(em,e,tm),densityServer:e=>En(Ls,e),segmentation:e=>En(nm,e)}};var zi=class{get operatorGroups(){return this._operators?this._operators:(this._operators=this.operatorsProvider(),this._operators)}constructor(t,n,r){this.operatorsProvider=r,this.id=t,this.details=n}};(function(e){function t(n,r,i){return new e(n,r,i)}e.create=t})(zi||(zi={}));var Io;(function(e){e.Default={assemblies:[],spacegroup:sn.ZeroP1,isNonStandardCrystalFrame:!1};function t(r,i){let o=i.toLocaleLowerCase(),s=Wt.Provider.get(r);return s?ol(s.assemblies,a=>a.id.toLowerCase()===o):void 0}e.findAssembly=t;function n(r){let{cell:i,name:o,num:s}=r.spacegroup,{size:a,anglesInRadians:c}=i,u=a[0].toFixed(2),l=a[1].toFixed(2),m=a[2].toFixed(2),f=On(c[0]).toFixed(2),d=On(c[1]).toFixed(2),p=On(c[2]).toFixed(2),h=[];return h.push(`Unit Cell <b>${o}</b> #${s}`),h.push(`${u}\xD7${l}\xD7${m} \u212B`),h.push(`\u03B1=${f}\xB0 \u03B2=${d}\xB0 \u03B3=${p}\xB0`),h.join(" | ")}e.getUnitcellLabel=n})(Io||(Io={}));var rm;(function(e){function t(n,r,i,o){return{id:Rt.create22(),label:n,basic:r,sourceData:o,bonds:i}}e.create=t})(rm||(rm={}));var Gc={};Br(Gc,{atomicHet:()=>A_,atomicSequence:()=>y_,bundleElementImpl:()=>C_,bundleGenerator:()=>S_,defaultBondTest:()=>Gs,spheres:()=>b_,water:()=>x_});var Pt;(function(e){function t(_){return le.ofSortedArray(_)}e.ofSortedRanges=t;function n(_){return _[0]}e.start=n;function r(_){return _[_.length-1]+1}e.end=r;function i(_){return _[0]}e.min=i;function o(_){return _[_.length-1]}e.max=o;function s(_){let b=0;for(let I=0,E=_.length;I<E;I+=2)b+=_[I+1]-_[I]+1;return b}e.size=s;function a(_){return _.length/2}e.count=a;function c(_,b){return _[b*2]}e.startAt=c;function u(_,b){return _[b*2+1]+1}e.endAt=u;function l(_,b){return _[b*2]}e.minAt=l;function m(_,b){return _[b*2+1]}e.maxAt=m;function f(_,b){if(_.length!==b.length)return!1;for(let I=0,E=_.length;I<E;++I)if(_[I]!==b[I])return!1;return!0}e.areEqual=f;function d(_,b){let I=0;for(let E=0,S=_.length;E<S;E+=2)for(let v=_[E],P=_[E+1];v<=P;++v)b(v,I),++I}e.forEach=d;function p(_,b){return x(_,b)!==-1}e.has=p;function h(_,b,I){return y(_,b,I)!==-1}e.hasFrom=h;function x(_,b){return y(_,b,0)}e.firstIntersectionIndex=x;function y(_,b,I){if(l(_,I)>Ie.max(b)||o(_)<Ie.min(b))return-1;for(let E=I,S=a(_);E<S;++E){let v=ue.ofRange(l(_,E),m(_,E));if(Ie.areIntersecting(v,b))return E}return-1}e.firstIntersectionIndexFrom=y;function g(_,b){return new C(_,b)}e.transientSegments=g;class C{updateValue(){this.value.index=this.curIndex,this.value.start=Ie.findPredecessorIndex(this.set,c(this.ranges,this.curIndex)),this.value.end=Ie.findPredecessorIndex(this.set,u(this.ranges,this.curIndex))}move(){return this.hasNext&&(this.updateValue(),this.curIndex=y(this.ranges,this.set,this.curIndex+1),this.hasNext=this.curIndex!==-1),this.value}constructor(b,I){this.ranges=b,this.set=I,this.value={index:0,start:0,end:0},this.curIndex=0,this.hasNext=!1,this.curIndex=x(b,I),this.hasNext=this.curIndex!==-1}}e.Iterator=C})(Pt||(Pt={}));var wo;(function(e){e.Empty={hash:-1,elements:[]};function t(l,m){return r(Be.toLociWithSourceUnits(Be.Singletons(l,m)))}e.fromSubStructure=t;function n(l){return r(Be.toLociWithSourceUnits(l))}e.fromSelection=n;function r(l){let m=[];for(let p of l.elements){let{unit:h,indices:x}=p;if(Ie.size(x)===0)continue;let y=[],g=[];if(Ie.isInterval(x))Ie.size(x)===1?g.push(ue.min(x)):y.push(ue.min(x),ue.max(x));else{let C=0,_=x.length;for(;C<_;){let b=C;for(C++;C<_&&x[C-1]+1===x[C];)C++;let I=C;if(I-b>2)y.push(x[b],x[I-1]);else for(let E=b;E<I;E++)g[g.length]=x[E]}}m.push({unit:h,set:le.ofSortedArray(g),ranges:Pt.ofSortedRanges(y)})}let f=new Map;for(let p=0,h=m.length;p<h;++p){let x=m[p],y=Dr(Yn(x.ranges),Yn(x.set));if(f.has(y)){let{groupedUnits:g}=f.get(y);g.has(x.unit.invariantId)?g.get(x.unit.invariantId).push(x.unit.id):g.set(x.unit.invariantId,[x.unit.id])}else{let g=new Map;g.set(x.unit.invariantId,[x.unit.id]),f.set(y,{groupedUnits:g,set:x.set,ranges:x.ranges})}}let d=[];return f.forEach(p=>{let h=[];p.groupedUnits.forEach(x=>h.push(le.ofUnsortedArray(x))),h.sort((x,y)=>x[0]-y[0]),d.push({groupedUnits:h,set:p.set,ranges:p.ranges})}),{hash:l.structure.hashCode,elements:d}}e.fromLoci=r;function i(l,m){let f=[];for(let d=0,p=l.length;d<p;++d){let h=l[d];m.unitMap.has(h)&&f.push(m.unitMap.get(h))}return f}function o(l,m){l.hash!==-1&&l.hash!==m.hashCode&&new Error("Bundle not compatible with given structure");let f=[];for(let d of l.elements)for(let p of d.groupedUnits){let h=i(p,m);if(h.length===0)continue;let x;if(d.ranges.length===0)x=d.set;else if(d.set.length===0)if(d.ranges.length===2)x=ue.ofRange(d.ranges[0],d.ranges[1]);else{let y=new Int32Array(Pt.size(d.ranges));Pt.forEach(d.ranges,(g,C)=>y[C]=g),x=le.ofSortedArray(y)}else{let y=Pt.size(d.ranges),g=new Int32Array(d.set.length+y);Pt.forEach(d.ranges,(C,_)=>g[_]=C),g.set(d.set,y),x=le.ofUnsortedArray(g)}for(let y of h)f.push({unit:y,indices:x})}return Hr(m,f)}e.toLoci=o;function s(l,m){l.hash!==-1&&l.hash!==m.hashCode&&new Error("Bundle not compatible with given structure");let f=[];for(let d of l.elements)for(let p of d.groupedUnits){let h=i(p,m);if(h.length===0)continue;let x=h[0].elements,y=Pt.size(d.ranges),g=d.set.length,C=new Int32Array(g+y),_;if(y===0){for(let b=0,I=g;b<I;++b)C[b]=x[d.set[b]];_=le.ofSortedArray(C)}else if(g===0)Pt.forEach(d.ranges,(b,I)=>C[I]=x[b]),_=le.ofSortedArray(C);else if(le.min(d.set)>Pt.max(d.ranges)){Pt.forEach(d.ranges,(b,I)=>C[I]=x[b]);for(let b=0,I=g;b<I;++b)C[b+y]=x[d.set[b]];_=le.ofSortedArray(C)}else if(Pt.min(d.ranges)>le.max(d.set)){for(let b=0,I=g;b<I;++b)C[b]=x[d.set[b]];Pt.forEach(d.ranges,(b,I)=>C[I+g]=x[b]),_=le.ofSortedArray(C)}else{Pt.forEach(d.ranges,(b,I)=>C[I]=x[b]);for(let b=0,I=g;b<I;++b)C[b+y]=x[d.set[b]];_=le.ofUnsortedArray(C)}for(let b of h)f.push(b.getChild(_))}return ot.create(f,{parent:m})}e.toStructure=s;function a(l){return St.internal.generator.bundleElement({groupedUnits:St.core.type.list(l.groupedUnits.map(m=>St.core.type.list(m))),ranges:St.core.type.list(l.ranges),set:St.core.type.list(l.set)})}function c(l){return St.internal.generator.bundle({elements:St.core.type.list(l.elements.map(a))})}e.toExpression=c;function u(l,m){if(l.elements.length!==m.elements.length)return!1;for(let f=0,d=l.elements.length;f<d;++f){let p=l.elements[f],h=m.elements[f];if(p.groupedUnits.length!==h.groupedUnits.length)return!1;for(let x=0,y=h.groupedUnits.length;x<y;++x)if(!le.areEqual(p.groupedUnits[x],h.groupedUnits[x]))return!1;if(!le.areEqual(p.set,h.set)||!Pt.areEqual(p.ranges,h.ranges))return!1}return!0}e.areEqual=u})(wo||(wo={}));function Gs(e){return $t.isCovalent(e.atomicBond.type)}function y_(){return function(t){let{inputStructure:n}=t,r=ht.Location.create(n),i=[];for(let o of n.units){if(o.kind!==0)continue;r.unit=o;let s=o.elements;if(r.element=s[0],Ye.entity.type(r)!=="polymer")continue;let a=We.transientSegments(o.model.atomicHierarchy.residueAtomSegments,s),c=0;for(;a.hasNext;)c++,a.move();c<8||i.push(o)}return Be.Singletons(n,ot.create(i,{parent:n}))}}function x_(){return function(t){let{inputStructure:n}=t,r=ht.Location.create(n),i=[];for(let o of n.units){if(o.kind!==0)continue;r.unit=o;let s=o.elements;r.element=s[0],Ye.entity.type(r)==="water"&&i.push(o)}return Be.Singletons(n,ot.create(i,{parent:n}))}}function A_(){return function(t){let{inputStructure:n}=t,r=ht.Location.create(n),i=[];for(let o of n.units){if(o.kind!==0)continue;r.unit=o;let s=o.elements;if(r.element=s[0],Ye.entity.type(r)!=="water"){if(Ye.entity.type(r)==="polymer"){let a=We.transientSegments(o.model.atomicHierarchy.residueAtomSegments,s),c=0;for(;a.hasNext;)c++,a.move();if(c>=8)continue}i.push(o)}}return Be.Singletons(n,ot.create(i,{parent:n}))}}function b_(){return function(t){let{inputStructure:n}=t,r=[];for(let i of n.units)i.kind===1&&r.push(i);return Be.Singletons(n,ot.create(r,{parent:n}))}}function C_(e,t,n){return{groupedUnits:e,ranges:t,set:n}}function S_(e){return function(n){let r={hash:n.inputStructure.hashCode,elements:e};return Be.Sequence(n.inputStructure,[wo.toStructure(r,n.inputStructure)])}}var fi=class{pushCurrentElement(){return this.currentElementStack[this.currentElementStack.length]=this.element,this.element=ht.Location.create(void 0),this.element}popCurrentElement(){this.element=this.currentElementStack.pop()}pushCurrentBond(){return this.atomicBond&&this.currentAtomicBondStack.push(this.atomicBond),this.atomicBond=new Hs,this.atomicBond}popCurrentBond(){this.currentAtomicBondStack.length>0?this.atomicBond=this.currentAtomicBondStack.pop():this.atomicBond=void 0}pushCurrentStructure(){this.currentStructure&&this.currentStructureStack.push(this.currentStructure)}popCurrentStructure(){this.currentStructureStack.length?this.currentStructure=this.currentStructureStack.pop():this.currentStructure=void 0}pushInputStructure(t){this.inputStructureStack.push(this.inputStructure),this.inputStructure=t}popInputStructure(){if(this.inputStructureStack.length===0)throw new Error("Must push before pop.");this.inputStructure=this.inputStructureStack.pop()}throwIfTimedOut(){if(this.timeoutMs!==0&&Qt()-this.timeCreated>this.timeoutMs)throw new Error(`The query took too long to execute (> ${this.timeoutMs/1e3}s).`)}tryGetCurrentSelection(){if(!this.currentSelection)throw new Error("The current selection is not assigned.");return this.currentSelection}constructor(t,n){this.currentElementStack=[],this.currentAtomicBondStack=[],this.currentStructureStack=[],this.inputStructureStack=[],this.timeCreated=Qt(),this.element=ht.Location.create(void 0),this.currentStructure=void 0,this.atomicBond=new Hs,this.currentSelection=void 0,this.inputStructure=t,this.timeoutMs=n&&n.timeoutMs||0,this.currentSelection=n&&n.currentSelection}},Hs=class{constructor(){this.a=ht.Location.create(void 0),this.aIndex=0,this.b=ht.Location.create(void 0),this.bIndex=0,this.type=0,this.order=0,this.key=-1,this.testFn=Gs}setStructure(t){this.a.structure=t,this.b.structure=t}setTestFn(t){this.testFn=t||Gs}test(t,n){return this.testFn(t)?!0:n?(this.swap(),this.testFn(t)):!1}swap(){let t=this.aIndex;this.aIndex=this.bIndex,this.bIndex=t;let n=this.a.unit;this.a.unit=this.b.unit,this.b.unit=n;let r=this.a.element;this.a.element=this.b.element,this.b.element=r}get length(){return ht.Location.distance(this.a,this.b)}};var Hc;(function(e){function t(n,r,i){return n(new fi(r,i))}e.run=t})(Hc||(Hc={}));var Kc={};Br(Kc,{all:()=>om,atoms:()=>Vc,bondedAtomicPairs:()=>k_,chains:()=>v_,none:()=>js,querySelection:()=>N_,residues:()=>w_,rings:()=>M_});function di(e,t){if(t.length===0)return ot.Empty;if(t.length===1)return t[0];let n=new Map,r=new Set;for(let{units:o}of t)for(let s=0,a=o.length;s<a;s++){let c=o[s];if(n.has(c.id)){if(r.has(c.id))continue;let u=le.union(n.get(c.id),c.elements);n.set(c.id,u),u.length===e.unitMap.get(c.id).elements.length&&r.add(c.id)}else n.set(c.id,c.elements),c.elements.length===e.unitMap.get(c.id).elements.length&&r.add(c.id)}let i=e.subsetBuilder(!0);return n.forEach(I_,i),i.getStructure()}function I_(e,t){this.setUnit(t,e)}function B7(e,t){if(e===t)return!0;if(e.units.length!==t.units.length)return!1;let n=e.units,r=t.unitMap;for(let i=0,o=n.length;i<o;i++){let s=n[i];if(!r.has(s.id))return!1;let a=r.get(s.id);if(!le.areEqual(s.elements,a.elements))return!1}return!0}function zs(e,t){if(e===t)return!0;let n,r;e.units.length<t.units.length?(n=e,r=t):(n=t,r=e);let i=n.units,o=r.unitMap;for(let s=0,a=i.length;s<a;s++){let c=i[s];if(!o.has(c.id))continue;let u=o.get(c.id);if(le.areIntersecting(c.elements,u.elements))return!0}return!1}function im(e,t){if(e===t)return e;if(!zs(e,t))return ot.Empty;let n,r;e.units.length<t.units.length?(n=e,r=t):(n=t,r=e);let i=n.units,o=r.unitMap,s=[];for(let a=0,c=i.length;a<c;a++){let u=i[a];if(!o.has(u.id))continue;let l=o.get(u.id);if(le.areIntersecting(u.elements,l.elements)){let m=le.intersect(u.elements,l.elements);s[s.length]=u.getChild(m)}}return ot.create(s,{parent:e.parent||t.parent})}function Vs(e,t){if(e===t)return ot.Empty;if(!zs(e,t))return e;let n=e.units,r=t.unitMap,i=[];for(let o=0,s=n.length;o<s;o++){let a=n[o];if(!r.has(a.id)){i[i.length]=a;continue}let c=r.get(a.id),u=le.subtract(a.elements,c.elements);u.length>0&&(i[i.length]=a.getChild(u))}return ot.create(i,{parent:e.parent||t.parent})}var Vi=class{add(t){t.elementCount&&(t.elementCount!==1&&(this.allSingletons=!1),this.set.add(t)&&(this.structures[this.structures.length]=t))}getSelection(){return this.allSingletons?Be.Singletons(this.source,di(this.source,this.structures)):Be.Sequence(this.source,this.structures)}constructor(t){this.source=t,this.set=wi(ot.hashCode,ot.areUnitIdsAndIndicesEqual),this.structures=[],this.allSingletons=!0}},Ks=class{add(t,n,r){let i=this.builderMap.get(t);i||(i=this.source.subsetBuilder(!0),this.builders[this.builders.length]=i,this.builderMap.set(t,i)),i.addToUnit(n,r)}allSingletons(){for(let t=0,n=this.builders.length;t<n;t++)if(this.builders[t].elementCount>1)return!1;return!0}singletonSelection(){let t=this.source.subsetBuilder(!0),n=ht.Location.create(this.source);for(let r=0,i=this.builders.length;r<i;r++)this.builders[r].setSingletonLocation(n),t.addToUnit(n.unit.id,n.element);return Be.Singletons(this.source,t.getStructure())}fullSelection(){let t=new Array(this.builders.length);for(let n=0,r=this.builders.length;n<r;n++)t[n]=this.builders[n].getStructure();return Be.Sequence(this.source,t)}getSelection(){return this.builders.length===0?Be.Empty(this.source):this.allSingletons()?this.singletonSelection():this.fullSelection()}constructor(t){this.source=t,this.builders=[],this.builderMap=new Map}};var js=e=>Be.Sequence(e.inputStructure,[]),om=e=>Be.Singletons(e.inputStructure,e.inputStructure);function w_(e){return Vc(Ct(Le({},e),{groupBy:t=>Ye.residue.key(t.element)}))}function v_(e){return Vc(Ct(Le({},e),{groupBy:t=>Ye.chain.key(t.element)}))}function zr(e){return!0}function P_(e){return 0}function Vc(e){if(!e||!e.atomTest&&!e.residueTest&&!e.chainTest&&!e.entityTest&&!e.unitTest&&!e.groupBy)return om;if(e.atomTest&&!e.residueTest&&!e.chainTest&&!e.entityTest&&!e.unitTest&&!e.groupBy)return B_(e.atomTest);let t={unitTest:e.unitTest||zr,entityTest:e.entityTest||zr,chainTest:e.chainTest||zr,residueTest:e.residueTest||zr,atomTest:e.atomTest||zr,groupBy:e.groupBy||P_};return e.groupBy?D_(t):E_(t)}function B_(e){return function(n){let{inputStructure:r}=n,{units:i}=r,o=n.pushCurrentElement(),s=r.subsetBuilder(!0);o.structure=r;for(let a of i){o.unit=a;let c=a.elements;s.beginUnit(a.id);for(let u=0,l=c.length;u<l;u++)o.element=c[u],e(n)&&s.addElement(o.element);s.commitUnit(),n.throwIfTimedOut()}return n.popCurrentElement(),Be.Singletons(r,s.getStructure())}}function E_({unitTest:e,entityTest:t,chainTest:n,residueTest:r,atomTest:i}){return function(s){let{inputStructure:a}=s,{units:c}=a,u=s.pushCurrentElement(),l=a.subsetBuilder(!0),m=r===zr&&i===zr,f=i===zr;u.structure=a;for(let d of c){if(u.unit=d,!e(s))continue;let{elements:p,model:h}=d;if(l.beginUnit(d.id),d.kind===0){let x=We.transientSegments(d.model.atomicHierarchy.chainAtomSegments,p),y=We.transientSegments(d.model.atomicHierarchy.residueAtomSegments,p);for(;x.hasNext;){let g=x.move();if(u.element=p[g.start],!(!t(s)||!n(s))){if(m){l.addElementRange(p,g.start,g.end);continue}for(y.setSegment(g);y.hasNext;){let C=y.move();if(u.element=p[C.start],!!r(s)){if(f){l.addElementRange(p,C.start,C.end);continue}for(let _=C.start,b=C.end;_<b;_++)u.element=p[_],i(s)&&l.addElement(u.element)}}}}}else{let{chainElementSegments:x}=h.coarseHierarchy.spheres,y=We.transientSegments(x,p);for(;y.hasNext;){let g=y.move();if(u.element=p[g.start],!(!t(s)||!n(s))){if(m){l.addElementRange(p,g.start,g.end);continue}for(let C=g.start,_=g.end;C<_;C++)u.element=p[C],r(s)&&l.addElement(u.element)}}}l.commitUnit(),s.throwIfTimedOut()}return s.popCurrentElement(),Be.Singletons(a,l.getStructure())}}function D_({unitTest:e,entityTest:t,chainTest:n,residueTest:r,atomTest:i,groupBy:o}){return function(a){let{inputStructure:c}=a,{units:u}=c,l=a.pushCurrentElement(),m=new Ks(c);l.structure=c;for(let f of u){if(l.unit=f,!e(a))continue;let{elements:d,model:p}=f;if(f.kind===0){let h=We.transientSegments(p.atomicHierarchy.chainAtomSegments,d),x=We.transientSegments(p.atomicHierarchy.residueAtomSegments,d);for(;h.hasNext;){let y=h.move();if(l.element=d[y.start],!(!t(a)||!n(a)))for(x.setSegment(y);x.hasNext;){let g=x.move();if(l.element=d[g.start],!!r(a))for(let C=g.start,_=g.end;C<_;C++)l.element=d[C],i(a)&&m.add(o(a),f.id,l.element)}}}else{let{chainElementSegments:h}=p.coarseHierarchy.spheres,x=We.transientSegments(h,d);for(;x.hasNext;){let y=x.move();if(l.element=d[y.start],!(!t(a)||!n(a)))for(let g=y.start,C=y.end;g<C;g++)l.element=d[g],r(a)&&m.add(o(a),f.id,l.element)}}a.throwIfTimedOut()}return a.popCurrentElement(),m.getSelection()}}function zc(e,t,n){let r=new Int32Array(t.length);for(let i=0,o=t.length;i<o;i++)r[i]=e.elements[t[i]];return ot.create([e.getChild(le.ofSortedArray(r))],{parent:n})}function M_(e,t){return function(r){let{units:i}=r.inputStructure,o=Be.LinearBuilder(r.inputStructure);if(!e||e.length===0){for(let s of i)if(ge.isAtomic(s))if(t)for(let a of s.rings.aromaticRings)o.add(zc(s,s.rings.all[a],r.inputStructure));else for(let a of s.rings.all)o.add(zc(s,a,r.inputStructure))}else{let s=It.create();for(let a=0;a<e.length;a++)It.add(s,e[a],e[a]);for(let a of i){if(!ge.isAtomic(a))continue;let c=a.rings;for(let u of s.array)if(c.byFingerprint.has(u))for(let l of c.byFingerprint.get(u))t&&!c.aromaticRings.includes(l)||o.add(zc(a,c.all[l],r.inputStructure))}}return o.getSelection()}}function N_(e,t,n=!1){return function(i){let o=e(i);if(Be.structureCount(o)===0)return o;let s=n?Vs(i.inputStructure,Be.unionStructure(o)):Be.unionStructure(o);if(s.elementCount===0)return Be.Empty(i.inputStructure);i.throwIfTimedOut(),i.pushInputStructure(s);let a=t(i);return i.popInputStructure(),Be.withInputStructure(a,i.inputStructure)}}function k_(e){return function(n){let r=n.inputStructure,i=r.interUnitBonds,o=Be.UniqueBuilder(n.inputStructure);n.pushCurrentBond();let s=n.atomicBond;s.setTestFn(e),s.setStructure(r);for(let a of r.units){if(a.kind!==0)continue;let{offset:c,b:u,edgeProps:{flags:l,order:m,key:f}}=a.bonds;s.a.unit=a,s.b.unit=a;for(let d=0,p=a.elements.length;d<p;d++){s.aIndex=d,s.a.element=a.elements[d];for(let h=c[d],x=c[d+1];h<x;h++)if(s.bIndex=u[h],s.b.element=a.elements[u[h]],s.type=l[h],s.order=m[h],s.key=f[h],s.test(n,!1)){let y=r.subsetBuilder(!1);y.beginUnit(a.id),y.addElement(s.a.element),y.addElement(s.b.element),y.commitUnit(),o.add(y.getStructure())}}}for(let a of i.edges)if(s.a.unit=r.unitMap.get(a.unitA),s.a.element=s.a.unit.elements[a.indexA],s.aIndex=a.indexA,s.b.unit=r.unitMap.get(a.unitB),s.b.element=s.b.unit.elements[a.indexB],s.bIndex=a.indexB,s.order=a.props.order,s.type=a.props.flag,s.key=a.props.key,s.test(n,!1)){let c=r.subsetBuilder(!1);c.addToUnit(s.a.unit.id,s.a.element),c.addToUnit(s.b.unit.id,s.b.element),o.add(c.getStructure())}return n.popCurrentBond(),o.getSelection()}}var uu={};Br(uu,{exceptBy:()=>Fy,expandProperty:()=>Ly,includeConnected:()=>qy,includeSurroundings:()=>Uy,intersectBy:()=>Ty,querySelection:()=>Ry,surroundingLigands:()=>Hy,union:()=>Oy,wholeResidues:()=>My});var U_=N.add,R_=N.squaredDistance,T_=N.distance;var Vr=class{reset(){N.set(this.center,0,0,0),this.radiusSq=0,this.count=0}includeStep(t){U_(this.center,this.center,t),this.count++}finishedIncludeStep(){this.count!==0&&N.scale(this.center,this.center,1/this.count)}radiusStep(t){let n=R_(t,this.center);n>this.radiusSq&&(this.radiusSq=n)}radiusSphereStep(t,n){let r=T_(t,this.center)+n,i=r*r;i>this.radiusSq&&(this.radiusSq=i)}getSphere(t){return t||(t=Kt()),N.copy(t.center,this.center),t.radius=Math.sqrt(this.radiusSq),t}getCount(){return this.count}constructor(){this.count=0,this.center=N(),this.radiusSq=0}};(function(e){let t=new e,n=N(),r=N();function i({x:a,y:c,z:u},l){t.reset();let m=a.length;for(let f=0;f<m;f++)N.set(n,a[f],c[f],u[f]),t.includeStep(n);t.finishedIncludeStep();for(let f=0;f<m;f++)N.set(n,a[f],c[f],u[f]),t.radiusStep(n);return N.copy(l.center,t.center),l.radius=Math.sqrt(t.radiusSq),l}e.fromArrays=i;function o(a,c,u){t.reset();for(let l=0;l<a;l++)c(l,n),t.includeStep(n);t.finishedIncludeStep();for(let l=0;l<a;l++)c(l,n),t.radiusStep(n);return N.copy(u.center,t.center),u.radius=Math.sqrt(t.radiusSq),u}e.fromProvider=o;function s(a,c,u){t.reset();for(let l=0;l<a;l++)c(l,n,r),t.includeStep(n),t.includeStep(r);t.finishedIncludeStep();for(let l=0;l<a;l++)c(l,n,r),t.radiusStep(n),t.radiusStep(r);return N.copy(u.center,t.center),u.radius=Math.sqrt(t.radiusSq),u}e.fromPairProvider=s})(Vr||(Vr={}));var Cr=class e{getConnectedUnits(t){return this.map.has(t)?this.map.get(t):sm}getEdgeIndex(t,n,r,i){let o=e.getEdgeKey(t,n,r,i),s=this.edgeKeyIndex.get(o);return s!==void 0?s:-1}hasEdge(t,n,r,i){return this.getEdgeIndex(t,n,r,i)!==-1}getEdge(t,n,r,i){let o=this.getEdgeIndex(t,n,r,i);return o!==-1?this.edges[o]:void 0}getEdgeIndices(t,n){return this.vertexKeyIndex.get(e.getVertexKey(t,n))||[]}constructor(t){this.map=t;let n=0,r=[],i=new Map,o=new Map;this.map.forEach(s=>{s.forEach(a=>{n+=a.edgeCount,a.connectedIndices.forEach(c=>{a.getEdges(c).forEach(u=>{let{unitA:l,unitB:m}=a,f=e.getEdgeKey(c,l,u.indexB,m);i.set(f,r.length);let d=e.getVertexKey(c,l),p=o.get(d);p===void 0?o.set(d,[r.length]):p.push(r.length),r.push(Ct(Le({},u),{indexA:c,unitA:l,unitB:m}))})})})}),this.edgeCount=n,this.edges=r,this.edgeKeyIndex=i,this.vertexKeyIndex=o}};(function(e){class t{hasEdges(a){return this.edgeMap.has(a)}getEdges(a){return this.edgeMap.has(a)?this.edgeMap.get(a):sm}get areUnitsOrdered(){return this.unitA<this.unitB}constructor(a,c,u,l,m){this.unitA=a,this.unitB=c,this.edgeCount=u,this.connectedIndices=l,this.edgeMap=m}}e.UnitPairEdges=t;function n(s,a,c,u){return`${s}|${a}|${c}|${u}`}e.getEdgeKey=n;function r(s,a){return`${s}|${a}`}e.getVertexKey=r;function i(s,a,c){s.has(a)?s.get(a).push(c):s.set(a,[c])}class o{constructor(){this.map=new Map}startUnitPair(a,c){this.uA=a,this.uB=c,this.mapAB=new Map,this.mapBA=new Map,this.linkedA=It.create(),this.linkedB=It.create(),this.linkCount=0}finishUnitPair(){this.linkCount!==0&&(i(this.map,this.uA,new t(this.uA,this.uB,this.linkCount,this.linkedA.array,this.mapAB)),i(this.map,this.uB,new t(this.uB,this.uA,this.linkCount,this.linkedB.array,this.mapBA)))}add(a,c,u){i(this.mapAB,a,{indexB:c,props:u}),i(this.mapBA,c,{indexB:a,props:u}),It.add(this.linkedA,a,a),It.add(this.linkedB,c,c),this.linkCount+=1}getMap(){return this.map}}e.Builder=o})(Cr||(Cr={}));var sm=[];var Ys;(function(e){e.Empty=Jt.create([],[],[],0,{flags:[],order:[],key:[]})})(Ys||(Ys={}));var Sr=class extends Cr{getBondFromLocation(t){return ge.isAtomic(t.aUnit)&&ge.isAtomic(t.bUnit)?this.getEdge(t.aIndex,t.aUnit.id,t.bIndex,t.bUnit.id):void 0}getBondIndexFromLocation(t){return ge.isAtomic(t.aUnit)&&ge.isAtomic(t.bUnit)?this.getEdgeIndex(t.aIndex,t.aUnit.id,t.bIndex,t.bUnit.id):-1}};(function(e){class t extends Cr.UnitPairEdges{}e.UnitPairBonds=t})(Sr||(Sr={}));var Zs={forceCompute:!1,noCompute:!1,maxRadius:4},jc={H:0,h:0,D:0,d:0,T:0,t:0,He:2,HE:2,he:2,Li:3,LI:3,li:3,Be:4,BE:4,be:4,B:5,b:5,C:6,c:6,N:7,n:7,O:8,o:8,F:9,f:9,Ne:10,NE:10,ne:10,Na:11,NA:11,na:11,Mg:12,MG:12,mg:12,Al:13,AL:13,al:13,Si:14,SI:14,si:14,P:15,p:15,S:16,s:16,Cl:17,CL:17,cl:17,Ar:18,AR:18,ar:18,K:19,k:19,Ca:20,CA:20,ca:20,Sc:21,SC:21,sc:21,Ti:22,TI:22,ti:22,V:23,v:23,Cr:24,CR:24,cr:24,Mn:25,MN:25,mn:25,Fe:26,FE:26,fe:26,Co:27,CO:27,co:27,Ni:28,NI:28,ni:28,Cu:29,CU:29,cu:29,Zn:30,ZN:30,zn:30,Ga:31,GA:31,ga:31,Ge:32,GE:32,ge:32,As:33,AS:33,as:33,Se:34,SE:34,se:34,Br:35,BR:35,br:35,Kr:36,KR:36,kr:36,Rb:37,RB:37,rb:37,Sr:38,SR:38,sr:38,Y:39,y:39,Zr:40,ZR:40,zr:40,Nb:41,NB:41,nb:41,Mo:42,MO:42,mo:42,Tc:43,TC:43,tc:43,Ru:44,RU:44,ru:44,Rh:45,RH:45,rh:45,Pd:46,PD:46,pd:46,Ag:47,AG:47,ag:47,Cd:48,CD:48,cd:48,In:49,IN:49,in:49,Sn:50,SN:50,sn:50,Sb:51,SB:51,sb:51,Te:52,TE:52,te:52,I:53,i:53,Xe:54,XE:54,xe:54,Cs:55,CS:55,cs:55,Ba:56,BA:56,ba:56,La:57,LA:57,la:57,Ce:58,CE:58,ce:58,Pr:59,PR:59,pr:59,Nd:60,ND:60,nd:60,Pm:61,PM:61,pm:61,Sm:62,SM:62,sm:62,Eu:63,EU:63,eu:63,Gd:64,GD:64,gd:64,Tb:65,TB:65,tb:65,Dy:66,DY:66,dy:66,Ho:67,HO:67,ho:67,Er:68,ER:68,er:68,Tm:69,TM:69,tm:69,Yb:70,YB:70,yb:70,Lu:71,LU:71,lu:71,Hf:72,HF:72,hf:72,Ta:73,TA:73,ta:73,W:74,w:74,Re:75,RE:75,re:75,Os:76,OS:76,os:76,Ir:77,IR:77,ir:77,Pt:78,PT:78,pt:78,Au:79,AU:79,au:79,Hg:80,HG:80,hg:80,Tl:81,TL:81,tl:81,Pb:82,PB:82,pb:82,Bi:83,BI:83,bi:83,Po:84,PO:84,po:84,At:85,AT:85,at:85,Rn:86,RN:86,rn:86,Fr:87,FR:87,fr:87,Ra:88,RA:88,ra:88,Ac:89,AC:89,ac:89,Th:90,TH:90,th:90,Pa:91,PA:91,pa:91,U:92,u:92,Np:93,NP:93,np:93,Pu:94,PU:94,pu:94,Am:95,AM:95,am:95,Cm:96,CM:96,cm:96,Bk:97,BK:97,bk:97,Cf:98,CF:98,cf:98,Es:99,ES:99,es:99,Fm:100,FM:100,fm:100,Md:101,MD:101,md:101,No:102,NO:102,no:102,Lr:103,LR:103,lr:103,Rf:104,RF:104,rf:104,Db:105,DB:105,db:105,Sg:106,SG:106,sg:106,Bh:107,BH:107,bh:107,Hs:108,HS:108,hs:108,Mt:109,MT:109,mt:109},F_={0:1.42,1:1.42,3:2.7,4:2.7,6:1.75,7:1.6,8:1.52,11:2.7,12:2.7,13:2.7,14:1.9,15:2,16:1.9,17:1.8,19:2.7,20:2.7,21:2.7,22:2.7,23:2.7,24:2.7,25:2.7,26:2.7,27:2.7,28:2.7,29:2.7,30:2.7,31:2.7,33:2.68,37:2.7,38:2.7,39:2.7,40:2.7,41:2.7,42:2.7,43:2.7,44:2.7,45:2.7,46:2.7,47:2.7,48:2.7,49:2.7,50:2.7,55:2.7,56:2.7,57:2.7,58:2.7,59:2.7,60:2.7,61:2.7,62:2.7,63:2.7,64:2.7,65:2.7,66:2.7,67:2.7,68:2.7,69:2.7,70:2.7,71:2.7,72:2.7,73:2.7,74:2.7,75:2.7,76:2.7,77:2.7,78:2.7,79:2.7,80:2.7,81:2.7,82:2.7,83:2.7,87:2.7,88:2.7,89:2.7,90:2.7,91:2.7,92:2.7,93:2.7,94:2.7,95:2.7,96:2.7,97:2.7,98:2.7,99:2.7,100:2.7,101:2.7,102:2.7,103:2.7,104:2.7,105:2.7,106:2.7,107:2.7,108:2.7,109:2.88},O_={0:.8,20:1.31,27:1.2,35:1.15,44:1.1,54:1,60:1.84,72:1.88,84:1.75,85:1.56,86:1.76,98:1.6,99:1.68,100:1.63,112:1.6,113:1.59,114:1.36,129:1.45,135:1.47,144:1.6,152:1.45,170:1.4,180:1.55,202:2.4,222:2.24,224:1.91,225:1.98,243:2.02,269:2,293:1.9,316:1.8,420:2.37,480:2.3,512:2.3,544:2.3,612:2.1,629:1.54,665:1,813:2.6,854:2.27,894:1.93,896:2.1,937:2.05,938:2.06,981:1.62,1258:2.68,1309:2.33,1484:1,1763:2.14,1823:2.48,1882:2.1,1944:1.72,2380:2.34,3367:2.44,3733:2.11,3819:2.6,3821:2.36,4736:2.75,5724:2.73,5959:2.63,6519:2.84,6750:2.87,8991:2.81},am=2.001,Ki=function(){let e=["LI","NA","K","RB","CS","FR","BE","MG","CA","SR","BA","RA","AL","GA","IN","SN","TL","PB","BI","SC","TI","V","CR","MN","FE","CO","NI","CU","ZN","Y","ZR","NB","MO","TC","RU","RH","PD","AG","CD","LA","HF","TA","W","RE","OS","IR","PT","AU","HG","AC","RF","DB","SG","BH","HS","MT","CE","PR","ND","PM","SM","EU","GD","TB","DY","HO","ER","TM","YB","LU","TH","PA","U","NP","PU","AM","CM","BK","CF","ES","FM","MD","NO","LR"],t=new Set;for(let n of e)t.add(jc[n]);return t}();function L_(e,t){return e<t?(e+t)*(e+t+1)/2+t:(e+t)*(e+t+1)/2+e}function tr(e){let t=jc[e];return t===void 0?-1:t}function q_(e,t){if(e<0||t<0)return-1;let n=O_[L_(e,t)];return n===void 0?-1:n}function nr(e){if(e<0)return am;let t=F_[e];return t===void 0?am:t}function ji(e,t,n,r){let i=q_(e,t);return i>0?i:t<0?n:(n+r)/1.95}var G_=jc.H;function rr(e){return e===G_}var H_=new Map([["HIS|CD2|CG",2],["HIS|CE1|ND1",2],["ARG|CZ|NH2",2],["PHE|CE1|CZ",2],["PHE|CD2|CE2",2],["PHE|CD1|CG",2],["TRP|CD1|CG",2],["TRP|CD2|CE2",2],["TRP|CE3|CZ3",2],["TRP|CH2|CZ2",2],["ASN|CG|OD1",2],["GLN|CD|OE1",2],["TYR|CD1|CG",2],["TYR|CD2|CE2",2],["TYR|CE1|CZ",2],["ASP|CG|OD1",2],["GLU|CD|OE1",2],["G|C8|N7",2],["G|C4|C5",2],["G|C2|N3",2],["G|C6|O6",2],["C|C4|N3",2],["C|C5|C6",2],["C|C2|O2",2],["A|C2|N3",2],["A|C6|N1",2],["A|C4|C5",2],["A|C8|N7",2],["U|C5|C6",2],["U|C2|O2",2],["U|C4|O4",2],["DG|C8|N7",2],["DG|C4|C5",2],["DG|C2|N3",2],["DG|C6|O6",2],["DC|C4|N3",2],["DC|C5|C6",2],["DC|C2|O2",2],["DA|C2|N3",2],["DA|C6|N1",2],["DA|C4|C5",2],["DA|C8|N7",2],["DT|C5|C6",2],["DT|C2|O2",2],["DT|C4|O4",2]]);function cm(e,t,n){return[t,n]=t<n?[t,n]:[n,t],xo.has(e)&&t==="C"&&n==="O"||Sc.has(e)&&t==="OP1"&&n==="P"?2:H_.get(`${e}|${t}|${n}`)||1}var z_=new Map([["LYS|NZ|RET|C15",2]]);function Ws(e,t,n,r){return e>n&&([e,n]=[n,e],[t,r]=[r,t]),z_.get(`${e}|${t}|${n}|${r}`)||1}var Ir;(function(e){e.Descriptor={name:"chem_comp_bond",cifExport:{prefix:"",categories:[{name:"chem_comp_bond",instance(i){let o=e.Provider.get(i.firstModel);if(!o)return At.Category.Empty;let s=o.data;if(!s)return At.Category.Empty;let a=i.structures[0].uniqueResidueNames,{comp_id:c,_rowCount:u}=s,l=[];for(let m=0;m<u;m++)a.has(c.value(m))&&(l[l.length]=m);return At.Category.ofTable(s,l)}}]}},e.Provider=en.create(e.Descriptor);function t(i,o){return mt.pick(o,nt.chem_comp_bond,s=>i.properties.chemicalComponentMap.has(o.comp_id.value(s)))}e.chemCompBondFromTable=t;function n(i){let o=new Map;function s(h){if(o.has(h))return o.get(h);let x=new r(h);return o.set(h,x),x}let{comp_id:a,atom_id_1:c,atom_id_2:u,value_order:l,pdbx_aromatic_flag:m,_rowCount:f,pdbx_ordinal:d}=i,p=s(a.value(0));for(let h=0;h<f;h++){let x=a.value(h),y=c.value(h),g=u.value(h),C=l.value(h),_=m.value(h)==="y",b=d.value(h);p.id!==x&&(p=s(x));let I=1,E=1;switch(_&&(I|=16),C.toLowerCase()){case"delo":I|=16;break;case"doub":E=2;break;case"trip":E=3;break;case"quad":E=4;break}p.add(y,g,E,I,b)}return o}e.getEntriesFromChemCompBond=n;class r{add(o,s,a,c,u,l=!0){let m=this.map.get(o);if(m!==void 0)m.get(s)===void 0&&m.set(s,{order:a,flags:c,key:u});else{let f=new Map;f.set(s,{order:a,flags:c,key:u}),this.map.set(o,f)}l&&this.add(s,o,a,c,u,!1)}constructor(o){this.id=o,this.map=new Map}}e.Entry=r})(Ir||(Ir={}));var cn;(function(e){e.Descriptor={name:"struct_conn",cifExport:{prefix:"",categories:[{name:"struct_conn",instance(o){let s=e.Provider.get(o.firstModel);if(!s||s.entries.length===0)return At.Category.Empty;let a=o.structures[0],c=[];for(let u of s.entries)n(a,u.partnerA.atomIndex)&&n(a,u.partnerB.atomIndex)&&(c[c.length]=u.rowIndex);return At.Category.ofTable(s.data,c)}}]}},e.Provider=en.create(e.Descriptor);function t(o){let s=e.Provider.get(o);return!!s&&s.data.id.rowCount/o.atomicConformation.atomId.rowCount>.95}e.isExhaustive=t;function n({units:o},s){for(let a=0,c=o.length;a<c;a++)if(le.indexOf(o[a].elements,s)>=0)return!0;return!1}function r(o){let s=new Map;for(let a of o){let{partnerA:{atomIndex:c},partnerB:{atomIndex:u}}=a;s.has(c)?s.get(c).push(a):s.set(c,[a]),s.has(u)?s.get(u).push(a):s.set(u,[a])}return s}e.getAtomIndexFromEntries=r;function i(o,s){let{conn_type_id:a,pdbx_dist_value:c,pdbx_value_order:u}=o,l={label_asym_id:o.ptnr1_label_asym_id,label_seq_id:o.ptnr1_label_seq_id,auth_seq_id:o.ptnr1_auth_seq_id,label_atom_id:o.ptnr1_label_atom_id,label_alt_id:o.pdbx_ptnr1_label_alt_id,ins_code:o.pdbx_ptnr1_PDB_ins_code,symmetry:o.ptnr1_symmetry},m={label_asym_id:o.ptnr2_label_asym_id,label_seq_id:o.ptnr2_label_seq_id,auth_seq_id:o.ptnr2_auth_seq_id,label_atom_id:o.ptnr2_label_atom_id,label_alt_id:o.pdbx_ptnr2_label_alt_id,ins_code:o.pdbx_ptnr2_PDB_ins_code,symmetry:o.ptnr2_symmetry},f=Array.from(s.entities.data.id.toArray()),d=(h,x)=>{if(x.label_asym_id.valueKind(h)!==0)return;let y=x.label_asym_id.value(h),g=x.label_atom_id.value(h);if(!g)return;let C=x.auth_seq_id.valueKind(h)===me.ValueKind.Present?x.auth_seq_id.value(h):x.label_seq_id.value(h),_=x.ins_code.value(h),b=x.label_alt_id.value(h);for(let I of f){let E=s.atomicHierarchy.index.findResidue(I,y,C,_);if(E<0)continue;let S=s.atomicHierarchy.index.findAtomOnResidue(E,g,b);if(!(S<0))return{residueIndex:E,atomIndex:S,symmetry:x.symmetry.value(h)}}},p=[];for(let h=0;h<o._rowCount;h++){let x=d(h,l),y=d(h,m);if(x===void 0||y===void 0)continue;let g=a.value(h),C=u.value(h)||"",_=0,b=1;switch(C){case"sing":b=1;break;case"doub":b=2;break;case"trip":b=3;break;case"quad":b=4;break;default:b=Ws(o.ptnr1_label_comp_id.value(h),o.ptnr1_label_atom_id.value(h),o.ptnr2_label_comp_id.value(h),o.ptnr2_label_atom_id.value(h))}switch(g){case"covale":_=1;break;case"disulf":_=9;break;case"hydrog":_=4;break;case"metalc":_=2;break}p.push({rowIndex:h,flags:_,order:b,distance:c.value(h),partnerA:x,partnerB:y})}return p}e.getEntriesFromStructConn=i})(cn||(cn={}));var V_=N.distance;function fm(e,t,n,r,i,o,s){let a=new Jt.EdgeBuilder(o,e,t),c=new Uint16Array(a.slotCount),u=new Int8Array(a.slotCount),l=new Uint32Array(a.slotCount);for(let m=0,f=a.edgeCount;m<f;m++)a.addNextEdge(),a.assignProperty(c,r[m]),a.assignProperty(u,n[m]),a.assignProperty(l,i[m]);return a.createGraph({flags:c,order:u,key:l},s)}var um=N(),lm=N();function K_(e,t,n){return e.conformation.position(t,um),e.conformation.position(n,lm),V_(um,lm)}var j_=new Set;function Y_(e){let t=rn.Provider.get(e.model),{elements:n}=e,{type_symbol:r}=e.model.atomicHierarchy.atoms,i=e.elements.length,{maxDistance:o}=t,{offset:s,b:a,edgeProps:{order:c,distance:u,flag:l,key:m,operatorA:f,operatorB:d}}=t.bonds,{atomSourceIndex:p}=e.model.atomicHierarchy,{invertedIndex:h}=Tt.getInvertedAtomSourceIndex(e.model),x=[],y=[],g=[],C=[],_=[],b=e.conformation.operator.key;for(let I=0;I<i;I++){let E=n[I],S=tr(r.value(E)),v=rr(S),P=p.value(E);for(let L=s[P],w=s[P+1];L<w;++L){let D=h[a[L]];if(E>=D)continue;let z=le.indexOf(e.elements,D);if(z<0)continue;let ie=f[L],O=d[L];if(ie>=0&&ie!==b||O>=0&&O!==b)continue;let Q=tr(r.value(D)),K=u[L],Z=K_(e,E,D),se=!1;if(K>=0)se=Ht(Z,K,.3);else if(o>=0)se=Z<o;else{let fe=ji(S,Q,nr(S),nr(Q));se=Z<fe,v&&rr(Q)&&(se=!1)}se&&(x[x.length]=I,y[y.length]=z,C[C.length]=c[L],g[g.length]=l[L],_[_.length]=m[L])}}return fm(x,y,C,g,_,i,{canRemap:!1,cacheable:t.cacheable})}function Z_(e,t){let{maxRadius:n}=t,{x:r,y:i,z:o}=e.model.atomicConformation,s=e.elements.length,{elements:a,residueIndex:c,chainIndex:u}=e,{type_symbol:l,label_atom_id:m,label_alt_id:f,label_comp_id:d}=e.model.atomicHierarchy.atoms,{label_seq_id:p}=e.model.atomicHierarchy.residues,{index:h}=e.model.atomicHierarchy,{byEntityKey:x}=e.model.sequence,y=e.lookup3d,g=cn.Provider.get(e.model),C=Ir.Provider.get(e.model),_=cn.isExhaustive(e.model),b=[],I=[],E=[],S=[],v=[],P=-1,L,w=!0,D=!0,z=!0,ie=j_;for(let O=0;O<s;O++){let Q=a[O],K=l.value(Q);w&&K!=="H"&&K!=="O"&&(w=!1);let Z=t.forceCompute?void 0:g&&g.byAtomIndex.get(Q),se=!1;if(Z)for(let ae of Z){let{partnerA:ne,partnerB:q}=ae;if(ne.symmetry!==q.symmetry)continue;let F=ne.atomIndex===Q?q:ne,W=le.indexOf(e.elements,F.atomIndex);W<0||a[W]<Q||(b[b.length]=O,I[I.length]=W,E[E.length]=ae.flags,S[S.length]=ae.order,v[v.length]=ae.rowIndex,se||ie.clear(),se=!0,ie.add(W))}if(_)continue;let fe=c[Q],Ce=p.value(fe),xe=d.value(Q);if(!t.forceCompute&&fe!==P)if(C&&C.entries.has(xe)){let ae=x[h.getEntityFromChain(u[Q])];ae&&ae.sequence.microHet.has(Ce)?L=void 0:L=C.entries.get(xe).map}else L=void 0;P=fe;let H=tr(K),$=m.value(Q),de=L?L.get($):void 0,{indices:T,count:B,squaredDistances:k}=y.find(r[Q],i[Q],o[Q],n),R=rr(H),V=nr(H),j=f.value(Q),oe=Ki.has(H);for(let ae=0;ae<B;ae++){let ne=T[ae];if(se&&ie.has(ne))continue;let q=a[ne];if(q<=Q)continue;let F=f.value(q);if(j&&F&&j!==F)continue;let W=tr(l.value(q)),re=rr(W);if(R&&re)continue;let _e=(oe||Ki.has(W))&&!(R||re),Ae=c[q];if(fe===Ae&&de){let M=de.get(m.value(q));if(M){b[b.length]=O,I[I.length]=ne,S[S.length]=M.order;let te=M.flags;_e&&(te|1&&(te^=1),te|=2),E[E.length]=te,v[v.length]=M.key}continue}let Ze=Math.sqrt(k[ae]);if(Ze===0)continue;let A=ji(H,W,V,nr(W));if(Ze<=A){b[b.length]=O,I[I.length]=ne,S[S.length]=cm(xe,$,m.value(q)),E[E.length]=(_e?2:1)|32,v[v.length]=-1;let M=p.value(Ae);Ce===M&&(D=!1),Math.abs(Ce-M)>1&&(z=!1)}}}return fm(b,I,S,E,v,s,{canRemap:w||D&&z})}function dm(e,t){let n=Le(Le({},Zs),t);return n.noCompute||Tt.isCoarseGrained(e.model)&&!rn.Provider.get(e.model)&&!cn.isExhaustive(e.model)?Ys.Empty:!n.forceCompute&&rn.Provider.get(e.model)?Y_(e):Z_(e,n)}var W_=N.distance,X_=N.set,$_=N.squaredDistance,Q_=N.transformMat4,mm=N(),pm=N();function hm(e,t,n,r){return e.conformation.position(t,mm),n.conformation.position(r,pm),W_(mm,pm)}var J_=ke(),mi=N();function eg(e,t,n,r){let{maxRadius:i}=n,{elements:o,residueIndex:s}=e,{x:a,y:c,z:u}=e.model.atomicConformation,{elements:l,residueIndex:m}=t,f=e.elements.length,{type_symbol:d,label_alt_id:p,label_atom_id:h,label_comp_id:x}=e.model.atomicHierarchy.atoms,{type_symbol:y,label_alt_id:g,label_atom_id:C,label_comp_id:_}=t.model.atomicHierarchy.atoms,{auth_seq_id:b}=e.model.atomicHierarchy.residues,{auth_seq_id:I}=t.model.atomicHierarchy.residues,{occupancy:E}=e.model.atomicConformation,{occupancy:S}=t.model.atomicConformation,v=E.isDefined&&S.isDefined,P=e.model===t.model&&cn.Provider.get(e.model),L=!n.forceCompute&&e.model===t.model&&rn.Provider.get(e.model),{atomSourceIndex:w}=e.model.atomicHierarchy,{invertedIndex:D}=L?Tt.getInvertedAtomSourceIndex(t.model):{invertedIndex:void 0},z=e.model===t.model&&cn.isExhaustive(e.model),ie=ke.mul(J_,t.conformation.operator.inverse,e.conformation.operator.matrix),O=!ke.isIdentity(ie),{center:Q,radius:K}=t.boundary.sphere,Z=(K+i)*(K+i);r.startUnitPair(e.id,t.id);let se=e.conformation.operator.key,fe=t.conformation.operator.key;for(let Ce=0;Ce<f;Ce++){let xe=o[Ce];if(X_(mi,a[xe],c[xe],u[xe]),O&&Q_(mi,mi,ie),$_(mi,Q)>Z)continue;if(!n.forceCompute&&L){let{maxDistance:F}=L,{offset:W,b:re,edgeProps:{order:_e,distance:Ae,flag:Ze,key:A,operatorA:M,operatorB:te}}=L.bonds,ce=w.value(xe),pe=tr(d.value(xe));for(let he=W[ce],Se=W[ce+1];he<Se;++he){let Ee=D[re[he]],Ne=le.indexOf(t.elements,Ee);if(Ne<0)continue;let Pe=M[he],ve=te[he];if(Pe>=0&&ve>=0&&(Pe===ve||Pe!==se||ve!==fe))continue;let Fe=tr(d.value(Ee)),Oe=Ae[he],Me=hm(e,xe,t,Ee),He=!1;if(Oe>=0)He=Ht(Me,Oe,.3);else if(F>=0)He=Me<F;else{let je=ji(pe,Fe,nr(pe),nr(Fe));He=Me<je,rr(pe)&&rr(Fe)&&(He=!1)}He&&r.add(Ce,Ne,{order:_e[he],flag:Ze[he],key:A[he]})}continue}let H=n.forceCompute?void 0:P&&P.byAtomIndex.get(xe);if(H&&H.length){let F=!1;for(let W of H){let{partnerA:re,partnerB:_e}=W,Ae=re.atomIndex===xe?_e:re,Ze=le.indexOf(t.elements,Ae.atomIndex);Ze<0||hm(e,xe,t,Ae.atomIndex)>i||(r.add(Ce,Ze,{order:W.order,flag:W.flags,key:W.rowIndex}),F=!0)}if(F)continue}if(z)continue;let $=E.value(xe),{lookup3d:de}=t,{indices:T,count:B,squaredDistances:k}=de.find(mi[0],mi[1],mi[2],i);if(B===0)continue;let R=tr(d.value(xe)),V=rr(R),j=nr(R),oe=p.value(xe),ae=Ki.has(R),ne=h.value(xe),q=x.value(s[xe]);for(let F=0;F<B;F++){let W=T[F],re=l[W],_e=g.value(re);if(oe&&_e&&oe!==_e||v&&S.value(re)<1&&$<1&&b.value(xe)===I.value(re))continue;let Ae=tr(y.value(re)),Ze=rr(Ae);if(V&&Ze)continue;let A=(ae||Ki.has(Ae))&&!(V||Ze),M=Math.sqrt(k[F]);if(M===0)continue;let te=ji(R,Ae,j,nr(Ae));if(M<=te){let ce=C.value(re),pe=_.value(m[re]);r.add(Ce,W,{order:Ws(q,pe,ne,ce),flag:(A?2:1)|32,key:-1})}}}r.finishUnitPair()}var tg=Ct(Le({},Zs),{ignoreWater:!0,ignoreIon:!0});function ng(e,t){let n=new Cr.Builder,r=e.models.some(o=>rn.Provider.get(o)),i=e.models.some(o=>cn.isExhaustive(o));return t.noCompute||e.isCoarseGrained&&!r&&!i?new Sr(n.getMap()):(ot.eachUnitPair(e,(o,s)=>{eg(o,s,t,n)},{maxRadius:t.maxRadius,validUnit:o=>t.validUnit(o),validUnitPair:(o,s)=>t.validUnitPair(e,o,s)}),new Sr(n.getMap()))}function _m(e,t){let n=Le(Le({},tg),t);return ng(e,Ct(Le({},n),{validUnit:t&&t.validUnit||(r=>ge.isAtomic(r)),validUnitPair:t&&t.validUnitPair||((r,i,o)=>{if(!ot.validUnitPair(r,i,o))return!1;let a=i.model.atomicHierarchy.derived.residue.moleculeType,c=o.model.atomicHierarchy.derived.residue.moleculeType,u=(!ge.isAtomic(i)||a[i.residueIndex[i.elements[0]]]!==2)&&(!ge.isAtomic(o)||c[o.residueIndex[o.elements[0]]]!==2),l=!ge.isAtomic(i)||a[i.residueIndex[i.elements[0]]]!==3,m=!ge.isAtomic(o)||c[o.residueIndex[o.elements[0]]]!==3,f=l&&m;return(u||!n.ignoreWater)&&(f||!n.ignoreIon)?!0:rg(i,o)})}))}function rg(e,t){if(e.model!==t.model||!ge.isAtomic(e)||!ge.isAtomic(t))return!1;let n=cn.Provider.get(e.model);if(!n)return!1;let r=e.elements.length<t.elements.length?e:t,i=e.elements.length>=t.elements.length?e:t,{elements:o}=r,{elements:s}=i,{indexOf:a}=le;for(let c=0,u=o.length;c<u;c++){let l=o[c],m=n.byAtomIndex.get(l);if(m?.length)for(let f of m){let d=f.partnerA.atomIndex===l?f.partnerB.atomIndex:f.partnerA.atomIndex;if(a(s,d)>=0)return!0}}return!1}var vo;(function(e){function t(x,y,g,C,_,b){return{kind:"bond-location",aStructure:x,aUnit:y,aIndex:g,bStructure:C,bUnit:_,bIndex:b}}e.Location=t;function n(x){return!!x&&x.kind==="bond-location"}e.isLocation=n;function r(x,y){return x.aStructure.label===y.aStructure.label&&x.bStructure.label===y.bStructure.label&&x.aIndex===y.aIndex&&x.bIndex===y.bIndex&&x.aUnit.id===y.aUnit.id&&x.bUnit.id===y.bUnit.id}e.areLocationsEqual=r;function i(x,y){return{kind:"bond-loci",structure:x,bonds:y}}e.Loci=i;function o(x){return!!x&&x.kind==="bond-loci"}e.isLoci=o;function s(x,y){if(x.structure!==y.structure||x.bonds.length!==y.bonds.length)return!1;for(let g=0,C=x.bonds.length;g<C;++g)if(!r(x.bonds[g],y.bonds[g]))return!1;return!0}e.areLociEqual=s;function a(x){return x.bonds.length===0}e.isLociEmpty=a;function c(x,y){if(y===x.structure)return x;let g=[];return x.bonds.forEach(C=>{let _=y.unitMap.get(C.aUnit.id);if(!_)return;let b=y.unitMap.get(C.bUnit.id);if(!b)return;let I=C.aUnit.elements[C.aIndex],E=le.indexOf(_.elements,I);if(E===-1)return;let S=C.bUnit.elements[C.bIndex],v=le.indexOf(b.elements,S);v!==-1&&g.push(t(x.structure,_,E,x.structure,b,v))}),i(y,g)}e.remapLoci=c;function u(x){let y=[],g=new Map;for(let C of x.bonds){let{aIndex:_,aUnit:b,bIndex:I,bUnit:E}=C;b===E?g.has(b.id)?g.get(b.id).push(_,I):g.set(b.id,[_,I]):(g.has(b.id)?g.get(b.id).push(_):g.set(b.id,[_]),g.has(E.id)?g.get(E.id).push(I):g.set(E.id,[I]))}return g.forEach((C,_)=>{y.push({unit:x.structure.unitMap.get(_),indices:le.deduplicate(le.ofUnsortedArray(C))})}),ht.Loci(x.structure,y)}e.toStructureElementLoci=u;function l(x){let{aUnit:y,aIndex:g}=x.bonds[0];return ht.Loci(x.structure,[{unit:y,indices:Ie.ofSingleton(g)}])}e.toFirstStructureElementLoci=l;function m(x,y){if(y.aUnit===y.bUnit){let g=y.aUnit.bonds,C=g.getEdgeIndex(y.aIndex,y.bIndex);return C<0?$t.create(0):$t.create(g.edgeProps.flags[C])}else{let g=x.interUnitBonds.getBondFromLocation(y);return g?$t.create(g.props.flag):$t.create(0)}}e.getType=m;function f(x,y){if(y.aUnit===y.bUnit){let g=y.aUnit.bonds,C=g.getEdgeIndex(y.aIndex,y.bIndex);return C<0?0:g.edgeProps.order[C]}else{let g=x.interUnitBonds.getBondFromLocation(y);return g?g.props.order:0}}e.getOrder=f;function d(x){let y=0;for(let g=0,C=x.units.length;g<C;++g){let _=x.units[g];ge.isAtomic(_)&&(y+=_.bonds.edgeCount)}return y}e.getIntraUnitBondCount=d;class p{move(){return this.advance(),this.current}setElement(y,g,C){this.structure=y,this.unit=g,this.index=C,this.interBondIndices=y.interUnitBonds.getEdgeIndices(C,g.id),this.interBondCount=this.interBondIndices.length,this.interBondIndex=0,this.intraBondEnd=g.bonds.offset[C+1],this.intraBondIndex=g.bonds.offset[C],this.hasNext=this.interBondIndex<this.interBondCount||this.intraBondIndex<this.intraBondEnd}advance(){if(this.intraBondIndex<this.intraBondEnd)this.current.otherUnit=this.unit,this.current.otherIndex=this.unit.bonds.b[this.intraBondIndex],this.current.type=this.unit.bonds.edgeProps.flags[this.intraBondIndex],this.current.order=this.unit.bonds.edgeProps.order[this.intraBondIndex],this.intraBondIndex+=1;else if(this.interBondIndex<this.interBondCount){let y=this.structure.interUnitBonds.edges[this.interBondIndex];this.current.otherUnit=this.structure.unitMap.get(y.unitA!==this.unit.id?y.unitA:y.unitB),this.current.otherIndex=y.indexA!==this.index?y.indexA:y.indexB,this.current.type=y.props.flag,this.current.order=y.props.order,this.interBondIndex+=1}else{this.hasNext=!1;return}this.hasNext=this.interBondIndex<this.interBondCount||this.intraBondIndex<this.intraBondEnd}constructor(){this.current={},this.hasNext=!1}}e.ElementBondIterator=p;function h(x,y){return Vr.fromPairProvider(x.bonds.length,(g,C,_)=>{let{aUnit:b,aIndex:I,bUnit:E,bIndex:S}=x.bonds[g];b.conformation.position(b.elements[I],C),E.conformation.position(E.elements[S],_)},y)}e.getBoundingSphere=h})(vo||(vo={}));function Sm(e){let t=og(e),n=ig(e,t),r=We.transientSegments(e.model.atomicHierarchy.residueAtomSegments,e.elements);for(;r.hasNext;){let i=r.move();sg(n,i.start,i.end)}return n.rings}function ig(e,t){return{startVertex:0,endVertex:0,count:0,isRingAtom:new Int32Array(t),marked:new Int32Array(t),queue:new Int32Array(t),pred:new Int32Array(t),depth:new Int32Array(t),left:new Int32Array(5),right:new Int32Array(5),color:new Int32Array(t),currentColor:0,currentAltLoc:"",hasAltLoc:!1,rings:[],currentRings:[],unit:e,bonds:e.bonds,altLoc:e.model.atomicHierarchy.atoms.label_alt_id}}function gm(e){e.count=e.endVertex-e.startVertex;let{isRingAtom:t,pred:n,color:r,depth:i,marked:o}=e;for(let s=0;s<e.count;s++)t[s]=0,n[s]=-1,o[s]=-1,r[s]=0,i[s]=0;e.currentColor=0,e.currentAltLoc="",e.hasAltLoc=!1}function ym(e){let{depth:t}=e;for(let n=0;n<e.count;n++)t[n]=e.count+1}function og(e){let t=We.transientSegments(e.model.atomicHierarchy.residueAtomSegments,e.elements),n=0;for(;t.hasNext;){let r=t.move();n=Math.max(n,r.end-r.start)}return n}function xm(e,t){let n=e.bonds.offset,r=e.startVertex+t,i=n[r],s=n[r+1]-i;return!(s<=1||e.isRingAtom[t]&&s===2)}function sg(e,t,n){if(e.startVertex=t,e.endVertex=n,e.endVertex-e.startVertex<3)return;e.currentRings=[];let{elements:r}=e.unit,i=[];for(let s=e.startVertex;s<e.endVertex;s++){let a=e.altLoc.value(r[s]);Tr(i,a)}xf(i,"");let o=1;if(i.length===0){gm(e);for(let s=0;s<e.count;s++)xm(e,s)&&(ym(e),o=Am(e,s,o))}else for(let s=0;s<i.length;s++){gm(e),e.hasAltLoc=!0,e.currentAltLoc=i[s];for(let a=0;a<e.count;a++){if(!xm(e,a))continue;let c=e.altLoc.value(r[e.startVertex+a]);c&&c!==e.currentAltLoc||(ym(e),o=Am(e,a,o))}}for(let s=0,a=e.currentRings.length;s<a;s++)e.rings.push(e.currentRings[s])}function ag(e,t,n,r){if(n<t)return!1;let{pred:i,color:o,left:s,right:a}=e,c=++e.currentColor,u=t;for(let y=0;y<5&&(o[u]=c,u=i[u],!(u<0));y++);let l=0,m=0,f=!1,d=0;u=n;for(let y=0;y<5;y++){if(o[u]===c){d=u,f=!0;break}if(a[m++]=u,u=i[u],u<0)break}if(!f)return!1;u=t;for(let y=0;y<5&&(s[l++]=u,!(d===u||(u=i[u],u<0)));y++);let p=l+m;if(p<3)return!1;let h=new Int32Array(p),x=0;for(let y=0;y<l;y++)h[x++]=e.startVertex+s[y],r[s[y]]=1;for(let y=m-1;y>=0;y--)h[x++]=e.startVertex+a[y],r[a[y]]=1;jt(h);for(let y=0,g=e.currentRings.length;y<g;y++){let C=e.currentRings[y];if(h.length===C.length){if(le.areEqual(h,C))return!1}else if(h.length>C.length&&le.isSubset(h,C))return!1}return e.currentRings.push(le.ofSortedArray(h)),!0}function Am(e,t,n){let{bonds:r,startVertex:i,endVertex:o,isRingAtom:s,marked:a,queue:c,pred:u,depth:l}=e,{elements:m}=e.unit,{b:f,edgeProps:{flags:d},offset:p}=r;a[t]=n,l[t]=0,c[0]=t;let h=0,x=1;for(;h<x;){let y=c[h++],g=l[y],C=i+y,_=p[C],b=p[C+1];for(let I=_;I<b;I++){let E=f[I];if(E<i||E>=o||!$t.isCovalent(d[I]))continue;if(e.hasAltLoc){let P=e.altLoc.value(m[E]);if(P&&e.currentAltLoc!==P)continue}let S=E-i;if(a[S]===n){if(u[S]!==y&&u[y]!==S&&ag(e,y,S,s))return n+1;continue}let v=Math.min(l[S],g+1);v>5||(l[S]=v,a[S]=n,c[x++]=S,u[S]=y)}}return n+1}function Im(e){let t=e.length,n=new Array(t);for(let s=0;s<t;s++)n[s]=e[t-s-1];let r=bm(e),i=bm(n),o=!1;for(let s=0;s<t;s++){let a=e[(s+r)%t],c=n[(s+i)%t];if(a!==c){o=a<c;break}}return o?Cm(e,r):Cm(n,i)}function bm(e){let t=e.length,n=new Int32Array(t*2);for(let s=0;s<n.length;s++)n[s]=-1;let r="",i="",o=0;for(let s=1;s<n.length;s++){let a=n[s-o-1];for(;a!==-1&&(r=e[s%t],i=e[(o+a+1)%t],r!==i);)r<i&&(o=s-a-1),a=n[a];a===-1?(r=e[s%t],i=e[(o+a+1)%t],r!==i?(r<i&&(o=s),n[s-o]=-1):n[s-o]=a+1):n[s-o]=a+1}return o}function Cm(e,t){let n=e.length,r=[],i;for(i=0;i<n-1;i++)r.push(e[(i+t)%n]),r.push("-");return r.push(e[(i+t)%n]),r.join("")}function wm(e,t){let n=new Map,r=new Map;for(let c=0,u=e.length;c<u;c++){let l=e[c];for(let m=0,f=l.length;m<f;m++){let d=l[m];n.has(d)?n.get(d).push(c):n.set(d,[c])}}for(let c=0,u=t.length;c<u;c++){let l=t[c],m=e[l];for(let f=0,d=m.length;f<d;f++){let p=m[f];r.has(p)?r.get(p).push(l):r.set(p,[l])}}let i=new Jt.UniqueEdgeBuilder(e.length);for(let c=0,u=e.length;c<u;c++){let l=e[c];for(let m=0,f=l.length;m<f;m++){let d=l[m],p=n.get(d);if(p.length!==1)for(let h=0,x=p.length;h<x;h++){let y=p[h];c>=y||i.addEdge(c,y)}}}let o=Jt.connectedComponents(i.getGraph()),s=o.componentIndex,a=[];for(let c=0;c<o.componentCount;c++)a[c]=[];for(let c=0,u=e.length;c<u;c++)a[s[c]].push(c);return{elementRingIndices:n,elementAromaticRingIndices:r,ringComponentIndex:s,ringComponents:a}}var Kr=class{get index(){return this._index?this._index:(this._index=wm(this.all,this.aromaticRings),this._index)}get byFingerprint(){return this._byFingerprint?this._byFingerprint:(this._byFingerprint=cg(this.unit,this.all),this._byFingerprint)}get elementRingIndices(){return this.index.elementRingIndices}get elementAromaticRingIndices(){return this.index.elementAromaticRingIndices}get ringComponentIndex(){return this.index.ringComponentIndex}get ringComponents(){return this.index.ringComponents}get aromaticRings(){return this._aromaticRings?this._aromaticRings:(this._aromaticRings=fg(this.unit,this.all),this._aromaticRings)}constructor(t,n){this.unit=n,this.all=t}},kn;(function(e){function t(a,c){let{elements:u}=a,{type_symbol:l}=a.model.atomicHierarchy.atoms,m=[];for(let f=0,d=c.length;f<d;f++)m[m.length]=l.value(u[c[f]]);return n(m)}e.fingerprint=t;function n(a){return Im(a)}e.elementFingerprint=n;let r=new Set(["B","C","N","O","SI","P","S","GE","AS","SN","SB","BI"]),i=.05;function o(a,c){let{elements:u,bonds:{b:l,offset:m,edgeProps:{flags:f}}}=a,{type_symbol:d,label_comp_id:p}=a.model.atomicHierarchy.atoms;if(p.value(a.elements[c[0]])==="PRO")return!1;let h=0,x=!1;for(let g=0,C=c.length;g<C;++g){let _=c[g];!x&&r.has(d.value(u[_]))&&(x=!0);for(let b=m[_],I=m[_+1];b<I;++b)$t.is(16,f[b])&&le.has(c,l[b])&&(h+=1)}if(h===2*c.length)return!0;if(!x||c.length<5||h>0)return!1;let y=mn.calculateMomentsAxes(Ns(a,c));return N.magnitude(y.dirC)<i}e.isAromatic=o;function s(a,c){let{label_alt_id:u}=a.model.atomicHierarchy.atoms,{elements:l}=a;for(let m=0,f=c.length;m<f;++m){let d=l[c[m]],p=u.value(d);if(p)return p}return""}e.getAltId=s})(kn||(kn={}));(function(e){function t(r){let i=Sm(r);return new e(i,r)}e.create=t;function n(r,i){let o=new Map;for(let s=0,a=i.length;s<a;s++){let c=i[s];lg(r,c,o)}return o}e.byFingerprintAndResidue=n})(Kr||(Kr={}));function cg(e,t){let n=new Map,r=0;for(let i=0,o=t.length;i<o;i++){let s=t[i],a=kn.fingerprint(e,s);n.has(a)?n.get(a).push(r):n.set(a,[r]),r++}return n}function ug(e,t){let{elements:n}=e,r=e.model.atomicHierarchy.residueAtomSegments.index,i=r[n[t[0]]];for(let o=1,s=t.length;o<s;o++)if(i!==r[n[t[o]]])return-1;return i}function lg(e,t,n){let r=e.byFingerprint.get(t);if(r)for(let i=0,o=r.length;i<o;i++){let s=r[i],a=ug(e.unit,e.all[s]);a>=0&&(n.has(a)?n.get(a).push(s):n.set(a,[s]))}}function fg(e,t){let n=[];for(let r=0,i=t.length;r<i;++r)kn.isAromatic(e,t[r])&&n.push(r);return n}function vm(e){let t=[],{elements:n,model:r}=e,{residueAtomSegments:i}=e.model.atomicHierarchy,{traceElementIndex:o}=r.atomicHierarchy.derived.residue,s=Pt.transientSegments(e.model.atomicRanges.polymerRanges,n),a=We.transientSegments(i,n);for(;s.hasNext;){let c=s.move();for(a.setSegment(c);a.hasNext;){let u=a.move(),{start:l,end:m,index:f}=u;if(Ie.areIntersecting(ue.ofRange(n[l],n[m-1]),n)){let d=o[f];t.push(d===-1?i.offsets[f]:d)}}}return le.ofSortedArray(t)}function Pm(e){let t=[],{elements:n,model:r}=e,{spheres:i,gaussians:o}=r.coarseHierarchy,s=ge.isSpheres(e)?i.polymerRanges:o.polymerRanges,a=Pt.transientSegments(s,n);for(;a.hasNext;){let{start:c,end:u}=a.move();for(let l=c;l<u;++l)t.push(n[l])}return le.ofSortedArray(t)}function Bm(e){let t=[],{elements:n,model:r,residueIndex:i}=e,{residueAtomSegments:o}=e.model.atomicHierarchy,{traceElementIndex:s}=r.atomicHierarchy.derived.residue,a=Pt.transientSegments(e.model.atomicRanges.gapRanges,e.elements);for(;a.hasNext;){let c=a.move(),u=i[n[c.start]],l=i[n[c.end-1]],m=s[u],f=s[l];t.push(m===-1?o.offsets[u]:m),t.push(f===-1?o.offsets[l]:f)}return le.ofSortedArray(t)}function Em(e){let t=[],{elements:n,model:r}=e,{spheres:i,gaussians:o}=r.coarseHierarchy,s=ge.isSpheres(e)?i.gapRanges:o.gapRanges,a=Pt.transientSegments(s,n);for(;a.hasNext;){let{start:c,end:u}=a.move();t.push(n[c],n[u-1])}return le.ofSortedArray(t)}function Dm(e){let t=[],{elements:n,model:r}=e,{chainAtomSegments:i,residueAtomSegments:o}=r.atomicHierarchy,{moleculeType:s,traceElementIndex:a}=r.atomicHierarchy.derived.residue,c=We.transientSegments(i,n),u=We.transientSegments(o,n);for(;c.hasNext;)for(u.setSegment(c.move());u.hasNext;){let{index:l}=u.move();if(wc(s[l])){let m=a[l];t.push(m===-1?o.offsets[l]:m)}}return le.ofSortedArray(t)}function Mm(e){let t=[],{elements:n,model:r}=e,{chainAtomSegments:i,residueAtomSegments:o}=r.atomicHierarchy,{moleculeType:s,traceElementIndex:a}=r.atomicHierarchy.derived.residue,c=We.transientSegments(i,n),u=We.transientSegments(o,n);for(;c.hasNext;)for(u.setSegment(c.move());u.hasNext;){let{index:l}=u.move();if(vc(s[l])){let m=a[l];t.push(m===-1?o.offsets[l]:m)}}return le.ofSortedArray(t)}var Nm=N();function dg(e){let{elements:t,conformation:n}=e,r=new Float32Array(t.length*3);for(let i=0,o=t.length;i<o;i++)n.invariantPosition(t[i],Nm),N.toArray(Nm,r,i*3);return r}function Yc(e){let t=dg(e);return mn.ofPositions(t)}var km=N.dot,Um=N.copy,mg=N.scaleAndSub,pg=N.scaleAndAdd,ir=class{computeExtrema(t,n){let r=km(this.dir[t],n);r<this.minDist[t]&&(this.minDist[t]=r,Um(this.extrema[t*2],n)),r>this.maxDist[t]&&(this.maxDist[t]=r,Um(this.extrema[t*2+1],n))}computeSphereExtrema(t,n,r){let i=this.dir[t],o=km(i,n);o-r<this.minDist[t]&&(this.minDist[t]=o-r,mg(this.extrema[t*2],n,i,r)),o+r>this.maxDist[t]&&(this.maxDist[t]=o+r,pg(this.extrema[t*2+1],n,i,r))}includeSphere(t){if(Kt.hasExtrema(t)&&t.extrema.length>1)for(let n of t.extrema)this.includePosition(n);else this.includePositionRadius(t.center,t.radius)}includePosition(t){for(let n=0;n<this.dirLength;++n)this.computeExtrema(n,t)}includePositionRadius(t,n){for(let r=0;r<this.dirLength;++r)this.computeSphereExtrema(r,t,n)}finishedIncludeStep(){for(let t=0;t<this.extrema.length;t++)this.centroidHelper.includeStep(this.extrema[t]);this.centroidHelper.finishedIncludeStep()}radiusSphere(t){if(Kt.hasExtrema(t)&&t.extrema.length>1)for(let n of t.extrema)this.radiusPosition(n);else this.radiusPositionRadius(t.center,t.radius)}radiusPosition(t){this.centroidHelper.radiusStep(t)}radiusPositionRadius(t,n){this.centroidHelper.radiusSphereStep(t,n)}getSphere(t){return Kt.setExtrema(this.centroidHelper.getSphere(t),this.extrema.slice())}getBox(t){return on.fromVec3Array(t||on(),this.extrema)}reset(){for(let t=0;t<this.dirLength;++t)this.minDist[t]=1/0,this.maxDist[t]=-1/0,this.extrema[t*2]=N(),this.extrema[t*2+1]=N();this.centroidHelper.reset()}constructor(t){this.minDist=[],this.maxDist=[],this.extrema=[],this.centroidHelper=new Vr,this.dir=hg(t),this.dirLength=this.dir.length,this.reset()}};function hg(e){let t;switch(e){case"6":t=[...Xs];break;case"14":t=[...Xs,...Zc];break;case"26":t=[...Xs,...Zc,...Rm];break;case"98":t=[...Xs,...Zc,...Rm,..._g,...gg,...yg];break}return t.map(n=>{let r=N.create(n[0],n[1],n[2]);return N.normalize(r,r)})}var Xs=[[1,0,0],[0,1,0],[0,0,1]],Zc=[[1,1,1],[-1,1,1],[-1,-1,1],[1,-1,1]],Rm=[[1,1,0],[1,-1,0],[1,0,1],[1,0,-1],[0,1,1],[0,1,-1]],_g=[[0,1,2],[0,2,1],[1,0,2],[2,0,1],[1,2,0],[2,1,0],[0,1,-2],[0,2,-1],[1,0,-2],[2,0,-1],[1,-2,0],[2,-1,0]],gg=[[1,1,2],[2,1,1],[1,2,1],[1,-1,2],[1,1,-2],[1,-1,-2],[2,-1,1],[2,1,-1],[2,-1,-1],[1,-2,1],[1,2,-1],[1,-2,-1]],yg=[[2,2,1],[1,2,2],[2,1,2],[2,-2,1],[2,2,-1],[2,-2,-1],[1,-2,2],[1,2,-2],[1,-2,-2],[2,-1,2],[2,1,-2],[2,-1,-2]];var Tm=N.set,xg=new ir("14"),Ag=new ir("98");function bg(e){return e>1e4?xg:Ag}function Qs(e){let t=on.computeBounding(e);return{box:t,sphere:Kt.fromBox3D(Kt(),t)}}var $s=N();function jr(e){let{x:t,y:n,z:r,radius:i,indices:o}=e,s=Ie.size(o);if(s>25e4)return Qs(e);let a=bg(s);a.reset();for(let u=0;u<s;u++){let l=Ie.getAt(o,u);Tm($s,t[l],n[l],r[l]),a.includePositionRadius($s,i&&i[l]||0)}a.finishedIncludeStep();for(let u=0;u<s;u++){let l=Ie.getAt(o,u);Tm($s,t[l],n[l],r[l]),a.radiusPositionRadius($s,i&&i[l]||0)}let c=a.getSphere();if(!i&&Kt.hasExtrema(c)&&s<=c.extrema.length){let u=[];for(let l=0;l<s;l++){let m=Ie.getAt(o,l);u.push(N.create(t[m],n[m],r[m]))}Kt.setExtrema(c,u)}return{box:a.getBox(),sphere:c}}var Js=class e{constructor(){this.data=new Map}get(t){let n=le.hashCode(t);if(this.data.has(n)){for(let[r,i]of this.data.get(n))if(le.areEqual(t,r))return i}}set(t,n){let r=le.hashCode(t);if(this.data.has(r)){let i=this.data.get(r);for(let o of i)if(le.areEqual(t,o[0])){o[1]=n;return}i.push([t,n])}else this.data.set(r,[[t,n]])}static get(t){return t._dynamicPropertyData.ElementSetIntraBondCache||(t._dynamicPropertyData.ElementSetIntraBondCache=new e),t._dynamicPropertyData.ElementSetIntraBondCache}};function Fm(e){return{delocalizedTriplets:Cg(e)}}function Cg(e){let t=e.bonds,{b:n,edgeProps:r,offset:i}=t,{order:o,flags:s}=r,{elementAromaticRingIndices:a}=e.rings,c=[],u=new Map,l=new Map,m=(f,d,p)=>{let h=c.length;c.push(le.ofUnsortedArray([f,d,p])),u.set(Sa(f,d),p),l.has(f)?l.get(f).push(h):l.set(f,[h])};for(let f=0;f<e.elements.length;f++){if(a.has(f)||i[f+1]-i[f]+1<2)continue;let p=[];for(let h=i[f],x=i[f+1];h<x;h++){let y=s[h];$t.is(y,16)&&p.push(n[h])}if(p.length>=2){m(f,p[0],p[1]);for(let h=1,x=p.length;h<x;h++)m(f,p[h],p[0])}}return{getThirdElement:(f,d)=>u.get(Sa(f,d)),getTripletIndices:f=>l.get(f),triplets:c}}var ge;(function(e){let t;(function(K){K[K.Atomic=0]="Atomic",K[K.Spheres=1]="Spheres",K[K.Gaussians=2]="Gaussians"})(t=e.Kinds||(e.Kinds={}));function n(K){return K.kind===0}e.isAtomic=n;function r(K){return K.kind===1||K.kind===2}e.isCoarse=r;function i(K){return K.kind===1}e.isSpheres=i;function o(K){return K.kind===2}e.isGaussians=o;function s(K,Z,se,fe,Ce,xe,H,$,de){switch(Ce){case 0:return new y(K,Z,se,fe,xe,$,xt.createMapping(H,xe.atomicConformation),de??g());case 1:return S(K,Z,se,fe,xe,1,$,xt.createMapping(H,xe.coarseConformation.spheres,h(xe)),de??b());case 2:return S(K,Z,se,fe,xe,2,$,xt.createMapping(H,xe.coarseConformation.gaussians,x(xe)),de??b())}}e.create=s;function a(K){let Z=yn.Mutable();for(let se=0,fe=K.length;se<fe;se++)Z.set(K[se].id,se);return Z}function c(K){let Z=[];for(let se=0,fe=K.length;se<fe;se++)Z.push(K[se].id);return Yn(Z)}function u(K){let Z={};return{elements:K[0].elements,units:K,get unitIndexMap(){return Z.unitIndexMap||(Z.unitIndexMap=a(K)),Z.unitIndexMap},hashCode:m(K[0]),transformHash:c(K)}}e.SymmetryGroup=u,function(K){function Z(fe,Ce){return fe.hashCode!==Ce.hashCode?!1:le.areEqual(fe.elements,Ce.elements)}K.areInvariantElementsEqual=Z;function se(fe){let Ce=yn.Mutable();for(let xe=0,H=fe.length;xe<H;++xe){let $=fe[xe];for(let de=0,T=$.units.length;de<T;++de)Ce.set($.units[de].id,xe)}return Ce}K.getUnitSymmetryGroupsIndexMap=se}(u=e.SymmetryGroup||(e.SymmetryGroup={}));function l(K){return e.isAtomic(K)?K.model.atomicConformation.id:K.model.coarseConformation.id}e.conformationId=l;function m(K){return Dr(K.invariantId,le.hashCode(K.elements))}e.hashUnit=m;let f;(function(K){K[K.None=0]="None",K[K.MultiChain=1]="MultiChain",K[K.Partitioned=2]="Partitioned",K[K.FastBoundary=4]="FastBoundary"})(f=e.Trait||(e.Trait={}));let d;(function(K){K.is=fn.has,K.create=fn.create})(d=e.Traits||(e.Traits={}));function p(){return{}}function h(K){let Z=K.coarseConformation.spheres.radius;return se=>Z[se]}function x(K){return Z=>0}class y{getChild(Z){return Z.length===this.elements.length?this:new y(this.id,this.invariantId,this.chainGroupId,this.traits,this.model,Z,this.conformation,g())}applyOperator(Z,se,fe=!1){let Ce=fe?se:xt.compose(this.conformation.operator,se);return new y(Z,this.invariantId,this.chainGroupId,this.traits,this.model,this.elements,xt.createMapping(Ce,this.model.atomicConformation,this.conformation.r),this.props)}remapModel(Z,se,fe){var Ce,xe;fe||(fe=Ct(Le({},this.props),{bonds:se&&!(!((xe=(Ce=this.props.bonds)===null||Ce===void 0?void 0:Ce.props)===null||xe===void 0)&&xe.canRemap)?void 0:w(this,this.props.bonds,Z,se)}),e.isSameConformation(this,Z)||(fe.boundary=void 0,fe.lookup3d=void 0,fe.principalAxes=void 0));let H=this.conformation.operator,$=Wt.Provider.get(Z);if(H.spgrOp!==-1&&$&&$!==Wt.Provider.get(this.model)){let[T,B,k]=H.hkl,{toFractional:R}=$.spacegroup.cell,V=N.transformMat4(N(),Tt.getCenter(Z),R);H=sn.getSymmetryOperatorRef($.spacegroup,H.spgrOp,T,B,k,V)}let de=this.model.atomicConformation!==Z.atomicConformation||H!==this.conformation.operator?xt.createMapping(H,Z.atomicConformation):this.conformation;return new y(this.id,this.invariantId,this.chainGroupId,this.traits,Z,this.elements,de,fe)}get boundary(){if(this.props.boundary)return this.props.boundary;let{x:Z,y:se,z:fe}=this.model.atomicConformation;return this.props.boundary=d.is(this.traits,f.FastBoundary)?Qs({x:Z,y:se,z:fe,indices:this.elements}):jr({x:Z,y:se,z:fe,indices:this.elements}),this.props.boundary}get lookup3d(){if(this.props.lookup3d)return this.props.lookup3d;let{x:Z,y:se,z:fe}=this.model.atomicConformation;return this.props.lookup3d=Xn({x:Z,y:se,z:fe,indices:this.elements},this.boundary),this.props.lookup3d}get principalAxes(){return this.props.principalAxes?this.props.principalAxes:(this.props.principalAxes=Yc(this),this.props.principalAxes)}get bonds(){var Z;if(this.props.bonds)return this.props.bonds;let se=Js.get(this.model),fe=se.get(this.elements);return fe||(fe=dm(this),!((Z=fe.props)===null||Z===void 0)&&Z.cacheable&&se.set(this.elements,fe)),this.props.bonds=fe,this.props.bonds}get rings(){return this.props.rings?this.props.rings:(this.props.rings=Kr.create(this),this.props.rings)}get resonance(){return this.props.resonance?this.props.resonance:(this.props.resonance=Fm(this),this.props.resonance)}get polymerElements(){return this.props.polymerElements?this.props.polymerElements:(this.props.polymerElements=vm(this),this.props.polymerElements)}get gapElements(){return this.props.gapElements?this.props.gapElements:(this.props.gapElements=Bm(this),this.props.gapElements)}get nucleotideElements(){return this.props.nucleotideElements?this.props.nucleotideElements:(this.props.nucleotideElements=Dm(this),this.props.nucleotideElements)}get proteinElements(){return this.props.proteinElements?this.props.proteinElements:(this.props.proteinElements=Mm(this),this.props.proteinElements)}get residueCount(){if(this.props.residueCount!==void 0)return this.props.residueCount;let Z=0,se=We.transientSegments(this.model.atomicHierarchy.residueAtomSegments,this.elements);for(;se.hasNext;)se.move(),Z+=1;return this.props.residueCount=Z,this.props.residueCount}getResidueIndex(Z){return this.residueIndex[this.elements[Z]]}constructor(Z,se,fe,Ce,xe,H,$,de){this.kind=0,this.objectPrimitive="atomistic",this.id=Z,this.invariantId=se,this.chainGroupId=fe,this.traits=Ce,this.model=xe,this.elements=H,this.conformation=$,this.residueIndex=xe.atomicHierarchy.residueAtomSegments.index,this.chainIndex=xe.atomicHierarchy.chainAtomSegments.index,this.props=de}}e.Atomic=y;function g(){return p()}class C{getChild(Z){return Z.length===this.elements.length?this:S(this.id,this.invariantId,this.chainGroupId,this.traits,this.model,this.kind,Z,this.conformation,b())}applyOperator(Z,se,fe=!1){let Ce=fe?se:xt.compose(this.conformation.operator,se);return S(Z,this.invariantId,this.chainGroupId,this.traits,this.model,this.kind,this.elements,xt.createMapping(Ce,this.getCoarseConformation(),this.conformation.r),this.props)}remapModel(Z,se,fe){let Ce=this.getCoarseConformation(),xe=_(this.kind,Z);fe||(fe=Le({},this.props),e.isSameConformation(this,Z)||(fe.boundary=void 0,fe.lookup3d=void 0,fe.principalAxes=void 0));let H=Ce!==xe?xt.createMapping(this.conformation.operator,xe,this.kind===1?h(Z):x(Z)):this.conformation;return new C(this.id,this.invariantId,this.chainGroupId,this.traits,Z,this.kind,this.elements,H,fe)}get boundary(){if(this.props.boundary)return this.props.boundary;let{x:Z,y:se,z:fe}=this.getCoarseConformation();return this.props.boundary=d.is(this.traits,f.FastBoundary)?Qs({x:Z,y:se,z:fe,indices:this.elements}):jr({x:Z,y:se,z:fe,indices:this.elements}),this.props.boundary}get lookup3d(){if(this.props.lookup3d)return this.props.lookup3d;let{x:Z,y:se,z:fe}=this.getCoarseConformation();return this.props.lookup3d=Xn({x:Z,y:se,z:fe,indices:this.elements},this.boundary),this.props.lookup3d}get principalAxes(){return this.props.principalAxes?this.props.principalAxes:(this.props.principalAxes=Yc(this),this.props.principalAxes)}get polymerElements(){return this.props.polymerElements?this.props.polymerElements:(this.props.polymerElements=Pm(this),this.props.polymerElements)}get gapElements(){return this.props.gapElements?this.props.gapElements:(this.props.gapElements=Em(this),this.props.gapElements)}getCoarseConformation(){return _(this.kind,this.model)}constructor(Z,se,fe,Ce,xe,H,$,de,T){this.kind=H,this.objectPrimitive=H===1?"sphere":"gaussian",this.id=Z,this.invariantId=se,this.chainGroupId=fe,this.traits=Ce,this.model=xe,this.elements=$,this.conformation=de,this.coarseElements=H===1?xe.coarseHierarchy.spheres:xe.coarseHierarchy.gaussians,this.coarseConformation=H===1?xe.coarseConformation.spheres:xe.coarseConformation.gaussians,this.props=T}}function _(K,Z){return K===1?Z.coarseConformation.spheres:Z.coarseConformation.gaussians}function b(){return p()}class I extends C{}e.Spheres=I;class E extends C{}e.Gaussians=E;function S(K,Z,se,fe,Ce,xe,H,$,de){return new C(K,Z,se,fe,Ce,xe,H,$,de)}function v(K,Z){return K.chainGroupId===Z.chainGroupId&&K.conformation.operator.name===Z.conformation.operator.name}e.areSameChainOperatorGroup=v;function P(K,Z){return ke.areEqual(K.conformation.operator.matrix,Z.conformation.operator.matrix,1e-6)}e.areOperatorsEqual=P;function L(K,Z){return K===Z?!0:le.areEqual(K.elements,Z.elements)?D(K,Z.model):!1}e.areConformationsEqual=L;function w(K,Z,se,fe){var Ce;if(!Z)return;if(K.model.atomicConformation.id===se.atomicConformation.id)return Z;let xe=rn.Provider.get(K.model);if(xe){let H=rn.Provider.get(se);return!H||xe===H?Z:void 0}return!((Ce=Z.props)===null||Ce===void 0)&&Ce.canRemap||!fe||D(K,se)?Z:void 0}function D(K,Z){let se=Tt.CoordinatesHistory.get(Tt.getRoot(Z));if(se)return se.areEqual(K.elements,K.kind,Z);let fe=K.elements,{x:Ce,y:xe,z:H}=K.conformation.coordinates,{x:$,y:de,z:T}=z(K.kind,Z);for(let B=0,k=fe.length;B<k;B++){let R=fe[B];if(Ce[R]!==$[R]||xe[R]!==de[R]||H[R]!==T[R])return!1}return!0}e.isSameConformation=D;function z(K,Z){return K===0?Z.atomicConformation:K===1?Z.coarseConformation.spheres:Z.coarseConformation.gaussians}e.getModelConformationOfKind=z;function ie(K){return z(K.kind,K.model)}e.getConformation=ie;function O(K,Z){return K===0?Z.atomicHierarchy:K===1?Z.coarseHierarchy.spheres:Z.coarseHierarchy.gaussians}e.getModelHierarchyOfKind=O;function Q(K){return O(K.kind,K.model)}e.getHierarchy=Q})(ge||(ge={}));function ea(e,t,n,r){return{type:e,key:t,elements:n,getIndex:r}}var pi=typeof process<"u"&&process.versions!=null&&process.versions.node!=null,Yi=Sg(),Po=Ig();function Sg(){return typeof XMLHttpRequest>"u"||pi?Lm():XMLHttpRequest}function Ig(){if(typeof File>"u"||pi){class e{arrayBuffer(){return this.blob.arrayBuffer()}slice(n,r,i){return this.blob.slice(n,r,i)}stream(){return this.blob.stream()}text(){return this.blob.text()}constructor(n,r,i){var o;this.blob=new Blob(n,i),this.size=this.blob.size,this.type=this.blob.type,this.name=r,this.lastModified=(o=i?.lastModified)!==null&&o!==void 0?o:0,this.webkitRelativePath=""}}return e}else return File}function qm(e){return e>>0}function or(e,t){return e[t]|e[t+1]<<8}function Yr(e,t,n){e[t]=n&255,e[t+1]=n>>8&255}function Zr(e,t){return e[t+3]*(256*256*256)+(e[t+2]<<16|e[t+1]<<8|e[t])}function sr(e,t,n){e[t]=n&255,e[t+1]=n>>8&255,e[t+2]=n>>16&255,e[t+3]=n>>24&255}function wg(e,t,n){let r="";for(let i=0;i<n;i++)r+=String.fromCharCode(e[t+i]);return r}function vg(e){return e.length<2?"0"+e:e}function Gm(e,t,n){let r="",i;for(let o=0;o<n;o++)r+="%"+vg(e[t+o].toString(16));try{i=decodeURIComponent(r)}catch{return wg(e,t,n)}return i}function Hm(e,t,n){let r=n.length,i=0;for(let o=0;o<r;o++){let s=n.charCodeAt(o);if(!(s&4294967168))e[t+i]=s,i++;else if(!(s&4294965248))e[t+i]=192|s>>6,e[t+i+1]=128|s>>0&63,i+=2;else if(!(s&4294901760))e[t+i]=224|s>>12,e[t+i+1]=128|s>>6&63,e[t+i+2]=128|s>>0&63,i+=3;else if(!(s&4294967295-(1<<21)+1))e[t+i]=240|s>>18,e[t+i+1]=128|s>>12&63,e[t+i+2]=128|s>>6&63,e[t+i+3]=128|s>>0&63,i+=4;else throw new Error("e")}return i}function Wc(e){let t=e.length,n=0;for(let r=0;r<t;r++){let i=e.charCodeAt(r);if(!(i&4294967168))n++;else if(!(i&4294965248))n+=2;else if(!(i&4294901760))n+=3;else if(!(i&4294967295-(1<<21)+1))n+=4;else throw new Error("e")}return n}var Pg=function(){let e=new Uint32Array(256);for(let t=0;t<256;t++){let n=t;for(let r=0;r<8;r++)n&1?n=3988292384^n>>>1:n=n>>>1;e[t]=n}return e}();function Bg(e,t,n,r){for(let i=0;i<r;i++)e=Pg[(e^t[n+i])&255]^e>>>8;return e}function Xc(e,t,n){return Bg(4294967295,e,t,n)^4294967295}var we=function(){let e=Uint16Array,t=Uint32Array;return{next_code:new e(16),bl_count:new e(16),ordr:[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],of0:[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,999,999,999],exb:[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0],ldef:new e(32),df0:[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,65535,65535],dxb:[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0],ddef:new t(32),flmap:new e(512),fltree:[],fdmap:new e(32),fdtree:[],lmap:new e(32768),ltree:[],ttree:[],dmap:new e(32768),dtree:[],imap:new e(512),itree:[],rev15:new e(32768),lhst:new t(286),dhst:new t(30),ihst:new t(19),lits:new t(15e3),strt:new e(65536),prev:new e(32768)}}();(function(){for(let n=0;n<32768;n++){let r=n;r=(r&2863311530)>>>1|(r&1431655765)<<1,r=(r&3435973836)>>>2|(r&858993459)<<2,r=(r&4042322160)>>>4|(r&252645135)<<4,r=(r&4278255360)>>>8|(r&16711935)<<8,we.rev15[n]=(r>>>16|r<<16)>>>17}function t(n,r,i){for(;r--!==0;)n.push(0,i)}for(let n=0;n<32;n++)we.ldef[n]=we.of0[n]<<3|we.exb[n],we.ddef[n]=we.df0[n]<<4|we.dxb[n];t(we.fltree,144,8),t(we.fltree,112,9),t(we.fltree,24,7),t(we.fltree,8,8),ar(we.fltree,9),Zi(we.fltree,9,we.flmap),Wi(we.fltree,9),t(we.fdtree,32,5),ar(we.fdtree,5),Zi(we.fdtree,5,we.fdmap),Wi(we.fdtree,5),t(we.itree,19,0),t(we.ltree,286,0),t(we.dtree,30,0),t(we.ttree,320,0)})();function Zi(e,t,n){let r=e.length,i=we.rev15;for(let o=0;o<r;o+=2)if(e[o+1]!==0){let s=o>>1,a=e[o+1],c=s<<4|a,u=t-a,l=e[o]<<u,m=l+(1<<u);for(;l!==m;){let f=i[l]>>>15-t;n[f]=c,l++}}}function ar(e,t){let n=e.length,r=we.bl_count;for(let s=0;s<=t;s++)r[s]=0;for(let s=1;s<n;s+=2)r[e[s]]++;let i=we.next_code,o=0;r[0]=0;for(let s=1;s<=t;s++)o=o+r[s-1]<<1,i[s]=o;for(let s=0;s<n;s+=2){let a=e[s+1];a!==0&&(e[s]=i[a],i[a]++)}}function Wi(e,t){let n=we.rev15,r=15-t;for(let i=0;i<e.length;i+=2){let o=e[i]<<t-e[i+1];e[i]=n[o]>>>r}}function Eg(e,t){let n=t===void 0;return t===void 0&&(t=new Uint8Array(e.length>>>2<<3)),{data:e,buf:t,noBuf:n,BFINAL:0,off:0,pos:0}}function Dg(e,t){let{data:n,noBuf:r}=e,{buf:i,BFINAL:o,off:s,pos:a}=e,c=0;for(;o===0&&c<t;){let u,l,m=0,f=0;o=Qc(n,a,1),c+=1;let d=Qc(n,a+1,2);if(a+=3,d===0){a&7&&(a+=8-(a&7));let p=(a>>>3)+4,h=n[p-4]|n[p-3]<<8;r&&(i=$c(i,s+h)),i.set(new Uint8Array(n.buffer,n.byteOffset+p,h),s),a=p+h<<3,s+=h;continue}if(r&&(i=$c(i,s+(1<<17))),d===1)u=we.flmap,l=we.fdmap,m=511,f=31;else if(d===2){let p=Wr(n,a,5)+257,h=Wr(n,a+5,5)+1,x=Wr(n,a+10,4)+4;a+=14;for(let _=0;_<38;_+=2)we.itree[_]=0,we.itree[_+1]=0;let y=1;for(let _=0;_<x;_++){let b=Wr(n,a+_*3,3);we.itree[(we.ordr[_]<<1)+1]=b,b>y&&(y=b)}a+=3*x,ar(we.itree,y),Zi(we.itree,y,we.imap),u=we.lmap,l=we.dmap,a=Mg(we.imap,(1<<y)-1,p+h,n,a,we.ttree);let g=zm(we.ttree,0,p,we.ltree);m=(1<<g)-1;let C=zm(we.ttree,p,h,we.dtree);f=(1<<C)-1,ar(we.ltree,g),Zi(we.ltree,g,u),ar(we.dtree,C),Zi(we.dtree,C,l)}else throw new Error(`unknown BTYPE ${d}`);for(;;){let p=u[Jc(n,a)&m];a+=p&15;let h=p>>>4;if(!(h>>>8))i[s++]=h;else{if(h===256)break;{let x=s+h-254;if(h>264){let b=we.ldef[h-257];x=s+(b>>>3)+Wr(n,a,b&7),a+=b&7}let y=l[Jc(n,a)&f];a+=y&15;let g=y>>>4,C=we.ddef[g],_=(C>>>4)+Qc(n,a,C&15);for(a+=C&15,r&&(i=$c(i,s+(1<<17)));s<x;)i[s]=i[s++-_],i[s]=i[s++-_],i[s]=i[s++-_],i[s]=i[s++-_];s=x}}}}e.buf=i,e.BFINAL=o,e.off=s,e.pos=a}function Vm(e,t,n){return Ve(this,null,function*(){if(t[0]===3&&t[1]===0)return n||new Uint8Array(0);let r=Eg(t,n);for(;r.BFINAL===0;)e.shouldUpdate&&(yield e.update({message:"Inflating blocks...",current:r.pos,max:t.length})),Dg(r,100);return r.buf.length===r.off?r.buf:r.buf.slice(0,r.off)})}function $c(e,t){let n=e.length;if(t<=n)return e;let r=new Uint8Array(Math.max(n<<1,t));return r.set(e,0),r}function Mg(e,t,n,r,i,o){let s=0;for(;s<n;){let a=e[Jc(r,i)&t];i+=a&15;let c=a>>>4;if(c<=15)o[s]=c,s++;else{let u=0,l=0;c===16?(l=3+Wr(r,i,2),i+=2,u=o[s-1]):c===17?(l=3+Wr(r,i,3),i+=3):c===18&&(l=11+Wr(r,i,7),i+=7);let m=s+l;for(;s<m;)o[s]=u,s++}}return i}function zm(e,t,n,r){let i=0,o=0,s=r.length>>>1;for(;o<n;){let a=e[o+t];r[o<<1]=0,r[(o<<1)+1]=a,a>i&&(i=a),o++}for(;o<s;)r[o<<1]=0,r[(o<<1)+1]=0,o++;return i}function Wr(e,t,n){return(e[t>>>3]|e[(t>>>3)+1]<<8)>>>(t&7)&(1<<n)-1}function Qc(e,t,n){return(e[t>>>3]|e[(t>>>3)+1]<<8|e[(t>>>3)+2]<<16)>>>(t&7)&(1<<n)-1}function Jc(e,t){return(e[t>>>3]|e[(t>>>3)+1]<<8|e[(t>>>3)+2]<<16)>>>(t&7)}function ta(e,t,n){let r=[],i=e.length,o=t.length;for(let p=0;p<o;p+=2)t[p]=0,t[p+1]=0;for(let p=0;p<i;p++)e[p]!==0&&r.push({lit:p,f:e[p],d:void 0});let s=r.length,a=r.slice(0);if(s===0)return 0;if(s===1){let p=r[0].lit,h=p===0?1:0;return t[(p<<1)+1]=1,t[(h<<1)+1]=1,1}r.sort(function(p,h){return p.f-h.f});let c=r[0],u=r[1],l=0,m=1,f=2;for(r[0]={lit:-1,f:c.f+u.f,l:c,r:u,d:0};m!==s-1;)l!==m&&(f===s||r[l].f<r[f].f)?c=r[l++]:c=r[f++],l!==m&&(f===s||r[l].f<r[f].f)?u=r[l++]:u=r[f++],r[m++]={lit:-1,f:c.f+u.f,l:c,r:u,d:void 0};let d=eu(r[m-1],0);d>n&&(Ng(a,n,d),d=n);for(let p=0;p<s;p++)t[(a[p].lit<<1)+1]=a[p].d;return d}function eu(e,t){return e.lit!==-1?(e.d=t,t):Math.max(eu(e.l,t+1),eu(e.r,t+1))}function Ng(e,t,n){let r=0,i=0,o=1<<n-t;for(e.sort(function(s,a){return a.d===s.d?s.f-a.f:a.d-s.d}),r=0;r<e.length&&e[r].d>t;r++){let s=e[r].d;e[r].d=t,i+=o-(1<<n-s)}for(i=i>>>n-t;i>0;){let s=e[r].d;s<t?(e[r].d++,i-=1<<t-s-1):r++}for(;r>=0;r--)e[r].d===t&&i<0&&(e[r].d--,i++);i!==0&&console.log("debt left")}function kg(e,t,n,r){let{lits:i,strt:o,prev:s}=we;return{data:e,out:t,opt:Rg[r],i:0,pos:n<<3,cvrd:0,dlen:e.length,li:0,lc:0,bs:0,ebits:0,c:0,nc:0,lits:i,strt:o,prev:s}}function Ug(e,t){let{data:n,dlen:r,out:i,opt:o}=e,{i:s,pos:a,cvrd:c,li:u,lc:l,bs:m,ebits:f,c:d,nc:p}=e,{lits:h,strt:x,prev:y}=we,g=Math.min(s+t,r);for(;s<g;s++){if(d=p,s+1<r-2){p=tu(n,s+1);let C=s+1&32767;y[C]=x[p],x[p]=C}if(c<=s){(u>14e3||l>26697)&&r-s>100&&(c<s&&(h[u]=s-c,u+=2,c=s),a=Wm(s===r-1||c===r?1:0,h,u,f,n,m,s-m,i,a),u=l=f=0,m=s);let C=0;if(s<r-2&&(C=Tg(n,s,y,d,Math.min(o[2],r-s),o[3])),C!==0){let _=C>>>16,b=C&65535,I=Ym(_,we.of0);we.lhst[257+I]++;let E=Ym(b,we.df0);we.dhst[E]++,f+=we.exb[I]+we.dxb[E],h[u]=_<<23|s-c,h[u+1]=b<<16|I<<8|E,u+=2,c=s+_}else we.lhst[n[s]]++;l++}}e.i=s,e.pos=a,e.cvrd=c,e.li=u,e.lc=l,e.bs=m,e.ebits=f,e.c=d,e.nc=p}var Rg=[[0,0,0,0,0],[4,4,8,4,0],[4,5,16,8,0],[4,6,16,16,0],[4,10,16,32,0],[8,16,32,32,0],[8,16,128,128,0],[8,32,128,256,0],[32,128,258,1024,1],[32,258,258,4096,1]];function Zm(e,t,n,r,i){return Ve(this,null,function*(){let o=kg(t,n,r,i),{dlen:s}=o;if(i===0){let{i:p,pos:h}=o;for(;p<s;){let x=Math.min(65535,s-p);hi(n,h,p+x===s?1:0),h=Xm(t,p,x,n,h+8),p+=x}return h>>>3}for(s>2&&(o.nc=tu(t,0),o.strt[o.nc]=0);o.i<s;)e.shouldUpdate&&(yield e.update({message:"Deflating...",current:o.i,max:s})),Ug(o,1024*1024);let{li:a,cvrd:c,pos:u}=o,{i:l,lits:m,bs:f,ebits:d}=o;for((f!==l||t.length===0)&&(c<l&&(m[a]=l-c,a+=2,c=l),u=Wm(1,m,a,d,t,f,l-f,n,u));u&7;)u++;return u>>>3})}function Tg(e,t,n,r,i,o){let s=t&32767,a=n[s],c=s-a+32768&32767;if(a===s||r!==tu(e,t-c))return 0;let u=0,l=0,m=Math.min(32767,t);for(;c<=m&&--o!==0&&a!==s;){if(u===0||e[t+u]===e[t+u-c]){let f=Fg(e,t,c);if(f>u){if(u=f,l=c,u>=i)break;c+2<f&&(f=c+2);let d=0;for(let p=0;p<f-2;p++){let h=t-c+p+32768&32767,x=n[h],y=h-x+32768&32767;y>d&&(d=y,a=h)}}}s=a,a=n[s],c+=s-a+32768&32767}return u<<16|l}function Fg(e,t,n){if(e[t]!==e[t-n]||e[t+1]!==e[t+1-n]||e[t+2]!==e[t+2-n])return 0;let r=t,i=Math.min(e.length,t+258);for(t+=3;t<i&&e[t]===e[t-n];)t++;return t-r}function tu(e,t){return(e[t]<<8|e[t+1])+(e[t+2]<<4)&65535}function Wm(e,t,n,r,i,o,s,a,c){we.lhst[256]++;let[u,l,m,f,d,p,h,x]=Og(),y=(c+3&7?8-(c+3&7):0)+32+(s<<3),g=r+Bo(we.fltree,we.lhst)+Bo(we.fdtree,we.dhst),C=r+Bo(we.ltree,we.lhst)+Bo(we.dtree,we.dhst);C+=14+3*p+Bo(we.itree,we.ihst)+(we.ihst[16]*2+we.ihst[17]*3+we.ihst[18]*7);for(let b=0;b<286;b++)we.lhst[b]=0;for(let b=0;b<30;b++)we.dhst[b]=0;for(let b=0;b<19;b++)we.ihst[b]=0;let _=y<g&&y<C?0:g<C?1:2;if(na(a,c,e),na(a,c+1,_),c+=3,_===0){for(;c&7;)c++;c=Xm(i,o,s,a,c)}else{let b,I;if(_===1)b=we.fltree,I=we.fdtree;else if(_===2){ar(we.ltree,u),Wi(we.ltree,u),ar(we.dtree,l),Wi(we.dtree,l),ar(we.itree,m),Wi(we.itree,m),b=we.ltree,I=we.dtree,hi(a,c,f-257),c+=5,hi(a,c,d-1),c+=5,hi(a,c,p-4),c+=4;for(let S=0;S<p;S++)hi(a,c+S*3,we.itree[(we.ordr[S]<<1)+1]);c+=3*p,c=Km(h,we.itree,a,c),c=Km(x,we.itree,a,c)}else gn(_);let E=o;for(let S=0;S<n;S+=2){let v=t[S],P=v>>>23,L=E+(v&(1<<23)-1);for(;E<L;)c=Eo(i[E++],b,a,c);if(P!==0){let w=t[S+1],D=w>>16,z=w>>8&255,ie=w&255;c=Eo(257+z,b,a,c),hi(a,c,P-we.of0[z]),c+=we.exb[z],c=Eo(ie,I,a,c),na(a,c,D-we.df0[ie]),c+=we.dxb[ie],E+=P}}c=Eo(256,b,a,c)}return c}function Xm(e,t,n,r,i){let o=i>>>3;return r[o]=n,r[o+1]=n>>>8,r[o+2]=255-r[o],r[o+3]=255-r[o+1],o+=4,r.set(new Uint8Array(e.buffer,t,n),o),i+(n+4<<3)}function Og(){let e=ta(we.lhst,we.ltree,15),t=ta(we.dhst,we.dtree,15),n=[],r=jm(we.ltree,n),i=[],o=jm(we.dtree,i);for(let c=0;c<n.length;c+=2)we.ihst[n[c]]++;for(let c=0;c<i.length;c+=2)we.ihst[i[c]]++;let s=ta(we.ihst,we.itree,7),a=19;for(;a>4&&we.itree[(we.ordr[a-1]<<1)+1]===0;)a--;return[e,t,s,r,o,a,n,i]}function Bo(e,t){let n=0;for(let r=0;r<t.length;r++)n+=t[r]*e[(r<<1)+1];return n}function Km(e,t,n,r){for(let i=0;i<e.length;i+=2){let o=e[i],s=e[i+1];r=Eo(o,t,n,r);let a=o===16?2:o===17?3:7;o>15&&(hi(n,r,s),r+=a)}return r}function jm(e,t){let n=e.length;for(;n!==2&&e[n-1]===0;)n-=2;for(let r=0;r<n;r+=2){let i=e[r+1],o=r+3<n?e[r+3]:-1,s=r+5<n?e[r+5]:-1,a=r===0?-1:e[r-1];if(i===0&&o===i&&s===i){let c=r+5;for(;c+2<n&&e[c+2]===i;)c+=2;let u=Math.min(c+1-r>>>1,138);u<11?t.push(17,u-3):t.push(18,u-11),r+=u*2-2}else if(i===a&&o===i&&s===i){let c=r+5;for(;c+2<n&&e[c+2]===i;)c+=2;let u=Math.min(c+1-r>>>1,6);t.push(16,u-3),r+=u*2-2}else t.push(i,0)}return n>>>1}function Ym(e,t){let n=0;return t[n|16]<=e&&(n|=16),t[n|8]<=e&&(n|=8),t[n|4]<=e&&(n|=4),t[n|2]<=e&&(n|=2),t[n|1]<=e&&(n|=1),n}function Eo(e,t,n,r){return na(n,r,t[e<<1]),r+t[(e<<1)+1]}function hi(e,t,n){n=n<<(t&7);let r=t>>>3;e[r]|=n,e[r+1]|=n>>>8}function na(e,t,n){n=n<<(t&7);let r=t>>>3;e[r]|=n,e[r+1]|=n>>>8,e[r+2]|=n>>>16}function nu(e,t,n=!1){return Ve(this,null,function*(){let r=Object.create(null),i=new Uint8Array(t);if(or(i,0)!==19280)throw new Error('Invalid ZIP file. A valid ZIP file must start with two magic bytes \\x50\\x4b ("PK" in ASCII).');let o=i.length-4;for(;Zr(i,o)!==101010256;)o--;let s=o;s+=4,s+=4;let a=or(i,s);s+=2,s+=2,s+=4;let c=Zr(i,s);s+=4,s=c;for(let u=0;u<a;u++){s+=4,s+=4,s+=4,s+=4,s+=4;let l=Zr(i,s);s+=4;let m=Zr(i,s);s+=4;let f=or(i,s),d=or(i,s+2),p=or(i,s+4);s+=6,s+=8;let h=Zr(i,s);s+=4,s+=f+d+p,yield Lg(e,i,h,r,l,m,n)}return r})}function Lg(e,t,n,r,i,o,s){return Ve(this,null,function*(){n+=4,n+=2,n+=2;let a=or(t,n);n+=2,n+=4,n+=4,n+=8;let c=or(t,n);n+=2;let u=or(t,n);n+=2;let l=Gm(t,n,c);if(n+=c,n+=u,s){r[l]={size:o,csize:i};return}let m=new Uint8Array(t.buffer,n);if(a===0)r[l]=new Uint8Array(m.buffer.slice(n,n+i));else if(a===8){let f=new Uint8Array(o);yield Qm(e,m,f),r[l]=f}else throw new Error(`unknown compression method: ${a}`)})}function Qm(e,t,n){return Ve(this,null,function*(){return Vm(e,t,n)})}function Jm(e,t,n){return Ve(this,null,function*(){let r=t[3],i=10;if(r&4){let l=or(t,i);i+=l}if(r&8){let l=i;for(;t[l]!==0;)++l;i=l+1}if(r&16){let l=i;for(;t[l]!==0;)++l;i=l+1}r&1&&(i+=2);let o=qm(Zr(t,t.length-8)),s=Zr(t,t.length-4);n===void 0&&(n=new Uint8Array(s));let a=new Uint8Array(t.buffer,t.byteOffset+i,t.length-i-8),c=yield Qm(e,a,n),u=Xc(c,0,c.length);return o!==u&&console.error("ungzip: checksums don't match"),c})}function qg(e,t,n){return Ve(this,null,function*(){n===void 0&&(n={level:6});let r=new Uint8Array(50+Math.floor(t.length*1.1)),i=yield Zm(e,t,r,0,n.level);return new Uint8Array(r.buffer,0,i)})}function _v(e,t=!1){return wt.create("Zip",n=>Gg(n,e,t))}function Gg(e,t,n=!1){return Ve(this,null,function*(){let r=0,i={};for(let m in t){let f=!Hg(m)&&!n,d=t[m],p=Xc(d,0,d.length);i[m]={cpr:f,usize:d.length,crc:p,file:f?yield qg(e,d):d}}for(let m in i)r+=i[m].file.length+30+46+2*Wc(m);r+=22;let o=new Uint8Array(r),s=0,a=[];for(let m in i){let f=i[m];a.push(s),s=$m(o,s,m,f,0)}let c=0,u=s;for(let m in i){let f=i[m];a.push(s),s=$m(o,s,m,f,1,a[c++])}let l=s-u;return sr(o,s,101010256),s+=4,s+=4,Yr(o,s,c),s+=2,Yr(o,s,c),s+=2,sr(o,s,l),s+=4,sr(o,s,u),s+=4,s+=2,o.buffer})}function Hg(e){let t=e.split(".").pop().toLowerCase();return"png,jpg,jpeg,zip".indexOf(t)!==-1}function $m(e,t,n,r,i,o=0){let s=r.file;sr(e,t,i===0?67324752:33639248),t+=4,i===1&&(t+=2),Yr(e,t,20),t+=2,Yr(e,t,0),t+=2,Yr(e,t,r.cpr?8:0),t+=2,sr(e,t,0),t+=4,sr(e,t,r.crc),t+=4,sr(e,t,s.length),t+=4,sr(e,t,r.usize),t+=4,Yr(e,t,Wc(n)),t+=2,Yr(e,t,0),t+=2,i===1&&(t+=2,t+=2,t+=6,sr(e,t,o),t+=4);let a=Hm(e,t,n);return t+=a,i===0&&(e.set(s,t),t+=s.length),t}var Un=function(e){return e[e.None=0]="None",e[e.Gzip=1]="Gzip",e[e.Zip=2]="Zip",e}(Un||{});function Xi(e,t){return jg(e,t)}function iu(e){return typeof e=="string"?t0(e,e,"string"):t0(e.title,e.url,e.type||"string",e.body,e.headers)}function zg(e){if(!pi&&e instanceof FileReader)return e.readyState===FileReader.DONE;if(e instanceof Yi)return e.readyState===Yi.DONE;throw new Error("unknown data type")}function e0(e){return e?"Failed to download data. Possible reasons: Resource is not available, or CORS is not allowed on the server.":"Failed to open file."}function o0(e,t,n){return new Promise((r,i)=>{if(zg(n)){let{error:s}=n;s!=null?i(s??e0(n instanceof Yi)):r(n);return}let o=!1;n.onerror=s=>{if(o)return;let{error:a}=s.target;i(a??e0(n instanceof Yi))},n.onprogress=s=>{if(!(!e.shouldUpdate||o))try{s.lengthComputable?e.update({message:t,isIndeterminate:!1,current:s.loaded,max:s.total}):e.update({message:`${t} ${(s.loaded/1024/1024).toFixed(2)} MB`,isIndeterminate:!0})}catch(a){o=!0,i(a)}},n.onload=s=>{r(n)}})}function s0(e){return/\.gz$/i.test(e)?Un.Gzip:/\.zip$/i.test(e)?Un.Zip:Un.None}var Vg=/^(__MACOSX|.DS_Store)/;function Kg(e,t,n){return Ve(this,null,function*(){switch(n){case Un.None:return t;case Un.Gzip:return Jm(e,t);case Un.Zip:let r=yield nu(e,t.buffer),i=Object.keys(r).filter(o=>!Vg.test(o));if(i.length!==1)throw new Error("can only decompress zip files with a single entry");return r[i[0]]}})}function a0(e,t,n,r){return Ve(this,null,function*(){let i=t instanceof ArrayBuffer?new Uint8Array(t):t;if(i===null)throw new Error("no data given");if(r!==Un.None){if(!(i instanceof Uint8Array))throw new Error("need Uint8Array for decompression");let o=yield Kg(e,i,r);n==="string"?(yield e.update({message:"Decoding text..."}),i=xs(o,0,o.length)):i=o}if(n==="binary"&&i instanceof Uint8Array)return i;if(n==="zip"&&i instanceof Uint8Array)return yield nu(e,i.buffer);if(n==="string"&&typeof i=="string")return i;if(n==="xml"&&typeof i=="string")return new DOMParser().parseFromString(i,"application/xml");if(n==="json"&&typeof i=="string")return JSON.parse(i);throw new Error(`could not get requested response data '${n}'`)})}function jg(e,t){if(pi)return Yg(e,t);let n;return wt.create("Read File",r=>Ve(this,null,function*(){try{n=new FileReader;let i=t==="zip"?Un.None:s0(e.name);t==="binary"||t==="zip"||i!==Un.None?n.readAsArrayBuffer(e):n.readAsText(e),yield r.update({message:"Opening file...",canAbort:!0});let o=yield o0(r,"Reading...",n);return yield r.update({message:"Processing file...",canAbort:!1}),yield a0(r,o.result,t,i)}finally{n=void 0}}),()=>{n&&n.abort()})}function Yg(e,t){return wt.create("Read File",n=>Ve(this,null,function*(){let r=t==="zip"?Un.None:s0(e.name);yield n.update({message:"Opening file...",canAbort:!1});let i;return t==="binary"||t==="zip"||r!==Un.None?i=yield e.arrayBuffer():i=yield e.text(),yield n.update({message:"Processing file...",canAbort:!1}),yield a0(n,i,t,r)}))}var ru=(()=>{class e{static get(){return this.pool.length?this.pool.pop():new Yi}static emptyFunc(){}static deposit(n){this.pool.length<this.poolSize&&(n.onabort=e.emptyFunc,n.onerror=e.emptyFunc,n.onload=e.emptyFunc,n.onprogress=e.emptyFunc,this.pool.push(n))}}return e.pool=[],e.poolSize=15,e})();function Zg(e,t){if(e.status>=200&&e.status<400){let{response:n}=e;if(ru.deposit(e),(t==="binary"||t==="zip")&&n instanceof ArrayBuffer)return new Uint8Array(n);if(t==="string"&&typeof n=="string")return n;if(t==="xml"&&n instanceof XMLDocument)return n;if(t==="json"&&typeof n=="object")return n;throw new Error(`could not get requested response data '${t}'`)}else throw ru.deposit(e),new Error(`Download failed with status code ${e.status}`)}function Wg(e){switch(e){case"json":return"json";case"xml":return"document";case"string":return"text";case"binary":return"arraybuffer";case"zip":return"arraybuffer"}}function t0(e,t,n,r,i){if(pi&&t.startsWith("file://"))return $g(e,t,n,r,i);let o;return wt.create(e||"Download",s=>Ve(this,null,function*(){if(o=ru.get(),o.open(r?"post":"get",t,!0),i)for(let[u,l]of i)o.setRequestHeader(u,l);o.responseType=Wg(n),o.send(r),yield s.update({message:"Waiting for server...",canAbort:!0});let a=yield o0(s,"Downloading...",o);return o=void 0,yield s.update({message:"Parsing response...",canAbort:!1}),Zg(a,n)}),()=>{o&&(o.abort(),o=void 0)})}var n0;function Xg(){if(!n0)throw new Error("When running in Node.js and reading from files, call mol-util/data-source's setFSModule function first.");return n0}function $g(e,t,n,r,i){if(!pi)throw new Error("This function should only be used when running in Node.js");if(!t.startsWith("file://"))throw new Error("This function is only for URLs with protocol file://");let o=t.substring(7),s=Xg().readFileSync(o),a=new Po([s],"raw-data");return Xi(a,n)}function Iv(e,t,n,r){return Ve(this,null,function*(){let i=n.length,o=new Array(n.length);yield e.update({message:"Downloading...",current:0,max:i});let s=[],a=[],c=0;for(let l=Math.min(i,r);c<l;c++){let m=n[c];s.push(i0(c,m.id,t.resolve(un.getUrlAsset(t,m.url),m.isBinary?"binary":"string").runAsChild(e))),a.push(c)}let u=0;for(;s.length>0;){let l=yield Promise.race(s),m=n[l.index],f=a.indexOf(l.index);if(u++,l.kind==="error"&&!m.canFail)throw new Error(`${m.url}: ${l.error}`);if(e.shouldUpdate&&(yield e.update({message:"Downloading...",current:u,max:i})),o[l.index]=l,s=s.filter(r0,f),a=a.filter(r0,f),c<i){let d=n[c],p=t.resolve(un.getUrlAsset(t,d.url),d.isBinary?"binary":"string").runAsChild(e);s.push(i0(c,d.id,p)),a.push(c),c++}}return o})}function r0(e,t){return this!==t}function i0(e,t,n){return Ve(this,null,function*(){try{return{kind:"ok",result:yield n,index:e,id:t}}catch(r){return{kind:"error",error:r,index:e,id:t}}})}var un;(function(e){function t(c,u){return Le({kind:"url",id:Rt.create22(),url:c},u)}e.Url=t;function n(c){return{kind:"file",id:Rt.create22(),name:c.name,file:c}}e.File=n;function r(c){return c?.kind==="url"}e.isUrl=r;function i(c){return c?.kind==="file"}e.isFile=i;function o(c,u,l){return{data:c,dispose:()=>{l.release(u)}}}e.Wrapper=o;function s(c){return typeof c=="string"?c:c.url}e.getUrl=s;function a(c,u,l){return typeof u=="string"?c.tryFindUrl(u,l)||t(u,{body:l}):u}e.getUrlAsset=a})(un||(un={}));var c0=class{constructor(){this._assets=new Map}get assets(){return $o(this._assets.values())}tryFindUrl(t,n){let r=this.assets.values();for(;;){let i=r.next();if(i.done)return;let o=i.value.asset;if(un.isUrl(o)&&o.url===t&&(o.body||"")===(n||""))return o}}set(t,n){this._assets.set(t.id,{asset:t,file:n,refCount:0})}get(t){return this._assets.get(t.id)}delete(t){return this._assets.delete(t.id)}has(t){return this._assets.has(t.id)}resolve(t,n,r=!0){return un.isUrl(t)?wt.create(`Download ${t.title||t.url}`,i=>Ve(this,null,function*(){if(this._assets.has(t.id)){let a=this._assets.get(t.id);return a.refCount++,un.Wrapper(yield Xi(a.file,n).runInContext(i),t,this)}if(!r)return un.Wrapper(yield iu(Ct(Le({},t),{type:n})).runInContext(i),t,this);let o=yield iu(Ct(Le({},t),{type:"binary"})).runInContext(i),s=new Po([o],"raw-data");return this._assets.set(t.id,{asset:t,file:s,refCount:1}),un.Wrapper(yield Xi(s,n).runInContext(i),t,this)})):wt.create(`Read ${t.name}`,i=>Ve(this,null,function*(){if(this._assets.has(t.id)){let o=this._assets.get(t.id);return o.refCount++,un.Wrapper(yield Xi(o.file,n).runInContext(i),t,this)}if(!(t.file instanceof Po))throw new Error(`Cannot resolve file asset '${t.name}' (${t.id})`);return r&&this._assets.set(t.id,{asset:t,file:t.file,refCount:1}),un.Wrapper(yield Xi(t.file,n).runInContext(i),t,this)}))}release(t){let n=this._assets.get(t.id);n&&(n.refCount--,n.refCount<=0&&this._assets.delete(t.id))}clear(){this._assets.clear()}dispose(){this.clear()}};var Et;(function(e){e.Essential={isEssential:!0};function t(q,F){return F&&(F.label&&(q.label=F.label),F.description&&(q.description=F.description),F.legend&&(q.legend=F.legend),F.fieldLabels&&(q.fieldLabels=F.fieldLabels),F.isHidden&&(q.isHidden=F.isHidden),F.shortLabel&&(q.shortLabel=F.shortLabel),F.twoColumns&&(q.twoColumns=F.twoColumns),F.isEssential&&(q.isEssential=F.isEssential),F.category&&(q.category=F.category),F.hideIf&&(q.hideIf=F.hideIf),F.help&&(q.help=F.help)),q}function n(q){let F=Le({},q);return F.isOptional=!0,F}e.Optional=n;function r(q,F){return t({type:"value",defaultValue:q},F)}e.Value=r;function i(q,F,W){return t({type:"select",defaultValue:ne(q,F),options:F,cycle:W?.cycle},W)}e.Select=i;function o(q,F,W){let re=t({type:"multi-select",defaultValue:q,options:F},W);return W?.emptyValue&&(re.emptyValue=W.emptyValue),re}e.MultiSelect=o;function s(q,F){return t({type:"boolean",defaultValue:q},F)}e.Boolean=s;function a(q="",F){return t({type:"text",defaultValue:q,multiline:F?.multiline,placeholder:F?.placeholder,disableInteractiveUpdates:F?.disableInteractiveUpdates},F)}e.Text=a;function c(q,F){let W=t({type:"color",defaultValue:q},F);return F?.isExpanded&&(W.isExpanded=F.isExpanded),W}e.Color=c;function u(q,F){let W;if(typeof q=="string"){let re=vs(q);W={kind:re.type!=="qualitative"?"interpolate":"set",colors:re.list}}else W=q;return t({type:"color-list",presetKind:F?.presetKind||"all",defaultValue:W,offsets:!!F?.offsets},F)}e.ColorList=u;function l(q,F,W){return t(h({type:"vec3",defaultValue:q},F),W)}e.Vec3=l;function m(q,F){return t({type:"mat4",defaultValue:q},F)}e.Mat4=m;function f(q,F){let W=typeof q=="string"?un.Url(q):un.Url(q.url,{body:q.body});return t({type:"url",defaultValue:W},F)}e.Url=f;function d(q){let F=t({type:"file",defaultValue:null},q);return q?.accept&&(F.accept=q.accept),F}e.File=d;function p(q){let F=t({type:"file-list",defaultValue:null},q);return q?.accept&&(F.accept=q.accept),F}e.FileList=p;function h(q,F){return F&&(typeof F.min<"u"&&(q.min=F.min),typeof F.max<"u"&&(q.max=F.max),typeof F.step<"u"&&(q.step=F.step)),q}function x(q,F,W){let re=t(h({type:"number",defaultValue:q},F),W);return W?.immediateUpdate&&(re.immediateUpdate=!0),re}e.Numeric=x;function y(q,F,W){return t(h({type:"interval",defaultValue:q},F),W)}e.Interval=y;function g(q,F){let W=t({type:"line-graph",defaultValue:q},F);return F?.getVolume&&(W.getVolume=F.getVolume),W}e.LineGraph=g;function C(q,F){let W=t({type:"group",defaultValue:F?.customDefault||O(q),params:q},F);return F?.presets&&(W.presets=F.presets),F?.isExpanded&&(W.isExpanded=F.isExpanded),F?.isFlat&&(W.isFlat=F.isFlat),F?.pivot&&(W.pivot=F.pivot),W}e.Group=C;function _(q){return C({},q)}e.EmptyGroup=_;function b(q,F,W,re){let _e=ne(q,F);return t({type:"mapped",defaultValue:{name:_e,params:W(_e).defaultValue},select:i(_e,F,re),map:W},re)}e.Mapped=b;function I(q,F,W){let re=W?.options?W.options:Object.keys(F).map(Ae=>[Ae,F[Ae].label||Lr(Ae)]),_e=ne(q,re);return t({type:"mapped",defaultValue:{name:_e,params:F[_e].defaultValue},select:i(_e,re,W),map:Ae=>F[Ae]},W)}e.MappedStatic=I;function E(q,F,W){return t({type:"object-list",element:q,getLabel:F,ctor:S,defaultValue:W?.defaultValue||[]},W)}e.ObjectList=E;function S(){return O(this.element)}function v(){throw new Error("getValue not set. Fix runtime.")}function P(q,F,W){var re;return t({type:"value-ref",defaultValue:{ref:(re=W?.defaultRef)!==null&&re!==void 0?re:"",getValue:v},getOptions:q,resolveRef:F},W)}e.ValueRef=P;function L(q){var F;return t({type:"data-ref",defaultValue:{ref:(F=q?.defaultRef)!==null&&F!==void 0?F:"",getValue:v}},q)}e.DataRef=L;function w(q,F,W){return t({type:"converted",defaultValue:F(W.defaultValue),converted:W,fromValue:q,toValue:F},W)}e.Converted=w;function D(q,F,W,re,_e){let Ae=Object.keys(F).map(Ze=>[Ze,Ze]);return t({type:"conditioned",select:i(W(q),Ae,_e),defaultValue:q,conditionParams:F,conditionForValue:W,conditionedValue:re},_e)}e.Conditioned=D;function z(q,F){return t({type:"script",defaultValue:q},F)}e.Script=z;function ie(q){return 0}e.For=ie;function O(q){let F={};for(let W of Object.keys(q))q[W].isOptional||(F[W]=q[W].defaultValue);return F}e.getDefaultValues=O;function Q(q,F,W){return()=>q(F,W)}function K(q,F,W){if(F){if(q.type==="value-ref"){let re=F;re.ref?re.getValue=Q(q.resolveRef,re.ref,W):re.getValue=()=>{throw new Error("Unset ref in ValueRef value.")}}else if(q.type==="data-ref"){let re=F;re.ref?re.getValue=Q(W,re.ref,W):re.getValue=()=>{throw new Error("Unset ref in ValueRef value.")}}else if(q.type==="group")fe(q.params,F,W);else if(q.type==="mapped"){let re=F,_e=q.map(re.name);K(_e,re.params,W)}else if(q.type==="object-list"){if(!se(q.element))return;for(let re of F)fe(q.element,re,W)}}}function Z(q){if(q.type==="value-ref"||q.type==="data-ref")return!0;if(q.type==="group"){if(se(q.params))return!0}else if(q.type==="mapped"){for(let[F]of q.select.options)if(Z(q.map(F)))return!0}else if(q.type==="object-list")return se(q.element);return!1}function se(q){for(let F of Object.keys(q))if(Z(q[F]))return!0;return!1}function fe(q,F,W){for(let re of Object.keys(q))K(q[re],F?.[re],W)}e.resolveRefs=fe;function Ce(q,F){for(let W of Object.keys(q))q[W].isOptional||(q[W].defaultValue=F[W])}e.setDefaultValues=Ce;function xe(q){return os(q)}e.clone=xe;function H(q,F){}e.validate=H;function $(q,F,W){if(F===W)return!0;if(typeof F!="object"||typeof W!="object")return!1;for(let re of Object.keys(q))if(!de(q[re],F[re],W[re]))return!1;return!0}e.areEqual=$;function de(q,F,W){if(F===W)return!0;if(q.type==="group")return $(q.params,F,W);if(q.type==="mapped"){let re=F,_e=W;if(re.name!==_e.name)return!1;let Ae=q.map(re.name);return de(Ae,re.params,_e.params)}else if(q.type==="multi-select"){let re=F,_e=W;if(re.length!==_e.length)return!1;if(re.length<10){for(let Ae=0,Ze=re.length;Ae<Ze;Ae++)if(re[Ae]!==_e[Ae]&&_e.indexOf(re[Ae])<0)return!1}else{let Ae=new Set(_e);for(let Ze=0,A=re.length;Ze<A;Ze++)if(re[Ze]!==_e[Ze]&&!Ae.has(re[Ze]))return!1}return!0}else{if(q.type==="interval")return F[0]===W[0]&&F[1]===W[1];if(q.type==="line-graph"){let re=F,_e=W;if(re.length!==_e.length)return!1;for(let Ae=0,Ze=re.length;Ae<Ze;Ae++)if(!vi.areEqual(re[Ae],_e[Ae]))return!1;return!0}else{if(q.type==="vec3")return N.equals(F,W);if(q.type==="mat4")return ke.areEqual(F,W,1e-6);if(q.type==="script"){let re=F,_e=W;return re.language===_e.language&&re.expression===_e.expression}else if(q.type==="object-list"){let re=F,_e=W,Ae=re.length;if(Ae!==_e.length)return!1;for(let Ze=0;Ze<Ae;Ze++)if(!$(q.element,re[Ze],_e[Ze]))return!1;return!0}else if(typeof F=="object"&&typeof W=="object")return wa(F,W)}}return!1}e.isParamEqual=de;function T(q,F,W){if(F===void 0)return Le({},W);if(W===void 0)return Le({},F);let re=Object.create(null);for(let _e of Object.keys(q))re[_e]=B(q[_e],F[_e],W[_e]);return re}e.merge=T;function B(q,F,W){if(F===void 0)return typeof W=="object"&&!Array.isArray(W)?Le({},W):W;if(W===void 0)return typeof F=="object"&&!Array.isArray(F)?Le({},F):F;if(q.type==="group")return T(q.params,F,W);if(q.type==="mapped"){let re=F,_e=W;if(re.name!==_e.name)return Le({},_e);let Ae=q.map(_e.name);return{name:_e.name,params:B(Ae,re.params,_e.params)}}else return q.type==="value"?W:typeof F=="object"&&typeof W=="object"?Array.isArray(W)?W:Le(Le({},F),W):W}e.mergeParam=B;function k(q,F){for(let W of q.options)if(W[0]===F)return!0;return!1}function R(q,F,W){if(F==null)return W?q.defaultValue:void 0;if(q.type==="value")return F;if(q.type==="group"){let re=Object.create(null);for(let _e of Object.keys(q.params)){let Ae=q.params[_e];F[_e]===void 0?W&&(re[_e]=Ae.defaultValue):re[_e]=R(Ae,F[_e],W)}return re}else if(q.type==="mapped"){let re=F;if(typeof re.name!="string")return q.defaultValue;if(typeof re.params>"u")return W?q.defaultValue:void 0;if(!k(q.select,re.name))return q.defaultValue;let _e=q.map(re.name);return{name:re.name,params:R(_e,re.params,W)}}else{if(q.type==="select")return k(q,F)?F:q.defaultValue;if(q.type==="multi-select"){if(!Array.isArray(F))return q.defaultValue;let re=F.filter(function(_e){return k(this,_e)},q);return F.length>0&&re.length===0?q.defaultValue:re}else if(q.type==="object-list")return Array.isArray(F)?F.map(re=>V(q.element,re,W?"all":"skip")):q.defaultValue}return F}function V(q,F,W){if(typeof F!="object"||F===null)return W?O(q):F;let re=Object.create(null);for(let _e of Object.keys(q)){let Ae=q[_e];F[_e]===void 0?W==="all"&&(re[_e]=Ae.defaultValue):re[_e]=R(Ae,F[_e],W!=="skip")}return re}e.normalizeParams=V;function j(q,F){let W=[];for(let re of Object.keys(q))if(!F)typeof q[re]=="string"?W.push([re,q[re]]):W.push([re,F===null?re:Lr(re)]);else{let _e=F(re,q[re]);W.push(typeof _e=="string"?[re,_e]:[re,_e[0],_e[1]])}return W}e.objectToOptions=j;function oe(q,F){let W=[];for(let re of q)F?W.push([re,F(re)]):W.push([re,F===null?re:Lr(re)]);return W}e.arrayToOptions=oe;function ae(q,F){for(let W of q.options)if(W[0]===F)return W[1];return""}e.optionLabel=ae;function ne(q,F){for(let W of F)if(W[0]===q)return q;return F.length>0?F[0][0]:void 0}})(Et||(Et={}));function u0(e){let{unit:t,flags:n,proteinInfo:r}=e,i=t.conformation,{traceElementIndex:o}=t.model.atomicHierarchy.derived.residue,{residueIndices:s,nIndices:a}=r,c=s.length,u=(y,g)=>y===-1?N.setNaN(g):i.position(y,g),l=N(),m=N(),f=N(),d=N(),p=N(),h=N(),x=N();e:for(let y=2;y<c-2;y++){for(let v=0;v<4;v++){let P=y+v-2;if(u(o[P],d),u(a[P+1],p),N.squaredDistance(d,p)>6.25)continue e}let g=s[y-2],C=s[y],_=s[y+2],b=o[g],I=o[C],E=o[_];u(b,l),u(I,m),u(E,f),N.sub(h,l,m),N.sub(x,m,f);let S=On(N.angle(h,x));S&&S>70&&(n[y]|=32)}}var Qg=9,ra=-27.888,Jg=-.5,l0=-9.9;function ey(e,t,n,r){let i=N.distance(e,r),o=N.distance(t,r),s=N.distance(t,n),a=N.distance(e,n),c=ra/i-ra/o,u=ra/s-ra/a,l=c+u;return l<l0?l0:l}function f0(e,t,n){let{residueIndices:r,cIndices:i,hIndices:o,nIndices:s,oIndices:a}=t,{index:c}=e.model.atomicHierarchy,u=e.conformation,{traceElementIndex:l}=e.model.atomicHierarchy.derived.residue,m=r.length,f=[],d=[],p=[],h=N(),x=N(),y=N(),g=N(),C=N(),_=N(),b=N();for(let I=0,E=r.length;I<E;++I){let S=I,v=r[I],P=a[S],L=i[S],w=l[v];if(P===-1||L===-1||c.findAtomOnResidue(v,"OXT")!==-1)continue;u.invariantPosition(P,h),u.invariantPosition(L,x),u.invariantPosition(w,y);let{indices:D,count:z}=n.find(y[0],y[1],y[2],Qg);for(let ie=0;ie<z;++ie){let O=D[ie];if(O===S||O-1===S||O+1===S)continue;let Q=s[O];if(Q===-1)continue;u.invariantPosition(Q,g);let K=o[O];if(K===-1){if(O===0)continue;let se=O-1,fe=a[se],Ce=i[se];if(fe===-1||Ce===-1)continue;u.invariantPosition(fe,b),u.invariantPosition(Ce,_),N.sub(C,_,b);let xe=N.distance(b,_);N.scaleAndAdd(C,g,C,1/xe)}else u.invariantPosition(K,C);let Z=ey(h,x,g,C);Z>Jg||(f[f.length]=S,d[d.length]=O,p[p.length]=Z)}}return ty(m,f,d,p)}function ty(e,t,n,r){let i=new Jt.DirectedEdgeBuilder(e,t,n),o=new Float32Array(i.slotCount);for(let s=0,a=i.edgeCount;s<a;s++)i.addNextEdge(),i.assignProperty(o,r[s]);return i.createGraph({energies:r})}var $e;(function(e){e.is=fn.has,e.create=fn.create})($e||($e={}));var _i=class{constructor(t,n,r){this.partner1=Math.min(t,n),this.partner2=Math.max(t,n),this.type=r}};function d0(e){let{proteinInfo:t,hbonds:n,flags:r}=e,i=[1024,2048,4096,128,256,512];for(let o=0;o<3;o++)for(let s=0,a=t.residueIndices.length-1;s<a;++s)if(n.getDirectedEdgeIndex(s,s+o+3)!==-1)if(r[s]|=i[o+3]|i[o],e.params.oldDefinition)for(let c=1;c<o+3;++c)r[s+c]|=i[o+3]|64;else for(let c=0;c<=o+3;++c)r[s+c]|=i[o+3]|64}function m0(e){let{proteinInfo:t,flags:n}=e,r=t.residueIndices.length,i=[1024,2048,4096,128,256,512],o=[0,0,0,8,1,16],s=e.params.oldOrdering?[4,3,5]:[3,4,5];for(let a=0;a<s.length;a++){let c=s[a];for(let u=1,l=r-c;u<l;u++){let m=$e.create(n[u]),f=$e.create(n[u-1]),d=$e.create(n[u+1]);if(e.params.oldOrdering){if(c===3&&($e.is(m,1)||$e.is(d,1))||c===5&&($e.is(m,1)||$e.is(m,8)||$e.is(d,1)||$e.is(d,8)))continue}else if(c===4&&($e.is(m,8)||$e.is(d,8))||c===5&&($e.is(m,1)||$e.is(m,8)||$e.is(d,1)||$e.is(d,8)))continue;if($e.is(m,i[c])&&$e.is(m,i[c-3])&&$e.is(f,i[c])&&$e.is(f,i[c-3]))if(e.params.oldDefinition)for(let p=0;p<c;p++)n[u+p]|=o[c];else for(let p=-1;p<=c;p++)n[u+p]|=o[c]}}}function ny(e,t){if(t.type!==e.type||t.partner1!==e.firstEnd+1)return!1;if(t.type===0){if(t.partner2===e.secondEnd+1)return!0}else if(t.partner2===e.secondStart-1)return!0;return!1}function ry(e,t){return e.type===t.type&&t.firstStart-e.firstEnd<6&&e.firstStart<t.firstStart&&t.nextLadder===0?e.type===0?p0(e,t):p0(t,e):!1}function p0(e,t){return t.secondStart-e.secondEnd>0&&(t.secondStart-e.secondEnd<6&&t.firstStart-e.firstEnd<3||t.secondStart-e.secondEnd<3)}function h0(e){let{bridges:t,ladders:n}=e;for(let r=0;r<t.length;r++){let i=t[r],o=!1;for(let s=0;s<n.length;s++){let a=n[s];ny(a,i)&&(o=!0,a.firstEnd++,i.type===0?a.secondEnd++:a.secondStart--)}o||(n[n.length]={previousLadder:0,nextLadder:0,firstStart:i.partner1,firstEnd:i.partner1,secondStart:i.partner2,secondEnd:i.partner2,type:i.type})}for(let r=0;r<n.length;r++){let i=n[r];for(let o=r;o<n.length;o++){let s=n[o];ry(i,s)&&(i.nextLadder=o,s.previousLadder=r)}}}function _0(e){let{proteinInfo:t,hbonds:n,flags:r,bridges:i}=e,{offset:o,b:s}=n,a,c;for(let u=0,l=t.residueIndices.length;u<l;++u)for(let m=o[u],f=o[u+1];m<f;m++){let d=s[m];u>d||(a=u+1,c=d,a!==c&&n.getDirectedEdgeIndex(c,a+1)!==-1&&(r[a]|=2,r[c]|=2,i[i.length]=new _i(a,c,0)),a=u,c=d-1,a!==c&&n.getDirectedEdgeIndex(c-1,a)!==-1&&(r[a]|=2,r[c]|=2,i[i.length]=new _i(c,a,0)),a=u,c=d,a!==c&&n.getDirectedEdgeIndex(c,a)!==-1&&(r[a]|=2,r[c]|=2,i[i.length]=new _i(c,a,1)),a=u+1,c=d-1,a!==c&&n.getDirectedEdgeIndex(c-1,a+1)!==-1&&(r[a]|=2,r[c]|=2,i[i.length]=new _i(c,a,1)))}i.sort((u,l)=>u.partner1>l.partner1?1:u.partner1<l.partner1?-1:0)}function g0(e){return $e.is(e,8)||$e.is(e,1)||$e.is(e,16)}function y0(e){let{ladders:t,flags:n}=e;for(let r=0;r<t.length;r++){let i=t[r];for(let s=i.firstStart;s<=i.firstEnd;s++){let a=i.firstStart-s,c=i.secondStart-a;i.firstStart!==i.firstEnd?(n[s]|=4,n[c]|=4):(!g0(n[s])&&$e.is(n[s],4)&&(n[s]|=2),!g0(n[c])&&$e.is(n[c],4)&&(n[c]|=2))}if(i.nextLadder===0)continue;let o=t[i.nextLadder];for(let s=i.firstStart;s<=o.firstEnd;s++)n[s]|=4;if(i.type===0)for(let s=i.secondStart;s<=o.secondEnd;s++)n[s]|=4;else for(let s=o.secondEnd;s<=i.secondStart;s++)n[s]|=4}}function x0(e,t){let{cIndices:n,nIndices:r,residueIndices:i}=t,o=e.conformation,{index:s}=e.model.atomicHierarchy,{traceElementIndex:a}=e.model.atomicHierarchy.derived.residue,c=i.length,u=(b,I)=>b===-1?N.setNaN(I):o.position(b,I),l=N(),m=N(),f=N(),d=N(),p=N(),h=N(),x=N(),y=N(),g=N();if(c===0)return{phi:new Float32Array(0),psi:new Float32Array(0)};let C=new Float32Array(c-1),_=new Float32Array(c-1);u(-1,l),u(-1,m),u(-1,f),u(n[0],d),u(a[i[0]],p),u(r[0],h),u(n[1],x),u(a[i[1]],y),u(r[1],g);for(let b=0;b<c-1;++b)s.findAtomOnResidue(i[b],"OXT")===-1&&(C[b]=On(N.dihedralAngle(l,h,p,d)),_[b]=On(N.dihedralAngle(h,p,d,g)),l=d,m=p,f=h,d=x,p=y,h=g,u(n[b+1],x),u(a[i[b+1]],y),u(r[b+1],g));return{phi:C,psi:_}}function A0(e,t){let{x:n,y:r,z:i}=e.model.atomicConformation,{traceElementIndex:o}=e.model.atomicHierarchy.derived.residue,s=new Uint32Array(t.length);for(let c=0,u=t.length;c<u;++c)s[c]=o[t[c]];let a={x:n,y:r,z:i,indices:le.ofSortedArray(s)};return Xn(a,jr(a))}function b0(e){let{index:t}=e.model.atomicHierarchy,{proteinElements:n,residueIndex:r}=e,i=n.length,o=new Uint32Array(i),s=new Int32Array(i),a=new Int32Array(i),c=new Int32Array(i),u=new Int32Array(i);for(let l=0;l<i;++l){let m=r[n[l]];o[l]=m,s[l]=t.findAtomOnResidue(m,"C"),a[l]=t.findAtomOnResidue(m,"H"),c[l]=t.findAtomOnResidue(m,"O"),u[l]=t.findAtomOnResidue(m,"N")}return{residueIndices:le.ofSortedArray(o),cIndices:s,hIndices:a,oIndices:c,nIndices:u}}var C0={oldDefinition:Et.Boolean(!0,{description:"Whether to use the old DSSP convention for the annotation of turns and helices, causes them to be two residues shorter"}),oldOrdering:Et.Boolean(!0,{description:"Alpha-helices are preferred over 3-10 helices"})};function S0(e,t){return Ve(this,null,function*(){let n=b0(e),{residueIndices:r}=n,i=A0(e,r),o=f0(e,n,i),s=r.length,a=new Uint32Array(s),c=x0(e,n),u=[],l=[],m=t.oldDefinition?sy:cy,f=t.oldOrdering?ay:uy,d={params:t,getResidueFlag:m,getFlagName:f,unit:e,proteinInfo:n,flags:a,hbonds:o,torsionAngles:c,ladders:u,bridges:l};d0(d),m0(d),u0(d),_0(d),h0(d),y0(d);let p=ly(a,m),h=new Uint32Array(s),x=[],y=[],g=C=>le.indexOf(r,C);for(let C=0,_=r.length;C<_;++C){let b=p[C];h[C]=b;let I=m(a[C]);(y.length===0||I!==y[y.length-1].flags)&&(y[y.length]=iy(oy(b),a[C],m)),x[C]=y.length-1}return ea(h,x,y,g)})}function iy(e,t,n){return e==="helix"?{kind:"helix",flags:n(t)}:e==="sheet"?{kind:"sheet",flags:n(t)}:e==="turn"||e==="bend"?{kind:"turn",flags:n(t)}:{kind:"none"}}function oy(e){return e===kt.SecondaryStructureDssp.H||e===kt.SecondaryStructureDssp.G||e===kt.SecondaryStructureDssp.I?"helix":e===kt.SecondaryStructureDssp.B||e===kt.SecondaryStructureDssp.E?"sheet":e===kt.SecondaryStructureDssp.T?"turn":e===kt.SecondaryStructureDssp.S?"bend":"none"}function sy(e){return $e.is(e,1)?kt.SecondaryStructureDssp.H:$e.is(e,4)?kt.SecondaryStructureDssp.E:$e.is(e,2)?kt.SecondaryStructureDssp.B:$e.is(e,8)?kt.SecondaryStructureDssp.G:$e.is(e,16)?kt.SecondaryStructureDssp.I:$e.is(e,64)?kt.SecondaryStructureDssp.T:$e.is(e,32)?kt.SecondaryStructureDssp.S:0}function ay(e){return $e.is(e,1)?"H":$e.is(e,4)?"E":$e.is(e,2)?"B":$e.is(e,8)?"G":$e.is(e,16)?"I":$e.is(e,64)?"T":$e.is(e,32)?"S":"-"}function cy(e){return $e.is(e,16)?kt.SecondaryStructureDssp.I:$e.is(e,1)?kt.SecondaryStructureDssp.H:$e.is(e,4)?kt.SecondaryStructureDssp.E:$e.is(e,2)?kt.SecondaryStructureDssp.B:$e.is(e,8)?kt.SecondaryStructureDssp.G:$e.is(e,64)?kt.SecondaryStructureDssp.T:$e.is(e,32)?kt.SecondaryStructureDssp.S:0}function uy(e){return $e.is(e,16)?"I":$e.is(e,1)?"H":$e.is(e,4)?"E":$e.is(e,2)?"B":$e.is(e,8)?"G":$e.is(e,64)?"T":$e.is(e,32)?"S":"-"}function ly(e,t){let n=new Uint32Array(e.length);for(let r=0,i=e.length;r<i;++r){let o=$e.create(e[r]);n[r]=t(o)}return n}var gi;(function(e){function t(r){let i=r.descriptor.name,o=r.type==="root"?"inheritedPropertyData":"currentPropertyData",s=c=>(i in c[o]||(c[o][i]={props:Le({},Et.getDefaultValues(r.getParams(c))),data:Zn.create(void 0)}),c[o][i]),a=(c,u,l)=>{let m=s(c);c[o][i]={props:u,data:Zn.withValue(m.data,l)}};return{label:r.label,descriptor:r.descriptor,isHidden:r.isHidden,getParams:c=>{let u=Et.clone(r.getParams(c));return Et.setDefaultValues(u,s(c).props),u},defaultParams:r.defaultParams,isApplicable:r.isApplicable,attach:(f,d,...p)=>Ve(this,[f,d,...p],function*(c,u,l={},m){m&&u.customPropertyDescriptors.reference(r.descriptor,!0),r.type==="root"&&(u=u.root);let h=s(u.root).props,x=s(u),y=Et.merge(r.defaultParams,h,l);if(x.data.value&&Et.areEqual(r.defaultParams,x.props,y))return;let{value:g,assets:C}=yield r.obtain(c,u,y);u.customPropertyDescriptors.add(r.descriptor),u.customPropertyDescriptors.assets(r.descriptor,C),a(u,y,g)}),ref:(c,u)=>c.customPropertyDescriptors.reference(r.descriptor,u),get:c=>s(c).data,set:(c,u={},l)=>{r.type==="root"&&(c=c.root);let m=s(c),f=Et.merge(r.defaultParams,m.props,u);Et.areEqual(r.defaultParams,m.props,f)||(a(c,f,l),c.customPropertyDescriptors.assets(r.descriptor))},props:c=>s(c).props}}e.createProvider=t;function n(r,i,o){let s={value:Et.Value(o,{isHidden:!0})};return t({label:Lr(r),descriptor:xn({name:r}),isHidden:!0,type:i,defaultParams:s,getParams:()=>({value:Et.Value(o,{isHidden:!0})}),isApplicable:()=>!0,obtain:(a,c,u)=>Ve(this,null,function*(){return Le(Le({},Et.getDefaultValues(s)),u)})})}e.createSimple=n})(gi||(gi={}));var zn;(function(e){e.Descriptor={name:"model_secondary_structure"},e.Provider=en.create(e.Descriptor);function t(n,r,i){let o=new Map,s=[{kind:"none"}],a=fy(n,r);dy(n,a,o,s),my(r,a,o,n._rowCount,s);let c=i.residues._rowCount,u=m=>m,l={type:new Int32Array(c),key:new Int32Array(c),elements:s};return o.size>0&&hy(i,a,o,l),ea(l.type,l.key,l.elements,u)}e.fromStruct=t})(zn||(zn={}));function fy(e,t){if(e._rowCount>0){if(e.beg_label_seq_id.valueKind(0)!==0||e.end_label_seq_id.valueKind(0)!==0)return"auth"}else if(t&&(t.beg_label_seq_id.valueKind(0)!==0||t.end_label_seq_id.valueKind(0)!==0))return"auth";return"label"}function dy(e,t,n,r){if(!e._rowCount)return;let{beg_label_asym_id:i,beg_label_seq_id:o,beg_auth_seq_id:s,pdbx_beg_PDB_ins_code:a}=e,{end_label_seq_id:c,end_auth_seq_id:u,pdbx_end_PDB_ins_code:l}=e,{pdbx_PDB_helix_class:m,conf_type_id:f,details:d}=e,p=t==="label"?o:s,h=t==="label"?c:u;for(let x=0,y=e._rowCount;x<y;x++){let g=kt.create(m.valueKind(x)===0?kt.SecondaryStructurePdb[m.value(x)]:f.valueKind(x)===0?kt.SecondaryStructureMmcif[f.value(x)]:536870912),C={kind:"helix",flags:g,type_id:f.valueKind(x)===0?f.value(x):"helx_p",helix_class:m.value(x),details:d.valueKind(x)===0?d.value(x):void 0},_={startSeqId:p.value(x),startInsCode:a.value(x),endSeqId:h.value(x),endInsCode:l.value(x),type:g,key:r.length};r[r.length]=C;let b=i.value(x);if(n.has(b)){let I=n.get(b);I.has(_.startSeqId)?I.get(_.startSeqId).push(_):I.set(_.startSeqId,[_])}else n.set(b,new Map([[_.startSeqId,[_]]]))}}function my(e,t,n,r,i){if(!e._rowCount)return;let{beg_label_asym_id:o,beg_label_seq_id:s,beg_auth_seq_id:a,pdbx_beg_PDB_ins_code:c}=e,{end_label_seq_id:u,end_auth_seq_id:l,pdbx_end_PDB_ins_code:m}=e,{sheet_id:f}=e,d=t==="label"?s:a,p=t==="label"?u:l,h=new Map,x=r+1;for(let y=0,g=e._rowCount;y<g;y++){let C=f.value(y),_;h.has(C)?_=h.get(C):(_=x++,h.set(C,_));let b=kt.create(8388612),I={kind:"sheet",flags:b,sheet_id:C,symmetry:void 0},E={startSeqId:d.value(y),startInsCode:c.value(y),endSeqId:p.value(y),endInsCode:m.value(y),type:b,key:i.length};i[i.length]=I;let S=o.value(y);if(n.has(S)){let v=n.get(S);v.has(E.startSeqId)?v.get(E.startSeqId).push(E):v.set(E.startSeqId,[E])}else n.set(S,new Map([[E.startSeqId,[E]]]))}}function py(e,t,n,r,i,o){let{auth_seq_id:s,label_seq_id:a,pdbx_PDB_ins_code:c}=e.residues,{endSeqId:u,endInsCode:l,key:m,type:f}=n,d=t==="label"?a:s,p=r;for(;p<i;){let h=d.value(p);if(o.type[p]=f,o.key[p]=m,h>u||h===u&&c.value(p)===l)break;p++}}function hy(e,t,n,r){let{count:i}=e.chainAtomSegments,{label_asym_id:o}=e.chains,{auth_seq_id:s,label_seq_id:a,pdbx_PDB_ins_code:c}=e.residues,u=t==="label"?a:s;for(let l=0;l<i;l++){let m=$n.chainStartResidueIndex(e,l),f=$n.chainEndResidueIndexExcl(e,l),d=o.value(l);if(n.has(d)){let p=n.get(d);for(let h=m;h<f;h++){let x=u.value(h);if(p.has(x)){let y=p.get(x);for(let g of y){let C=c.value(h);g.startInsCode===C&&py(e,t,g,h,f,r)}}}}}}function w0(e){let t="model";if(e){t="dssp";for(let n=0,r=e.models.length;n<r;++n){let i=e.models[n];if(Tt.isFromPdbArchive(i)||Tt.hasSecondaryStructure(i)){t="model";break}}}return{type:Et.MappedStatic(t,{model:Et.EmptyGroup({label:"Model"}),dssp:Et.Group(C0,{label:"DSSP",isFlat:!0})},{options:[["model","Model"],["dssp","DSSP"]]})}}var I0=w0(),ou=gi.createProvider({label:"Secondary Structure",descriptor:xn({name:"molstar_computed_secondary_structure"}),type:"root",defaultParams:I0,getParams:w0,isApplicable:e=>!0,obtain:(e,t,n)=>Ve(void 0,null,function*(){let r=Le(Le({},Et.getDefaultValues(I0)),n);switch(r.type.name){case"dssp":return{value:yield _y(t,r.type.params)};case"model":return{value:yield gy(t)}}})});function _y(e,t){return Ve(this,null,function*(){let n=new Map;for(let r=0,i=e.unitSymmetryGroups.length;r<i;++r){let o=e.unitSymmetryGroups[r].units[0];if(ge.isAtomic(o)&&!Tt.isCoarseGrained(o.model)){let s=yield S0(o,t);n.set(o.invariantId,s)}}return n})}function gy(e){return Ve(this,null,function*(){let t=new Map;for(let n=0,r=e.unitSymmetryGroups.length;n<r;++n){let i=e.unitSymmetryGroups[n].units[0];if(ge.isAtomic(i)){let o=zn.Provider.get(i.model);o&&t.set(i.invariantId,o)}}return t})}var yy={true:e=>!0,false:e=>!1,zero:e=>0};function Ft(){throw new Error("Property only available for atomic models.")}function wr(e){throw e?new Error(`Property only available for coarse models (${e}).`):new Error("Property only available for coarse models.")}var Do={key:e=>e.element,x:e=>e.unit.conformation.x(e.element),y:e=>e.unit.conformation.y(e.element),z:e=>e.unit.conformation.z(e.element),id:e=>ge.isAtomic(e.unit)?e.unit.model.atomicConformation.atomId.value(e.element):Ft(),occupancy:e=>ge.isAtomic(e.unit)?e.unit.model.atomicConformation.occupancy.value(e.element):Ft(),B_iso_or_equiv:e=>ge.isAtomic(e.unit)?e.unit.model.atomicConformation.B_iso_or_equiv.value(e.element):Ft(),sourceIndex:e=>ge.isAtomic(e.unit)?e.unit.model.atomicHierarchy.atomSourceIndex.value(e.element):e.element,type_symbol:e=>ge.isAtomic(e.unit)?e.unit.model.atomicHierarchy.atoms.type_symbol.value(e.element):Ft(),label_atom_id:e=>ge.isAtomic(e.unit)?e.unit.model.atomicHierarchy.atoms.label_atom_id.value(e.element):Ft(),auth_atom_id:e=>ge.isAtomic(e.unit)?e.unit.model.atomicHierarchy.atoms.auth_atom_id.value(e.element):Ft(),label_alt_id:e=>ge.isAtomic(e.unit)?e.unit.model.atomicHierarchy.atoms.label_alt_id.value(e.element):Ft(),label_comp_id:ia,auth_comp_id:e=>ge.isAtomic(e.unit)?e.unit.model.atomicHierarchy.atoms.auth_comp_id.value(e.element):Ft(),pdbx_formal_charge:e=>ge.isAtomic(e.unit)?e.unit.model.atomicHierarchy.atoms.pdbx_formal_charge.value(e.element):Ft(),vdw_radius:e=>ge.isAtomic(e.unit)?hd(e.unit.model.atomicHierarchy.atoms.type_symbol.value(e.element)):Ft()};function ia(e){return ge.isAtomic(e.unit)||Ft(),e.unit.model.atomicHierarchy.atoms.label_comp_id.value(e.element)}function su(e){return ge.isAtomic(e.unit)?e.unit.model.atomicHierarchy.residues.label_seq_id.value(e.unit.residueIndex[e.element]):Ft()}function xy(e){ge.isAtomic(e.unit)||Ft();let t=e.unit.model.sequence.byEntityKey[ln(e)];return t&&t.sequence.microHet.has(su(e))}function v0(e){ge.isAtomic(e.unit)||Ft();let t=e.unit.model.sequence.byEntityKey[ln(e)];return t?t.sequence.microHet.get(su(e))||[ia(e)]:[ia(e)]}var Ay={key:e=>ge.isAtomic(e.unit)?e.unit.residueIndex[e.element]:Ft(),group_PDB:e=>ge.isAtomic(e.unit)?e.unit.model.atomicHierarchy.residues.group_PDB.value(e.unit.residueIndex[e.element]):Ft(),label_seq_id:su,auth_seq_id:e=>ge.isAtomic(e.unit)?e.unit.model.atomicHierarchy.residues.auth_seq_id.value(e.unit.residueIndex[e.element]):Ft(),pdbx_PDB_ins_code:e=>ge.isAtomic(e.unit)?e.unit.model.atomicHierarchy.residues.pdbx_PDB_ins_code.value(e.unit.residueIndex[e.element]):Ft(),isNonStandard:e=>ge.isAtomic(e.unit)?v0(e).some(t=>e.unit.model.properties.chemicalComponentMap.get(t).mon_nstd_flag[0]==="n"):Ft(),hasMicroheterogeneity:xy,microheterogeneityCompIds:v0,secondary_structure_type:e=>{var t;ge.isAtomic(e.unit)||Ft();let n=(t=ou.get(e.structure).value)===null||t===void 0?void 0:t.get(e.unit.invariantId);return n?n.type[n.getIndex(e.unit.residueIndex[e.element])]:536870912},secondary_structure_key:e=>{var t;ge.isAtomic(e.unit)||Ft();let n=(t=ou.get(e.structure).value)===null||t===void 0?void 0:t.get(e.unit.invariantId);return n?n.key[n.getIndex(e.unit.residueIndex[e.element])]:-1},chem_comp_type:e=>ge.isAtomic(e.unit)?e.unit.model.properties.chemicalComponentMap.get(ia(e)).type:Ft()},by={key:e=>ge.isAtomic(e.unit)?e.unit.chainIndex[e.element]:Ft(),label_asym_id:e=>ge.isAtomic(e.unit)?e.unit.model.atomicHierarchy.chains.label_asym_id.value(e.unit.chainIndex[e.element]):Ft(),auth_asym_id:e=>ge.isAtomic(e.unit)?e.unit.model.atomicHierarchy.chains.auth_asym_id.value(e.unit.chainIndex[e.element]):Ft(),label_entity_id:e=>ge.isAtomic(e.unit)?e.unit.model.atomicHierarchy.chains.label_entity_id.value(e.unit.chainIndex[e.element]):Ft()},Cy={key:Do.key,entityKey:e=>ge.isCoarse(e.unit)?e.unit.coarseElements.entityKey[e.element]:wr(),x:Do.x,y:Do.y,z:Do.z,asym_id:e=>ge.isCoarse(e.unit)?e.unit.coarseElements.asym_id.value(e.element):wr(),entity_id:e=>ge.isCoarse(e.unit)?e.unit.coarseElements.entity_id.value(e.element):wr(),seq_id_begin:e=>ge.isCoarse(e.unit)?e.unit.coarseElements.seq_id_begin.value(e.element):wr(),seq_id_end:e=>ge.isCoarse(e.unit)?e.unit.coarseElements.seq_id_end.value(e.element):wr(),sphere_radius:e=>ge.isSpheres(e.unit)?e.unit.coarseConformation.radius[e.element]:wr("spheres"),sphere_rmsf:e=>ge.isSpheres(e.unit)?e.unit.coarseConformation.rmsf[e.element]:wr("spheres"),gaussian_weight:e=>ge.isGaussians(e.unit)?e.unit.coarseConformation.weight[e.element]:wr("gaussians"),gaussian_covariance_matrix:e=>ge.isGaussians(e.unit)?e.unit.coarseConformation.covariance_matrix[e.element]:wr("gaussians")};function ln(e){switch(e.unit.kind){case 0:return e.unit.model.atomicHierarchy.index.getEntityFromChain(e.unit.chainIndex[e.element]);case 1:return e.unit.model.coarseHierarchy.spheres.entityKey[e.element];case 2:return e.unit.model.coarseHierarchy.gaussians.entityKey[e.element]}}var Sy={key:ln,id:e=>e.unit.model.entities.data.id.value(ln(e)),type:e=>e.unit.model.entities.data.type.value(ln(e)),src_method:e=>e.unit.model.entities.data.src_method.value(ln(e)),pdbx_description:e=>e.unit.model.entities.data.pdbx_description.value(ln(e)),formula_weight:e=>e.unit.model.entities.data.formula_weight.value(ln(e)),pdbx_number_of_molecules:e=>e.unit.model.entities.data.pdbx_number_of_molecules.value(ln(e)),details:e=>e.unit.model.entities.data.details.value(ln(e)),pdbx_mutation:e=>e.unit.model.entities.data.pdbx_mutation.value(ln(e)),pdbx_fragment:e=>e.unit.model.entities.data.pdbx_fragment.value(ln(e)),pdbx_ec:e=>e.unit.model.entities.data.pdbx_ec.value(ln(e)),subtype:e=>e.unit.model.entities.subtype.value(ln(e)),prd_id:e=>{var t,n;return(n=(t=e.unit.model.entities.prd_id)===null||t===void 0?void 0:t.value(ln(e)))!==null&&n!==void 0?n:""}},Iy=[],wy={id:e=>e.unit.id,chainGroupId:e=>e.unit.chainGroupId,multiChain:e=>ge.Traits.is(e.unit.traits,ge.Trait.MultiChain),object_primitive:e=>e.unit.objectPrimitive,operator_name:e=>e.unit.conformation.operator.name,operator_key:e=>e.unit.conformation.operator.key,model_index:e=>e.unit.model.modelNum,model_label:e=>e.unit.model.label,model_entry_id:e=>e.unit.model.entryId,hkl:e=>e.unit.conformation.operator.hkl,spgrOp:e=>e.unit.conformation.operator.spgrOp,model_num:e=>e.unit.model.modelNum,pdbx_struct_assembly_id:e=>{var t;return((t=e.unit.conformation.operator.assembly)===null||t===void 0?void 0:t.id)||xt.DefaultName},pdbx_struct_oper_list_ids:e=>{var t;return((t=e.unit.conformation.operator.assembly)===null||t===void 0?void 0:t.operList)||Iy},struct_ncs_oper_id:e=>e.unit.conformation.operator.ncsId},Ye={constant:yy,atom:Do,residue:Ay,chain:by,entity:Sy,unit:wy,coarse:Cy};var ur;(function(e){function t(l,m){return wt.create("Build Assembly",f=>Ve(this,null,function*(){let d=l.models;if(d.length!==1)throw new Error("Can only build assemblies from structures based on 1 model.");let p=Io.findAssembly(d[0],m);if(!p)throw new Error(`Assembly '${m}' is not defined.`);let h=xt.create(p.id,ke.identity(),{assembly:{id:p.id,operId:0,operList:[]}}),x=ot.Builder({coordinateSystem:h,label:l.label,dynamicBonds:l.dynamicBonds}),y=new fi(l);for(let g of p.operatorGroups){let C=g.selector(y);if(Be.structureCount(C)===0)continue;let{units:_}=Be.unionStructure(C);for(let b of g.operators)for(let I of _)x.addWithOperator(I,b)}return x.getStructure()}))}e.buildAssembly=t;function n(l,m,f){return wt.create("Build Symmetry Assembly",d=>Ve(this,null,function*(){let p=l.models;if(p.length!==1)throw new Error("Can only build symmetry assemblies from structures based on 1 model.");let h=N(),x=ot.Builder({label:l.label,representativeModel:p[0],dynamicBonds:l.dynamicBonds}),y=new fi(l);for(let g of m){let _=vy(g.asymIds)(y);if(Be.structureCount(_)===0)continue;let{units:b}=Be.unionStructure(_);for(let{index:I,shift:[E,S,v]}of g.operators){let P=P0(f,I,E,S,v,h);for(let L of b)for(let w of P)x.addWithOperator(L,w)}}return x.getStructure()}))}e.buildSymmetryAssembly=n;function r(l,m){return wt.create("Find Symmetry Mates",f=>Dy(f,l,m))}e.builderSymmetryMates=r;function i(l,m,f){return wt.create("Build Symmetry",d=>Ey(d,l,m,f))}e.buildSymmetryRange=i;function o(l){return wt.create("Build NCS",m=>By(m,l))}e.buildNcs=o;function s(l,m){return l.invariantId===m.invariantId&&l.model.id===m.model.id&&le.areEqual(l.elements,m.elements)}e.areUnitsEquivalent=s;function a(){return Yu(ge.hashUnit,s)}e.UnitEquivalenceBuilder=a;function c(l){let m=a();for(let d of l.units)m.add(d.id,d);let f=[];for(let d of m.groups)f.push(ge.SymmetryGroup(d.map(p=>l.unitMap.get(p))));return f}e.computeTransformGroups=c;function u(l,m){if(l.length!==m.length)return!1;for(let f=0,d=l.length;f<d;++f){let p=l[f].units,h=m[f].units;if(p.length!==h.length||l[f].hashCode!==m[f].hashCode)return!1;for(let x=0,y=p.length;x<y;x++)if(p[x].conformation!==h[x].conformation)return!1}return!0}e.areTransformGroupsEquivalent=u})(ur||(ur={}));function vy(e){return cr.generators.atoms({chainTest:cr.pred.and(cr.pred.eq(t=>Ye.unit.operator_name(t.element),xt.DefaultName),cr.pred.inSet(t=>Ye.chain.label_asym_id(t.element),e))})}function P0(e,t,n,r,i,o){let{spacegroup:s,ncsOperators:a}=e,c=[],{toFractional:u}=s.cell,l=N.transformMat4(N(),o,u),m=sn.getSymmetryOperatorRef(s,t,n,r,i,l);if(a&&a.length)for(let f=0,d=a.length;f<d;++f){let p=a[f],h=ke.mul(ke(),m.matrix,p.matrix),x=xt.create(`${m.name} ${p.name}`,h,{assembly:m.assembly,ncsId:p.ncsId,hkl:m.hkl,spgrOp:m.spgrOp});c.push(x)}else c.push(m);return c}function B0(e,t,n,r){let{spacegroup:i,ncsOperators:o}=e,s=o&&o.length||0,a=[];!s&&t[0]<=0&&n[0]>=0&&t[1]<=0&&n[1]>=0&&t[2]<=0&&n[2]>=0&&(a[0]=sn.getSymmetryOperator(i,0,0,0,0));for(let c=0;c<i.operators.length;c++)for(let u=t[0];u<=n[0];u++)for(let l=t[1];l<=n[1];l++)for(let m=t[2];m<=n[2];m++)!s&&c===0&&u===0&&l===0&&m===0||a.push(...P0(e,c,u,l,m,r));return a}function Py(e,t){return e._operators_333&&N.equals(t,e._operators_333.ref)||(e._operators_333={ref:N.clone(t),operators:B0(e,N.create(-3,-3,-3),N.create(3,3,3),t)}),e._operators_333.operators}function E0(e,t){let n=ot.Builder({label:e.label,dynamicBonds:e.dynamicBonds}),{units:r}=e;for(let i of t)for(let o of r)n.addWithOperator(o,i);return n.getStructure()}function By(e,t){return Ve(this,null,function*(){let n=t.models;if(n.length!==1)throw new Error("Can only build NCS from structures based on 1 model.");let r=Wt.Provider.get(n[0]);if(!r)return t;let i=r.ncsOperators;return!i||!i.length?t:E0(t,i)})}function Ey(e,t,n,r){return Ve(this,null,function*(){let i=t.models;if(i.length!==1)throw new Error("Can only build symmetries from structures based on 1 model.");let o=Wt.Provider.get(i[0]);if(!o)return t;let{spacegroup:s}=o;if(hr.isZero(s.cell))return t;let a=Tt.getCenter(i[0]),c=B0(o,n,r,a);return E0(t,c)})}function Dy(e,t,n){return Ve(this,null,function*(){let r=t.models;if(r.length!==1)throw new Error("Can only build symmetries from structures based on 1 model.");let i=Wt.Provider.get(r[0]);if(!i)return t;let{spacegroup:o}=i;if(hr.isZero(o.cell))return t;e.shouldUpdate&&(yield e.update("Initialing..."));let s=Tt.getCenter(r[0]),a=Py(i,s),c=t.lookup3d,u=new Set;function l(p,h){return`${p.invariantId}|${h.name}`}let m=ot.Builder({label:t.label,dynamicBonds:t.dynamicBonds}),{units:f}=t,d=N.zero();for(let p of a){for(let h of f){let x=h.lookup3d.boundary.sphere;N.transformMat4(d,x.center,p.matrix);let y=c.findUnitIndices(d[0],d[1],d[2],x.radius+n);for(let g=0,C=y.count;g<C;g++){if(!f[y.indices[g]].lookup3d.check(d[0],d[1],d[2],x.radius+n))continue;let b=l(h,p);u.has(b)||(m.addWithOperator(h,p),u.add(b))}}e.shouldUpdate&&(yield e.update("Building symmetry..."))}return m.getStructure()})}var yi=class{addToUnit(t,n){let r=this.unitMap.get(t);if(r)It.add(r,n,n)&&this.elementCount++;else{let i=It.create();It.add(i,n,n),this.unitMap.set(t,i),this.ids[this.ids.length]=t,this.elementCount++}}has(t,n){let r=this.unitMap.get(t);return r?It.has(r,n):!1}beginUnit(t){this.parentId=t,this.unitMap.has(t)?this.currentUnit=this.unitMap.get(t):this.currentUnit=this.currentUnit.array.length>0?It.create():this.currentUnit}addElement(t){It.add(this.currentUnit,t,t)&&this.elementCount++}commitUnit(){this.currentUnit.array.length===0||this.unitMap.has(this.parentId)||(this.ids[this.ids.length]=this.parentId,this.unitMap.set(this.parentId,this.currentUnit),this.parentId=-1)}getStructure(){if(this.isEmpty)return ot.Empty;let t=[];jt(this.ids);let n=ur.UnitEquivalenceBuilder();for(let r=0,i=this.ids.length;r<i;r++){let o=this.ids[r],s=this.parent.unitMap.get(o),a=this.unitMap.get(o).array,c=a.length;if(a.length===s.elements.length){t[t.length]=s,n.add(s.id,s);continue}c>1&&jt(a);let u=s.getChild(le.ofSortedArray(a)),l=n.add(u.id,u);u!==l&&(u=l.applyOperator(u.id,u.conformation.operator,!0)),t[t.length]=u}return ot.create(t,{parent:this.parent})}get isEmpty(){return this.elementCount===0}constructor(t){this.parent=t,this.ids=[],this.unitMap=yn.Mutable(),this.parentId=-1,this.currentUnit=It.create(),this.elementCount=0}};var Xr=class{add(t){let n=this.index.get(t.label_asym_id);n||(n=new Map,this.index.set(t.label_asym_id,n));let r=n.get(t.label_seq_id);return r||(r=[],n.set(t.label_seq_id,r)),this._find(t,r)?!1:(r.push(t),!0)}hasLabelAsymId(t){return this.index.has(t)}has(t){var n,r;let i=D0(t);if(!this.index.has(i))return;let o=this.index.get(i),s=M0(t);if(!o.has(s))return;let a=o.get(s),c=N0(t),u=k0(t),l=U0(t),m=(n=R0(t))!==null&&n!==void 0?n:"1_555";for(let f of a)if(!(f.label_comp_id!==c||f.label_alt_id!==u||f.ins_code!==l)&&!(this.checkOperator&&((r=f.operator_name)!==null&&r!==void 0?r:"1_555")!==m))return f}static getLabel(t,n=!1){var r;return`${t.label_asym_id} ${t.label_comp_id} ${t.label_seq_id}:${t.ins_code}:${t.label_alt_id}${n?" "+((r=t.operator_name)!==null&&r!==void 0?r:"1_555"):""}`}static getEntryFromLocation(t){var n;return{label_asym_id:D0(t),label_comp_id:N0(t),label_seq_id:M0(t),label_alt_id:k0(t),ins_code:U0(t),operator_name:(n=R0(t))!==null&&n!==void 0?n:"1_555"}}_find(t,n){var r,i;for(let o of n)if(!(o.label_comp_id!==t.label_comp_id||o.label_alt_id!==t.label_alt_id||o.ins_code!==t.ins_code)&&!(this.checkOperator&&((r=o.operator_name)!==null&&r!==void 0?r:"1_555")!==((i=t.operator_name)!==null&&i!==void 0?i:"1_555")))return!0;return!1}constructor(t){var n;this.index=new Map,this.checkOperator=!1,this.checkOperator=(n=t?.checkOperator)!==null&&n!==void 0?n:!1}},D0=Ye.chain.label_asym_id,M0=Ye.residue.label_seq_id,N0=Ye.atom.label_comp_id,k0=Ye.atom.label_alt_id,U0=Ye.residue.pdbx_PDB_ins_code,R0=Ye.unit.operator_name;function $i(e,t,n){let r=t.subsetBuilder(!0);for(let i of n.units){if(i.kind!==0){r.setUnit(i.id,i.elements);continue}let{residueAtomSegments:o}=i.model.atomicHierarchy,s=t.unitMap.get(i.id).elements,a=i.elements;r.beginUnit(i.id);let c=We.transientSegments(o,a);for(;c.hasNext;){let u=c.move().index;for(let l=o.offsets[u],m=o.offsets[u+1];l<m;l++)le.has(s,l)&&r.addElement(l)}r.commitUnit(),e.throwIfTimedOut()}return r.getStructure()}function My(e){return function(n){let r=e(n);if(Be.isSingleton(r))return Be.Singletons(n.inputStructure,$i(n,n.inputStructure,r.structure));{let i=new Vi(n.inputStructure);for(let o of r.structures)i.add($i(n,n.inputStructure,o));return i.getSelection()}}}function au(e,t,n,r){let i=new yi(t),o=t.lookup3d,s=r.radius;for(let a of n.units){let c=a.conformation,u=a.elements;for(let l=0,m=u.length;l<m;l++){let f=u[l];o.findIntoBuilder(c.x(f),c.y(f),c.z(f),s,i)}e.throwIfTimedOut()}return r.wholeResidues?$i(e,t,i.getStructure()):i.getStructure()}function T0(e,t,n,r){let i=new yi(t),o=t.lookup3d,{elementRadius:s,elementRadiusClosure:a,sourceMaxRadius:c,radius:u}=r;e.pushCurrentElement(),e.element.structure=n;for(let l of n.units){e.element.unit=l;let m=l.conformation,f=l.elements;for(let d=0,p=f.length;d<p;d++){let h=f[d];e.element.element=h;let x=s(e);o.findIntoBuilderWithRadius(m.x(h),m.y(h),m.z(h),x,c,u,a,i)}e.throwIfTimedOut()}return e.popCurrentElement(),r.wholeResidues?$i(e,t,i.getStructure()):i.getStructure()}function Ny(e,t){return n=>(e.element.structure=n.structure,e.element.unit=n.unit,e.element.element=n.element,t(e))}function ky(e,t){let n=0;e.element.structure=e.inputStructure;for(let r of e.inputStructure.units){e.element.unit=r;let i=r.elements;for(let o=0,s=i.length;o<s;o++){let a=i[o];e.element.element=a;let c=t(e);c>n&&(n=c)}}return e.throwIfTimedOut(),n}function Uy(e,t){return function(r){let i=e(r);if(t.elementRadius){let o=Ct(Le({},t),{elementRadius:t.elementRadius,elementRadiusClosure:Ny(r,t.elementRadius),sourceMaxRadius:ky(r,t.elementRadius)});if(Be.isSingleton(i)){let s=T0(r,r.inputStructure,i.structure,o);return Be.Singletons(r.inputStructure,s)}else{let s=new Vi(r.inputStructure);for(let a of i.structures)s.add(T0(r,r.inputStructure,a,o));return s.getSelection()}}if(Be.isSingleton(i)){let o=au(r,r.inputStructure,i.structure,t);return Be.Singletons(r.inputStructure,o)}else{let o=new Vi(r.inputStructure);for(let s of i.structures)o.add(au(r,r.inputStructure,s,t));return o.getSelection()}}}function Ry(e,t){return function(r){let i=e(r);if(Be.structureCount(i)===0)return i;let o=Be.UniqueBuilder(r.inputStructure),s=a=>o.add(a);return Be.forEach(i,(a,c)=>{r.pushInputStructure(a),Be.forEach(t(r),s),r.popInputStructure(),c%10===0&&r.throwIfTimedOut()}),o.getSelection()}}function Ty(e,t){return function(r){let i=e(r);if(Be.structureCount(i)===0)return i;let o=t(r);if(Be.structureCount(o)===0)return Be.Empty(r.inputStructure);let s=Be.unionStructure(o),a=Be.UniqueBuilder(r.inputStructure);return Be.forEach(i,(c,u)=>{let l=im(s,c);l.elementCount!==0&&a.add(l),u%50===0&&r.throwIfTimedOut()}),a.getSelection()}}function Fy(e,t){return function(r){let i=e(r);if(Be.structureCount(i)===0)return i;let o=t(r);if(Be.structureCount(o)===0)return i;let s=Be.unionStructure(o),a=Be.UniqueBuilder(r.inputStructure);return Be.forEach(i,(c,u)=>{let l=Vs(c,s);l.elementCount!==0&&a.add(l),u%50===0&&r.throwIfTimedOut()}),a.getSelection()}}function Oy(e){return function(n){let r=Be.LinearBuilder(n.inputStructure);return r.add(Be.unionStructure(e(n))),r.getSelection()}}function Ly(e,t){return function(r){let i=e(r),o=new Map,s=[];r.pushCurrentElement(),Be.forEach(i,(c,u)=>{r.element.structure=c;for(let l of c.units){r.element.unit=l;let m=l.elements;for(let f=0,d=m.length;f<d;f++){r.element.element=m[f];let p=t(r),h;o.has(p)?h=o.get(p):(h=It.create(),o.set(p,h)),It.add(h,u,u)}}s[u]=r.inputStructure.subsetBuilder(!0),u%10===0&&r.throwIfTimedOut()}),r.element.structure=r.inputStructure;for(let c of r.inputStructure.units){r.element.unit=c;let u=c.elements;for(let l=0,m=u.length;l<m;l++){r.element.element=u[l];let f=t(r);if(!o.has(f))continue;let d=o.get(f).array;for(let p=0,h=d.length;p<h;p++)s[d[p]].addToUnit(c.id,u[l])}}r.popCurrentElement();let a=Be.UniqueBuilder(r.inputStructure);for(let c of s)a.add(c.getStructure());return a.getSelection()}}function qy({query:e,layerCount:t,wholeResidues:n,bondTest:r,fixedPoint:i}){let o=Math.max(t,0);return function(a){let c=Be.UniqueBuilder(a.inputStructure),u=e(a);return a.pushCurrentBond(),a.atomicBond.setTestFn(r),Be.forEach(u,(l,m)=>{let f=l;if(i)for(;;){let d=f.elementCount;if(f=F0(a,n,f),f.elementCount===d)break}else for(let d=0;d<o;d++)f=F0(a,n,f);c.add(f),m%10===0&&a.throwIfTimedOut()}),a.popCurrentBond(),c.getSelection()}}function F0(e,t,n){let r=Gy(e,n);return t?$i(e,e.inputStructure,r):r}function Gy(e,t){let n=e.inputStructure,r=n.interUnitBonds,i=new yi(n),o=e.atomicBond;for(let s of t.units){if(s.kind!==0){i.beginUnit(s.id);for(let d=0,p=s.elements.length;d<p;d++)i.addElement(s.elements[d]);i.commitUnit();continue}let a=n.unitMap.get(s.id),{offset:c,b:u,edgeProps:{flags:l,order:m,key:f}}=a.bonds;o.setStructure(n),o.a.unit=a,o.b.unit=a;for(let d=0,p=s.elements.length;d<p;d++){i.addToUnit(s.id,s.elements[d]);let h=le.indexOf(a.elements,s.elements[d]);for(let x=c[h],y=c[h+1];x<y;x++){let g=u[x],C=a.elements[g];le.has(s.elements,C)||i.has(s.id,C)||(o.aIndex=h,o.a.element=s.elements[d],o.bIndex=g,o.b.element=C,o.type=l[x],o.order=m[x],o.key=f[x],o.test(e,!0)&&i.addToUnit(s.id,C))}}for(let d of r.getConnectedUnits(a.id)){let p=t.unitMap.get(d.unitB),h=n.unitMap.get(d.unitB);for(let x of d.connectedIndices)if(le.has(s.elements,a.elements[x]))for(let y of d.getEdges(x)){let g=h.elements[y.indexB];p&&le.has(p.elements,g)||i.has(d.unitB,g)||(o.a.unit=a,o.aIndex=x,o.a.element=a.elements[x],o.b.unit=h,o.bIndex=y.indexB,o.b.element=g,o.type=y.props.flag,o.order=y.props.order,o.key=y.props.key,o.test(e,!0)&&i.addToUnit(d.unitB,g))}}}return i.getStructure()}function Hy({query:e,radius:t,includeWater:n}){return function(i){let o=Be.unionStructure(e(i)),s=$i(i,i.inputStructure,au(i,i.inputStructure,o,{radius:t})),a=Ky(i.inputStructure),c=jy(i.inputStructure),u=ht.Location.create(s),l=new Map,m=new Xr({checkOperator:!0});for(let p of s.units){if(p.kind!==0)continue;u.unit=p;let{elements:h}=p,x=We.transientSegments(p.model.atomicHierarchy.chainAtomSegments,h),y=We.transientSegments(p.model.atomicHierarchy.residueAtomSegments,h);for(;x.hasNext;){let g=x.move();u.element=h[g.start];let C=Ye.chain.label_asym_id(u),_=Ye.unit.operator_name(u);if(a.has(C)){l.has(C)?Tr(l.get(C),_):l.set(C,[_]);continue}let b=Ye.entity.type(u);if(!(b==="water"||b==="polymer"))for(y.setSegment(g);y.hasNext;){let I=y.move();u.element=h[I.start],c.addComponent(Xr.getEntryFromLocation(u),m)}}i.throwIfTimedOut()}let f=i.inputStructure.subsetBuilder(!0);for(let p of i.inputStructure.units){if(p.kind!==0)continue;u.unit=p;let{elements:h}=p,x=We.transientSegments(p.model.atomicHierarchy.chainAtomSegments,h),y=We.transientSegments(p.model.atomicHierarchy.residueAtomSegments,h);for(f.beginUnit(p.id);x.hasNext;){let g=x.move();u.element=h[g.start];let C=Ye.chain.label_asym_id(u),_=Ye.unit.operator_name(u);if(l.has(C)&&l.get(C).indexOf(_)>=0){f.addElementRange(h,g.start,g.end);continue}if(m.hasLabelAsymId(C))for(y.setSegment(g);y.hasNext;){let b=y.move();u.element=h[b.start],m.has(u)&&f.addElementRange(h,b.start,b.end)}}f.commitUnit(),i.throwIfTimedOut()}let d=di(i.inputStructure,[f.getStructure(),o]);if(n){let p=new yi(i.inputStructure),h=i.inputStructure.lookup3d;for(let x of d.units){let y=x.conformation,g=x.elements;for(let C=0,_=g.length;C<_;C++){let b=g[C];h.findIntoBuilderIf(y.x(b),y.y(b),y.z(b),t,p,Vy),p.addToUnit(x.id,b)}i.throwIfTimedOut()}return Be.Sequence(i.inputStructure,[p.getStructure()])}else return Be.Sequence(i.inputStructure,[d])}}var zy=Ye.entity.type;function Vy(e){return zy(e)==="water"}function Ky(e){let t=e.models[0],n=new Set;if(!_t.is(t.sourceData))return n;let{_rowCount:r,asym_id:i}=t.sourceData.data.db.pdbx_molecule;for(let o=0;o<r;o++)n.add(i.value(o));return n}function jy(e){var t,n;let r=e.models[0],i=new cu;if(!_t.is(r.sourceData))return i;let o=r.sourceData.data.db.struct_conn,{conn_type_id:s}=o,{ptnr1_label_asym_id:a,ptnr1_label_comp_id:c,ptnr1_label_seq_id:u,ptnr1_symmetry:l,pdbx_ptnr1_label_alt_id:m,pdbx_ptnr1_PDB_ins_code:f}=o,{ptnr2_label_asym_id:d,ptnr2_label_comp_id:p,ptnr2_label_seq_id:h,ptnr2_symmetry:x,pdbx_ptnr2_label_alt_id:y,pdbx_ptnr2_PDB_ins_code:g}=o;for(let C=0;C<o._rowCount;C++){let _=s.value(C);if(_!=="covale"&&_!=="metalc")continue;let b={label_asym_id:a.value(C),label_comp_id:c.value(C),label_seq_id:u.value(C),label_alt_id:m.value(C),ins_code:f.value(C),operator_name:(t=l.value(C))!==null&&t!==void 0?t:"1_555"},I={label_asym_id:d.value(C),label_comp_id:p.value(C),label_seq_id:h.value(C),label_alt_id:y.value(C),ins_code:g.value(C),operator_name:(n=x.value(C))!==null&&n!==void 0?n:"1_555"};i.addEdge(b,I)}return i}var cu=class{constructor(){this.vertices=new Map,this.edges=new Map}addVertex(t,n){this.vertices.has(n)||(this.vertices.set(n,t),this.edges.set(n,[]))}addEdge(t,n){let r=Xr.getLabel(t),i=Xr.getLabel(n);this.addVertex(t,r),this.addVertex(n,i),Tr(this.edges.get(r),i),Tr(this.edges.get(i),r)}addComponent(t,n){let r=Xr.getLabel(t);if(!this.vertices.has(r)){n.add(t);return}let i=new Set,o=new Set,s=[r];for(o.add(r),n.add(t);s.length>0;){let a=s.pop();i.add(a);let c=this.vertices.get(a);for(let u of this.edges.get(a)){if(i.has(u)||(s.push(u),o.has(u)))continue;o.add(u);let l=this.vertices.get(u);c.operator_name===l.operator_name?n.add(Ct(Le({},l),{operator_name:t.operator_name})):n.add(l)}}}};var lu={};Br(lu,{areIntersectedBy:()=>$y,first:()=>Zy,getCurrentStructureProperties:()=>Mo,isConnectedTo:()=>rx,pick:()=>Yy,withSameAtomProperties:()=>Xy,within:()=>Qy});function O0(e,t,n,r,i,o){return t.elementCount===0||n.elementCount===0?!0:t.elementCount<=n.elementCount?oa.check(e,t,n,r,i,o):oa.check(e,n,t,r,i,o)}function L0(e,t,n,r,i){return t.elementCount===0||n.elementCount===0?!0:t.elementCount<=n.elementCount?sa.check(e,t,n,r,i):sa.check(e,n,t,r,i)}var oa;(function(e){let t=N();function n(s,a,c,u,l,m,f){let{elements:d,conformation:p}=a,h=t;s.element.unit=a;let x=!1;for(let y=0,g=d.length;y<g;y++){let C=d[y];s.element.element=C;let _=Math.max(0,N.distance(c,p.position(C,h))-u-f(s));if(_<l)return 0;_<m&&(x=!0)}return x?1:2}function r(s,a,c,u,l,m,f){let{units:d}=a,p=!1;for(let h=0,x=d.length;h<x;h++){let y=n(s,d[h],c,u,l,m,f);if(y===0)return 0;y===1&&(p=!0)}return p?1:2}let i=N();function o(s,a,c,u,l,m){if(a.elementCount===0||c.elementCount===0)return 0;let{units:f}=a,d=!1;s.element.structure=a;for(let p=0,h=f.length;p<h;p++){let x=f[p],{elements:y,conformation:g}=x;s.element.unit=x;for(let C=0,_=y.length;C<_;C++){let b=y[C];s.element.element=b;let I=r(s,c,g.position(b,i),m(s),u,l,m);if(I===0)return!1;I===1&&(d=!0)}}return d}e.check=o})(oa||(oa={}));var sa;(function(e){let t=N();function n(s,a,c,u,l,m){let{elements:f,conformation:d}=a,p=t;s.element.unit=a;for(let h=0,x=f.length;h<x;h++){let y=f[h];if(s.element.element=y,Math.max(0,N.distance(c,d.position(y,p))-u-m(s))<=l)return!0}return!1}function r(s,a,c,u,l,m){let{units:f}=a;for(let d=0,p=f.length;d<p;d++)if(n(s,f[d],c,u,l,m))return!0;return!1}let i=N();function o(s,a,c,u,l){if(a.elementCount===0||c.elementCount===0)return 0;let{units:m}=a;s.element.structure=a;for(let f=0,d=m.length;f<d;f++){let p=m[f];s.element.unit=p;let{elements:h,conformation:x}=p;for(let y=0,g=h.length;y<g;y++){let C=h[y];if(s.element.element=C,r(s,c,x.position(C,i),l(s),u,l))return!0}}return!1}e.check=o})(sa||(sa={}));function Yy(e,t){return n=>{let r=e(n),i=Be.LinearBuilder(n.inputStructure);return n.pushCurrentElement(),Be.forEach(r,(o,s)=>{n.currentStructure=o,t(n)&&i.add(o),s%100&&n.throwIfTimedOut()}),n.popCurrentStructure(),i.getSelection()}}function Zy(e){return t=>{let n=e(t),r=Be.LinearBuilder(t.inputStructure);if(n.kind==="singletons"){if(n.structure.elementCount>0){let i=n.structure.units[0],o=ot.create([i.getChild(le.ofSingleton(i.elements[0]))],{parent:t.inputStructure});r.add(o)}}else n.structures.length>0&&r.add(n.structures[0]);return r.getSelection()}}function Mo(e,t,n){let{units:r}=e.currentStructure,i=e.pushCurrentElement();i.structure=e.currentStructure;for(let o of r){i.unit=o;let s=o.elements,a=t;if(a){for(let c=0,u=s.length;c<u;c++)i.element=s[c],n.add(a(e));e.throwIfTimedOut()}}return e.popCurrentElement(),n}function Wy(e,t,n){let r=new Set,i=t(e);return e.pushCurrentElement(),Be.forEach(i,(o,s)=>{e.currentStructure=o,Mo(e,n,r),s%10&&e.throwIfTimedOut()}),e.popCurrentElement(),r}function Xy(e,t,n){return r=>{let i=e(r),o=Wy(r,t,n),s=Be.LinearBuilder(r.inputStructure);return r.pushCurrentStructure(),Be.forEach(i,(a,c)=>{r.currentStructure=a;let u=Mo(r,n,new Set);hn.isSuperset(o,u)&&s.add(a),c%10&&r.throwIfTimedOut()}),r.popCurrentStructure(),s.getSelection()}}function $y(e,t){return n=>{let r=Be.unionStructure(t(n)),i=Be.LinearBuilder(n.inputStructure);return Be.forEach(e(n),(o,s)=>{zs(r,o)&&i.add(o),s%10&&n.throwIfTimedOut()}),i.getSelection()}}function Qy(e){return t=>{let n={queryCtx:t,selection:e.query(t),target:e.target(t),maxRadius:e.maxRadius,minRadius:e.minRadius?Math.max(0,e.minRadius):0,elementRadius:e.elementRadius,invert:!!e.invert};return n.minRadius===0&&typeof e.minRadius>"u"?Jy(n):n.minRadius===0?ex(n):tx(n)}}function Jy({queryCtx:e,selection:t,target:n,maxRadius:r,invert:i}){let o=Be.unionStructure(n).lookup3d,s=Be.LinearBuilder(e.inputStructure),a=N.zero();return Be.forEach(t,(c,u)=>{let{units:l}=c,m=!1;for(let f=0,d=l.length;f<d;f++){let p=l[f],{elements:h,conformation:x}=p;for(let y=0,g=h.length;y<g;y++){let C=h[y];if(x.position(C,a),o.check(a[0],a[1],a[2],r+x.r(C))){m=!0;break}}if(m)break}i&&(m=!m),m&&s.add(c),u%10===0&&e.throwIfTimedOut()}),s.getSelection()}function ex({queryCtx:e,selection:t,target:n,maxRadius:r,invert:i,elementRadius:o}){let s=Be.unionStructure(n),a=Be.LinearBuilder(e.inputStructure);return e.pushCurrentElement(),Be.forEach(t,(c,u)=>{let l=L0(e,s,c,r,o);i&&(l=!l),l&&a.add(c),u%10===0&&e.throwIfTimedOut()}),e.popCurrentElement(),a.getSelection()}function tx({queryCtx:e,selection:t,target:n,minRadius:r,maxRadius:i,invert:o,elementRadius:s}){let a=Be.unionStructure(n),c=Be.LinearBuilder(e.inputStructure);return e.pushCurrentElement(),Be.forEach(t,(u,l)=>{let m=O0(e,a,u,r,i,s);o&&(m=!m),m&&c.add(u),l%10===0&&e.throwIfTimedOut()}),e.popCurrentElement(),c.getSelection()}function nx(e,t){let{queryCtx:n,input:r,target:i,disjunct:o}=e,s=n.atomicBond,a=r.interUnitBonds;s.setStructure(r);for(let c of t.units){if(!ge.isAtomic(c))continue;let u=r.unitMap.get(c.id),{offset:l,b:m,edgeProps:{flags:f,order:d,key:p}}=u.bonds,h=a.getConnectedUnits(c.id),x=h.length,y=c.elements,g=u.elements;for(let C=0,_=y.length;C<_;C++){let b=le.indexOf(g,y[C]);s.a.unit=u,s.b.unit=u;for(let I=l[b],E=l[b+1];I<E;I++)if(s.b.element=u.elements[m[I]],!(o&&le.has(c.elements,s.b.element))&&i.hasElement(s.b)&&(s.aIndex=b,s.a.element=y[C],s.bIndex=m[I],s.type=f[I],s.order=d[I],s.key=p[I],s.test(n,!0)))return!0;for(let I=0;I<x;I++){let E=h[I],S=r.unitMap.get(E.unitB),v=S.elements,P=E.getEdges(b);for(let L=0,w=P.length;L<w;L++){let D=P[L];if(s.b.unit=S,s.b.element=v[D.indexB],!!i.hasElement(s.b)&&!(o&&t.hasElement(s.b))&&(s.a.unit=u,s.aIndex=b,s.a.element=y[C],s.bIndex=D.indexB,s.type=D.props.flag,s.order=D.props.order,s.key=D.props.key,s.test(n,!0)))return!0}}}}return!1}function rx({query:e,target:t,disjunct:n,invert:r,bondTest:i}){return o=>{let s=t(o);if(Be.isEmpty(s))return s;let a=e(o);if(Be.isEmpty(a))return a;let c={queryCtx:o,input:o.inputStructure,disjunct:n,target:Be.unionStructure(s)},u=Be.LinearBuilder(o.inputStructure);return o.pushCurrentBond(),o.atomicBond.setTestFn(i),Be.forEach(a,(l,m)=>{(nx(c,l)||r)&&u.add(l),m%5===0&&o.throwIfTimedOut()}),o.popCurrentBond(),u.getSelection()}}var fu={};Br(fu,{intersect:()=>ox,merge:()=>ix});function ix(e){return e.length===0?js:e.length===1?e[0]:t=>{let n=Be.UniqueBuilder(t.inputStructure);for(let r=0;r<e.length;r++)Be.forEach(e[r](t),(i,o)=>{n.add(i),r%100&&t.throwIfTimedOut()});return n.getSelection()}}function ox(e){return e.length===0?js:e.length===1?e[0]:t=>{let n=[];for(let a=0;a<e.length;a++)n.push(e[a](t));let r=0,i=Be.structureCount(n[0]);for(let a=1;a<n.length;a++){let c=Be.structureCount(n[a]);c<i&&(r=a,i=c)}t.throwIfTimedOut();let o=wi(a=>a.hashCode,ot.areUnitIdsAndIndicesEqual);Be.forEach(n[r],a=>o.add(a));let s=Be.UniqueBuilder(t.inputStructure);for(let a=0;a<n.length;a++)a!==r&&(Be.forEach(n[a],c=>{o.has(c)&&s.add(c)}),t.throwIfTimedOut());return s.getSelection()}}var du={};Br(du,{atomCount:()=>sx,countQuery:()=>ax,propertySet:()=>cx});function sx(e){return e.currentStructure.elementCount}function ax(e){return t=>{let n=e(t);return Be.structureCount(n)}}function cx(e){return t=>Mo(t,e,new Set)}var aa;(function(e){function t(f){return!!f&&!!f.has}function n(f,d){return p=>f(p)===d}e.eq=n;function r(f,d){return p=>f(p)<d}e.lt=r;function i(f,d){return p=>f(p)<=d}e.lte=i;function o(f,d){return p=>f(p)>d}e.gt=o;function s(f,d){return p=>f(p)>=d}e.gte=s;function a(f){return!0}function c(f){return!1}function u(f,d){if(t(d))return p=>d.has(f(p));{if(d.length===0)return c;let p=new Set;for(let h=0;h<d.length;h++)p.add(d[h]);return h=>p.has(f(h))}}e.inSet=u;function l(...f){switch(f.length){case 0:return a;case 1:return f[0];case 2:{let d=f[0],p=f[1];return h=>d(h)&&p(h)}case 3:{let d=f[0],p=f[1],h=f[2];return x=>d(x)&&p(x)&&h(x)}case 4:{let d=f[0],p=f[1],h=f[2],x=f[3];return y=>d(y)&&p(y)&&h(y)&&x(y)}case 5:{let d=f[0],p=f[1],h=f[2],x=f[3],y=f[4];return g=>d(g)&&p(g)&&h(g)&&x(g)&&y(g)}case 6:{let d=f[0],p=f[1],h=f[2],x=f[3],y=f[4],g=f[5];return C=>d(C)&&p(C)&&h(C)&&x(C)&&y(C)&&g(C)}default:{let d=f.length;return p=>{for(let h=0;h<d;h++)if(!f[h])return!1;return!0}}}}e.and=l;function m(...f){switch(f.length){case 0:return c;case 1:return f[0];case 2:{let d=f[0],p=f[1];return h=>d(h)||p(h)}case 3:{let d=f[0],p=f[1],h=f[2];return x=>d(x)||p(x)||h(x)}case 4:{let d=f[0],p=f[1],h=f[2],x=f[3];return y=>d(y)||p(y)||h(y)||x(y)}case 5:{let d=f[0],p=f[1],h=f[2],x=f[3],y=f[4];return g=>d(g)||p(g)||h(g)||x(g)||y(g)}case 6:{let d=f[0],p=f[1],h=f[2],x=f[3],y=f[4],g=f[5];return C=>d(C)||p(C)||h(C)||x(C)||y(C)||g(C)}default:{let d=f.length;return p=>{for(let h=0;h<d;h++)if(f[h])return!0;return!1}}}}e.or=m})(aa||(aa={}));var cr={generators:Kc,filters:lu,modifiers:uu,combinators:fu,pred:aa,internal:Gc,atomset:du};var vr=class{getFrameAtIndex(t){return this.frames[t]}constructor(t){this.frames=t,this.frameCount=t.length,this.representative=t[0],this.duration=t.length}};function q0(e,t,n){if(!e._rowCount)return[];let r=fx(n),i=[];for(let o=0;o<e._rowCount;o++)i[i.length]=ux(e,t,o,r);return i}function ux(e,t,n,r){let i=e.id.value(n),o=e.details.value(n),s=[],{assembly_id:a,oper_expression:c,asym_id_list:u}=t;for(let l=0,m=t._rowCount;l<m;l++)a.value(l)===i&&(s[s.length]={assemblyId:i,expression:c.value(l),asymIds:u.value(l)});return zi.create(i,o,lx(s,r))}function lx(e,t){return()=>{let n=[],r=0;for(let i=0;i<e.length;i++){let o=e[i],s=px(o.expression),a=dx(s),c=mx(t,a,r,o.assemblyId),u=cr.generators.atoms({chainTest:cr.pred.and(cr.pred.eq(l=>Ye.unit.operator_name(l.element),xt.DefaultName),cr.pred.inSet(l=>Ye.chain.label_asym_id(l.element),o.asymIds))});n[n.length]={selector:u,operators:c,asymIds:o.asymIds},r+=c.length}return n}}function fx(e){let{id:t,matrix:n,vector:r,_schema:i}=e,o=new Map,s=N();for(let a=0,c=e._rowCount;a<c;a++){let u=nn.toMat4(ke(),i.matrix.space,n.value(a));nn.toVec3(s,i.vector.space,r.value(a)),ke.setTranslation(u,s),ke.setValue(u,3,3,1),o.set(t.value(a),u)}return o}function dx(e){let t=[],n=[];for(let r=0;r<e.length;r++)n[r]="";return G0(e,t,e.length-1,n),t}function G0(e,t,n,r){if(n<0){t[t.length]=r.slice(0);return}let i=e[n],o=i.length;for(let s=0;s<o;s++)r[n]=i[s],G0(e,t,n-1,r)}function mx(e,t,n,r){let i=[],o=n;for(let s of t){let a=ke.identity();for(let c=0;c<s.length;c++)ke.mul(a,a,e.get(s[c]));o++,i[i.length]=xt.create(`ASM_${o}`,a,{assembly:{id:r,operId:o,operList:s}})}return i}function px(e){let t=/\(?([^\(\)]+)\)?]*/g,n=[],r=[],i;for(;i=t.exec(e);)n[n.length]=i[1];return n.forEach(o=>{let s=[];o.split(",").forEach(a=>{let c=a.indexOf("-");if(c>0){let u=parseInt(a.substring(0,c)),l=parseInt(a.substr(c+1));for(let m=u;m<=l;m++)s[s.length]=m.toString()}else s[s.length]=a.trim()}),r[r.length]=s}),r}var Wt;(function(e){e.Descriptor={name:"model_symmetry"},e.Provider=en.create(e.Descriptor);function t(r){let i=q0(r.pdbx_struct_assembly,r.pdbx_struct_assembly_gen,r.pdbx_struct_oper_list),o=gx(r.symmetry,r.cell),s=hx(r.atom_sites,o);return{assemblies:i,spacegroup:o,isNonStandardCrystalFrame:s,ncsOperators:yx(r.struct_ncs_oper)}}e.fromData=t;function n(r,i){let o=hr.create("P 1",r,i),s=sn.create(o);return{assemblies:[],spacegroup:s,isNonStandardCrystalFrame:!1}}e.fromCell=n})(Wt||(Wt={}));function hx(e,t){return e._rowCount===0,!1}function _x(e){let t=e.Int_Tables_number.value(0),n=e["space_group_name_H-M"].value(0);return e.Int_Tables_number.isDefined?e["space_group_name_H-M"].isDefined?n:t:n}function gx(e,t){if(e._rowCount===0||t._rowCount===0)return sn.ZeroP1;let n=t.length_a.value(0),r=t.length_b.value(0),i=t.length_c.value(0);if(n===0||r===0||i===0)return sn.ZeroP1;let o=t.angle_alpha.value(0),s=t.angle_beta.value(0),a=t.angle_gamma.value(0);if(o===0||s===0||a===0)return sn.ZeroP1;let c=_x(e),u=hr.create(c,N.create(n,r,i),N.scale(N(),N.create(o,s,a),Math.PI/180));return sn.create(u)}function yx(e){if(e._rowCount===0)return;let{id:t,matrix:n,vector:r}=e,i=nt.struct_ncs_oper.matrix.space,o=nt.struct_ncs_oper.vector.space,s=[];for(let a=0;a<e._rowCount;a++){let c=nn.toMat3(Xt(),i,n.value(a)),u=nn.toVec3(N(),o,r.value(a));if(!xt.checkIfRotationAndTranslation(c,u)||e.code.value(a)==="given"&&!Xt.isIdentity(c)&&!N.isZero(u))continue;let l=t.value(a);s[s.length]=xt.ofRotationAndOffset(`ncs_${l}`,c,u,l)}return s}var xx={U:nt.atom_site_anisotrop.U,U_esd:nt.atom_site_anisotrop.U_esd},Qi;(function(e){e.Schema=xx,e.Descriptor={name:"atom_site_anisotrop",cifExport:{prefix:"",categories:[{name:"atom_site_anisotrop",instance(r){return e.Provider.get(r.firstModel)?_t.is(r.firstModel.sourceData)?At.Category.ofTable(r.firstModel.sourceData.data.db.atom_site_anisotrop):At.Category.Empty:At.Category.Empty}}]}},e.Provider=en.create(e.Descriptor);function t(r,i){let o=new Int32Array(r.rowCount);o.fill(-1);for(let a=0,c=r.rowCount;a<c;a++)o[r.value(a)]=a;let s=new Int32Array(r.rowCount);s.fill(-1);for(let a=0,c=i.rowCount;a<c;++a){let u=o[i.value(a)];u!==-1&&(s[u]=a)}return s}e.getElementToAnsiotrop=t;function n(r,i){let o={};for(let a=0,c=r.rowCount;a<c;a++)o[r.value(a)]=a;let s=new Int32Array(r.rowCount);s.fill(-1);for(let a=0,c=i.rowCount;a<c;++a){let u=o[i.value(a)];u!==void 0&&(s[u]=a)}return s}e.getElementToAnsiotropFromLabel=n})(Qi||(Qi={}));var Ji;(function(e){let t="molstar_global_model_transform_info";e.Schema={[t]:{matrix:me.Schema.Matrix(4,4,me.Schema.float)}},e.Descriptor=xn({name:t,cifExport:{categories:[{name:t,instance(a){let c=r(a.firstModel);if(!c)return At.Category.Empty;let u=mt.ofRows(e.Schema.molstar_global_model_transform_info,[{matrix:c}]);return At.Category.ofTable(u)}}],prefix:"molstar"}}),e.Provider=en.create(e.Descriptor);function n(a,c){a.customProperties.has(e.Descriptor)||a.customProperties.add(e.Descriptor),e.Provider.set(a,c)}e.attach=n;function r(a){return e.Provider.get(a)}e.get=r;function i(a){if(!_t.is(a.sourceData))return;let c=a.sourceData.data.frame.categories[t];if(!c)return;let u=Gf(e.Schema[t],c);if(u._rowCount!==0)return u.matrix.value(0)}e.fromMmCif=i;function o(a){if(!_t.is(a.sourceData))return!1;let c=a.sourceData.data.frame.categories[t];return!!c&&c.rowCount>0}e.hasData=o;function s(a,c){a.writeCategory({name:t,instance(){let u=mt.ofRows(e.Schema.molstar_global_model_transform_info,[{matrix:c}]);return At.Category.ofTable(u)}})}e.writeMmCif=s})(Ji||(Ji={}));var TE={label_comp_id:nt.atom_site.label_comp_id,label_seq_id:nt.atom_site.label_seq_id,pdbx_PDB_ins_code:nt.atom_site.pdbx_PDB_ins_code,label_asym_id:nt.atom_site.label_asym_id,label_entity_id:nt.atom_site.label_entity_id,auth_comp_id:nt.atom_site.auth_atom_id,auth_seq_id:nt.atom_site.auth_seq_id,auth_asym_id:nt.atom_site.auth_asym_id},FE=Ct(Le({},nt.chem_comp_bond),{molstar_protonation_variant:me.Schema.Str()}),H0=Ct(Le({},nt.chem_comp),{type:me.Schema.Aliased(me.Schema.str)});function V0(e,t){let{ihm_model_group:n,ihm_model_group_link:r}=t,i=mt.pickRow(r,o=>r.model_id.value(o)===e);if(i){let o=mt.pickRow(n,s=>n.id.value(s)===i.group_id);if(o)return o.name}return""}function z0(e){for(let t=0,n=e.rowCount;t<n;t++)if(e.valueKind(t)===0)return!0;return!1}function ca(e,t,n){(!e[t].isDefined||!z0(e[t]))&&(e[t]=e[n]),(!e[n].isDefined||!z0(e[n]))&&(e[n]=e[t])}function K0(e){let t=mt.ofColumns(e._schema,e);return ca(t,"label_atom_id","auth_atom_id"),ca(t,"label_comp_id","auth_comp_id"),ca(t,"label_seq_id","auth_seq_id"),ca(t,"label_asym_id","auth_asym_id"),t}var _n={entry:nt.entry,struct:nt.struct,struct_asym:nt.struct_asym,ihm_model_list:nt.ihm_model_list,ihm_model_group:nt.ihm_model_group,ihm_model_group_link:nt.ihm_model_group_link,entity:nt.entity,entity_poly:nt.entity_poly,entity_poly_seq:nt.entity_poly_seq,pdbx_entity_branch:nt.pdbx_entity_branch,chem_comp:H0,pdbx_chem_comp_identifier:nt.pdbx_chem_comp_identifier,atom_site:nt.atom_site,ihm_sphere_obj_site:nt.ihm_sphere_obj_site,ihm_gaussian_obj_site:nt.ihm_gaussian_obj_site,pdbx_unobs_or_zero_occ_residues:nt.pdbx_unobs_or_zero_occ_residues,pdbx_molecule:nt.pdbx_molecule};function mu(e,t=!1){let n=Object.create(null);for(let r of Object.keys(_n))r in e?n[r]=e[r]:n[r]=mt.ofUndefinedColumns(_n[r],0);return t&&(n.atom_site=K0(n.atom_site)),n}var ua=class{constructor(){this.count=0,this.ids=[],this.types=[],this.descriptions=[],this.compoundsMap=new Map,this.namesMap=new Map,this.heteroMap=new Map,this.chainMap=new Map}set(t,n){this.count+=1,this.ids.push(`${this.count}`),this.types.push(t),this.descriptions.push([n])}getEntityId(t,n,r,i){return n===2?(this.waterId===void 0&&(this.set("water",i?.customName||"Water"),this.waterId=`${this.count}`),this.waterId):Li(n)?this.compoundsMap.has(r)?this.compoundsMap.get(r):(this.chainMap.has(r)||(this.set("polymer",i?.customName||`Polymer ${this.chainMap.size+1}`),this.chainMap.set(r,`${this.count}`)),this.chainMap.get(r)):(this.heteroMap.has(t)||(this.set("non-polymer",i?.customName||this.namesMap.get(t)||t),this.heteroMap.set(t,`${this.count}`)),this.heteroMap.get(t))}getEntityTable(){return mt.ofPartialColumns(_n.entity,{id:me.ofStringArray(this.ids),type:me.ofStringAliasArray(this.types),pdbx_description:me.ofStringListArray(this.descriptions)},this.count)}setCompounds(t){for(let n=0,r=t.length;n<r;++n){let{chains:i,description:o}=t[n];this.set("polymer",o);for(let s=0,a=i.length;s<a;++s)this.compoundsMap.set(i[s],`${this.count}`)}}setNames(t){t.forEach(n=>this.namesMap.set(n[0],n[1]))}};var Ax=[new Set(["CA"]),new Set(["C"]),new Set(["N"])],bx=[new Set(["P","O3'","O3*"]),new Set(["C4'","C4*"]),new Set(["O2'","O2*","F2'","F2*"])],Cx=[new Set(["P","O3'","O3*"]),new Set(["C3'","C3*"]),new Set(["O2'","O2*","F2'","F2*"])],Sx=new Set(["FMN","NCN","FNS","FMA","ATP","ADP","AMP","GTP","GDP","GMP","LIG"]),j0=function(){let e=new Map;return[{id:"HIS",name:"HISTIDINE",type:"l-peptide linking"},{id:"ARG",name:"ARGININE",type:"l-peptide linking"},{id:"LYS",name:"LYSINE",type:"l-peptide linking"},{id:"ILE",name:"ISOLEUCINE",type:"l-peptide linking"},{id:"PHE",name:"PHENYLALANINE",type:"l-peptide linking"},{id:"LEU",name:"LEUCINE",type:"l-peptide linking"},{id:"TRP",name:"TRYPTOPHAN",type:"l-peptide linking"},{id:"ALA",name:"ALANINE",type:"l-peptide linking"},{id:"MET",name:"METHIONINE",type:"l-peptide linking"},{id:"CYS",name:"CYSTEINE",type:"l-peptide linking"},{id:"ASN",name:"ASPARAGINE",type:"l-peptide linking"},{id:"VAL",name:"VALINE",type:"l-peptide linking"},{id:"GLY",name:"GLYCINE",type:"peptide linking"},{id:"SER",name:"SERINE",type:"l-peptide linking"},{id:"GLN",name:"GLUTAMINE",type:"l-peptide linking"},{id:"TYR",name:"TYROSINE",type:"l-peptide linking"},{id:"ASP",name:"ASPARTIC ACID",type:"l-peptide linking"},{id:"GLU",name:"GLUTAMIC ACID",type:"l-peptide linking"},{id:"THR",name:"THREONINE",type:"l-peptide linking"},{id:"PRO",name:"PROLINE",type:"l-peptide linking"},{id:"SEC",name:"SELENOCYSTEINE",type:"l-peptide linking"},{id:"PYL",name:"PYRROLYSINE",type:"l-peptide linking"},{id:"MSE",name:"SELENOMETHIONINE",type:"l-peptide linking"},{id:"SEP",name:"PHOSPHOSERINE",type:"l-peptide linking"},{id:"TPO",name:"PHOSPHOTHREONINE",type:"l-peptide linking"},{id:"PTR",name:"O-PHOSPHOTYROSINE",type:"l-peptide linking"},{id:"PCA",name:"PYROGLUTAMIC ACID",type:"l-peptide linking"},{id:"A",name:"ADENOSINE-5'-MONOPHOSPHATE",type:"rna linking"},{id:"C",name:"CYTIDINE-5'-MONOPHOSPHATE",type:"rna linking"},{id:"T",name:"THYMIDINE-5'-MONOPHOSPHATE",type:"rna linking"},{id:"G",name:"GUANOSINE-5'-MONOPHOSPHATE",type:"rna linking"},{id:"I",name:"INOSINIC ACID",type:"rna linking"},{id:"U",name:"URIDINE-5'-MONOPHOSPHATE",type:"rna linking"},{id:"DA",name:"2'-DEOXYADENOSINE-5'-MONOPHOSPHATE",type:"dna linking"},{id:"DC",name:"2'-DEOXYCYTIDINE-5'-MONOPHOSPHATE",type:"dna linking"},{id:"DT",name:"THYMIDINE-5'-MONOPHOSPHATE",type:"dna linking"},{id:"DG",name:"2'-DEOXYGUANOSINE-5'-MONOPHOSPHATE",type:"dna linking"},{id:"DI",name:"2'-DEOXYINOSINE-5'-MONOPHOSPHATE",type:"dna linking"},{id:"DU",name:"2'-DEOXYURIDINE-5'-MONOPHOSPHATE",type:"dna linking"}].forEach(n=>e.set(n.id,n)),e}(),Y0=function(){let e=new Map;return[{id:"ZN2",name:"ZINC ION",type:"ion"},{id:"SOD",name:"SODIUM ION",type:"ion"},{id:"CES",name:"CESIUM ION",type:"ion"},{id:"CLA",name:"CHLORIDE ION",type:"ion"},{id:"CAL",name:"CALCIUM ION",type:"ion"},{id:"POT",name:"POTASSIUM ION",type:"ion"}].forEach(n=>e.set(n.id,n)),e}(),la=class{set(t){this.comps.set(t.id,t),this.ids.push(t.id),this.names.push(t.name),this.types.push(t.type),this.mon_nstd_flags.push(Ms.has(t.id)?"y":"n")}getAtomIds(t){let n=new Set,r=this.seqId.value(t);for(;t<this.seqId.rowCount;){let i=this.seqId.value(t);if(i!==r)break;n.add(this.atomId.value(t)),r-i,t+=1}return n}hasAtomIds(t,n){for(let r=0,i=n.length;r<i;++r)if(!hn.areIntersecting(t,n[r]))return!1;return!0}getType(t){return this.hasAtomIds(t,Ax)?"peptide linking":this.hasAtomIds(t,bx)?"rna linking":this.hasAtomIds(t,Cx)?"dna linking":"other"}has(t){return this.comps.has(t)}get(t){return this.comps.get(t)}add(t,n){if(!this.has(t))if(j0.has(t))this.set(j0.get(t));else if(Bs.has(t))this.set({id:t,name:"WATER",type:"non-polymer"});else if(Sx.has(t.toUpperCase()))this.set({id:t,name:this.namesMap.get(t)||t,type:"non-polymer"});else if(Dn.has(t.toUpperCase()))this.set({id:t,name:this.namesMap.get(t)||t,type:"saccharide"});else{let r=this.getAtomIds(n);if(r.size===1&&Y0.has(t))this.set(Y0.get(t));else{let i=this.getType(r);this.set({id:t,name:this.namesMap.get(t)||t,type:i})}}return this.get(t)}getChemCompTable(){return mt.ofPartialColumns(_n.chem_comp,{id:me.ofStringArray(this.ids),name:me.ofStringArray(this.names),type:me.ofStringAliasArray(this.types),mon_nstd_flag:me.ofStringAliasArray(this.mon_nstd_flags)},this.ids.length)}setNames(t){t.forEach(n=>this.namesMap.set(n[0],n[1]))}constructor(t,n){this.seqId=t,this.atomId=n,this.namesMap=new Map,this.comps=new Map,this.ids=[],this.names=[],this.types=[],this.mon_nstd_flags=[]}};function Ix(e){if(_t.is(e.sourceData))return Wt.fromData(e.sourceData.data.db)}Wt.Provider.formatRegistry.add("mmCIF",Ix);function wx(e){if(!_t.is(e.sourceData))return;let{struct_conf:t,struct_sheet_range:n}=e.sourceData.data.db;return zn.fromStruct(t,n,e.atomicHierarchy)}zn.Provider.formatRegistry.add("mmCIF",wx);function vx(e){if(!_t.is(e.sourceData))return;let{atom_site_anisotrop:t}=e.sourceData.data.db,n=mt.ofColumns(Qi.Schema,t),r=Qi.getElementToAnsiotrop(e.atomicConformation.atomId,t.id);return{data:n,elementToAnsiotrop:r}}function Px(e){return _t.is(e.sourceData)?e.sourceData.data.db.atom_site_anisotrop.U.isDefined:!1}Qi.Provider.formatRegistry.add("mmCIF",vx,Px);function Bx(e){if(!_t.is(e.sourceData))return;let{chem_comp_bond:t}=e.sourceData.data.db;if(t._rowCount!==0)return{data:t,entries:Ir.getEntriesFromChemCompBond(t)}}Ir.Provider.formatRegistry.add("mmCIF",Bx);function Ex(e){if(!_t.is(e.sourceData))return;let{struct_conn:t}=e.sourceData.data.db;if(t._rowCount===0)return;let n=cn.getEntriesFromStructConn(t,e);return{data:t,byAtomIndex:cn.getAtomIndexFromEntries(n),entries:n}}cn.Provider.formatRegistry.add("mmCIF",Ex);Ji.Provider.formatRegistry.add("mmCIF",Ji.fromMmCif,Ji.hasData);var _t;(function(e){function t(r){return r?.kind==="mmCIF"}e.is=t;function n(r,i,o,s){return i||(i=qc.schema.mmCIF(r)),{kind:"mmCIF",name:i._name,data:{db:i,file:s,frame:r,source:o}}}e.fromFrame=n})(_t||(_t={}));function yD(e,t){let n=_t.fromFrame(e,void 0,void 0,t),r=mu(n.data.db,!0);return wt.create("Create mmCIF Model",i=>ko(r,n,i))}var No;(function(e){let t="__CcdCoordinateType__";e.CoordinateType={get(i){return i._staticPropertyData[t]},set(i,o){return i._staticPropertyData[t]=o}};function n(i){return i?.kind==="CCD"}e.is=n;function r(i,o){return o||(o=qc.schema.CCD(i)),{kind:"CCD",name:o._name,data:{db:o,frame:i}}}e.fromFrame=r})(No||(No={}));function xD(e){let t=No.fromFrame(e);return wt.create("Create CCD Models",n=>Dx(t.data.db,No.fromFrame(e),n))}function Dx(e,t,n){return Ve(this,null,function*(){let r=yield Z0(e,t,{coordinateType:"ideal",cartn_x:"pdbx_model_Cartn_x_ideal",cartn_y:"pdbx_model_Cartn_y_ideal",cartn_z:"pdbx_model_Cartn_z_ideal"},n),i=yield Z0(e,t,{coordinateType:"model",cartn_x:"model_Cartn_x",cartn_y:"model_Cartn_y",cartn_z:"model_Cartn_z"},n),o=[];r&&o.push(r),i&&o.push(i);for(let s=0,a=o.length;s<a;++s)Tt.TrajectoryInfo.set(o[s],{index:s,size:o.length});return new vr(o)})}function Z0(e,t,n,r){return Ve(this,null,function*(){let{chem_comp:i,chem_comp_atom:o,chem_comp_bond:s}=e,{coordinateType:a,cartn_x:c,cartn_y:u,cartn_z:l}=n,m=i.name.value(0),f=i.id.value(0),{atom_id:d,charge:p,comp_id:h,pdbx_ordinal:x,type_symbol:y}=o,g=o._rowCount,C=[];for(let $=0;$<g;$++)o[c].valueKind($)>0||(C[C.length]=$);let _=C.length,b=me.ofConst("A",_,me.Schema.str),I=me.ofConst(1,_,me.Schema.int),E=me.ofConst("1",_,me.Schema.str),S=me.ofConst(1,_,me.Schema.float),v=me.ofConst(1,_,me.Schema.int),P=me.view(d,C),L=me.view(h,C),w=me.view(o[c],C),D=me.view(o[u],C),z=me.view(o[l],C),ie=me.view(x,C),O=me.view(y,C),Q=me.view(p,C),K=mt.ofPartialColumns(_n.atom_site,{auth_asym_id:b,auth_atom_id:P,auth_comp_id:L,auth_seq_id:I,Cartn_x:w,Cartn_y:D,Cartn_z:z,id:ie,label_asym_id:b,label_atom_id:P,label_comp_id:L,label_seq_id:I,label_entity_id:E,occupancy:S,type_symbol:O,pdbx_PDB_model_num:v,pdbx_formal_charge:Q},_),Z=new ua;Z.setNames([[f,`${m} (${a})`]]),Z.getEntityId(f,0,"A");let se=new la(I,y);se.setNames([[f,`${m} (${a})`]]),se.add(f,0);let fe=mu({entity:Z.getEntityTable(),chem_comp:se.getChemCompTable(),atom_site:K}),Ce=yield ko(fe,t,r);if(!Ce.representative)return;let xe=Ce.representative,H=Ir.getEntriesFromChemCompBond(s);return Ir.Provider.set(xe,{data:s,entries:H}),No.CoordinateType.set(xe,a),Ce.representative})}function Mx(e){if(e._rowCount===0)return{residues:[],chains:[]};let t=0,n=e._rowCount,r=[t],i=[t],{label_entity_id:o,label_asym_id:s,label_seq_id:a,auth_seq_id:c,pdbx_PDB_ins_code:u}=e;for(let l=t+1;l<n;l++){let m=!o.areValuesEqual(l-1,l)||!s.areValuesEqual(l-1,l);(m||!a.areValuesEqual(l-1,l)||!c.areValuesEqual(l-1,l)||!u.areValuesEqual(l-1,l))&&(r[r.length]=l),m&&(i[i.length]=l)}return{residues:r,chains:i}}function Nx(e,t,n){let r=mt.ofColumns(dd,{type_symbol:me.ofArray({array:me.mapToArray(e.type_symbol,yr),schema:me.Schema.Aliased(me.Schema.str)}),label_atom_id:e.label_atom_id,auth_atom_id:e.auth_atom_id,label_alt_id:e.label_alt_id,label_comp_id:e.label_comp_id,auth_comp_id:e.auth_comp_id,pdbx_formal_charge:e.pdbx_formal_charge}),i=mt.view(e,md,n.residues),o=mt.view(e,pd,n.chains);if(!i.label_seq_id.isDefined){let s=new Int32Array(i.label_seq_id.rowCount),{residues:a,chains:c}=n,u=0,l=0;for(let m=0,f=s.length;m<f;++m)a[m]>=c[u+1]&&(u+=1,l=0),s[m]=++l;i.label_seq_id=me.ofIntArray(s)}return mt.columnToArray(i,"label_seq_id",Int32Array),mt.columnToArray(i,"auth_seq_id",Int32Array),{atoms:r,residues:i,chains:o,atomSourceIndex:t}}function kx(e){return{id:Rt.create22(),atomId:e.id,occupancy:e.occupancy.isDefined?e.occupancy:me.ofConst(1,e._rowCount,me.Schema.float),B_iso_or_equiv:e.B_iso_or_equiv,xyzDefined:e.Cartn_x.isDefined&&e.Cartn_y.isDefined&&e.Cartn_z.isDefined,x:e.Cartn_x.toArray({array:Float32Array}),y:e.Cartn_y.toArray({array:Float32Array}),z:e.Cartn_z.toArray({array:Float32Array})}}function Ux(e,t){return mt.areEqual(e.chains,t.chains)&&mt.areEqual(e.residues,t.residues)&&mt.areEqual(e.atoms,t.atoms)}function Rx(e,t){let n=new Map;if(!_t.is(t))return n;let{molstar_atom_site_operator_mapping:r}=En(fd,t.data.frame);if(r._rowCount===0)return n;let i=new Map,o=new Map;for(let l=0;l<r._rowCount;l++){let m=r.assembly_operator_id.valueKind(l)===0?{id:r.assembly_id.value(l),operList:[],operId:r.assembly_operator_id.value(l)}:void 0,f=xt.create(r.operator_name.value(l),ke.identity(),{assembly:m,spgrOp:r.symmetry_operator_index.valueKind(l)===0?r.symmetry_operator_index.value(l):void 0,hkl:N.ofArray(r.symmetry_hkl.value(l)),ncsId:r.ncs_id.value(l)}),d=r.suffix.value(l),p=r.label_asym_id.value(l);i.set(`${p}${d}`,{name:p,operator:f});let h=r.auth_asym_id.value(l);o.set(`${h}${d}`,h)}let{label_asym_id:s,auth_asym_id:a}=e.chains,c=new Array(s.rowCount),u=new Array(s.rowCount);for(let l=0;l<s.rowCount;l++){let m=s.value(l),f=a.value(l);if(!i.has(m)){c[l]=m,u[l]=f;continue}let{name:d,operator:p}=i.get(m);n.set(l,p),c[l]=d,u[l]=o.get(f)||f}return e.chains.label_asym_id=me.ofArray({array:c,valueKind:e.chains.label_asym_id.valueKind,schema:e.chains.label_asym_id.schema}),e.chains.auth_asym_id=me.ofArray({array:u,valueKind:e.chains.auth_asym_id.valueKind,schema:e.chains.auth_asym_id.schema}),n}function Tx(e,t,n,r,i,o){let s=Mx(e),a=Nx(e,t,s),c=Rx(a,i);if(o&&Ux(o.atomicHierarchy,a))return{sameAsPrevious:!0,hierarchy:o.atomicHierarchy,chainOperatorMapping:c};let u={residueAtomSegments:We.ofOffsets(s.residues,ue.ofBounds(0,e._rowCount)),chainAtomSegments:We.ofOffsets(s.chains,ue.ofBounds(0,e._rowCount))},l=qd(a,n,u),m=Ld(a,u,l,r);return{sameAsPrevious:!1,hierarchy:Ct(Le(Le({},a),u),{index:l,derived:m}),chainOperatorMapping:c}}function pu(e,t,n,r,i,o){let{sameAsPrevious:s,hierarchy:a,chainOperatorMapping:c}=Tx(e,t,n,r,i,o),u=kx(e);return{sameAsPrevious:s,hierarchy:a,conformation:u,chainOperatorMapping:c}}var W0={chainKey:[],entityKey:[],findSequenceKey:()=>-1,findChainKey:()=>-1,getEntityFromChain:()=>-1,count:0,entity_id:me.Undefined(0,me.Schema.str),asym_id:me.Undefined(0,me.Schema.str),seq_id_begin:me.Undefined(0,me.Schema.int),seq_id_end:me.Undefined(0,me.Schema.int),chainElementSegments:We.create([]),polymerRanges:Pt.ofSortedRanges([]),gapRanges:Pt.ofSortedRanges([])},hu=function(e){return e.Empty={isDefined:!1,spheres:W0,gaussians:W0},e}(hu||{});function Fx(e,t,n){if(e.has(t))return e.get(t);let r=n.index++;return e.set(t,r),r}function Ox(e,t){if(e.has(t))return e.get(t);let n=new Map;return e.set(t,n),n}function Lx(e,t,n){let r=e.getEntityIndex;return{findChainKey:(s,a)=>{let c=r(s);if(c<0)return-1;let u=t.get(c);return u.has(a)?u.get(a):-1},findSequenceKey:(s,a,c)=>{let u=r(s);if(u<0)return-1;let l=t.get(u);if(l===void 0)return-1;let m=l.get(a);if(m===void 0)return-1;let f=n.get(m),{elementIndices:d,seqRanges:p}=f,h=Pt.firstIntersectionIndex(p,Ie.ofSingleton(c));return h!==-1?d[h]:-1}}}function qx(e){throw new Error(`Missing entity entry for entity id '${e}'.`)}function _u(e,t){let{entity_id:n,asym_id:r,seq_id_begin:i,seq_id_end:o,count:s,chainElementSegments:a}=e,c=new Map,u=new Map,l={index:0},m=new Int32Array(s),f=new Int32Array(s),d=new Int32Array(a.count);for(let y=0;y<s;y++)f[y]=t.getEntityIndex(n.value(y)),f[y]<0&&qx(n.value(y));for(let y=0;y<a.count;y++){let g=a.offsets[y],C=a.offsets[y+1],_=f[g];d[y]=_;let b=Ox(u,_),I=Fx(b,r.value(g),l);for(let P=g;P<C;P++)m[P]=I;let E=[],S=[];for(let P=g;P<C;P++){let L=i.value(P),w=o.value(P);E.push(P),S.push(L,w)}let v={elementIndices:E,seqRanges:Pt.ofSortedRanges(S)};c.set(I,v)}let{findChainKey:p,findSequenceKey:h}=Lx(t,u,c);return{chainKey:m,entityKey:f,findSequenceKey:h,findChainKey:p,getEntityFromChain:y=>d[y]}}function gu(e,t){let n=[],r=[],i=We.transientSegments(e.chainElementSegments,ue.ofBounds(0,e.count)),{seq_id_begin:o,seq_id_end:s}=e;for(;i.hasNext;){let{start:a,end:c}=i.move(),u=-1,l=-1;for(let m=a;m<c;++m){let f=s.value(m);m===a?(u=m,l=s.value(m)):o.value(m)-l>1&&(n.push(u,m-1),r.push(m-1,m),u=m),m===c-1&&n.push(u,m),l=f}}return{polymerRanges:Pt.ofSortedRanges(n),gapRanges:Pt.ofSortedRanges(r)}}var yu={hierarchy:hu.Empty,conformation:void 0};function $0(e,t){let{ihm_sphere_obj_site:n,ihm_gaussian_obj_site:r}=e;if(n._rowCount===0&&r._rowCount===0)return yu;let i=X0(n),o=Gx(n),s=_u(i,e.entities),a=gu(i,t),c=X0(r),u=Hx(r),l=_u(c,e.entities),m=gu(c,t);return{hierarchy:{isDefined:!0,spheres:Le(Le(Le({},i),s),a),gaussians:Le(Le(Le({},c),l),m)},conformation:{id:Rt.create22(),spheres:o,gaussians:u}}}function Gx(e){return{x:e.Cartn_x.toArray({array:Float32Array}),y:e.Cartn_y.toArray({array:Float32Array}),z:e.Cartn_z.toArray({array:Float32Array}),radius:e.object_radius.toArray({array:Float32Array}),rmsf:e.rmsf.toArray({array:Float32Array})}}function Hx(e){let t=_n.ihm_gaussian_obj_site.covariance_matrix.space,n=[],{covariance_matrix:r}=e;for(let i=0,o=r.rowCount;i<o;i++)n[i]=nn.toMat3(Xt(),t,r.value(i));return{x:e.mean_Cartn_x.toArray({array:Float32Array}),y:e.mean_Cartn_y.toArray({array:Float32Array}),z:e.mean_Cartn_z.toArray({array:Float32Array}),weight:e.weight.toArray({array:Float32Array}),covariance_matrix:n}}function zx(e,t,n){let r=[0];for(let i=1,o=e.rowCount;i<o;i++)!e.areValuesEqual(i-1,i)&&(r[r.length]=i);return{chainElementSegments:We.ofOffsets(r,ue.ofBounds(0,e.rowCount))}}function X0(e){let{entity_id:t,seq_id_begin:n,seq_id_end:r,asym_id:i}=e;return Le({count:t.rowCount,entity_id:t,asym_id:i,seq_id_begin:n,seq_id_end:r},zx(i,n,r))}var Vx={HIS:"H",ARG:"R",LYS:"K",ILE:"I",PHE:"F",LEU:"L",TRP:"W",ALA:"A",MET:"M",PRO:"P",CYS:"C",ASN:"N",VAL:"V",GLY:"G",SER:"S",GLN:"Q",TYR:"Y",ASP:"D",GLU:"E",THR:"T",SEC:"U",PYL:"O",HSD:"H",HSE:"H",HSP:"H",LSN:"K",ASPP:"D",GLUP:"E",HID:"H",HIE:"H",HIP:"H",LYN:"K",ASH:"D",GLH:"E"},Kx={DA:"A",DC:"C",DG:"G",DT:"T",DU:"U"},jx={A:"A",C:"C",G:"G",T:"T",U:"U"};function xu(e){return Vx[e]||"X"}function Au(e){return jx[e]||"X"}function bu(e){return Kx[e]||"X"}var xi;(function(e){let t;(function(u){u.Protein="protein",u.RNA="RNA",u.DNA="DNA",u.Generic="generic"})(t=e.Kind||(e.Kind={}));function n(u){let l=u.code.toArray();return(l instanceof Array?l:Array.from(l)).join("")}e.getSequenceString=n;function r(u){for(let l=0,m=Math.min(u.rowCount,10);l<m;l++){let f=u.value(l)||"";if(xu(f)!=="X")return t.Protein;if(Au(f)!=="X")return t.RNA;if(bu(f)!=="X")return t.DNA}return t.Generic}function i(u,l){let m;switch(u){case t.Protein:m=xu;break;case t.DNA:m=bu;break;case t.RNA:m=Au;break;case t.Generic:m=()=>"X";break;default:gn(u)}return l&&l.size>0?f=>{let d=m(f);return d!=="X"||!l.has(f)?d:m(l.get(f))}:m}function o(u,l){if(l.rowCount===0)throw new Error("cannot be empty");let m=r(u);return new s(m,u,l)}e.ofResidueNames=o;class s{index(l){return this.indexMap.get(l)}constructor(l,m,f){this.kind=l,this.microHet=new Map;let d=i(l),p=[],h=[],x=[],y=new Map,g=0,C=new Map;for(let b=0,I=f.rowCount;b<I;++b){let E=f.value(b);if(C.has(E))y.has(E)?y.get(E).push(m.value(b)):y.set(E,[h[C.get(E)],m.value(b)]);else{C.set(E,g);let S=m.value(b);h[g]=S,x[g]=E,p[g]=d(S),g+=1}}let _=[];for(let b=0,I=g;b<I;++b){let E=y.get(x[b]);if(E){let S=E.map(v=>{let P=d(v);return P==="X"?v:P});_[b]=`(${S.join("|")})`}else _[b]=p[b]==="X"?h[b]:p[b]}this.length=g,this.code=me.ofStringArray(p),this.compId=me.ofStringArray(h),this.seqId=me.ofIntArray(x),this.label=me.ofStringArray(_),this.microHet=y,this.indexMap=C}}function a(u,l){let m=t.Generic;return new c(m,u,l)}e.ofSequenceRanges=a;class c{index(l){return l-this.minSeqId}constructor(l,m,f){this.kind=l,this.seqIdStart=m,this.seqIdEnd=f,this.microHet=new Map;let d=0,p=Number.MAX_SAFE_INTEGER;for(let x=0,y=this.seqIdStart.rowCount;x<y;x++){let g=this.seqIdStart.value(x),C=this.seqIdEnd.value(x);g<p&&(p=g),d<C&&(d=C)}let h=d-p+1;this.code=me.ofConst("X",h,me.Schema.str),this.label=me.ofConst("",h,me.Schema.str),this.seqId=me.ofLambda({value:x=>x+p+1,rowCount:h,schema:me.Schema.int}),this.compId=me.ofConst("",h,me.Schema.str),this.length=h,this.minSeqId=p}}})(xi||(xi={}));var Uo;(function(e){let t={byEntityKey:{},sequences:[]};function n(...a){let c=[],u={};for(let l=0,m=a.length;l<m;++l)c.push(...a[l].sequences),Object.assign(u,a[l].byEntityKey);return{sequences:c,byEntityKey:u}}function r(a,c,u){let l=i(a,c),m=u.isDefined?o(a,u):t;return n(l,m)}e.fromHierarchy=r;function i(a,c){let{label_comp_id:u}=c.atoms,{label_seq_id:l}=c.residues,{chainAtomSegments:m,residueAtomSegments:f}=c,{count:d,offsets:p}=m,h={},x=[];if(d===1&&p[0]===0&&p[1]===0)return{byEntityKey:h,sequences:x};for(let y=0,g=c.chains._rowCount;y<g;y++){let C=c.index.getEntityFromChain(y);if(h[C]!==void 0||a.data.type.value(C)!=="polymer")continue;let _=y;for(y++;y<g&&C===c.index.getEntityFromChain(y)&&a.data.type.value(C)!=="polymer";)y++;y--;let b=f.index[p[_]],I=f.index[p[y+1]-1]+1,E=me.window(l,b,I),S=[];for(let P=b;P<I;++P)S.push(u.value(f.offsets[P]));let v=me.ofStringArray(S);h[C]={entityId:a.data.id.value(C),sequence:xi.ofResidueNames(v,E)},x.push(h[C])}return{byEntityKey:h,sequences:x}}e.fromAtomicHierarchy=i;function o(a,c){let u=s(a,c.spheres),l=s(a,c.gaussians);return n(u,l)}e.fromCoarseHierarchy=o;function s(a,c){let{chainElementSegments:u,seq_id_begin:l,seq_id_end:m}=c,{count:f,offsets:d}=u,p={},h=[];if(f===1&&d[0]===0&&d[1]===0)return{byEntityKey:p,sequences:h};for(let x=0,y=f;x<y;x++){let g=c.getEntityFromChain(x);if(p[g]!==void 0)continue;let C=x;for(x++;x<y&&g===c.getEntityFromChain(x);)x++;x--;let _=d[C],b=d[x+1]-1,I=me.window(l,_,b),E=me.window(m,_,b);p[g]={entityId:a.data.id.value(g),sequence:xi.ofSequenceRanges(I,E)},h.push(p[g])}return{byEntityKey:p,sequences:h}}e.fromCoarseElements=s})(Uo||(Uo={}));function Cu(e,t,n,r){if(!e.entity_poly_seq||!e.entity_poly_seq._rowCount)return Uo.fromHierarchy(t,n,r);let{entity_id:i,num:o,mon_id:s}=e.entity_poly_seq,a={},c=[],u=i.rowCount,l=0;for(;l<u;){let m=l;for(;l<u-1&&i.areValuesEqual(l,l+1);)l++;l++;let f=i.value(m),d=me.window(s,m,l),p=me.window(o,m,l),h=t.getEntityIndex(f);a[h]={entityId:f,sequence:xi.ofResidueNames(d,p)},c.push(a[h])}return{byEntityKey:a,sequences:c}}function Su(e,t,n,r){return Ve(this,null,function*(){let i=so(n,r-1),{label_entity_id:o,label_asym_id:s,label_seq_id:a}=t,c=Yo(i,o.value);e.shouldUpdate&&(yield e.update());for(let u=0,l=c.length-1;u<l;u++){let m=Yo(i,s.value,{start:c[u],end:c[u+1]});for(let f=0,d=m.length-1;f<d;f++){let p=m[f];a.valueKind(p)===0&&(Yo(i,a.value,{sort:!0,start:p,end:m[f+1]}),e.shouldUpdate&&(yield e.update()))}e.shouldUpdate&&(yield e.update())}return Af(i)&&i.length===t._rowCount?{atom_site:t,sourceIndex:me.ofIntArray(i)}:{atom_site:mt.view(t,t._schema,i),sourceIndex:me.ofIntArray(i)}})}function Q0(e,t,n,r,i){let{polymerType:o,traceElementIndex:s,directionFromElementIndex:a,directionToElementIndex:c}=i.residue,u=o[e],l=o[t];if(u===0||l===0||s[e]===-1||s[t]===-1)return!1;let m=r.findAtomsOnResidue(e,Qn(u,"backboneStart")),f=r.findAtomsOnResidue(t,Qn(l,"backboneEnd"));(m===-1||f===-1)&&(m=r.findAtomsOnResidue(e,Qn(u,"coarseBackbone")),f=r.findAtomsOnResidue(t,Qn(l,"coarseBackbone")));let{x:d,y:p,z:h}=n,x=N.create(d[m],p[m],h[m]),y=N.create(d[f],p[f],h[f]),g=a[e]===-1||c[e]===-1||a[t]===-1||c[t]===-1;return N.distance(x,y)<(g?10:3)}function Iu(e,t,n,r){let i=[],o=[],s=new Map,a=We.transientSegments(e.chainAtomSegments,ue.ofBounds(0,e.atoms._rowCount)),c=We.transientSegments(e.residueAtomSegments,ue.ofBounds(0,e.atoms._rowCount)),{index:u,derived:l}=e,{label_seq_id:m}=e.residues,{label_entity_id:f}=e.chains,{moleculeType:d,traceElementIndex:p}=l.residue,h,x,y,g;for(;a.hasNext;){let C=a.move();c.setSegment(C),h=-1,x=-1,y=-1,g=-1;let _=t.getEntityIndex(f.value(C.index)),b=r.byEntityKey[_],I=b?b.sequence.seqId.value(b.sequence.seqId.rowCount-1):-1,E=e.residueAtomSegments.index[C.start],S=e.residueAtomSegments.index[C.end-1],v=m.value(E),P=m.value(S);for(v===1&&P===I&&n.xyzDefined&&Q0(E,S,n,u,l)&&(s.set(E,S),s.set(S,E));c.hasNext;){let L=c.move(),w=L.index,D=m.value(w);if(Li(d[w])&&p[w]!==-1)if(g!==-1)if(D!==h+1)i.push(g,y-1),o.push(x,L.end-1),g=L.start;else if(!c.hasNext)i.push(g,L.end-1);else{let z=e.residueAtomSegments.index[L.start],ie=e.residueAtomSegments.index[y-1];n.xyzDefined&&!Q0(z,ie,n,e.index,l)&&(i.push(g,y-1),o.push(x,L.end-1),g=L.start)}else g=L.start;else g!==-1&&(i.push(g,y-1),g=-1);x=L.start,y=L.end,h=D}}return{polymerRanges:Pt.ofSortedRanges(i),gapRanges:Pt.ofSortedRanges(o),cyclicPolymerMap:s}}function EM(e){let t,n;return(...r)=>{if(!t||t.length!==r.length)return t=r,n=e.apply(void 0,r),n;for(let i=0,o=r.length;i<o;i++)if(r[i]!==t[i])return t=r,n=e.apply(void 0,r),n;return n}}function J0(e){let t=new Map;return n=>{if(t.has(n))return t.get(n);let r=e(n);return t.set(n,r),r}}function e1(e){let t=new Map,n=(i,o,s)=>`${i}|${o}|${s}`,r=e.pdbx_unobs_or_zero_occ_residues;for(let i=0,o=r._rowCount;i<o;++i){let s=n(r.PDB_model_num.value(i),r.label_asym_id.value(i),r.label_seq_id.value(i));t.set(s,{polymer_flag:r.polymer_flag.value(i),occupancy_flag:r.occupancy_flag.value(i)})}return{has:(i,o,s)=>t.has(n(i,o,s)),get:(i,o,s)=>t.get(n(i,o,s)),size:t.size}}function t1(e){let t=new Map;if(e.chem_comp._rowCount>0){let{id:n}=e.chem_comp;for(let r=0,i=n.rowCount;r<i;++r)t.set(n.value(r),mt.getRow(e.chem_comp,r))}else r1(e).forEach(r=>{t.set(r,Rd(r))});return t}function n1(e){let t=new Map;if(e.pdbx_chem_comp_identifier._rowCount>0){let{comp_id:n,type:r,identifier:i}=e.pdbx_chem_comp_identifier;for(let o=0,s=n.rowCount;o<s;++o)if(r.value(o)==="SNFG CARBOHYDRATE SYMBOL"||r.value(o)==="SNFG CARB SYMBOL"){let a=i.value(o),c=Ad.get(a);c?t.set(n.value(o),c):console.warn(`Unknown SNFG name '${a}'`)}}if(e.chem_comp._rowCount>0){let{id:n,type:r}=e.chem_comp;for(let i=0,o=n.rowCount;i<o;++i){let s=n.value(i);if(t.has(s))continue;let a=r.value(i);Dn.has(s)?t.set(s,Dn.get(s)):Oi(a,s)===9&&t.set(s,Ps)}}else{let n=r1(e);Dn.forEach((r,i)=>{!t.has(i)&&n.has(i)&&t.set(i,r)})}return t}var r1=J0(e=>{let t=new Set,{label_comp_id:n,auth_comp_id:r}=e.atom_site,i=n.isDefined?n:r;for(let o=0,s=i.rowCount;o<s;++o)t.add(i.value(o));return t});function wu(e,t){let n=new Map,{auth_asym_id:r,label_asym_id:i,label_entity_id:o}=e.chains;for(let s=0,a=e.chains._rowCount;s<a;s++){let c=i.value(s);n.set(c,{id:c,auth_id:r.value(s),entity_id:o.value(s)})}if(t?.struct_asym._rowCount){let{id:s,entity_id:a}=t.struct_asym;for(let c=0,u=s.rowCount;c<u;++c){let l=s.value(c);n.has(l)||n.set(l,{id:l,auth_id:"",entity_id:a.value(c)})}}return n}var i1=me.Schema.Aliased(me.Schema.Str());function vu(e){let t;if(e.entity.id.isDefined)t=e.entity;else{let a=new Set,c=[],u=[],{label_entity_id:l,label_comp_id:m}=e.atom_site;for(let p=0,h=e.atom_site._rowCount;p<h;p++){let x=l.value(p);a.has(x)||(c.push(x),u.push(Td(m.value(p))),a.add(x))}let{entity_id:f}=e.ihm_sphere_obj_site;for(let p=0,h=e.ihm_sphere_obj_site._rowCount;p<h;p++){let x=f.value(p);a.has(x)||(c.push(x),u.push("polymer"),a.add(x))}let{entity_id:d}=e.ihm_gaussian_obj_site;for(let p=0,h=e.ihm_gaussian_obj_site._rowCount;p<h;p++){let x=d.value(p);a.has(x)||(c.push(x),u.push("polymer"),a.add(x))}t=mt.ofPartialColumns(_n.entity,{id:me.ofArray({array:c,schema:_n.entity.id}),type:me.ofArray({array:u,schema:_n.entity.type})},c.length)}let n=me.createIndexer(t.id),r=new Array(t._rowCount);r.fill("other");let i=new Set,o=!1;if(e.entity_poly&&e.entity_poly.type.isDefined){let{entity_id:a,type:c,_rowCount:u}=e.entity_poly;for(let l=0;l<u;++l){let m=a.value(l);r[n(m)]=c.value(l),i.add(m)}}else o=!0;if(e.pdbx_entity_branch&&e.pdbx_entity_branch.entity_id.isDefined){let{entity_id:a,type:c,_rowCount:u}=e.pdbx_entity_branch;for(let l=0;l<u;++l){let m=a.value(l);r[n(m)]=c.value(l),i.add(m)}}else o=!0;if(i.size<r.length&&(o=!0),o){let a=new Map;if(e.chem_comp){let{id:c,type:u}=e.chem_comp;for(let l=0,m=e.chem_comp._rowCount;l<m;l++)a.set(c.value(l),u.value(l))}if(e.atom_site){let{label_entity_id:c,label_comp_id:u}=e.atom_site;for(let l=0,m=e.atom_site._rowCount;l<m;l++){let f=c.value(l);if(!i.has(f)){let d=u.value(l),p=a.get(d)||"other";r[n(f)]=Fd(d,p),i.add(f)}}}}let s=me.ofArray({array:r,schema:i1});return{data:t,subtype:s,getEntityIndex:n}}function Pu(e,t,n){var r;if(!e.pdbx_molecule||!e.pdbx_molecule.prd_id.isDefined)return t;let i=new Array(t.data._rowCount);i.fill("");let{asym_id:o,prd_id:s,_rowCount:a}=e.pdbx_molecule;for(let u=0;u<a;++u){let l=o.value(u),m=(r=n.get(l))===null||r===void 0?void 0:r.entity_id;m!==void 0&&(i[t.getEntityIndex(m)]=s.value(u))}let c=me.ofArray({array:i,schema:me.Schema.str});return Ct(Le({},t),{prd_id:c})}function ko(e,t,n){return Ve(this,null,function*(){let r=Yx(e,t),i=e.ihm_model_list._rowCount>0?yield $x(n,e,r,t):yield Xx(n,e,r,t);for(let o=0;o<i.length;o++)Tt.TrajectoryInfo.set(i[o],{index:o,size:i.length});return new vr(i)})}function Yx(e,t){return{missingResidues:e1(e),chemicalComponentMap:t1(e),saccharideComponentMap:n1(e)}}function Zx(e,t,n,r,i,o,s){let a=pu(t,n,r,i.chemicalComponentMap,o,s),c=t.pdbx_PDB_model_num.value(0);if(s&&a.sameAsPrevious)return Ct(Le({},s),{id:Rt.create22(),modelNum:c,atomicConformation:a.conformation,_dynamicPropertyData:Object.create(null)});let u=yu,l=Cu(e,r,a.hierarchy,u.hierarchy),m=Iu(a.hierarchy,r,a.conformation,l),f=wu(a.hierarchy),d=e.entry.id.valueKind(0)===0?e.entry.id.value(0):o.name,p=[];return d&&p.push(d),e.struct.title.valueKind(0)===0&&p.push(e.struct.title.value(0)),{id:Rt.create22(),entryId:d,label:p.join(" | "),entry:d,sourceData:o,modelNum:c,parent:void 0,entities:Pu(e,r,f),sequence:l,atomicHierarchy:a.hierarchy,atomicConformation:a.conformation,atomicRanges:m,atomicChainOperatorMappinng:a.chainOperatorMapping,coarseHierarchy:u.hierarchy,coarseConformation:u.conformation,properties:Ct(Le({},i),{structAsymMap:f}),customProperties:new pr,_staticPropertyData:Object.create(null),_dynamicPropertyData:Object.create(null)}}function Wx(e,t,n,r){let i=pu(t.atom_site,t.atom_site_sourceIndex,t.entities,n.chemicalComponentMap,r),o=$0(t,n.chemicalComponentMap),s=Cu(e,t.entities,i.hierarchy,o.hierarchy),a=Iu(i.hierarchy,t.entities,i.conformation,s),c=e.entry.id.valueKind(0)===0?e.entry.id.value(0):r.name,u=[];c&&u.push(c),e.struct.title.valueKind(0)===0&&u.push(e.struct.title.value(0)),t.model_name&&u.push(t.model_name),t.model_group_name&&u.push(t.model_group_name);let l=wu(i.hierarchy,e);return{id:Rt.create22(),entryId:c,label:u.join(" | "),entry:c,sourceData:r,modelNum:t.model_id,parent:void 0,entities:Pu(e,t.entities,l),sequence:s,atomicHierarchy:i.hierarchy,atomicConformation:i.conformation,atomicRanges:a,atomicChainOperatorMappinng:i.chainOperatorMapping,coarseHierarchy:o.hierarchy,coarseConformation:o.conformation,properties:Ct(Le({},n),{structAsymMap:l}),customProperties:new pr,_staticPropertyData:Object.create(null),_dynamicPropertyData:Object.create(null)}}function o1(e,t){let n=e.rowCount;if(!e.isDefined)return n;let r=t+1;for(;r<n&&e.areValuesEqual(t,r);)r++;return r}function Xx(e,t,n,r){return Ve(this,null,function*(){let i=[];if(t.atom_site){let o=t.atom_site.id.rowCount,s=vu(t),a=0;for(;a<o;){let c=o1(t.atom_site.pdbx_PDB_model_num,a),{atom_site:u,sourceIndex:l}=yield Su(e,t.atom_site,a,c),m=Zx(t,u,l,s,n,r,i.length>0?i[i.length-1]:void 0);i.push(m),a=c}}return i})}function Bu(e,t){let n=new Map,r=e._rowCount,i=0;for(;i<r;){let o=o1(t,i),s=t.value(i);n.set(s,{table:mt.window(e,e._schema,i,o),start:i,end:o}),i=o}return n}function $x(e,t,n,r){return Ve(this,null,function*(){let i=vu(t),o=t.atom_site.ihm_model_id.isDefined?t.atom_site.ihm_model_id:t.atom_site.pdbx_PDB_model_num,s=Bu(t.atom_site,o),a=Bu(t.ihm_sphere_obj_site,t.ihm_sphere_obj_site.model_id),c=Bu(t.ihm_gaussian_obj_site,t.ihm_gaussian_obj_site.model_id),u=[];if(t.ihm_model_list){let{model_id:l,model_name:m}=t.ihm_model_list;for(let f=0;f<t.ihm_model_list._rowCount;f++){let d=l.value(f),p,h;if(s.has(d)){let g=s.get(d),{atom_site:C,sourceIndex:_}=yield Su(e,t.atom_site,g.start,g.end);p=C,h=_}else p=mt.window(t.atom_site,t.atom_site._schema,0,0),h=me.ofIntArray([]);let x={model_id:d,model_name:m.value(f),model_group_name:V0(d,t),entities:i,atom_site:p,atom_site_sourceIndex:h,ihm_sphere_obj_site:a.has(d)?a.get(d).table:mt.window(t.ihm_sphere_obj_site,t.ihm_sphere_obj_site._schema,0,0),ihm_gaussian_obj_site:c.has(d)?c.get(d).table:mt.window(t.ihm_gaussian_obj_site,t.ihm_gaussian_obj_site._schema,0,0)},y=Wx(t,x,n,r);u.push(y)}}return u})}var $r;(function(e){function t(r){let i=r.descriptor.name,o=r.type==="static"?"_staticPropertyData":"_dynamicPropertyData",s=c=>(i in c[o]||(c[o][i]={props:Le({},Et.getDefaultValues(r.getParams(c))),data:Zn.create(void 0)}),c[o][i]),a=(c,u,l)=>{let m=s(c);c[o][i]={props:u,data:Zn.withValue(m.data,l)}};return{label:r.label,descriptor:r.descriptor,isHidden:r.isHidden,getParams:c=>{let u=Et.clone(r.getParams(c));return Et.setDefaultValues(u,s(c).props),u},defaultParams:r.defaultParams,isApplicable:r.isApplicable,attach:(f,d,...p)=>Ve(this,[f,d,...p],function*(c,u,l={},m){m&&u.customProperties.reference(r.descriptor,!0);let h=s(u),x=Et.merge(r.defaultParams,h.props,l);if(h.data.value&&Et.areEqual(r.defaultParams,h.props,x))return;let{value:y,assets:g}=yield r.obtain(c,u,x);u.customProperties.add(r.descriptor),u.customProperties.assets(r.descriptor,g),a(u,x,y)}),ref:(c,u)=>c.customProperties.reference(r.descriptor,u),get:c=>{var u;return(u=s(c))===null||u===void 0?void 0:u.data},set:(c,u={},l)=>{let m=s(c),f=Et.merge(r.defaultParams,m.props,u);Et.areEqual(r.defaultParams,m.props,f)||(a(c,f,l),c.customProperties.assets(r.descriptor))},props:c=>s(c).props}}e.createProvider=t;function n(r,i,o){let s={value:Et.Value(o,{isHidden:!0})};return t({label:Lr(r),descriptor:xn({name:r}),isHidden:!0,type:i,defaultParams:s,getParams:()=>({value:Et.Value(o,{isHidden:!0})}),isApplicable:()=>!0,obtain:(a,c,u)=>Ve(this,null,function*(){return Le(Le({},Et.getDefaultValues(s)),u)})})}e.createSimple=n})($r||($r={}));var Tt;(function(e){function t(O,Q){let K=[],{frames:Z}=Q,se=O.atomicHierarchy.atomSourceIndex,Ce=me.isIdentity(se)?void 0:se.toArray({array:Int32Array}),xe=h(O),H=O.atomicHierarchy.atoms._rowCount;for(let $=0,de=Z.length;$<de;++$){let T=Z[$];if(T.elementCount!==H)throw new Error(`Frame element count mismatch, got ${T.elementCount} but expected ${H}.`);let B=Ct(Le({},O),{id:Rt.create22(),modelNum:$,atomicConformation:as.getAtomicConformation(T,{atomId:O.atomicConformation.atomId,occupancy:O.atomicConformation.occupancy,B_iso_or_equiv:O.atomicConformation.B_iso_or_equiv},Ce),customProperties:new pr,_staticPropertyData:Object.create(null),_dynamicPropertyData:Object.create(null)});if(T.cell){let k=Wt.fromCell(T.cell.size,T.cell.anglesInRadians);Wt.Provider.set(B,k)}e.TrajectoryInfo.set(B,{index:$,size:Z.length}),e.CoarseGrained.set(B,xe),K.push(B)}return{trajectory:K,srcIndexArray:Ce}}function n(O,Q){return new vr(t(O,Q).trajectory)}e.trajectoryFromModelAndCoordinates=n;function r(O,Q){return wt.create("Create Trajectory",K=>Ve(this,null,function*(){let Z=yield ko(O.basic,O.sourceData,K);if(Z.frameCount===0)throw new Error("found no model");let se=Z.representative,{trajectory:fe}=t(se,Q),Ce={pairs:O.bonds,count:se.atomicHierarchy.atoms._rowCount},xe=rn.fromData(Ce),H=h(se),$=0;for(let de of fe)rn.Provider.set(de,xe),e.TrajectoryInfo.set(de,{index:$++,size:fe.length}),e.CoarseGrained.set(de,H);return new vr(fe)}))}e.trajectoryFromTopologyAndCoordinates=r;let i="__Center__";function o(O){if(O._dynamicPropertyData[i])return O._dynamicPropertyData[i];let Q=bf(O.atomicConformation,O.coarseConformation);return O._dynamicPropertyData[i]=Q,Q}e.getCenter=o;function s(O){let Q=new Int32Array(O.rowCount),K=!1;for(let Z=0,se=O.rowCount;Z<se;Z++){let fe=O.value(Z);fe!==Z&&(K=!1),Q[fe]=Z}return{isIdentity:K,invertedIndex:Q}}let a="__InvertedAtomSrcIndex__";function c(O){if(O._staticPropertyData[a])return O._staticPropertyData[a];let Q=s(O.atomicHierarchy.atomSourceIndex);return O._staticPropertyData[a]=Q,Q}e.getInvertedAtomSourceIndex=c;let u="__TrajectoryInfo__";e.TrajectoryInfo={get(O){return O._dynamicPropertyData[u]||{index:0,size:1}},set(O,Q){return O._dynamicPropertyData[u]=Q}};let l="__AsymIdCount__";e.AsymIdCount={get(O){if(O._dynamicPropertyData[l])return O._dynamicPropertyData[l];let Q=Cf(O);return O._dynamicPropertyData[l]=Q,Q}},e.AsymIdOffset=$r.createSimple("asym_id_offset","static"),e.Index=$r.createSimple("index","static"),e.MaxIndex=$r.createSimple("max_index","static");function m(O){return O.parent||O}e.getRoot=m;function f(O,Q){return O.atomicHierarchy===Q.atomicHierarchy&&O.coarseHierarchy===Q.coarseHierarchy}e.areHierarchiesEqual=f;let d="__CoordinatesHistory__";e.CoordinatesHistory={get(O){return O._staticPropertyData[d]},set(O,Q){return O._staticPropertyData[d]=Q}};let p="__CoarseGrained__";e.CoarseGrained={get(O){return O._staticPropertyData[p]},set(O,Q){return O._staticPropertyData[p]=Q}};function h(O){let Q=e.CoarseGrained.get(O);if(Q===void 0){let K=0,{polymerType:Z}=O.atomicHierarchy.derived.residue;for(let H=0;H<Z.length;++H)Z[H]!==0&&(K+=1);let se=!1,fe=!1,{label_atom_id:Ce,_rowCount:xe}=O.atomicHierarchy.atoms;for(let H=0;H<xe;++H){let $=Ce.value(H);if(!se&&$==="BB"&&(se=!0),!fe&&$==="SC1"&&(fe=!0),se&&fe)break}Q=se&&fe||(K&&xe?xe/K<3:!1),e.CoarseGrained.set(O,Q)}return Q}e.isCoarseGrained=h;function x(O){return O.properties.saccharideComponentMap.size>0}e.hasCarbohydrate=x;function y(O){let{subtype:Q}=O.entities;for(let K=0,Z=Q.rowCount;K<Z;++K)if(Q.value(K).startsWith("polypeptide"))return!0;return!1}e.hasProtein=y;function g(O){let{subtype:Q}=O.entities;for(let K=0,Z=Q.rowCount;K<Z;++K){let se=Q.value(K);if(se.endsWith("ribonucleotide hybrid")||se.endsWith("ribonucleotide"))return!0}return!1}e.hasNucleic=g;function C(O){if(!_t.is(O.sourceData))return!1;let{db:Q}=O.sourceData.data;for(let K=0,Z=Q.database_2.database_id.rowCount;K<Z;++K)if(Q.database_2.database_id.value(K)==="pdb")return!0;return!1}e.isFromPdbArchive=C;function _(O){return _t.is(O.sourceData)?O.entryId.match(/^[1-9][a-z0-9]{3,3}$/i)!==null||O.entryId.match(/^pdb_[0-9]{4,4}[1-9][a-z0-9]{3,3}$/i)!==null:!1}e.hasPdbId=_;function b(O){if(_t.is(O.sourceData)){let{db:Q}=O.sourceData.data;return Q.struct_conf.id.isDefined||Q.struct_sheet_range.id.isDefined}else return zn.Provider.isApplicable(O)}e.hasSecondaryStructure=b;let I=N.create(1.5707963,1.5707963,1.5707963),E=N.create(1,1,1);function S(O){var Q;let K=(Q=Wt.Provider.get(O))===null||Q===void 0?void 0:Q.spacegroup;return!!K&&!(K.num===1&&N.equals(K.cell.anglesInRadians,I)&&N.equals(K.cell.size,E))}e.hasCrystalSymmetry=S;function v(O){if(!_t.is(O.sourceData))return!1;let{db:Q}=O.sourceData.data;for(let K=0;K<Q.exptl.method.rowCount;K++)if(Q.exptl.method.value(K).toUpperCase().indexOf("DIFFRACTION")>=0)return!0;return!1}e.isFromXray=v;function P(O){if(!_t.is(O.sourceData))return!1;let{db:Q}=O.sourceData.data;for(let K=0;K<Q.exptl.method.rowCount;K++)if(Q.exptl.method.value(K).toUpperCase().indexOf("MICROSCOPY")>=0)return!0;return!1}e.isFromEm=P;function L(O){if(!_t.is(O.sourceData))return!1;let{db:Q}=O.sourceData.data;for(let K=0;K<Q.exptl.method.rowCount;K++)if(Q.exptl.method.value(K).toUpperCase().indexOf("NMR")>=0)return!0;return!1}e.isFromNmr=L;function w(O){if(!_t.is(O.sourceData)||!v(O))return!1;let{db:Q}=O.sourceData.data,{status_code_sf:K}=Q.pdbx_database_status;return K.isDefined&&K.value(0)==="REL"}e.hasXrayMap=w;function D(O){if(!_t.is(O.sourceData))return!1;let{db:Q}=O.sourceData.data,{db_name:K,content_type:Z}=Q.pdbx_database_related;for(let se=0,fe=Q.pdbx_database_related._rowCount;se<fe;++se)if(K.value(se).toUpperCase()==="EMDB"&&Z.value(se)==="associated EM volume")return!0;return!1}e.hasEmMap=D;function z(O){return _t.is(O.sourceData)?w(O)||D(O):!1}e.hasDensityMap=z;function ie(O){if(!_t.is(O.sourceData))return!1;let{db:Q}=O.sourceData.data;return z(O)||_(O)&&(!Q.exptl.method.isDefined||v(O)&&(!Q.pdbx_database_status.status_code_sf.isDefined||Q.pdbx_database_status.status_code_sf.valueKind(0)===2)||P(O)&&!Q.pdbx_database_related.db_name.isDefined)}e.probablyHasDensityMap=ie})(Tt||(Tt={}));var s1;(function(e){function t(m,f,d){if(!f)return{rowCount:0};if(d&&d[f.id])return d[f.id];let p=f.getElements(m),h={data:p,rowCount:p.elements.length};return d&&(d[f.id]=h),h}e.getCifDataSource=t;function n(m){return new fa(m)}e.fromAtomMap=n;function r(m){return new fa(Eu(m))}e.fromAtomArray=r;let i=m=>m.atomicHierarchy.residueAtomSegments;function o(m){return new eo("residue",m,i,0)}e.fromResidueMap=o;function s(m){return new eo("residue",Eu(m),i,0)}e.fromResidueArray=s;let a=m=>m.atomicHierarchy.chainAtomSegments;function c(m){return new eo("chain",m,a,0)}e.fromChainMap=c;function u(m){return new eo("chain",Eu(m),a,0)}e.fromChainArray=u;function l(m){return new Du(m)}e.fromEntityMap=l})(s1||(s1={}));function Eu(e){let t=new Map;for(let n=0,r=e.length;n<r;n++)t.set(n,e[n]);return t}var eo=class{has(t){return this.map.has(t)}get(t){return this.map.get(t)}getStructureElements(t){let n=t.models;if(n.length!==1)throw new Error("Only works on structures with a single model.");let r=new Set,i=t.unitSymmetryGroups,o=[],s=this.segmentGetter(n[0]);for(let a of i){let c=a.units[0];if(c.kind!==this.kind)continue;let u=We.transientSegments(s,c.elements);for(;u.hasNext;){let l=u.move();!this.has(l.index)||r.has(l.index)||(r.add(l.index),o[o.length]=ht.Location.create(t,c,c.elements[l.start]))}}return o.sort((a,c)=>a.element-c.element),o}getElements(t){let n=this.segmentGetter(t.model).index,r=this.getStructureElements(t);return{elements:r,property:i=>this.get(n[r[i].element])}}constructor(t,n,r,i){this.level=t,this.map=n,this.segmentGetter=r,this.id=Rt.create22(),this.kind=i}},fa=class{has(t){return this.map.has(t)}get(t){return this.map.get(t)}getStructureElements(t){if(t.models.length!==1)throw new Error("Only works on structures with a single model.");let r=new Set,i=t.unitSymmetryGroups,o=[];for(let s of i){let a=s.units[0];if(a.kind!==this.kind)continue;let c=a.elements;for(let u=0,l=c.length;u<l;u++){let m=c[u];!this.has(m)||r.has(m)||(r.add(c[u]),o[o.length]=ht.Location.create(t,a,m))}}return o.sort((s,a)=>s.element-a.element),o}getElements(t){let n=this.getStructureElements(t);return{elements:n,property:r=>this.get(n[r].element)}}constructor(t){this.map=t,this.id=Rt.create22(),this.level="atom",this.kind=0}},Du=class{has(t){return this.map.has(t)}get(t){return this.map.get(t)}getStructureElements(t){let n=t.models;if(n.length!==1)throw new Error("Only works on structures with a single model.");let r=n[0].atomicHierarchy.index,i=new Set,o=t.unitSymmetryGroups,s=[],a=n[0].atomicHierarchy.chainAtomSegments;for(let c of o){let u=c.units[0];if(u.kind!==this.kind)continue;let l=We.transientSegments(a,u.elements);for(;l.hasNext;){let m=l.move(),f=r.getEntityFromChain(m.index);!this.has(f)||i.has(f)||(i.add(f),s[s.length]=ht.Location.create(t,u,u.elements[m.start]))}}return s.sort((c,u)=>c.element-u.element),s}getElements(t){let n=this.getStructureElements(t),r=t.model.atomicHierarchy.chainAtomSegments.index,i=t.model.atomicHierarchy.index;return{elements:n,property:o=>this.get(i.getEntityFromChain(r[n[o].element]))}}constructor(t){this.map=t,this.id=Rt.create22(),this.level="entity",this.kind=0}};var to;(function(e){function t(i,o,s,a){i.indices[i.count]=s,i.units[i.count]=o,i.squaredDistances[i.count]=a,i.count++}e.add=t;function n(){return{count:0,indices:[],units:[],squaredDistances:[]}}e.create=n;function r(i,o){for(let s=0;s<o.count;++s)i.indices[s]=o.indices[s],i.units[s]=o.units[s],i.squaredDistances[s]=o.squaredDistances[s];return i.count=o.count,i}e.copy=r})(to||(to={}));function Qx(){return{result:to.create(),closeUnitsResult:dn.create(),unitGroupResult:dn.create()}}var da=class{findUnitIndices(t,n,r,i){return this.unitLookup.find(t,n,r,i)}find(t,n,r,i,o){return this._find(t,n,r,i,o??this.findContext)}_find(t,n,r,i,o){dn.reset(o.result);let{units:s}=this.structure,a=this.unitLookup.find(t,n,r,i,o.closeUnitsResult);if(a.count===0)return o.result;for(let c=0,u=a.count;c<u;c++){let l=s[a.indices[c]];N.set(this.pivot,t,n,r),l.conformation.operator.isIdentity||N.transformMat4(this.pivot,this.pivot,l.conformation.operator.inverse);let f=l.lookup3d.find(this.pivot[0],this.pivot[1],this.pivot[2],i,o.unitGroupResult);for(let d=0,p=f.count;d<p;d++)to.add(o.result,l,f.indices[d],f.squaredDistances[d])}return o.result}nearest(t,n,r,i=1,o){return this._nearest(t,n,r,i,o??this.findContext)}_nearest(t,n,r,i,o){let s=o.result,a=this.heap;dn.reset(s),a.clear();let{units:c}=this.structure,u=0,l=this.unitLookup.nearest(t,n,r,c.length,d=>(u+=c[d].elements.length)>=i,o.closeUnitsResult);if(l.count===0)return s;let m=0,f=-Number.MAX_VALUE;for(let d=0,p=l.count;d<p;d++){let h=l.squaredDistances[d];if(m>=i&&f<h)break;N.set(this.pivot,t,n,r);let x=c[l.indices[d]];x.conformation.operator.isIdentity||N.transformMat4(this.pivot,this.pivot,x.conformation.operator.inverse);let g=x.lookup3d.nearest(this.pivot[0],this.pivot[1],this.pivot[2],i,void 0,o.unitGroupResult);if(g.count!==0){m+=g.count,f=Math.max(f,g.squaredDistances[g.count-1]);for(let C=0,_=g.count;C<_;C++)a.insert(g.squaredDistances[C],{index:g.indices[C],unit:x})}}if(i===1){let d=a.findMinimum();if(d){let{key:p}=d,{unit:h,index:x}=d.value;to.add(s,h,x,p)}}else for(;!a.isEmpty()&&s.count<i;){let d=a.extractMinimum(),{key:p}=d,{unit:h,index:x}=d.value;to.add(s,h,x,p)}return s}findIntoBuilder(t,n,r,i,o){let{units:s}=this.structure,a=this.unitLookup.find(t,n,r,i);if(a.count!==0)for(let c=0,u=a.count;c<u;c++){let l=s[a.indices[c]];N.set(this.pivot,t,n,r),l.conformation.operator.isIdentity||N.transformMat4(this.pivot,this.pivot,l.conformation.operator.inverse);let f=l.lookup3d.find(this.pivot[0],this.pivot[1],this.pivot[2],i);if(f.count===0)continue;let d=l.elements;o.beginUnit(l.id);for(let p=0,h=f.count;p<h;p++)o.addElement(d[f.indices[p]]);o.commitUnit()}}findIntoBuilderIf(t,n,r,i,o,s){let{units:a}=this.structure,c=this.unitLookup.find(t,n,r,i);if(c.count===0)return;let u=ht.Location.create(this.structure);for(let l=0,m=c.count;l<m;l++){let f=a[c.indices[l]];N.set(this.pivot,t,n,r),f.conformation.operator.isIdentity||N.transformMat4(this.pivot,this.pivot,f.conformation.operator.inverse);let p=f.lookup3d.find(this.pivot[0],this.pivot[1],this.pivot[2],i);if(p.count===0)continue;let h=f.elements;u.unit=f,o.beginUnit(f.id);for(let x=0,y=p.count;x<y;x++)u.element=h[p.indices[x]],s(u)&&o.addElement(u.element);o.commitUnit()}}findIntoBuilderWithRadius(t,n,r,i,o,s,a,c){let{units:u}=this.structure,l=this.unitLookup.find(t,n,r,s);if(l.count===0)return;let m=ht.Location.create(this.structure),f=i+o+s;for(let d=0,p=l.count;d<p;d++){let h=u[l.indices[d]];N.set(this.pivot,t,n,r),h.conformation.operator.isIdentity||N.transformMat4(this.pivot,this.pivot,h.conformation.operator.inverse);let y=h.lookup3d.find(this.pivot[0],this.pivot[1],this.pivot[2],f);if(y.count===0)continue;let g=h.elements;m.unit=h,c.beginUnit(h.id);for(let C=0,_=y.count;C<_;C++){m.element=g[y.indices[C]];let b=a(m);Math.sqrt(y.squaredDistances[C])-i-b>s||c.addElement(g[y.indices[C]])}c.commitUnit()}}check(t,n,r,i){let{units:o}=this.structure,s=this.unitLookup.find(t,n,r,i);if(s.count===0)return!1;for(let a=0,c=s.count;a<c;a++){let u=o[s.indices[a]];if(N.set(this.pivot,t,n,r),u.conformation.operator.isIdentity||N.transformMat4(this.pivot,this.pivot,u.conformation.operator.inverse),u.lookup3d.check(this.pivot[0],this.pivot[1],this.pivot[2],i))return!0}return!1}get boundary(){return this.structure.boundary}constructor(t){this.structure=t,this.pivot=N(),this.heap=new ki,this.findContext=Qx();let{units:n,boundary:r}=t,i=n.length,o=new Float32Array(i),s=new Float32Array(i),a=new Float32Array(i),c=new Float32Array(i),u=N();for(let m=0;m<i;m++){let f=n[m],d=f.boundary.sphere;N.transformMat4(u,d.center,f.conformation.operator.matrix),o[m]=u[0],s[m]=u[1],a[m]=u[2],c[m]=d.radius}let l={x:o,y:s,z:a,radius:c,indices:Ie.ofBounds(0,i)};this.unitLookup=Xn(l,r)}};var ma=class{addToUnit(t,n){let r=this.unitMap.get(t);r?r[r.length]=n:(this.unitMap.set(t,[n]),this.ids[this.ids.length]=t),this.elementCount++}beginUnit(t){this.parentId=t,this.currentUnit=this.currentUnit.length>0?[]:this.currentUnit}addElement(t){this.currentUnit[this.currentUnit.length]=t,this.elementCount++}addElementRange(t,n,r){for(let i=n;i<r;i++)this.currentUnit[this.currentUnit.length]=t[i],this.elementCount++}commitUnit(){this.currentUnit.length!==0&&(this.ids[this.ids.length]=this.parentId,this.unitMap.set(this.parentId,this.currentUnit),this.parentId=-1)}setUnit(t,n){this.ids[this.ids.length]=t,this.unitMap.set(t,n),this.elementCount+=n.length}_getStructure(t){if(this.isEmpty)return ot.Empty;let n=[];jt(this.ids);let r=ur.UnitEquivalenceBuilder();for(let i=0,o=this.ids.length;i<o;i++){let s=this.ids[i],a=this.parent.unitMap.get(s),c=this.unitMap.get(s),u=!1;t&&(this.isSorted||jt(c),c=le.deduplicate(le.ofSortedArray(this.currentUnit)),u=!0);let l=c.length;if(c.length===a.elements.length){n[n.length]=a,r.add(a.id,a);continue}!this.isSorted&&!u&&l>1&&jt(c);let m=a.getChild(le.ofSortedArray(c)),f=r.add(m.id,m);m!==f&&(m=f.applyOperator(m.id,m.conformation.operator,!0)),n[n.length]=m}return ot.create(n,{parent:this.parent})}getStructure(){return this._getStructure(!1)}getStructureDeduplicate(){return this._getStructure(!0)}setSingletonLocation(t){let n=this.ids[0];t.unit=this.parent.unitMap.get(n),t.element=this.unitMap.get(n)[0]}get isEmpty(){return this.elementCount===0}constructor(t,n){this.parent=t,this.isSorted=n,this.ids=[],this.unitMap=yn.Mutable(),this.parentId=-1,this.currentUnit=[],this.elementCount=0}};function a1(e,t){let n=1;for(;t--;)n*=e--;return n}function Jx(e,t){return t>e?0:a1(e,t)/a1(t,t)}function e3(e){let t=e&-e,n=e+t,i=((n&-n)/t>>1)-1;return n|i}var Mu=class{move(){if(this.hasNext){let t=0,n=0,r=this.index;for(;r;r>>>=1,t++)r&1&&(this.value[n++]=this.array[t]);this.index=e3(this.index),this.hasNext=this.index<this.maxIndex}return this.value}constructor(t,n){this.array=t,this.hasNext=!1,this.index=(1<<n)-1,this.size=Jx(t.length,n),this.maxIndex=1<<t.length,this.value=new Array(n),this.hasNext=n>0&&n<=t.length}};function Nu(e,t){let n=[],r=new Mu(e,t);for(;r.hasNext;)n.push(r.move().slice());return n}var Ai=[],c1={links:Ai,terminalLinks:Ai,elements:Ai,partialElements:Ai,getElementIndices:()=>Ai,getLinkIndices:()=>Ai,getTerminalLinkIndices:()=>Ai};var Yt=yr("C"),Ro=yr("O"),t3=[kn.elementFingerprint([Yt,Yt,Yt,Ro]),kn.elementFingerprint([Yt,Yt,Yt,Yt,Ro]),kn.elementFingerprint([Yt,Yt,Yt,Yt,Yt,Ro]),kn.elementFingerprint([Yt,Yt,Yt,Yt,Yt,Yt,Ro])];function n3(e,t){let n=-1,r=-1,i=-1,o=-1,{elements:s}=e,{type_symbol:a,label_atom_id:c}=e.model.atomicHierarchy.atoms,{b:u,offset:l}=e.bonds;for(let m=0,f=t.length;m<f;++m){let d=s[t[m]];if(a.value(d)!==Yt)continue;let p=0,h=0;for(let x=l[t[m]],y=l[t[m]+1];x<y;++x){let g=s[u[x]],C=a.value(g);C===Ro?++p:C===Yt&&++h}if(p===2){n=d;break}else p===1&&h===1?r=d:c.value(d).startsWith("C1")?i=d:o=d}return n!==-1?n:r!==-1?r:i!==-1?i:o!==-1?o:s[t[0]]}function r3(e,t){let{elements:n}=e,{label_alt_id:r}=e.model.atomicHierarchy.atoms;return r.value(n[t])}function i3(e,t,n,r){let i=t.conformation;return N.normalize(e,N.sub(e,r,i.position(n,e))),e}function u1(e,t){let{elements:n}=e,{label_atom_id:r}=e.model.atomicHierarchy.atoms;return r.value(n[t])}function o3(e,t){if(!t||!t.length)return;let{unit:n,all:r}=e,i=new Set,o=Nu(Ya(new Array(t.length)),2);for(let s=0,a=o.length;s<a;++s){let c=o[s],u=r[t[c[0]]],l=r[t[c[1]]];le.areIntersecting(u,l)&&kn.getAltId(n,u)===kn.getAltId(n,l)&&(i.add(t[c[0]]),i.add(t[c[1]]))}if(i.size){let s=[];for(let a=0,c=t.length;a<c;++a)i.has(t[a])||s.push(t[a]);return s}else return t}function s3(e,t){return t.properties.saccharideComponentMap.get(e)}function l1(e){if(e.models.reduce((f,d)=>f+d.properties.saccharideComponentMap.size,0)===0)return c1;let t=[],n=[],r=[],i=[],o=new Map;function s(f,d,p){return`${f}|${d}|${p}`}function a(f,d){o.has(f)?o.get(f).push(d):o.set(f,[d])}function c(f,d){N.sub(r[f].geometry.direction,r[d].geometry.center,r[f].geometry.center),N.normalize(r[f].geometry.direction,r[f].geometry.direction)}let u=N();function l(f,d,p){let h=p.conformation,x=r[f].geometry;N.sub(x.direction,h.position(p.elements[d],u),x.center),N.normalize(x.direction,x.direction)}for(let f=0,d=e.units.length;f<d;++f){let p=e.units[f];if(!ge.isAtomic(p))continue;let{model:h,rings:x}=p,{chainAtomSegments:y,residueAtomSegments:g,atoms:C}=h.atomicHierarchy,{label_comp_id:_}=C,b=We.transientSegments(y,p.elements),I=We.transientSegments(g,p.elements),E;for(;b.hasNext;)for(I.setSegment(b.move());I.hasNext;){let{index:S}=I.move(),v=s3(_.value(g.offsets[S]),h);if(!v)continue;E||(E=Kr.byFingerprintAndResidue(x,t3));let P=o3(x,E.get(S));if(!P||!P.length){i.push({unit:p,residueIndex:S,component:v});continue}let L=[];for(let D=0,z=P.length;D<z;++D){let ie=x.all[P[D]],O=n3(p,ie),Q=mn.calculateMomentsAxes(Ns(p,ie)),K=mn.calculateNormalizedAxes(Q),Z=N.copy(N(),K.origin),se=N.copy(N(),K.dirC),fe=i3(N(),p,O,Z);N.orthogonalize(fe,se,fe);let Ce=kn.getAltId(p,ie),xe=r.length;L.push(xe),a(s(S,p.id,Ce),xe),Ce&&a(s(S,p.id,""),xe),r.push({geometry:{center:Z,normal:se,direction:fe},component:v,ringIndex:P[D],altId:Ce,unit:p,residueIndex:S})}let w=Nu(Ya(new Array(P.length)),2);for(let D=0,z=w.length;D<z;++D){let ie=w[D],O=x.all[P[ie[0]]],Q=x.all[P[ie[1]]];if(Jt.areVertexSetsConnected(p.bonds,O,Q,3)){let K=L[ie[0]],Z=L[ie[1]];r[K].altId===r[Z].altId&&(c(K,Z),c(Z,K),t.push({carbohydrateIndexA:K,carbohydrateIndexB:Z}),t.push({carbohydrateIndexA:Z,carbohydrateIndexB:K}))}}}}function m(f,d){return o.get(s(f.getResidueIndex(d),f.id,r3(f,d)))||[]}for(let f=0,d=r.length;f<d;++f){let p=r[f],{unit:h}=p;for(let x=f+1;x<d;++x){let y=r[x];if(h!==y.unit||p.residueIndex===y.residueIndex)continue;let g=h.rings.all[p.ringIndex],C=h.rings.all[y.ringIndex];Jt.areVertexSetsConnected(h.bonds,g,C,3)&&(c(f,x),c(x,f),t.push({carbohydrateIndexA:f,carbohydrateIndexB:x}),t.push({carbohydrateIndexA:x,carbohydrateIndexB:f}))}}for(let f=0,d=e.units.length;f<d;++f){let p=e.units[f];ge.isAtomic(p)&&e.interUnitBonds.getConnectedUnits(p.id).forEach(h=>{h.connectedIndices.forEach(x=>{h.getEdges(x).forEach(({props:y,indexB:g})=>{if(!$t.isCovalent(y.flag))return;let C=e.unitMap.get(h.unitA),_=e.unitMap.get(h.unitB),b=m(C,x),I=m(_,g);if(b.length>0&&I.length>0){let E=b.length,S=I.length;for(let v=0,P=Math.max(E,S);v<P;++v){let L=b[Math.min(v,E-1)],w=I[Math.min(v,S-1)],D=u1(C,x);(D.startsWith("O1")||D.startsWith("C1"))&&c(L,w),t.push({carbohydrateIndexA:L,carbohydrateIndexB:w})}}else if(I.length===0)for(let E of b){let S=u1(C,x);(S.startsWith("O1")||S.startsWith("C1"))&&l(E,g,_),n.push({carbohydrateIndex:E,elementIndex:g,elementUnit:_,fromCarbohydrate:!0})}else if(b.length===0)for(let E of I)n.push({carbohydrateIndex:E,elementIndex:x,elementUnit:C,fromCarbohydrate:!1})})})})}return Le({links:t,terminalLinks:n,elements:r,partialElements:i},a3(r,t,n))}function a3(e,t,n){function r(m,f){return jn(m.id,f)}function i(m,f,d){let p=[],h=m.get(r(f,d));if(h!==void 0)for(let x of h)Tr(p,x);return p}let o=new Map;for(let m=0,f=e.length;m<f;++m){let{unit:d,ringIndex:p}=e[m],h=d.rings.all[p];for(let x=0,y=h.length;x<y;++x){let g=r(d,d.elements[h[x]]),C=o.get(g);C===void 0?o.set(g,[m]):C.push(m)}}function s(m,f){return i(o,m,f)}let a=new Map;for(let m=0,f=t.length;m<f;++m){let d=t[m],{unit:p,ringIndex:h}=e[d.carbohydrateIndexA],x=p.rings.all[h];for(let y=0,g=x.length;y<g;++y){let C=r(p,p.elements[x[y]]),_=a.get(C);_===void 0?a.set(C,[m]):_.push(m)}}function c(m,f){return i(a,m,f)}let u=new Map;for(let m=0,f=n.length;m<f;++m){let{fromCarbohydrate:d,carbohydrateIndex:p,elementUnit:h,elementIndex:x}=n[m];if(d){let{unit:y,ringIndex:g}=e[p],C=y.rings.all[g];for(let _=0,b=C.length;_<b;++_){let I=r(y,y.elements[C[_]]),E=u.get(I);E===void 0?u.set(I,[m]):E.push(m)}}else{let y=r(h,h.elements[x]),g=u.get(y);g===void 0?u.set(y,[m]):g.push(m)}}function l(m,f){return i(u,m,f)}return{getElementIndices:s,getLinkIndices:c,getTerminalLinkIndices:l}}var pa=Kt(),c3=new ir("14"),u3=new ir("98");function l3(e){return e>500?c3:u3}function f1(e){let{units:t}=e,n=l3(t.length);n.reset();for(let r=0,i=t.length;r<i;r++){let o=t[r],s=o.boundary,a=o.conformation.operator;a.isIdentity?n.includeSphere(s.sphere):(Kt.transform(pa,s.sphere,a.matrix),n.includeSphere(pa))}n.finishedIncludeStep();for(let r=0,i=t.length;r<i;r++){let o=t[r],s=o.boundary,a=o.conformation.operator;a.isIdentity?n.radiusSphere(s.sphere):(Kt.transform(pa,s.sphere,a.matrix),n.radiusSphere(pa))}return{box:n.getBox(),sphere:n.getSphere()}}var ot=class e{subsetBuilder(t){return new ma(this,t)}get elementCount(){return this.state.elementCount}get bondCount(){return this.state.bondCount===-1&&(this.state.bondCount=this.interUnitBonds.edgeCount+vo.getIntraUnitBondCount(this)),this.state.bondCount}get hasCustomProperties(){return!!this.state.customProps&&this.state.customProps.all.length>0}get customPropertyDescriptors(){return this.state.customProps||(this.state.customProps=new pr),this.state.customProps}get currentPropertyData(){return this.state.propertyData||(this.state.propertyData=Object.create(null)),this.state.propertyData}get inheritedPropertyData(){return this.parent?this.parent.currentPropertyData:this.currentPropertyData}get polymerResidueCount(){return this.state.polymerResidueCount===-1&&(this.state.polymerResidueCount=y3(this)),this.state.polymerResidueCount}get polymerGapCount(){return this.state.polymerGapCount===-1&&(this.state.polymerGapCount=x3(this)),this.state.polymerGapCount}get polymerUnitCount(){return this.state.polymerUnitCount===-1&&(this.state.polymerUnitCount=A3(this)),this.state.polymerUnitCount}get uniqueElementCount(){return this.state.uniqueElementCount===-1&&(this.state.uniqueElementCount=g3(this)),this.state.uniqueElementCount}get atomicResidueCount(){return this.state.atomicResidueCount===-1&&(this.state.atomicResidueCount=b3(this)),this.state.atomicResidueCount}get isCoarseGrained(){return this.models.some(t=>Tt.isCoarseGrained(t))}get isEmpty(){return this.units.length===0}get hashCode(){return this.state.hashCode!==-1?this.state.hashCode:this.computeHash()}get transformHash(){return this.state.transformHash!==-1?this.state.transformHash:(this.state.transformHash=Yn(this.units.map(t=>t.id)),this.state.transformHash)}computeHash(){let t=23;for(let n=0,r=this.units.length;n<r;n++){let i=this.units[n];t=31*t+i.id|0,t=31*t+le.hashCode(i.elements)|0}return t=31*t+this.elementCount|0,t=Zu(t),t===-1&&(t=0),this.state.hashCode=t,t}elementLocations(){return new e.ElementLocationIterator(this)}get root(){var t;return(t=this.state.parent)!==null&&t!==void 0?t:this}get parent(){return this.state.parent}get coordinateSystem(){return this.state.coordinateSystem}get label(){return this.state.label}get boundary(){return this.state.boundary?this.state.boundary:(this.state.boundary=f1(this),this.state.boundary)}get lookup3d(){return this.state.lookup3d?this.state.lookup3d:(this.state.lookup3d=new da(this),this.state.lookup3d)}get interUnitBonds(){return this.state.interUnitBonds?this.state.interUnitBonds:(this.parent&&this.state.dynamicBonds===this.parent.state.dynamicBonds&&this.parent.state.interUnitBonds&&this.parent.state.interUnitBonds.edgeCount===0?this.state.interUnitBonds=new Sr(new Map):this.state.interUnitBonds=_m(this,{ignoreWater:!this.dynamicBonds,ignoreIon:!this.dynamicBonds,validUnit:this.state.interBondsValidUnit,validUnitPair:this.state.interBondsValidUnitPair}),this.state.interUnitBonds)}get dynamicBonds(){return this.state.dynamicBonds}get interBondsValidUnit(){return this.state.interBondsValidUnit}get interBondsValidUnitPair(){return this.state.interBondsValidUnitPair}get unitSymmetryGroups(){return this.state.unitSymmetryGroups?this.state.unitSymmetryGroups:(this.state.unitSymmetryGroups=ur.computeTransformGroups(this),this.state.unitSymmetryGroups)}get unitSymmetryGroupsIndexMap(){return this.state.unitSymmetryGroupsIndexMap?this.state.unitSymmetryGroupsIndexMap:(this.state.unitSymmetryGroupsIndexMap=ge.SymmetryGroup.getUnitSymmetryGroupsIndexMap(this.unitSymmetryGroups),this.state.unitSymmetryGroupsIndexMap)}get carbohydrates(){return this.state.carbohydrates?this.state.carbohydrates:(this.state.carbohydrates=l1(this),this.state.carbohydrates)}get models(){return this.state.models?this.state.models:(this.state.models=d3(this),this.state.models)}get uniqueResidueNames(){return this.state.uniqueResidueNames||(this.state.uniqueResidueNames=m3(this))}get uniqueElementSymbols(){return this.state.uniqueElementSymbols||(this.state.uniqueElementSymbols=p3(this))}get entityIndices(){return this.state.entityIndices||(this.state.entityIndices=h3(this))}get uniqueAtomicResidueIndices(){return this.state.uniqueAtomicResidueIndices||(this.state.uniqueAtomicResidueIndices=_3(this))}get isAtomic(){for(let t of this.units)if(!ge.isAtomic(t))return!1;return!0}get hasAtomic(){for(let t of this.units)if(ge.isAtomic(t))return!0;return!1}get isCoarse(){for(let t of this.units)if(!ge.isCoarse(t))return!1;return!0}get hasCoarse(){for(let t of this.units)if(ge.isCoarse(t))return!0;return!1}get serialMapping(){return this.state.serialMapping||(this.state.serialMapping=C3(this))}get model(){if(this.state.model)return this.state.model;if(this.state.representativeModel)return this.state.representativeModel;if(this.state.masterModel)return this.state.masterModel;let t=this.models;if(t.length>1)throw new Error("The structure is based on multiple models and has neither a master- nor a representative-model.");return this.state.model=t[0],this.state.model}get masterModel(){return this.state.masterModel}get representativeModel(){return this.state.representativeModel}hasElement(t){return this.unitMap.has(t.unit.id)?le.has(this.unitMap.get(t.unit.id).elements,t.element):!1}getModelIndex(t){return this.models.indexOf(t)}remapModel(t){let{dynamicBonds:n,interUnitBonds:r,parent:i}=this.state,o=[];for(let s of this.unitSymmetryGroups){let a=s.units[0].remapModel(t,n);o.push(a);for(let c=1,u=s.units.length;c<u;++c){let l=s.units[c];o.push(l.remapModel(t,n,a.props))}}return e.create(o,{parent:i?.remapModel(t),label:this.label,interUnitBonds:n?void 0:r,dynamicBonds:n,interBondsValidUnit:this.state.interBondsValidUnit,interBondsValidUnitPair:this.state.interBondsValidUnitPair,coordinateSystem:this.state.coordinateSystem,masterModel:this.state.masterModel,representativeModel:this.state.representativeModel})}asParent(){if(this._proxy)return this._proxy;if(this.parent){let t=this.parent.coordinateSystem.isIdentity?this.parent:e.transform(this.parent,this.parent.coordinateSystem.inverse),n=this.coordinateSystem.isIdentity?t:e.transform(t,this.coordinateSystem.matrix);this._proxy=new e(n.units,n.unitMap,n.unitIndexMap,Ct(Le({},n.state),{dynamicBonds:this.dynamicBonds}),{child:this,target:this.parent})}else this._proxy=this;return this._proxy}get child(){return this._child}get target(){var t;return(t=this._target)!==null&&t!==void 0?t:this}constructor(t,n,r,i,o){this.units=t,this.unitMap=n,this.unitIndexMap=r,this.state=i,this._child=o?.child,this._target=o?.target,this._proxy=void 0}};function f3(e,t,n){return e[t].id-e[n].id}function d3(e){let{units:t}=e,n=It.create();for(let r of t)It.add(n,r.model.id,r.model);return n.array}function m3(e){let{microheterogeneityCompIds:t}=Ye.residue,n=new Set,r=ht.Location.create(e);for(let i of e.unitSymmetryGroups){let o=i.units[0];if(!ge.isAtomic(o))continue;let s=We.transientSegments(o.model.atomicHierarchy.residueAtomSegments,o.elements);for(r.unit=o;s.hasNext;){let a=s.move();r.element=o.elements[a.start];let c=t(r);for(let u of c)n.add(u)}}return n}function p3(e){let t=Ye.atom.type_symbol,n=new Set,r=ht.Location.create(e);for(let i of e.unitSymmetryGroups){let o=i.units[0];if(ge.isAtomic(o)){r.unit=o;for(let s=0,a=o.elements.length;s<a;++s)r.element=o.elements[s],n.add(t(r))}}return n}function h3(e){let{units:t}=e,n=ht.Location.create(e),r=It.create();for(let i of t){let o=i.kind===0?Ye.entity.key:Ye.coarse.entityKey;n.unit=i;let s=i.elements,a=We.transientSegments(i.model.atomicHierarchy.chainAtomSegments,s);for(;a.hasNext;){let c=a.move();n.element=s[c.start];let u=o(n);It.add(r,u,u)}}return jt(r.array),r.array}function _3(e){let t=new Map,n=[],r=e.unitSymmetryGroups;for(let o of r){let s=o.units[0];if(!ge.isAtomic(s))continue;let a;t.has(s.model.id)?a=t.get(s.model.id):(a=It.create(),n.push(s.model.id),t.set(s.model.id,a));let c=We.transientSegments(s.model.atomicHierarchy.residueAtomSegments,s.elements);for(;c.hasNext;){let u=c.move();It.add(a,u.index,u.index)}}let i=new Map;for(let o of n){let s=t.get(o).array;jt(s),i.set(o,s)}return i}function g3(e){let{unitSymmetryGroups:t}=e,n=0;for(let r=0,i=t.length;r<i;r++)n+=t[r].elements.length;return n}function y3(e){let{units:t}=e,n=0;for(let r=0,i=t.length;r<i;r++)n+=t[r].polymerElements.length;return n}function x3(e){let{units:t}=e,n=0;for(let r=0,i=t.length;r<i;r++)n+=t[r].gapElements.length/2;return n}function A3(e){let{units:t}=e,n=0;for(let r=0,i=t.length;r<i;r++)t[r].polymerElements.length>0&&(n+=1);return n}function b3(e){let{units:t}=e,n=0;for(let r=0,i=t.length;r<i;r++){let o=t[r];if(!ge.isAtomic(o))continue;let{elements:s,residueIndex:a}=o,c=-1,u=-1;for(let l=0,m=s.length;l<m;++l)c=a[s[l]],c!==u&&(n+=1,u=c)}return n}function C3(e){let{units:t,elementCount:n,unitIndexMap:r}=e,i=new Uint32Array(t.length),o=new Uint32Array(n),s=new Uint32Array(n);for(let a=0,c=0,u=t.length;a<u;++a){i[a]=c;let{elements:l}=t[a];for(let m=0,f=l.length;m<f;++m){let d=c+m;o[d]=a,s[d]=l[m]}c+=l.length}return{cumulativeUnitElementCount:i,unitIndices:o,elementIndices:s,getSerialIndex:(a,c)=>i[r.get(a.id)]+Ie.indexOf(a.elements,c)}}(function(e){e.Empty=c([]);function t(k){return{kind:"structure-loci",structure:k}}e.Loci=t;function n(k){let R=[];for(let V of k.units)R.push({unit:V,indices:ue.ofBounds(0,V.elements.length)});return ht.Loci(k,R)}e.toStructureElementLoci=n;function r(k,R){return Be.toLociWithSourceUnits(Be.Singletons(k,R))}e.toSubStructureElementLoci=r;function i(k){return!!k&&k.kind==="structure-loci"}e.isLoci=i;function o(k,R){return k.structure===R.structure}e.areLociEqual=o;function s(k){return k.structure.isEmpty}e.isLociEmpty=s;function a(k,R){return R===k.structure?k:t(R)}e.remapLoci=a;function c(k,R={}){let V=yn.Mutable(),j=yn.Mutable(),oe=0,ae=!0,ne=k.length>0?k[0].id:0;for(let F=0,W=k.length;F<W;F++){let re=k[F];V.set(re.id,re),oe+=re.elements.length,re.id<ne&&(ae=!1),ne=re.id}ae||jo(k,0,k.length,f3,lr);for(let F=0,W=k.length;F<W;F++)j.set(k[F].id,F);let q={hashCode:-1,transformHash:-1,elementCount:oe,bondCount:-1,uniqueElementCount:-1,atomicResidueCount:-1,polymerResidueCount:-1,polymerGapCount:-1,polymerUnitCount:-1,dynamicBonds:!1,coordinateSystem:xt.Default,label:""};return R.parent&&(q.parent=R.parent.parent||R.parent),R.interUnitBonds&&(q.interUnitBonds=R.interUnitBonds),R.interBondsValidUnit?q.interBondsValidUnit=R.interBondsValidUnit:R.parent&&(q.interBondsValidUnit=R.parent.interBondsValidUnit),R.interBondsValidUnitPair?q.interBondsValidUnitPair=R.interBondsValidUnitPair:R.parent&&(q.interBondsValidUnitPair=R.parent.interBondsValidUnitPair),R.dynamicBonds?q.dynamicBonds=R.dynamicBonds:R.parent&&(q.dynamicBonds=R.parent.dynamicBonds),R.coordinateSystem?q.coordinateSystem=R.coordinateSystem:R.parent&&(q.coordinateSystem=R.parent.coordinateSystem),R.label?q.label=R.label:R.parent&&(q.label=R.parent.label),R.masterModel?q.masterModel=R.masterModel:R.parent&&(q.masterModel=R.parent.masterModel),R.representativeModel?q.representativeModel=R.representativeModel:R.parent&&(q.representativeModel=R.parent.representativeModel),new e(k,V,j,q)}e.create=c;function u(k,R){return Ve(this,null,function*(){if(k.frameCount===0)return e.Empty;let V=[],j,oe=0;for(let ae=0,ne=k.frameCount;ae<ne;++ae){let q=yield wt.resolveInContext(k.getFrameAtIndex(ae),R);j||(j=q);let F=m(q);for(let W=0,re=F.units.length;W<re;++W){let _e=F.units[W],Ae=_e.invariantId+oe,Ze=_e.chainGroupId+oe,A=ge.create(V.length,Ae,Ze,_e.traits,_e.kind,_e.model,_e.conformation.operator,_e.elements);V.push(A)}oe=V.length}return c(V,{representativeModel:j,label:j.label})})}e.ofTrajectory=u;let l=!1;function m(k,R={}){let V=k.atomicHierarchy.chainAtomSegments,{index:j}=k.atomicHierarchy,{auth_asym_id:oe}=k.atomicHierarchy.chains,{atomicChainOperatorMappinng:ae}=k,ne=new g(Le({label:k.label},R));for(let F=0;F<V.count;F++){let W=ae.get(F)||xt.Default,re=V.offsets[F],_e=$n.chainResidueCount(k.atomicHierarchy,F)===V.offsets[F+1]-V.offsets[F],Ae=!1;if(f(k,F))for(;F+1<V.count&&f(k,F+1);){let A=ae.get(F),M=ae.get(F+1);if(A!==M)break;Ae=!0,F++}else for(;F+1<V.count&&V.offsets[F+1]-V.offsets[F]===1&&V.offsets[F+2]-V.offsets[F+1]===1;){_e=!0;let A=j.getEntityFromChain(F),M=j.getEntityFromChain(F+1);if(A!==M)break;let te=oe.value(F),ce=oe.value(F+1);if(te!==ce)break;let pe=ae.get(F),he=ae.get(F+1);if(pe!==he)break;Ae=!0,F++}let Ze=le.ofBounds(re,V.offsets[F+1]);l?_e&&!d(k,F)?p(k,Ze,ne,Ae,W):Ze.length>2e5||f(k,F)?h(k,Ze,ne,Ae,W):ne.addUnit(0,k,W,Ze,Ae?ge.Trait.MultiChain:ge.Trait.None):ne.addUnit(0,k,W,Ze,Ae?ge.Trait.MultiChain:ge.Trait.None)}let q=k.coarseHierarchy;return q.isDefined&&(q.spheres.count>0&&x(ne,k,k.coarseHierarchy.spheres,1),q.gaussians.count>0&&x(ne,k,k.coarseHierarchy.gaussians,2)),ne.getStructure()}e.ofModel=m;function f(k,R){let V=k.atomicHierarchy.index.getEntityFromChain(R);return k.entities.data.type.value(V)==="water"}function d(k,R){let V=k.atomicHierarchy.index.getEntityFromChain(R);return k.entities.data.type.value(V)==="polymer"}function p(k,R,V,j,oe){let{x:ae,y:ne,z:q}=k.atomicConformation,F={x:ae,y:ne,z:q,indices:R},W=Xn(F,jr(F),8192),{offset:re,count:_e,array:Ae}=W.buckets,Ze=(j?ge.Trait.MultiChain:ge.Trait.None)|(re.length>1?ge.Trait.Partitioned:ge.Trait.None);V.beginChainGroup();for(let A=0,M=re.length;A<M;A++){let te=re[A],ce=new Int32Array(_e[A]);for(let pe=0,he=_e[A];pe<he;pe++)ce[pe]=R[Ae[te+pe]];V.addUnit(0,k,oe,le.ofSortedArray(ce),Ze)}V.endChainGroup()}function h(k,R,V,j,oe){let{residueAtomSegments:ae}=k.atomicHierarchy,ne=[],q=[],F=We.transientSegments(ae,R);for(;F.hasNext;){let Se=F.move();ne[ne.length]=R[Se.start],q[q.length]=R[Se.end]}let re=512*(q[0]-ne[0]),{x:_e,y:Ae,z:Ze}=k.atomicConformation,A={x:_e,y:Ae,z:Ze,indices:le.ofSortedArray(ne)},M=Xn(A,jr(A),re),{offset:te,count:ce,array:pe}=M.buckets,he=(j?ge.Trait.MultiChain:ge.Trait.None)|(te.length>1?ge.Trait.Partitioned:ge.Trait.None);V.beginChainGroup();for(let Se=0,Ee=te.length;Se<Ee;Se++){let Ne=te[Se],Pe=[];for(let ve=0,Fe=ce[Se];ve<Fe;ve++){let Oe=pe[Ne+ve];for(let Me=ne[Oe],He=q[Oe];Me<He;Me++)Pe[Pe.length]=Me}V.addUnit(0,k,oe,le.ofSortedArray(new Int32Array(Pe)),he)}V.endChainGroup()}function x(k,R,V,j){let{chainElementSegments:oe}=V;for(let ae=0;ae<oe.count;ae++){let ne=le.ofBounds(oe.offsets[ae],oe.offsets[ae+1]);k.addUnit(j,R,xt.Default,ne,ge.Trait.None)}}function y(k,R){if(ke.isIdentity(R))return k;if(!ke.isRotationAndTranslation(R,xt.RotationTranslationEpsilon))throw new Error("Only rotation/translation combination can be applied.");let V=[];for(let ae of k.units){let ne=ae.conformation.operator,q=xt.create(ne.name,R,ne);V.push(ae.applyOperator(ae.id,q))}let j=k.coordinateSystem,oe=xt.compose(xt.create(j.name,R,j),j);return c(V,{parent:k,coordinateSystem:oe})}e.transform=y;class g{beginChainGroup(){this.chainGroupId++,this.inChainGroup=!0}endChainGroup(){this.inChainGroup=!1}addUnit(R,V,j,oe,ae,ne){ne===void 0&&(ne=this.invariantId());let q=this.inChainGroup?this.chainGroupId:++this.chainGroupId,F=ge.create(this.units.length,ne,q,ae,R,V,j,oe);return this.add(F)}add(R){if(R.elements.length===1){R.conformation.position(R.elements[0],this.p);let V=[R.invariantId,this.p[0],this.p[1],this.p[2]].join("|");if(this.singleElementUnits.has(V))return this.singleElementUnits.get(V);this.singleElementUnits.set(V,R)}return this.units.push(R),R}addWithOperator(R,V,j=!1){return this.add(R.applyOperator(this.units.length,V,j))}getStructure(){return c(this.units,this.props)}get isEmpty(){return this.units.length===0}constructor(R={}){this.props=R,this.units=[],this.invariantId=Pi(),this.chainGroupId=-1,this.inChainGroup=!1,this.p=N(),this.singleElementUnits=new Map}}e.StructureBuilder=g;function C(k={}){return new g(k)}e.Builder=C;function _(k){return k.hashCode}e.hashCode=_;function b(k){return $u(k.units.map(R=>ge.conformationId(R)).join("|"))}e.conformationHash=b;function I(k,R){if(k===R)return!0;if(k.elementCount!==R.elementCount)return!1;let V=k.units.length;if(V!==R.units.length)return!1;for(let j=0;j<V;j++)if(k.units[j].id!==R.units[j].id)return!1;return!0}e.areUnitIdsEqual=I;function E(k,R){if(k===R)return!0;if(!I(k,R))return!1;for(let V=0,j=k.units.length;V<j;V++)if(!le.areEqual(k.units[V].elements,R.units[V].elements))return!1;return!0}e.areUnitIdsAndIndicesEqual=E;function S(k,R){if(k.hashCode!==R.hashCode)return!1;let V=k.models.length;if(V!==R.models.length)return!1;for(let j=0;j<V;j++)if(!Tt.areHierarchiesEqual(k.models[j],R.models[j]))return!1;return!0}e.areHierarchiesEqual=S;function v(k,R){return k===R||k.hashCode===R.hashCode&&ur.areTransformGroupsEquivalent(k.unitSymmetryGroups,R.unitSymmetryGroups)}e.areEquivalent=v;function P(k,R){return v(k.root,R.root)}e.areRootsEquivalent=P;function L(k,R){return k.root===R.root}e.areRootsEqual=L;class w{move(){return this.advance(),this.current.element=this.elements[this.idx],this.current}advance(){if(this.idx<this.maxIdx){this.idx++,this.idx===this.maxIdx&&(this.hasNext=this.unitIndex+1<this.structure.units.length);return}if(this.idx=0,this.unitIndex++,this.unitIndex>=this.structure.units.length){this.hasNext=!1;return}this.current.unit=this.structure.units[this.unitIndex],this.elements=this.current.unit.elements,this.maxIdx=this.elements.length-1,this.maxIdx===0&&(this.hasNext=this.unitIndex+1<this.structure.units.length)}constructor(R){this.structure=R,this.unitIndex=0,this.maxIdx=0,this.idx=-1,this.current=ht.Location.create(R),this.hasNext=R.elementCount>0,this.hasNext&&(this.elements=R.units[0].elements,this.maxIdx=this.elements.length-1,this.current.unit=R.units[0])}}e.ElementLocationIterator=w;let D=N();function z(k,R,V){let{elements:j,conformation:oe}=k,ae=D,ne=Number.MAX_VALUE;for(let q=0,F=j.length;q<F;q++){let W=j[q],re=N.distance(R,oe.position(W,ae))-V-oe.r(W);re<ne&&(ne=re)}return ne}function ie(k,R,V){let{units:j}=k,oe=Number.MAX_VALUE;for(let ae=0,ne=j.length;ae<ne;ae++){let q=j[ae],F=z(q,R,V);F<oe&&(oe=F)}return oe}e.minDistanceToPoint=ie;let O=N();function Q(k,R){if(k.elementCount===0||R.elementCount===0)return 0;let{units:V}=k,j=Number.MAX_VALUE;for(let oe=0,ae=V.length;oe<ae;oe++){let ne=V[oe],{elements:q,conformation:F}=ne;for(let W=0,re=q.length;W<re;W++){let _e=q[W],Ae=ie(R,F.position(_e,O),F.r(_e));Ae<j&&(j=Ae)}}return j}e.distance=Q;function K(k){return k.elementCount===1?"1 element":`${k.elementCount} elements`}e.elementDescription=K;function Z(k,R,V){return k.masterModel?R.model===V.model||R.model===k.masterModel||V.model===k.masterModel:R.model===V.model}e.validUnitPair=Z;function se(k,R,V){let{maxRadius:j,validUnit:oe,validUnitPair:ae}=V;if(!k.units.some(F=>oe(F)))return;let ne=k.lookup3d,q=N();for(let F of k.units){if(!oe(F))continue;let W=F.boundary.sphere;N.transformMat4(q,W.center,F.conformation.operator.matrix);let re=ne.findUnitIndices(q[0],q[1],q[2],W.radius+j);for(let _e=0;_e<re.count;_e++){let Ae=k.units[re.indices[_e]];F.id>=Ae.id||!oe(Ae)||!ae(F,Ae)||(Ae.elements.length>=F.elements.length?R(F,Ae):R(Ae,F))}}}e.eachUnitPair=se;function fe(k,{chain:R,residue:V,atom:j}){let oe=ht.Location.create(k);for(let ae of k.units){if(ae.kind!==0)continue;oe.unit=ae;let{elements:ne}=ae,q=We.transientSegments(ae.model.atomicHierarchy.chainAtomSegments,ne),F=We.transientSegments(ae.model.atomicHierarchy.residueAtomSegments,ne);for(;q.hasNext;){let W=q.move();if(R&&(oe.element=ne[W.start],R(oe)),!(!V&&!j))for(F.setSegment(W);F.hasNext;){let re=F.move();if(V&&(oe.element=ne[re.start],V(oe)),!!j)for(let _e=re.start,Ae=re.end;_e<Ae;_e++)oe.element=ne[_e],j(oe)}}}}e.eachAtomicHierarchyElement=fe,e.DefaultSizeThresholds={smallResidueCount:10,mediumResidueCount:5e3,largeResidueCount:3e4,highSymmetryUnitCount:10,fiberResidueCount:15};function Ce(k){return k.unitSymmetryGroups.filter(R=>R.units[0].polymerElements.length>0)}function xe(k,R){let V=Ce(k);return V.length===1&&V[0].units.length>2&&V[0].units[0].polymerElements.length<R.fiberResidueCount}function H(k,R){let V=Ce(k);return V.length>=1&&V[0].units.length>R.highSymmetryUnitCount}let $;(function(k){k[k.Small=0]="Small",k[k.Medium=1]="Medium",k[k.Large=2]="Large",k[k.Huge=3]="Huge",k[k.Gigantic=4]="Gigantic"})($=e.Size||(e.Size={}));function de(k,R={},V=1){let j=Le(Le({},e.DefaultSizeThresholds),R);return k.polymerResidueCount>=j.largeResidueCount*V?H(k,j)?$.Huge:$.Gigantic:xe(k,j)||k.polymerResidueCount<j.smallResidueCount*V?$.Small:k.polymerResidueCount<j.mediumResidueCount*V?$.Medium:$.Large}e.getSize=de,e.Index=gi.createSimple("index","root"),e.MaxIndex=gi.createSimple("max_index","root");let T="__PrincipalAxes__";function B(k){if(k.currentPropertyData[T])return k.currentPropertyData[T];let R=ht.Loci.getPrincipalAxes(e.toStructureElementLoci(k));return k.currentPropertyData[T]=R,R}e.getPrincipalAxes=B})(ot||(ot={}));var S3=Ot.diff;function Hr(e,t){return{kind:"element-loci",structure:e,elements:t}}(function(e){function t(B){return!!B&&B.kind==="element-loci"}e.is=t;function n(B,k){if(B.structure!==k.structure||B.elements.length!==k.elements.length)return!1;for(let R=0,V=B.elements.length;R<V;++R){let j=B.elements[R],oe=k.elements[R];if(j.unit.id!==oe.unit.id||!Ie.areEqual(j.indices,oe.indices))return!1}return!0}e.areEqual=n;function r(B){for(let k of B.elements)if(Ie.size(k.indices)>0)return!1;return!0}e.isEmpty=r;function i(B){return o(B)===B.structure.elementCount}e.isWholeStructure=i;function o(B){let k=0;for(let{indices:R}of B.elements)typeof R=="number"?k+=S3(R):k+=R.length;return k}e.size=o;function s(B){return e(B,B.units.map(k=>({unit:k,indices:Ie.ofBounds(0,k.elements.length)})))}e.all=s;function a(B){return e(B,[])}e.none=a;function c(B,k){if(r(B))return;let R=B.elements[0].unit,V=R.elements[Ie.getAt(B.elements[0].indices,0)];return k?(k.structure=B.structure,k.unit=B.elements[0].unit,k.element=V,k):yt.create(B.structure,R,V)}e.getFirstLocation=c;function u(B){return r(B)?B:e(B.structure,[{unit:B.elements[0].unit,indices:Ie.ofSingleton(Ie.start(B.elements[0].indices))}])}e.firstElement=u;function l(B){return r(B)?B:b(u(B))}e.firstResidue=l;function m(B){return r(B)?B:P(u(B))}e.firstChain=m;function f(B){let k=[];for(let R of B.elements){let{unit:V,indices:j}=R,oe=new Int32Array(Ie.size(j));Ie.forEach(j,(ae,ne)=>oe[ne]=V.elements[ae]),k.push(V.getChild(le.ofSortedArray(oe)))}return ot.create(k,{parent:B.structure.parent})}e.toStructure=f;function d(B,k){if(e.isEmpty(B))return;let R=yt.create(B.structure);for(let V of B.elements){let{unit:j,indices:oe}=V;R.unit=j;let{elements:ae}=V.unit;for(let ne=0,q=Ie.size(oe);ne<q;ne++)R.element=ae[Ie.getAt(oe,ne)],k(R)}}e.forEachLocation=d;function p(B,k){if(k===B.structure)return B;let R=[];return B.elements.forEach(V=>{if(!k.unitMap.has(V.unit.id))return;let j=k.unitMap.get(V.unit.id),oe=Ie.indexedIntersect(V.indices,V.unit.elements,j.elements);Ie.size(oe)>0&&R.push({unit:j,indices:oe})}),e(k,R)}e.remap=p;function h(B,k){if(B.elements.length>k.elements.length)return h(k,B);if(e.isEmpty(B))return k;let R=new Map;for(let j of B.elements)R.set(j.unit.id,j.indices);let V=[];for(let j of k.elements)R.has(j.unit.id)?(V[V.length]={unit:j.unit,indices:Ie.union(R.get(j.unit.id),j.indices)},R.delete(j.unit.id)):V[V.length]=j;return R.forEach((j,oe)=>{V[V.length]={unit:B.structure.unitMap.get(oe),indices:j}}),e(B.structure,V)}e.union=h;function x(B,k){let R=new Map;for(let j of k.elements)R.set(j.unit.id,j.indices);let V=[];for(let j of B.elements)if(R.has(j.unit.id)){let oe=Ie.subtract(j.indices,R.get(j.unit.id));if(Ie.size(oe)===0)continue;V[V.length]={unit:j.unit,indices:oe}}else V[V.length]=j;return e(B.structure,V)}e.subtract=x;function y(B,k){let R=new Map;for(let j of B.elements)R.set(j.unit.id,j.indices);let V=[];for(let j of k.elements){if(!R.has(j.unit.id))continue;let oe=Ie.intersect(R.get(j.unit.id),j.indices);Ie.size(oe)!==0&&(V[V.length]={unit:j.unit,indices:oe})}return e(B.structure,V)}e.intersect=y;function g(B,k){if(B.elements.length>k.elements.length)return g(k,B);if(e.isEmpty(B))return e.isEmpty(k);let R=new Map;for(let V of B.elements)R.set(V.unit.id,V.indices);for(let V of k.elements)if(R.has(V.unit.id)&&Ie.areIntersecting(R.get(V.unit.id),V.indices))return!0;return!1}e.areIntersecting=g;function C(B,k){if(e.isEmpty(B))return e.isEmpty(k);let R=new Map;for(let j of B.elements)R.set(j.unit.id,j.indices);let V=!1;for(let j of k.elements)if(R.has(j.unit.id))if(Ie.isSubset(R.get(j.unit.id),j.indices))V=!0;else return!1;return V}e.isSubset=C;function _(B){return B.length>3&&le.isRange(B)?ue.ofRange(B[0],B[B.length-1]):le.ofSortedArray(B)}function b(B,k){let R=[],V=new Set;for(let j of B.elements){if(E(j)){R[R.length]=j;continue}if(j.unit.kind===0){let oe=j.unit.elements,ae=j.unit.model.atomicHierarchy,{label_alt_id:ne}=j.unit.model.atomicHierarchy.atoms,{index:q,offsets:F}=ae.residueAtomSegments,W=[],re=j.indices,_e=Ie.size(re),Ae=0;for(;Ae<_e;){V.clear();let Ze=oe[Ie.getAt(re,Ae)],A=q[Ze];for(V.add(ne.value(Ze)),Ae++;Ae<_e;){let te=oe[Ie.getAt(re,Ae)];if(q[te]!==A)break;V.add(ne.value(te)),Ae++}let M=V.has("");for(let te=F[A],ce=F[A+1];te<ce;te++){let pe=Ie.indexOf(oe,te);if(pe>=0){let he=ne.value(te);(!k||M||!he||V.has(he))&&(W[W.length]=pe)}}}R[R.length]={unit:j.unit,indices:_(W)}}else R[R.length]=j}return e(B.structure,R)}e.extendToWholeResidues=b;function I(B){switch(B.kind){case 0:return B.model.atomicHierarchy.chainAtomSegments;case 1:return B.model.coarseHierarchy.spheres.chainElementSegments;case 2:return B.model.coarseHierarchy.gaussians.chainElementSegments}}function E(B){return B.unit.elements.length===Ie.size(B.indices)}function S(B,k,R){let{index:V}=I(B),j=B.elements,oe=0;for(let ne=0,q=j.length;ne<q;ne++){let F=j[ne],W=V[F];k.has(W)&&oe++}if(oe===B.elements.length){R[R.length]={unit:B,indices:ue.ofBounds(0,oe)};return}let ae=new Int32Array(oe);oe=0;for(let ne=0,q=j.length;ne<q;ne++){let F=j[ne],W=V[F];k.has(W)&&(ae[oe++]=ne)}ae.length>0&&(R[R.length]={unit:B,indices:_(ae)})}function v(B,k,R,V,j){let{index:oe}=I(B.elements[0].unit),ae=new Set;for(let ne=k;ne<R;ne++){let q=B.elements[ne],F=q.indices,W=q.unit.elements;for(let re=0,_e=Ie.size(F);re<_e;re++)ae.add(oe[W[Ie.getAt(F,re)]])}if(V){let ne=B.elements[0].unit;for(let q of B.structure.units)ge.areSameChainOperatorGroup(q,ne)&&S(q,ae,j)}else for(let ne=k;ne<R;ne++)S(B.elements[ne].unit,ae,j)}function P(B){let k=[];for(let R=0,V=B.elements.length;R<V;R++){let j=B.elements[R];if(ge.Traits.is(j.unit.traits,ge.Trait.Partitioned)){let oe=R;for(;R<V&&ge.areSameChainOperatorGroup(B.elements[R].unit,j.unit);)R++;let ae=R;R--,v(B,oe,ae,!0,k)}else E(j)?k[k.length]=j:v(B,R,R+1,!1,k)}return e(B.structure,k)}e.extendToWholeChains=P;function L(B){return`${B.unit.model.id}|${Ye.entity.id(B)}`}function w(B){let k=[],R=yt.create(B.structure),V=new Set,{units:j}=B.structure;for(let oe=0,ae=B.elements.length;oe<ae;oe++){let ne=B.elements[oe];R.unit=ne.unit,R.element=ne.unit.elements[0],V.add(L(R))}for(let oe=0,ae=j.length;oe<ae;++oe){let ne=j[oe];if(R.unit=ne,R.element=ne.elements[0],V.has(L(R))){let q=Ie.ofBounds(0,ne.elements.length);k[k.length]={unit:ne,indices:q}}}return e(B.structure,k)}e.extendToWholeEntities=w;function D(B){let k=[],R=new Set,{units:V}=B.structure;for(let j=0,oe=B.elements.length;j<oe;j++){let ae=B.elements[j];R.add(ae.unit.model.id)}for(let j=0,oe=V.length;j<oe;++j){let ae=V[j];if(R.has(ae.model.id)){let ne=Ie.ofBounds(0,ae.elements.length);k[k.length]={unit:ae,indices:ne}}}return e(B.structure,k)}e.extendToWholeModels=D;function z(B,k){let R=[];for(let V=0,j=Ie.size(k);V<j;++V)R.push(B[Ie.getAt(k,V)]);return le.ofSortedArray(R)}function ie(B,k){return le.isRange(B)&&le.areEqual(B,k)?ue.ofLength(B.length):_(le.indicesOf(B,k))}function O(B){let k=[],R=new Map;for(let V=0,j=B.elements.length;V<j;V++){let oe=B.elements[V],{model:ae}=oe.unit,ne=z(oe.unit.elements,oe.indices);R.has(ae)?R.set(ae,le.union(ne,R.get(ae))):R.set(ae,ne)}for(let V=0,j=B.structure.units.length;V<j;++V){let oe=B.structure.units[V],ae=R.get(oe.model);if(!ae)continue;let ne=ie(oe.elements,ae);Ie.size(ne)&&(k[k.length]={unit:oe,indices:ne})}return e(B.structure,k)}e.extendToAllInstances=O;function Q(B){let k=[],R=new Set,{units:V}=B.structure;for(let j=0,oe=B.elements.length;j<oe;j++){let ae=B.elements[j];R.add(ae.unit.conformation.operator.name)}for(let j=0,oe=V.length;j<oe;++j){let ae=V[j];if(R.has(ae.conformation.operator.name)){let ne=Ie.ofBounds(0,ae.elements.length);k[k.length]={unit:ae,indices:ne}}}return e(B.structure,k)}e.extendToWholeOperators=Q;let K=new ir("98"),Z=N();function se(B,k){K.reset();for(let R of B.elements){let{indices:V}=R,{elements:j,conformation:oe}=R.unit;for(let ae=0,ne=Ie.size(V);ae<ne;ae++){let q=j[Ie.getAt(V,ae)];oe.position(q,Z),k&&N.transformMat4(Z,Z,k),K.includePositionRadius(Z,oe.r(q))}}K.finishedIncludeStep();for(let R of B.elements){let{indices:V}=R,{elements:j,conformation:oe}=R.unit;for(let ae=0,ne=Ie.size(V);ae<ne;ae++){let q=j[Ie.getAt(V,ae)];oe.position(q,Z),k&&N.transformMat4(Z,Z,k),K.radiusPositionRadius(Z,oe.r(q))}}return{box:K.getBox(),sphere:K.getSphere()}}e.getBoundary=se;let fe=N();function Ce(B,k,R=0){let V=R;for(let j of B.elements){let{indices:oe}=j,{elements:ae,conformation:ne}=j.unit,q=Ie.size(oe);for(let F=0;F<q;F++){let W=ae[Ie.getAt(oe,F)];ne.position(W,fe),N.toArray(fe,k,V+F*3)}V+=q*3}return k}e.toPositionsArray=Ce;function xe(B){let k=o(B),R=Ce(B,new Float32Array(3*k));return mn.ofPositions(R)}e.getPrincipalAxes=xe;function H(B){let k=0;B.forEach(j=>{k+=o(j)});let R=new Float32Array(3*k),V=0;return B.forEach(j=>{Ce(j,R,V),V+=o(j)*3}),mn.ofPositions(R)}e.getPrincipalAxesMany=H;function $(B,k){return ge.isAtomic(B)?B.model.atomicHierarchy.atomSourceIndex.value(k):k}function de(B){if(e.isEmpty(B))return St.struct.generator.empty();let k=B.structure.models,R=new Map;for(let ne of B.elements){let{indices:q}=ne,{elements:F}=ne.unit,W=ne.unit.conformation.operator.name,re;R.has(W)?re=R.get(W).xs:(re=It.create(),R.set(W,{modelLabel:ne.unit.model.label,modelIndex:ne.unit.model.modelNum,xs:re}));for(let _e=0,Ae=Ie.size(q);_e<Ae;_e++){let Ze=$(ne.unit,F[Ie.getAt(q,_e)]);It.add(re,Ze,Ze)}}let V=[],j=R.keys();for(;;){let ne=j.next();if(ne.done)break;let q=R.get(ne.value);V.push(T(ne.value,q.xs.array,k.length>1,q.modelLabel,q.modelIndex))}let oe=new Map;for(let ne=0,q=V.length;ne<q;++ne){let F=V[ne],re=`${Dr(Yn(F.atom.ranges),Yn(F.atom.set))}|${F.entity?F.entity.modelLabel+F.entity.modelIndex:""}`;oe.has(re)?oe.get(re).chain.opName.push(...F.chain.opName):oe.set(re,F)}let ae=[];return oe.forEach(ne=>{let{ranges:q,set:F}=ne.atom,{opName:W}=ne.chain,re=St.struct.atomProperty.core.operatorName(),_e=St.struct.atomProperty.core.sourceIndex(),Ae=[];F.length>0&&(Ae[Ae.length]=St.core.set.has([St.core.type.set(F),_e]));for(let Ze=0,A=q.length/2;Ze<A;Ze++)Ae[Ae.length]=St.core.rel.inRange([_e,q[2*Ze],q[2*Ze+1]]);if(ne.entity){let{modelLabel:Ze,modelIndex:A}=ne.entity;ae.push(St.struct.generator.atomGroups({"atom-test":Ae.length>1?St.core.logic.or(Ae):Ae[0],"chain-test":W.length>1?St.core.set.has([St.core.type.set(W),re]):St.core.rel.eq([re,W[0]]),"entity-test":St.core.logic.and([St.core.rel.eq([St.struct.atomProperty.core.modelLabel(),Ze]),St.core.rel.eq([St.struct.atomProperty.core.modelIndex(),A])])}))}else ae.push(St.struct.generator.atomGroups({"atom-test":Ae.length>1?St.core.logic.or(Ae):Ae[0],"chain-test":W.length>1?St.core.set.has([St.core.type.set(W),re]):St.core.rel.eq([re,W[0]])}))}),St.struct.modifier.union([ae.length===1?ae[0]:St.struct.combinator.merge(ae.map(ne=>St.struct.modifier.union([ne])))])}e.toExpression=de;function T(B,k,R,V,j){jt(k);let oe=[],ae=[],ne=0,q=k.length;for(;ne<q;){let F=ne;for(ne++;ne<q&&k[ne-1]+1===k[ne];)ne++;let W=ne;if(W-F>12)oe[oe.length]=k[F],oe[oe.length]=k[W-1];else for(let re=F;re<W;re++)ae[ae.length]=k[re]}return R?{atom:{set:ae,ranges:oe},chain:{opName:[B]},entity:{modelLabel:V,modelIndex:j}}:{atom:{set:ae,ranges:oe},chain:{opName:[B]}}}})(Hr||(Hr={}));var ku;(function(e){function t(){return{elementCount:0,conformationCount:0,residueCount:0,chainCount:0,unitCount:0,structureCount:0,firstElementLoc:yt.create(void 0),firstConformationLoc:yt.create(void 0),firstResidueLoc:yt.create(void 0),firstChainLoc:yt.create(void 0),firstUnitLoc:yt.create(void 0),firstStructureLoc:yt.create(void 0)}}e.create=t;function n(c,u,l){let m=c.get(u)||0;c.set(u,m+l)}function r(c,u,l){let{indices:m,unit:f}=l,{elements:d}=f,p=Ie.size(m),h=new Map,x=new Map;if(p>0&&yt.set(c.firstElementLoc,u,f,d[Ie.start(m)]),p===d.length)c.unitCount+=1,c.unitCount===1&&yt.set(c.firstUnitLoc,u,f,d[Ie.start(m)]);else if(p===1){if(ge.Traits.is(f.traits,ge.Trait.MultiChain))return;c.elementCount+=1,c.elementCount===1&&yt.set(c.firstElementLoc,u,f,d[Ie.start(m)])}else if(ge.isAtomic(f)){let{index:y,offsets:g}=f.model.atomicHierarchy.residueAtomSegments,{label_alt_id:C}=f.model.atomicHierarchy.atoms,_=0;for(;_<p;){h.clear();let b=0,I=d[Ie.getAt(m,_)],E=y[I];for(n(h,C.value(I),1),++_,++b;_<p;){let S=d[Ie.getAt(m,_)];if(y[S]!==E)break;n(h,C.value(S),1),++_,++b}if(g[E+1]-g[E]===b)c.residueCount+=1,c.residueCount===1&&yt.set(c.firstResidueLoc,u,f,g[E]);else{x.clear();for(let S=g[E],v=g[E+1];S<v;++S)n(x,C.value(S),1);x.get("")===h.get("")&&h.forEach((S,v)=>{if(x.get(v)===S){if(v!==""&&(c.conformationCount+=1,c.conformationCount===1)){for(let P=g[E],L=g[E+1];P<L;++P)if(v===C.value(P)){yt.set(c.firstConformationLoc,u,f,P);break}}b-=S}}),c.elementCount+=b}}}else c.elementCount+=p,c.elementCount===1&&yt.set(c.firstElementLoc,u,f,d[Ie.start(m)])}function i(c,u,l){let{indices:m,unit:f}=l,d=Ie.size(m);if(d===0)return;let{elements:p}=f;if(!ge.Traits.is(f.traits,ge.Trait.MultiChain)){d===p.length&&(c.chainCount+=1,c.chainCount===1&&yt.set(c.firstChainLoc,u,f,p[Ie.start(m)]));return}let h=ge.isAtomic(f)?f.model.atomicHierarchy.chainAtomSegments:ge.isSpheres(f)?f.model.coarseHierarchy.spheres.chainElementSegments:ge.isGaussians(f)?f.model.coarseHierarchy.gaussians.chainElementSegments:void 0;if(!h){console.warn("StructureElement loci stats: unknown unit type");return}let{index:x,offsets:y}=h,g=0;for(;g<d;){let C=0,_=p[Ie.getAt(m,g)],b=x[_];for(++g,++C;g<d;){let I=p[Ie.getAt(m,g)];if(x[I]!==b)break;++g,++C}y[b+1]-y[b]===C?(c.chainCount+=1,c.chainCount===1&&yt.set(c.firstChainLoc,u,f,y[b])):d===1&&(c.elementCount+=1,c.elementCount===1&&yt.set(c.firstElementLoc,u,f,_))}}function o(c,u,l,m,f){let d=l[m],p=ge.isAtomic(d.unit)?d.unit.model.atomicHierarchy.chainAtomSegments:ge.isSpheres(d.unit)?d.unit.model.coarseHierarchy.spheres.chainElementSegments:ge.isGaussians(d.unit)?d.unit.model.coarseHierarchy.gaussians.chainElementSegments:void 0;if(!p){console.warn("StructureElement loci stats: unknown unit type");return}let{index:h,offsets:x}=p,y=new Map;for(let C=m;C<f;C++){d=l[C];let{indices:_,unit:b}=d,I=Ie.size(_);if(I===0)continue;let{elements:E}=b;if(!ge.Traits.is(b.traits,ge.Trait.MultiChain)){let v=E[Ie.start(_)];n(y,h[v],E.length);continue}let S=0;for(;S<I;){let v=0,P=E[Ie.getAt(_,S)],L=h[P];for(++S,++v;S<I;){let w=E[Ie.getAt(_,S)];if(h[w]!==L)break;++S,++v}n(y,L,v)}}let g=-1;if(y.forEach((C,_)=>{x[_+1]-x[_]===C&&(c.chainCount+=1,c.chainCount===1&&(g=_))}),!(g<0))for(let C=m;C<f;C++){d=l[C];let{indices:_,unit:b}=d,I=Ie.size(_);if(I===0)continue;let{elements:E}=b,S=0;for(;S<I;){let v=E[Ie.getAt(_,S)];if(h[v]===g){yt.set(c.firstChainLoc,u,b,v);return}}}}function s(c){let u=t();if(Hr.isEmpty(c))return u;let l=!1;if(Hr.isWholeStructure(c)){if(u.structureCount+=1,u.structureCount===1){let{unit:m,indices:f}=c.elements[0];yt.set(u.firstStructureLoc,c.structure,m,m.elements[Ie.min(f)])}}else for(let m of c.elements)r(u,c.structure,m),ge.Traits.is(m.unit.traits,ge.Trait.Partitioned)?l=!0:i(u,c.structure,m);if(l)for(let m=0,f=c.elements.length;m<f;m++){let d=c.elements[m];if(!ge.Traits.is(d.unit.traits,ge.Trait.Partitioned))continue;let p=m;for(;m<f&&ge.areSameChainOperatorGroup(c.elements[m].unit,d.unit);)m++;let h=m;m--,h-p===1?i(u,c.structure,d):o(u,c.structure,c.elements,p,h)}return u}e.ofLoci=s;function a(c,u,l){return u.elementCount===1&&l.elementCount===0?yt.copy(c.firstElementLoc,u.firstElementLoc):u.elementCount===0&&l.elementCount===1&&yt.copy(c.firstElementLoc,l.firstElementLoc),u.conformationCount===1&&l.conformationCount===0?yt.copy(c.firstConformationLoc,u.firstConformationLoc):u.conformationCount===0&&l.conformationCount===1&&yt.copy(c.firstConformationLoc,l.firstConformationLoc),u.residueCount===1&&l.residueCount===0?yt.copy(c.firstResidueLoc,u.firstResidueLoc):u.residueCount===0&&l.residueCount===1&&yt.copy(c.firstResidueLoc,l.firstResidueLoc),u.chainCount===1&&l.chainCount===0?yt.copy(c.firstChainLoc,u.firstChainLoc):u.chainCount===0&&l.chainCount===1&&yt.copy(c.firstChainLoc,l.firstChainLoc),u.unitCount===1&&l.unitCount===0?yt.copy(c.firstUnitLoc,u.firstUnitLoc):u.unitCount===0&&l.unitCount===1&&yt.copy(c.firstUnitLoc,l.firstUnitLoc),u.structureCount===1&&l.structureCount===0?yt.copy(c.firstStructureLoc,u.firstStructureLoc):u.structureCount===0&&l.structureCount===1&&yt.copy(c.firstStructureLoc,l.firstStructureLoc),c.elementCount=u.elementCount+l.elementCount,c.conformationCount=u.conformationCount+l.conformationCount,c.residueCount=u.residueCount+l.residueCount,c.chainCount=u.chainCount+l.chainCount,c.unitCount=u.unitCount+l.unitCount,c.structureCount=u.structureCount+l.structureCount,c}e.add=a})(ku||(ku={}));function I3(e){return e}function d1(e){throw new Error(`Property only available for ${e} models.`)}function w3(e){return t=>ge.isAtomic(t.unit)?e(t):d1("atomic")}function v3(e){return t=>ge.isCoarse(t.unit)?e(t):d1("coarse")}function P3(e){return ge.isAtomic(e.unit)?e.unit.residueIndex[e.element]:-1}function B3(e){return ge.isAtomic(e.unit)?e.unit.chainIndex[e.element]:-1}function E3(e){return Ye.entity.key(e)}var ha;(function(e){e.Provider=$r.createProvider({label:"SIFTS Mapping",descriptor:xn({name:"sifts_sequence_mapping"}),type:"static",defaultParams:{},getParams:()=>({}),isApplicable:o=>t(o),obtain:(o,s)=>Ve(this,null,function*(){return{value:i(s)}})});function t(o){if(!_t.is(o.sourceData))return!1;let{pdbx_sifts_xref_db_name:s,pdbx_sifts_xref_db_acc:a,pdbx_sifts_xref_db_num:c,pdbx_sifts_xref_db_res:u}=o.sourceData.data.db.atom_site;return s.isDefined&&a.isDefined&&c.isDefined&&u.isDefined}e.isAvailable=t;function n(o){let s=o.unit.model,a=e.Provider.get(s).value;if(!a)return"";let c=s.atomicHierarchy.residueAtomSegments.index[o.element];return a.accession[c]}e.getKey=n;function r(o){let s=o.unit.model,a=e.Provider.get(s).value;if(!a)return;let c=s.atomicHierarchy.residueAtomSegments.index[o.element],u=a.dbName[c];if(u)return`${u} ${a.accession[c]} ${a.num[c]} ${a.residue[c]}`}e.getLabel=r;function i(o){if(!_t.is(o.sourceData))return;let{pdbx_sifts_xref_db_name:s,pdbx_sifts_xref_db_acc:a,pdbx_sifts_xref_db_num:c,pdbx_sifts_xref_db_res:u}=o.sourceData.data.db.atom_site;if(!s.isDefined||!a.isDefined||!c.isDefined||!u.isDefined)return;let{atomSourceIndex:l}=o.atomicHierarchy,{count:m,offsets:f}=o.atomicHierarchy.residueAtomSegments,d=new Array(m),p=new Array(m),h=new Array(m),x=new Array(m);for(let y=0;y<m;y++){let g=l.value(f[y]);if(s.valueKind(g)!==0){d[y]="",p[y]="",h[y]="",x[y]="";continue}d[y]=s.value(g),p[y]=a.value(g),h[y]=c.value(g),x[y]=u.value(g)}return{dbName:d,accession:p,num:h,residue:x}}})(ha||(ha={}));var AU=At.Field,Vn=At.Encodings;function D3(e){let t=Ye.chain.label_asym_id(e),n=e.unit.conformation.operator.suffix;return n?t+n:t}function M3(e){let t=Ye.chain.auth_asym_id(e),n=e.unit.conformation.operator.suffix;return n?t+n:t}var m1={shouldInclude(e){var t;return!!(!((t=e.atom_site)===null||t===void 0)&&t.pdbx_label_index.isDefined)},value(e,t){let n=t.sourceIndex.value(e.element);return t.atom_site.pdbx_label_index.value(n)}},Rn={shouldInclude(e){return ha.isAvailable(e.structure.models[0])},pdbx_sifts_xref_db_name:{value(e,t){let n=t.sourceIndex.value(e.element);return t.atom_site.pdbx_sifts_xref_db_name.value(n)},valueKind(e,t){let n=t.sourceIndex.value(e.element);return t.atom_site.pdbx_sifts_xref_db_name.valueKind(n)}},pdbx_sifts_xref_db_acc:{value(e,t){let n=t.sourceIndex.value(e.element);return t.atom_site.pdbx_sifts_xref_db_acc.value(n)},valueKind(e,t){let n=t.sourceIndex.value(e.element);return t.atom_site.pdbx_sifts_xref_db_acc.valueKind(n)}},pdbx_sifts_xref_db_num:{value(e,t){let n=t.sourceIndex.value(e.element);return t.atom_site.pdbx_sifts_xref_db_num.value(n)},valueKind(e,t){let n=t.sourceIndex.value(e.element);return t.atom_site.pdbx_sifts_xref_db_num.valueKind(n)}},pdbx_sifts_xref_db_res:{value(e,t){let n=t.sourceIndex.value(e.element);return t.atom_site.pdbx_sifts_xref_db_res.value(n)},valueKind(e,t){let n=t.sourceIndex.value(e.element);return t.atom_site.pdbx_sifts_xref_db_res.valueKind(n)}}},N3=()=>At.fields().str("group_PDB",Ye.residue.group_PDB).index("id").str("type_symbol",Ye.atom.type_symbol).str("label_atom_id",Ye.atom.label_atom_id).str("label_comp_id",Ye.atom.label_comp_id).int("label_seq_id",Ye.residue.label_seq_id,{encoder:Vn.deltaRLE,valueKind:(e,t)=>{let n=e.unit.model;return n.atomicHierarchy.residues.label_seq_id.valueKind(n.atomicHierarchy.residueAtomSegments.index[e.element])}}).str("label_alt_id",Ye.atom.label_alt_id).str("pdbx_PDB_ins_code",Ye.residue.pdbx_PDB_ins_code).str("label_asym_id",D3).str("label_entity_id",Ye.chain.label_entity_id).float("Cartn_x",Ye.atom.x,{digitCount:3,encoder:Vn.fixedPoint3}).float("Cartn_y",Ye.atom.y,{digitCount:3,encoder:Vn.fixedPoint3}).float("Cartn_z",Ye.atom.z,{digitCount:3,encoder:Vn.fixedPoint3}).float("occupancy",Ye.atom.occupancy,{digitCount:2,encoder:Vn.fixedPoint2}).float("B_iso_or_equiv",Ye.atom.B_iso_or_equiv,{digitCount:2,encoder:Vn.fixedPoint2}).int("pdbx_formal_charge",Ye.atom.pdbx_formal_charge,{encoder:Vn.deltaRLE,valueKind:(e,t)=>e.unit.model.atomicHierarchy.atoms.pdbx_formal_charge.valueKind(e.element)}).str("auth_atom_id",Ye.atom.auth_atom_id).str("auth_comp_id",Ye.atom.auth_comp_id).int("auth_seq_id",Ye.residue.auth_seq_id,{encoder:Vn.deltaRLE}).str("auth_asym_id",M3).int("pdbx_PDB_model_num",Ye.unit.model_num,{encoder:Vn.deltaRLE}).int("pdbx_label_index",m1.value,{shouldInclude:m1.shouldInclude}).str("pdbx_sifts_xref_db_name",Rn.pdbx_sifts_xref_db_name.value,{shouldInclude:Rn.shouldInclude,valueKind:Rn.pdbx_sifts_xref_db_name.valueKind}).str("pdbx_sifts_xref_db_acc",Rn.pdbx_sifts_xref_db_acc.value,{shouldInclude:Rn.shouldInclude,valueKind:Rn.pdbx_sifts_xref_db_acc.valueKind}).str("pdbx_sifts_xref_db_num",Rn.pdbx_sifts_xref_db_num.value,{shouldInclude:Rn.shouldInclude,valueKind:Rn.pdbx_sifts_xref_db_num.valueKind}).str("pdbx_sifts_xref_db_res",Rn.pdbx_sifts_xref_db_res.value,{shouldInclude:Rn.shouldInclude,valueKind:Rn.pdbx_sifts_xref_db_res.valueKind}).getFields(),p1={name:"atom_site",instance({structures:e}){return{fields:N3(),source:e.map(t=>({data:{structure:t,sourceIndex:t.model.atomicHierarchy.atomSourceIndex,atom_site:_t.is(t.model.sourceData)?t.model.sourceData.data.db.atom_site:void 0},rowCount:t.elementCount,keys:()=>t.elementLocations()}))}}};function bi(e,t){return e?`${e}_${t}`:t}function k3(e){return e?`pdbx_${e}_PDB_ins_code`:"pdbx_PDB_ins_code"}function Pr(e,t){return(n,r)=>t(e(n,r))}function U3(e,t,n){n&&n.includeModelNum&&e.int("pdbx_PDB_model_num",Pr(t,Ye.unit.model_num))}function To(e,t){let n=t&&t.prefix,r=At.fields().str(bi(n,"label_comp_id"),Pr(e,Ye.atom.label_comp_id)).int(bi(n,"label_seq_id"),Pr(e,Ye.residue.label_seq_id),{encoder:Vn.deltaRLE,valueKind:(i,o)=>{let s=e(i,o),a=s.unit.model;return a.atomicHierarchy.residues.label_seq_id.valueKind(a.atomicHierarchy.residueAtomSegments.index[s.element])}}).str(k3(n),Pr(e,Ye.residue.pdbx_PDB_ins_code)).str(bi(n,"label_asym_id"),Pr(e,Ye.chain.label_asym_id)).str(bi(n,"label_entity_id"),Pr(e,Ye.chain.label_entity_id)).str(bi(n,"auth_comp_id"),Pr(e,Ye.atom.auth_comp_id)).int(bi(n,"auth_seq_id"),Pr(e,Ye.residue.auth_seq_id),{encoder:Vn.deltaRLE}).str(bi(n,"auth_asym_id"),Pr(e,Ye.chain.auth_asym_id));return U3(r,e,t),r.getFields()}var Qr=At.Field,h1={name:"struct_conf",instance(e){let t=g1(e,"helix");return{fields:T3(),source:[{data:t,rowCount:t.length}]}}},_1={name:"struct_sheet_range",instance(e){let t=g1(e,"sheet").sort(R3);return{fields:F3(),source:[{data:t,rowCount:t.length}]}}};function R3(e,t){let n=e.element,r=t.element;return n.sheet_id<r.sheet_id?-1:n.sheet_id===r.sheet_id?e.start.element-t.start.element:1}var T3=()=>[Qr.str("conf_type_id",(e,t)=>t[e].element.type_id),Qr.str("id",(e,t,n)=>`${t[e].element.type_id}${n+1}`),...To((e,t)=>t[e].start,{prefix:"beg"}),...To((e,t)=>t[e].end,{prefix:"end"}),Qr.str("pdbx_PDB_helix_class",(e,t)=>t[e].element.helix_class),Qr.str("details",(e,t)=>t[e].element.details||"",{valueKind:(e,t)=>t[e].element.details?0:2}),Qr.int("pdbx_PDB_helix_length",(e,t)=>t[e].length)],F3=()=>[Qr.str("sheet_id",(e,t)=>t[e].element.sheet_id),Qr.index("id"),...To((e,t)=>t[e].start,{prefix:"beg"}),...To((e,t)=>t[e].end,{prefix:"end"}),Qr.str("symmetry",(e,t)=>"",{valueKind:(e,t)=>2})];function g1(e,t){let n=zn.Provider.get(e.firstModel);if(!n)return[];let{key:r,elements:i}=n,o=[],s=e.structures[0];for(let{units:a}of s.unitSymmetryGroups){let c=a[0];if(!ge.isAtomic(c))continue;let u=c.model.atomicHierarchy.residueAtomSegments,l=We.transientSegments(u,c.elements),m,f=!0;for(;l.hasNext;){f&&(m=l.move());let d=m.index,p=r[d],h=i[p];if(h.kind!==t){f=!0;continue}let x=d;for(;l.hasNext;)if(x=m.index,m=l.move(),p!==r[m.index]){f=!1,o[o.length]={start:ht.Location.create(s,c,u.offsets[d]),end:ht.Location.create(s,c,u.offsets[x]),length:x-d+1,element:h};break}}}return o}function Ci(e,t){if(_t.is(e.sourceData))return e.sourceData.data.db[t]}function _a(e){return hn.unionMany(...e.map(t=>t.uniqueResidueNames))}function y1(e){if(e.length===0)return new Set;let t=e[0].model.entities.data.id;return new Set(Uu(e).map(n=>t.value(n)))}function Uu(e){if(e.length===0)return[];if(e.length===1)return e[0].entityIndices;let t=It.create();for(let n of e)for(let r of n.entityIndices)It.add(t,r,r);return jt(t.array),t.array}function In(e,t){return{name:e,instance({structures:n}){if(t&&!t(n[0]))return At.Category.Empty;let r=n[0].model;if(!_t.is(r.sourceData))return At.Category.Empty;let i=r.sourceData.data.db[e];return!i||!i._rowCount?At.Category.Empty:At.Category.ofTable(i)}}}var Jr=At.Category,x1={name:"chem_comp",instance({firstModel:e,structures:t,cache:n}){let r=Ci(t[0].model,"chem_comp");if(!r)return Jr.Empty;let{id:i}=r,o=n.uniqueResidueNames||(n.uniqueResidueNames=_a(t)),s=me.indicesOf(i,a=>o.has(a));return Jr.ofTable(r,s)}},A1={name:"chem_comp_bond",instance({firstModel:e,structures:t,cache:n}){let r=Ci(t[0].model,"chem_comp_bond");if(!r)return Jr.Empty;let{comp_id:i}=r,o=n.uniqueResidueNames||(n.uniqueResidueNames=_a(t)),s=me.indicesOf(i,a=>o.has(a));return Jr.ofTable(r,s)}},b1={name:"pdbx_chem_comp_identifier",instance({firstModel:e,structures:t,cache:n}){let r=Ci(e,"pdbx_chem_comp_identifier");if(!r)return Jr.Empty;let{comp_id:i}=r,o=n.uniqueResidueNames||(n.uniqueResidueNames=_a(t)),s=me.indicesOf(i,a=>o.has(a));return Jr.ofTable(r,s)}},C1={name:"pdbx_nonpoly_scheme",instance({firstModel:e,structures:t,cache:n}){let r=Ci(e,"pdbx_nonpoly_scheme");return r?Jr.ofTable(r):Jr.Empty}};var S1=At.Category,I1=Ru("struct_asym"),w1=Ru("entity_poly"),v1=Ru("entity_poly_seq");function Ru(e){return{name:e,instance({structures:t,cache:n}){return O3(t,e,n)}}}function O3(e,t,n){let r=Ci(e[0].model,t);if(!r)return S1.Empty;let{entity_id:i}=r,o=n.uniqueEntityIds||(n.uniqueEntityIds=y1(e)),s=me.indicesOf(i,a=>o.has(a));return S1.ofTable(r,s)}var L3=At.Category,P1;(function(e){function t(n){let r=Array.isArray(n)?n:[n];return{structures:r,firstModel:r[0].model,cache:Object.create(null)}}e.create=t})(P1||(P1={}));var q3={name:"entity",instance({structures:e}){let t=Uu(e);return L3.ofTable(e[0].model.entities.data,t)}};function Fu(e){return e.units.every(t=>t.conformation.operator.isIdentity)}function Tu(e){return Fu(e)&&e.units.every(t=>!t.conformation.operator.assembly&&!t.conformation.operator.suffix)}var eR=[In("entry"),In("exptl"),q3,In("cell",Fu),In("symmetry",Fu),In("pdbx_struct_assembly",Tu),In("pdbx_struct_assembly_gen",Tu),In("pdbx_struct_oper_list",Tu),h1,_1,I1,w1,v1,In("pdbx_entity_branch"),In("pdbx_entity_branch_link"),In("pdbx_branch_scheme"),In("struct_conn"),x1,A1,b1,In("atom_sites"),C1,p1],B1;(function(e){e.AtomSitePositionsFieldNames=new Set(["id","Cartn_x","Cartn_y","Cartn_z"])})(B1||(B1={}));var Be;(function(e){function t(y,g){return{kind:"singletons",source:y,structure:g}}e.Singletons=t;function n(y,g){return{kind:"sequence",source:y,structures:g}}e.Sequence=n;function r(y){return t(y,ot.Empty)}e.Empty=r;function i(y){return y.kind==="singletons"}e.isSingleton=i;function o(y){return i(y)?y.structure.units.length===0:y.structures.length===0}e.isEmpty=o;function s(y){return i(y)?y.structure.elementCount:y.structures.length}e.structureCount=s;function a(y){return o(y)?ot.Empty:i(y)?y.structure:di(y.source,y.structures)}e.unionStructure=a;function c(y){let g=[],{unitMap:C}=y.source;for(let _ of a(y).units)_===C.get(_.id)?g[g.length]={unit:_,indices:Ie.ofBounds(0,_.elements.length)}:g[g.length]={unit:_,indices:Ie.ofSortedArray(le.indicesOf(C.get(_.id).elements,_.elements))};return ht.Loci(y.source,g)}e.toLociWithCurrentUnits=c;function u(y){let g=[],{unitMap:C}=y.source;for(let _ of a(y).units){let b=C.get(_.id);b===_?g[g.length]={unit:b,indices:Ie.ofBounds(0,b.elements.length)}:g[g.length]={unit:b,indices:Ie.ofSortedArray(le.indicesOf(b.elements,_.elements))}}return ht.Loci(y.source,g)}e.toLociWithSourceUnits=u;function l(y,g,C){return g.length===0?r(y):C?t(y,di(y,g)):n(y,g)}class m{add(g){let C=g.elementCount;C!==0&&(this.structures[this.structures.length]=g,C!==1&&(this.allSingletons=!1))}getSelection(){return l(this.source,this.structures,this.allSingletons)}constructor(g){this.source=g,this.structures=[],this.allSingletons=!0}}class f{add(g){let C=g.elementCount;C===0||!this.uniqueSets.add(g)||(this.structures[this.structures.length]=g,C!==1&&(this.allSingletons=!1))}getSelection(){return l(this.structure,this.structures,this.allSingletons)}constructor(g){this.structure=g,this.structures=[],this.allSingletons=!0,this.uniqueSets=wi(ot.hashCode,ot.areUnitIdsAndIndicesEqual)}}function d(y){return new m(y)}e.LinearBuilder=d;function p(y){return new f(y)}e.UniqueBuilder=p;function h(y,g){let C=0;if(e.isSingleton(y))for(let _ of y.structure.units){let{elements:b}=_;for(let I=0,E=b.length;I<E;I++){let S=ot.create([_.getChild(le.ofSingleton(b[I]))],{parent:y.source});g(S,C++)}}else for(let _ of y.structures)g(_,C++)}e.forEach=h;function x(y,g){return i(y)?t(g,y.structure):n(g,y.structures)}e.withInputStructure=x})(Be||(Be={}));export{BA as a,Kn as b,On as c,EA as d,DA as e,MA as f,NA as g,Fn as h,qo as i,Go as j,CA as k,pn as l,Hn as m,Cn as n,VS as o,jS as p,YS as q,ws as r,Lr as s,ZS as t,WS as u,XS as v,$S as w,gr as x,yd as y,tI as z,nI as A,vs as B,fn as C,Qt as D,Eb as E,Rt as F,Pi as G,tl as H,Gb as I,io as J,nl as K,Hb as L,wa as M,va as N,zb as O,iI as P,ri as Q,Zu as R,Dr as S,$u as T,jn as U,Sa as V,xb as W,Yn as X,Ut as Y,Ht as Z,N as _,ke as $,Xt as aa,vi as ba,zo as ca,KA as da,gn as ea,jA as fa,vn as ga,nn as ha,bb as ia,Cb as ja,Ln as ka,me as la,mt as ma,ol as na,$o as oa,ue as pa,le as qa,Ie as ra,We as sa,yn as ta,yc as ua,y4 as va,as as wa,rm as xa,xn as ya,pr as za,Y5 as Aa,Z5 as Ba,W5 as Ca,os as Da,X5 as Ea,i4 as Fa,o4 as Ga,An as Ha,Yp as Ia,s4 as Ja,a4 as Ka,Ya as La,c4 as Ma,Zp as Na,Tr as Oa,xf as Pa,u4 as Qa,l4 as Ra,f4 as Sa,Wa as Ta,Sf as Ua,S4 as Va,If as Wa,I4 as Xa,w4 as Ya,k4 as Za,vf as _a,wt as $a,Di as ab,Jt as bb,en as cb,rn as db,y6 as eb,th as fb,x6 as gb,Mi as hb,ci as ib,M6 as jb,xt as kb,hr as lb,sn as mb,bn as nb,Gt as ob,mn as pb,Kt as qb,on as rb,Xn as sb,hA as tb,It as ub,J as vb,ni as wb,be as xb,ze as yb,Ou as zb,V3 as Ab,Te as Bb,Ii as Cb,St as Db,Zt as Eb,qe as Fb,CI as Gb,SI as Hb,II as Ib,hn as Jb,yr as Kb,UI as Lb,RI as Mb,TI as Nb,Bs as Ob,Nd as Pb,xo as Qb,FI as Rb,Es as Sb,Ds as Tb,Sc as Ub,OI as Vb,LI as Wb,Ms as Xb,Oi as Yb,Li as Zb,wc as _b,kt as $b,$t as ac,qI as bc,Vr as cc,Cr as dc,Ki as ec,tr as fc,rr as gc,CC as hc,BC as ic,EC as jc,DC as kc,MC as lc,yo as mc,xs as nc,pc as oc,cn as pc,vo as qc,zI as rc,kn as sc,Pt as tc,ir as uc,jr as vc,Io as wc,Wt as xc,ge as yc,Qx as zc,di as Ac,B7 as Bc,zs as Cc,im as Dc,Vs as Ec,Be as Fc,C_ as Gc,S_ as Hc,fi as Ic,Hc as Jc,ks as Kc,t8 as Lc,Mn as Mc,xr as Nc,Zd as Oc,qc as Pc,gc as Qc,hd as Rc,BS as Sc,_d as Tc,Qi as Uc,Ji as Vc,_n as Wc,mu as Xc,ua as Yc,la as Zc,_t as _c,yD as $c,xD as ad,pi as bd,nu as cd,_v as dd,Xi as ed,iu as fd,Iv as gd,un as hd,c0 as id,Et as jd,gi as kd,ou as ld,Ye as md,cr as nd,ur as od,ot as pd,ht as qd,$r as rd,ha as sd,EM as td,J0 as ud,vr as vd,ko as wd,Tt as xd};
